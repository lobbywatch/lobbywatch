/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under the MIT license
 */
if(define("pgui.localizer",[],(function(){var deferred=null,locale={translations:{}};return{load:function(){return deferred=deferred||$.getJSON("components/js/jslang.php").done((function(data){locale=data}))},getString:function(code,defaultValue){return void 0!==locale.translations[code]?locale.translations[code]:defaultValue||code},getFirstDayOfWeek:function(){return locale.firstDayOfWeek||0}}})),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,(function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,(function(e,t){return n.call(e,t,e)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(S.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e)||(t=r(e))&&("function"!=typeof(n=v.call(t,"constructor")&&t.constructor)||a.call(n)!==l))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){n["[object "+t+"]"]=t.toLowerCase()}));var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){for((f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;o--;)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){for(var n=e.split("|"),r=n.length;r--;)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le((function(o){return o=+o,le((function(e,t){for(var n,r=a([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))}))}))}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce((function(e){return a.appendChild(e).appendChild(C.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),d.attributes=ce((function(e){return e.className="i",!e.getAttribute("className")})),d.getElementsByTagName=ce((function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length})),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce((function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length})),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce((function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")})),ce((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")}))),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce((function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)})),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){for(;l;){for(a=e;a=a[l];)if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){for(d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];a=++s&&a&&a[l]||(d=s=0)||u.pop();)if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)for(;(a=++s&&a&&a[l]||(d=s=0)||u.pop())&&((x?a.nodeName.toLowerCase()!==f:1!==a.nodeType)||!++d||(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a!==e)););return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le((function(e,t){for(var n,r=a(e,o),i=r.length;i--;)e[n=P(e,r[i])]=!(t[n]=r[i])})):function(e){return a(e,0,t)}):a}},pseudos:{not:le((function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le((function(e,t,n,r){for(var i,o=s(e,null,r,[]),a=e.length;a--;)(i=o[a])&&(e[a]=!(t[a]=i))})):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}})),has:le((function(t){return function(e){return 0<se(t,e).length}})),contains:le((function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}})),lang:le((function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve((function(){return[0]})),last:ve((function(e,t){return[t-1]})),eq:ve((function(e,t,n){return[n<0?n+t:n]})),even:ve((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ve((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ve((function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e})),gt:ve((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){for(;e=e[u];)if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){for(;e=e[u];)if((1===e.nodeType||f)&&s(e,t,n))return!0}else for(;e=e[u];)if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le((function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v)for(i=Te(p,u),v(i,[],n,r),o=i.length;o--;)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a));if(e){if(y||d){if(y){for(i=[],o=p.length;o--;)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}for(o=p.length;o--;)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)}))}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be((function(e){return e===i}),a,!0),l=be((function(e){return-1<P(i,e)}),a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r&&!b.relative[e[n].type];n++);return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);for(a=e,s=[],u=b.preFilter;a;){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){for(t||(t=h(e)),n=t.length;n--;)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){for(a=0,t||o.ownerDocument==C||(T(o),n=!E);s=v[a++];)if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){for(a=0;s=y[a++];)s(c,f,t,n);if(e){if(0<u)for(;l--;)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=G.needsContext.test(e)?0:o.length;i--&&(a=o[i],!b.relative[s=a.type]);)if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce((function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))})),ce((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||fe("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),d.attributes&&ce((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||fe("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ce((function(e){return null==e.getAttribute("disabled")}))||fe(R,(function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null})),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,(function(e,t){return!!n.call(e,t,e)!==r})):n.nodeType?S.grep(e,(function(e){return e===n!==r})):"string"!=typeof n?S.grep(e,(function(e){return-1<i.call(n,e)!==r})):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,(function(e){return 1===e.nodeType})))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter((function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},(function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}}));var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],(function(e,t){n[t]=!0})),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1)for(t=u.shift();++l<s.length;)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1);r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,(function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)}))}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,(function(e,t){for(var n;-1<(n=S.inArray(t,s,n));)s.splice(n,1),n<=l&&l--})),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred((function(r){S.each(o,(function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]]((function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)}))})),i=null})).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred((function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))})).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,(function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add((function(){i=r}),o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith})),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();for(;t--;)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout((function(){throw e}))};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e).catch((function(e){S.readyException(e)})),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each((function(){Q.set(this,n)})):$(this,(function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))||void 0!==(t=Z(o,n))?t:void 0;this.each((function(){Q.set(this,n,e)}))}),null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each((function(){Q.remove(this,e)}))}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,(function(){S.dequeue(e,t)}),o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add((function(){Y.remove(e,[t+"queue",n])}))})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each((function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)}))},dequeue:function(e){return this.each((function(){S.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;a--;)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ae(this)?S(this).show():S(this).hide()}))}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){for(a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];c--;)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));for(f.textContent="",d=0;o=p[d++];)if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n)for(c=0;o=a[c++];)he.test(o.type||"")&&n.push(o);return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each((function(){S.event.add(this,t,i,r,n)}))}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return void 0!==S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;l--;)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){for(l=(t=(t||"").match(P)||[""]).length;l--;)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){for(f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){for(a=S.event.handlers.call(this,u,l),t=0;(i=a[t++])&&!u.isPropagationStopped();)for(u.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},(function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}})),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}})),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each((function(){S.event.remove(this,e,n,t)}))}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each((function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)}));if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],"input"===(l=(u=a[r]).nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,(function(e){return void 0===e?S.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return He(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)}))},prepend:function(){return He(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return He(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return He(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return S.clone(this,e,t)}))},html:function(e){return $(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,(function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))}),n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}}));var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){return S.cssProps[e]||_e[e]||(e in $e?e:_e[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Be.length;n--;)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"==(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],(function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,(function(){return Je(e,u,n)}))},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}})),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),S.each({margin:"",padding:"",border:"Width"},(function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)})),S.fn.extend({css:function(e,t){return $(this,(function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)}),e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout((function(){Ze=void 0})),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always((function(){delete u.elem})),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always((function(){p.always((function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()}))}))),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done((function(){h.display=l})),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always((function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}))),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done((function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])}))),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each((function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)}))},finish:function(a){return!1!==a&&(a=a||"fx"),this.each((function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish}))}}),S.each(["toggle","show","hide"],(function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}})),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}})),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,(function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}}))},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each((function(){S.removeAttr(this,e)}))}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),(function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}}));var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each((function(){delete this[S.propFix[e]||e]}))}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){S.propFix[this.toLowerCase()]=this})),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each((function(e){S(this).addClass(t.call(this,e,gt(this)))}));if((e=vt(t)).length)for(;n=this[u++];)if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each((function(e){S(this).removeClass(t.call(this,e,gt(this)))}));if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)for(;n=this[u++];)if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){for(a=0;o=e[a++];)for(;-1<r.indexOf(" "+o+" ");)r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each((function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)})):this.each((function(){var e,t,n,r;if(a)for(t=0,n=S(this),r=vt(i);e=r[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each((function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,(function(e){return null==e?"":e+""}))),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))}))):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=S.makeArray(t),a=i.length;a--;)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],(function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}for(i=0;(o=p[i++])&&!e.isPropagationStopped();)f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each((function(){S.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},(function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}}));var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,(function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)}));else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,(function(){i(this.name,this.value)}));else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))})).map((function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,(function(e){return{name:t.name,value:e.replace(Et,"\r\n")}})):{name:t.name,value:n.replace(Et,"\r\n")}})).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],(function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)})),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n)for(n={};t=qt.exec(p);)n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout((function(){T.abort("timeout")}),v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var r,i,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],(function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}})),S.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(n){return m(n)?this.each((function(e){S(this).wrapInner(n.call(this,e))})):this.each((function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)}))},wrap:function(t){var n=m(t);return this.each((function(e){S(this).wrapAll(n?t.call(this,e):t)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){S(this).replaceWith(this.childNodes)})),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport((function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout((function(){o&&a()}))},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}})),S.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),S.ajaxTransport("script",(function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}}));var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",(function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always((function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0})),"script"})),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)})).always(n&&function(e,t){a.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,(function(e){return t===e.elem})).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){S.offset.setOffset(this,t,e)}));var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===S.css(e,"position");)e=e.offsetParent;return e||re}))}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,(function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n}),t,e,arguments.length)}})),S.each(["top","left"],(function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,(function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t}))})),S.each({Height:"height",Width:"width"},(function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},(function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,(function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)}),s,n?e:void 0,n)}}))})),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){S.fn[t]=function(e){return this.on(t,e)}})),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}));var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return S}));var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},void 0===e&&(C.jQuery=C.$=S),S})),function(jQuery){function keyHandler(handleObj){if("string"==typeof handleObj.data&&(handleObj.data={keys:handleObj.data}),handleObj.data&&handleObj.data.keys&&"string"==typeof handleObj.data.keys){var origHandler=handleObj.handler,keys=handleObj.data.keys.toLowerCase().split(" ");handleObj.handler=function(event){if(this===event.target||!(jQuery.hotkeys.options.filterInputAcceptingElements&&jQuery.hotkeys.textInputTypes.test(event.target.nodeName)||jQuery.hotkeys.options.filterContentEditable&&jQuery(event.target).attr("contenteditable")||jQuery.hotkeys.options.filterTextInputs&&jQuery.inArray(event.target.type,jQuery.hotkeys.textAcceptingInputTypes)>-1)){var special="keypress"!==event.type&&jQuery.hotkeys.specialKeys[event.which],character=String.fromCharCode(event.which).toLowerCase(),modif="",possible={};jQuery.each(["alt","ctrl","shift"],(function(index,specialKey){event[specialKey+"Key"]&&special!==specialKey&&(modif+=specialKey+"+")})),event.metaKey&&!event.ctrlKey&&"meta"!==special&&(modif+="meta+"),event.metaKey&&"meta"!==special&&modif.indexOf("alt+ctrl+shift+")>-1&&(modif=modif.replace("alt+ctrl+shift+","hyper+")),special?possible[modif+special]=!0:(possible[modif+character]=!0,possible[modif+jQuery.hotkeys.shiftNums[character]]=!0,"shift+"===modif&&(possible[jQuery.hotkeys.shiftNums[character]]=!0));for(var i=0,l=keys.length;i<l;i++)if(possible[keys[i]])return origHandler.apply(this,arguments)}}}}jQuery.hotkeys={version:"0.2.0",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"],textInputTypes:/textarea|input|select/i,options:{filterInputAcceptingElements:!0,filterTextInputs:!0,filterContentEditable:!0}},jQuery.each(["keydown","keyup","keypress"],(function(){jQuery.event.special[this]={add:keyHandler}}))}(jQuery||this.jQuery||window.jQuery),define("jquery.hotkeys",["jquery"],(function(){})),define("pgui.shortcuts",["jquery.hotkeys"],(function(){$.hotkeys.options=$.extend($.hotkeys.options,{filterInputAcceptingElements:!1,filterContentEditable:!1,filterTextInputs:!1});var shortcuts=[{keys:["Ctrl+[","Ctrl+]"],selector:".toggle-sidebar",scope:"common"},{keys:["Ctrl+left"],selector:".pgui-pagination .pgui-pagination-prev",scope:"grid"},{keys:["Ctrl+right"],selector:".pgui-pagination  .pgui-pagination-next",scope:"grid"},{keys:["Alt+Ctrl+I","Alt+Insert"],selector:".grid:first .pgui-add",scope:"grid"},{keys:["Ctrl+Shift+/"],selector:".grid:first .expand-all-details",scope:"grid"},{keys:["Ctrl+Shift+F"],selector:".grid:first .js-filter-builder-open",scope:"grid"},{keys:["Ctrl+Return"],selector:".js-form-container:visible .js-primary-save",ignoreFocusedInputs:!0,scope:"form"},{keys:["Ctrl+Shift+Return"],selector:".js-form-container:visible .js-save-insert",ignoreFocusedInputs:!0,scope:"form"},{keys:["Alt+Ctrl+I","Alt+Insert"],selector:".js-form-add:visible",scope:"form"},{keys:["Alt+Ctrl+I","Alt+Insert"],selector:".modal:visible .js-group-action-select[data-action=add-condition]",ignoreFocusedInputs:!0,scope:"filter_builder"},{keys:["Ctrl+Return"],selector:".modal:visible .js-filter-builder-commit",ignoreFocusedInputs:!0,scope:"filter_builder"},{keys:["Ctrl+Return"],selector:".webui-popover-content .js-save",ignoreFocusedInputs:!0,scope:"quick_edit"}],handlers={};$document=$(document);var currentScopes=[];function push(scopes){scopes=scopes||["grid","form"],currentScopes.push(scopes),$.each(shortcuts,(function(index,shortcut){if(-1!==scopes.indexOf(shortcut.scope)){var handler=function(id,ignoreFocusedInputs,selector,scope){return handlers[id]||(handlers[id]=function(e){if("common"!==scope&&-1===currentScopes[currentScopes.length-1].indexOf(scope))return!0;if(!ignoreFocusedInputs&&/textarea|input|select/i.test(e.target.nodeName))return!0;var element=$(selector).get(0);return element&&element.click(),!1}),handlers[id]}(shortcut.keys.join("")+shortcut.scope,shortcut.ignoreFocusedInputs,shortcut.selector,shortcut.scope);$document.off("keydown",handler),$.each(shortcut.keys,(function(index,key){$document.on("keydown",null,key,handler)}));var $element=$(shortcut.selector);if($element.length){var title=$element.attr("title");title=title?title+" ":"",$element.attr("title",title+"("+shortcut.keys.join(", ")+")")}}}))}return $((function(){push(["common"])})),{push:push,pop:function(){currentScopes.pop()}}})),window.matchMedia||(window.matchMedia=function(c){var E,w=(a=c.document).documentElement,l=[],t=0,x="",h={},G=/\s*(only|not)?\s*(screen|print|[a-z\-]+)\s*(and)?\s*/i,H=/^\s*\(\s*(-[a-z]+-)?(min-|max-)?([a-z\-]+)\s*(:?\s*([0-9]+(\.[0-9]+)?|portrait|landscape)(px|em|dppx|dpcm|rem|%|in|cm|mm|ex|pt|pc|\/([0-9]+(\.[0-9]+)?))?)?\s*\)\s*$/,y=0,A=function(b){var z=-1!==b.indexOf(",")&&b.split(",")||[b],e=z.length-1,j=e,g=null,d=null,c="",a=0,l=!1,m="",f="",k=(g=null,d=0,f=null,""),p="",q="",n="",r="";k=!1;if(""===b)return!0;do{if(l=!1,(d=(g=z[j-e]).match(G))&&(c=d[0],a=d.index),!d||-1===g.substring(0,a).indexOf("(")&&(a||!d[3]&&c!==d.input))k=!1;else{if(f=g,l="not"===d[1],a||(m=d[2],f=g.substring(c.length)),k=m===x||"all"===m||""===m,d=(g=-1!==f.indexOf(" and ")&&f.split(" and ")||[f]).length-1,k&&0<=d&&""!==f)do{if(!(f=g[d].match(H))||!h[f[3]]){k=!1;break}if(k=f[2],n=p=f[5],q=f[7],r=h[f[3]],q&&(n="px"===q?Number(p):"em"===q||"rem"===q?16*p:f[8]?(p/f[8]).toFixed(2):"dppx"===q?96*p:"dpcm"===q?.3937*p:Number(p)),!(k="min-"===k&&n?r>=n:"max-"===k&&n?r<=n:n?r===n:!!r))break}while(d--);if(k)break}}while(e--);return l?!k:k},B=function(){var b=c.innerWidth||w.clientWidth,a=c.innerHeight||w.clientHeight,e=c.screen.width,j=c.screen.height,g=c.screen.colorDepth,d=c.devicePixelRatio;h.width=b,h.height=a,h["aspect-ratio"]=(b/a).toFixed(2),h["device-width"]=e,h["device-height"]=j,h["device-aspect-ratio"]=(e/j).toFixed(2),h.color=g,h["color-index"]=Math.pow(2,g),h.orientation=a>=b?"portrait":"landscape",h.resolution=d&&96*d||c.screen.deviceXDPI||96,h["device-pixel-ratio"]=d||1},C=function(){clearTimeout(y),y=setTimeout((function(){var b=null,a=t-1,e=a,j=!1;if(0<=a){B();do{if((b=l[e-a])&&((j=A(b.mql.media))&&!b.mql.matches||!j&&b.mql.matches)&&(b.mql.matches=j,b.listeners)){j=0;for(var g=b.listeners.length;j<g;j++)b.listeners[j]&&b.listeners[j].call(c,b.mql)}}while(a--)}}),10)},D=a.getElementsByTagName("head")[0],a=a.createElement("style"),u="screen print speech projection handheld tv braille embossed tty".split(" "),m=0,I=u.length,s="#mediamatchjs { position: relative; z-index: 0; }",v="",F=c.addEventListener||(v="on")&&c.attachEvent;for(a.type="text/css",a.id="mediamatchjs",D.appendChild(a),E=c.getComputedStyle&&c.getComputedStyle(a)||a.currentStyle;m<I;m++)s+="@media "+u[m]+" { #mediamatchjs { position: relative; z-index: "+m+" } }";return a.styleSheet?a.styleSheet.cssText=s:a.textContent=s,x=u[1*E.zIndex||0],D.removeChild(a),B(),F(v+"resize",C),F(v+"orientationchange",C),function(a){var c=t,e={matches:!1,media:a,addListener:function(a){l[c].listeners||(l[c].listeners=[]),a&&l[c].listeners.push(a)},removeListener:function(a){var b=l[c],d=0,e=0;if(b)for(e=b.listeners.length;d<e;d++)b.listeners[d]===a&&b.listeners.splice(d,1)}};return""===a?(e.matches=!0,e):(e.matches=A(a),t=l.push({mql:e,listeners:null}),e)}}(window)),define("libs/match-media",(function(){})),define("pgui.sidebar",["pgui.shortcuts","libs/match-media"],(function(){return function($body){function toggleSidebar(){var className=window.matchMedia("(max-width: 991px)").matches?"sidebar-active":"sidebar-desktop-active";$body.toggleClass(className)}$body.on("click touchstart",".sidebar-backdrop",toggleSidebar),$body.on("click",".toggle-sidebar",toggleSidebar)}})),function(){function n(n){return function(r,e,u,i){e=b(e,i,4);var o=!k(r)&&m.keys(r),a=(o||r).length,c=n>0?0:a-1;return arguments.length<3&&(u=r[o?o[c]:c],c+=n),function(t,r,e,u,i,o){for(;i>=0&&o>i;i+=n){var a=u?u[i]:i;e=r(e,t[a],a,t)}return e}(r,e,u,o,c,a)}}function t(n){return function(t,r,e){r=x(r,e);for(var u=O(t),i=n>0?0:u-1;i>=0&&u>i;i+=n)if(r(t[i],i,t))return i;return-1}}function r(n,t,r){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(r&&i&&a)return e[i=r(e,u)]===u?i:-1;if(u!=u)return(i=t(l.call(e,o,a),m.isNaN))>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&a>i;i+=n)if(e[i]===u)return i;return-1}}function e(n,t){var r=I.length,e=n.constructor,u=m.isFunction(e)&&e.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(t,i)&&t.push(i);r--;)(i=I[r])in n&&n[i]!==u[i]&&!m.contains(t,i)&&t.push(i)}var u=this,i=u._,o=Array.prototype,a=Object.prototype,c=Function.prototype,f=o.push,l=o.slice,s=a.toString,p=a.hasOwnProperty,h=Array.isArray,v=Object.keys,g=c.bind,y=Object.create,d=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):u._=m,m.VERSION="1.8.3";var b=function(n,t,r){if(void 0===t)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}},x=function(n,t,r){return null==n?m.identity:m.isFunction(n)?b(n,t,r):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,t){return x(n,t,1/0)};var _=function(n,t){return function(r){var e=arguments.length;if(2>e||null==r)return r;for(var u=1;e>u;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;a>c;c++){var f=o[c];t&&void 0!==r[f]||(r[f]=i[f])}return r}},j=function(n){if(!m.isObject(n))return{};if(y)return y(n);d.prototype=n;var t=new d;return d.prototype=null,t},w=function(n){return function(t){return null==t?void 0:t[n]}},A=Math.pow(2,53)-1,O=w("length"),k=function(n){var t=O(n);return"number"==typeof t&&t>=0&&A>=t};m.each=m.forEach=function(n,t,r){var e,u;if(t=b(t,r),k(n))for(e=0,u=n.length;u>e;e++)t(n[e],e,n);else{var i=m.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},m.map=m.collect=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=Array(u),o=0;u>o;o++){var a=e?e[o]:o;i[o]=t(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,t,r){var e;return void 0!==(e=k(n)?m.findIndex(n,t,r):m.findKey(n,t,r))&&-1!==e?n[e]:void 0},m.filter=m.select=function(n,t,r){var e=[];return t=x(t,r),m.each(n,(function(n,r,u){t(n,r,u)&&e.push(n)})),e},m.reject=function(n,t,r){return m.filter(n,m.negate(x(t)),r)},m.every=m.all=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(!t(n[o],o,n))return!1}return!0},m.some=m.any=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(t(n[o],o,n))return!0}return!1},m.contains=m.includes=m.include=function(n,t,r,e){return k(n)||(n=m.values(n)),("number"!=typeof r||e)&&(r=0),m.indexOf(n,t,r)>=0},m.invoke=function(n,t){var r=l.call(arguments,2),e=m.isFunction(t);return m.map(n,(function(n){var u=e?t:n[t];return null==u?u:u.apply(n,r)}))},m.pluck=function(n,t){return m.map(n,m.property(t))},m.where=function(n,t){return m.filter(n,m.matcher(t))},m.findWhere=function(n,t){return m.find(n,m.matcher(t))},m.max=function(n,t,r){var e,u,i=-1/0,o=-1/0;if(null==t&&null!=n)for(var a=0,c=(n=k(n)?n:m.values(n)).length;c>a;a++)(e=n[a])>i&&(i=e);else t=x(t,r),m.each(n,(function(n,r,e){((u=t(n,r,e))>o||u===-1/0&&i===-1/0)&&(i=n,o=u)}));return i},m.min=function(n,t,r){var e,u,i=1/0,o=1/0;if(null==t&&null!=n)for(var a=0,c=(n=k(n)?n:m.values(n)).length;c>a;a++)e=n[a],i>e&&(i=e);else t=x(t,r),m.each(n,(function(n,r,e){u=t(n,r,e),(o>u||1/0===u&&1/0===i)&&(i=n,o=u)}));return i},m.shuffle=function(n){for(var t,r=k(n)?n:m.values(n),e=r.length,u=Array(e),i=0;e>i;i++)(t=m.random(0,i))!==i&&(u[i]=u[t]),u[t]=r[i];return u},m.sample=function(n,t,r){return null==t||r?(k(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,t))},m.sortBy=function(n,t,r){return t=x(t,r),m.pluck(m.map(n,(function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}})).sort((function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index-t.index})),"value")};var F=function(n){return function(t,r,e){var u={};return r=x(r,e),m.each(t,(function(e,i){var o=r(e,i,t);n(u,e,o)})),u}};m.groupBy=F((function(n,t,r){m.has(n,r)?n[r].push(t):n[r]=[t]})),m.indexBy=F((function(n,t,r){n[r]=t})),m.countBy=F((function(n,t,r){m.has(n,r)?n[r]++:n[r]=1})),m.toArray=function(n){return n?m.isArray(n)?l.call(n):k(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:k(n)?n.length:m.keys(n).length},m.partition=function(n,t,r){t=x(t,r);var e=[],u=[];return m.each(n,(function(n,r,i){(t(n,r,i)?e:u).push(n)})),[e,u]},m.first=m.head=m.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:m.initial(n,n.length-t)},m.initial=function(n,t,r){return l.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},m.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:m.rest(n,Math.max(0,n.length-t))},m.rest=m.tail=m.drop=function(n,t,r){return l.call(n,null==t||r?1:t)},m.compact=function(n){return m.filter(n,m.identity)};var S=function(n,t,r,e){for(var u=[],i=0,o=e||0,a=O(n);a>o;o++){var c=n[o];if(k(c)&&(m.isArray(c)||m.isArguments(c))){t||(c=S(c,t,r));var f=0,l=c.length;for(u.length+=l;l>f;)u[i++]=c[f++]}else r||(u[i++]=c)}return u};m.flatten=function(n,t){return S(n,t,!1)},m.without=function(n){return m.difference(n,l.call(arguments,1))},m.uniq=m.unique=function(n,t,r,e){m.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=x(r,e));for(var u=[],i=[],o=0,a=O(n);a>o;o++){var c=n[o],f=r?r(c,o,n):c;t?(o&&i===f||u.push(c),i=f):r?m.contains(i,f)||(i.push(f),u.push(c)):m.contains(u,c)||u.push(c)}return u},m.union=function(){return m.uniq(S(arguments,!0,!0))},m.intersection=function(n){for(var t=[],r=arguments.length,e=0,u=O(n);u>e;e++){var i=n[e];if(!m.contains(t,i)){for(var o=1;r>o&&m.contains(arguments[o],i);o++);o===r&&t.push(i)}}return t},m.difference=function(n){var t=S(arguments,!0,!0,1);return m.filter(n,(function(n){return!m.contains(t,n)}))},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var t=n&&m.max(n,O).length||0,r=Array(t),e=0;t>e;e++)r[e]=m.pluck(n,e);return r},m.object=function(n,t){for(var r={},e=0,u=O(n);u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},m.findIndex=t(1),m.findLastIndex=t(-1),m.sortedIndex=function(n,t,r,e){for(var u=(r=x(r,e,1))(t),i=0,o=O(n);o>i;){var a=Math.floor((i+o)/2);r(n[a])<u?i=a+1:o=a}return i},m.indexOf=r(1,m.findIndex,m.sortedIndex),m.lastIndexOf=r(-1,m.findLastIndex),m.range=function(n,t,r){null==t&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var E=function(n,t,r,e,u){if(!(e instanceof t))return n.apply(r,u);var i=j(n.prototype),o=n.apply(i,u);return m.isObject(o)?o:i};m.bind=function(n,t){if(g&&n.bind===g)return g.apply(n,l.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var r=l.call(arguments,2),e=function(){return E(n,e,t,this,r.concat(l.call(arguments)))};return e},m.partial=function(n){var t=l.call(arguments,1),r=function(){for(var e=0,u=t.length,i=Array(u),o=0;u>o;o++)i[o]=t[o]===m?arguments[e++]:t[o];for(;e<arguments.length;)i.push(arguments[e++]);return E(n,r,this,this,i)};return r},m.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)n[r=arguments[t]]=m.bind(n[r],n);return n},m.memoize=function(n,t){var r=function(e){var u=r.cache,i=""+(t?t.apply(this,arguments):e);return m.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},m.delay=function(n,t){var r=l.call(arguments,2);return setTimeout((function(){return n.apply(null,r)}),t)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,t,r){var e,u,i,o=null,a=0;r||(r={});var c=function(){a=!1===r.leading?0:m.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var f=m.now();a||!1!==r.leading||(a=f);var l=t-(f-a);return e=this,u=arguments,0>=l||l>t?(o&&(clearTimeout(o),o=null),a=f,i=n.apply(e,u),o||(e=u=null)):o||!1===r.trailing||(o=setTimeout(c,l)),i}},m.debounce=function(n,t,r){var e,u,i,o,a,c=function(){var f=m.now()-o;t>f&&f>=0?e=setTimeout(c,t-f):(e=null,r||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=m.now();var f=r&&!e;return e||(e=setTimeout(c,t)),f&&(a=n.apply(i,u),i=u=null),a}},m.wrap=function(n,t){return m.partial(t,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},m.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},m.before=function(n,t){var r;return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}},m.once=m.partial(m.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(v)return v(n);var t=[];for(var r in n)m.has(n,r)&&t.push(r);return M&&e(n,t),t},m.allKeys=function(n){if(!m.isObject(n))return[];var t=[];for(var r in n)t.push(r);return M&&e(n,t),t},m.values=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},m.mapObject=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=u.length,o={},a=0;i>a;a++)o[e=u[a]]=t(n[e],e,n);return o},m.pairs=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},m.invert=function(n){for(var t={},r=m.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},m.functions=m.methods=function(n){var t=[];for(var r in n)m.isFunction(n[r])&&t.push(r);return t.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=0,o=u.length;o>i;i++)if(t(n[e=u[i]],e,n))return e},m.pick=function(n,t,r){var e,u,i={},o=n;if(null==o)return i;m.isFunction(t)?(u=m.allKeys(o),e=b(t,r)):(u=S(arguments,!1,!1,1),e=function(n,t,r){return t in r},o=Object(o));for(var a=0,c=u.length;c>a;a++){var f=u[a],l=o[f];e(l,f,o)&&(i[f]=l)}return i},m.omit=function(n,t,r){if(m.isFunction(t))t=m.negate(t);else{var e=m.map(S(arguments,!1,!1,1),String);t=function(n,t){return!m.contains(e,t)}}return m.pick(n,t,r)},m.defaults=_(m.allKeys,!0),m.create=function(n,t){var r=j(n);return t&&m.extendOwn(r,t),r},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,t){return t(n),n},m.isMatch=function(n,t){var r=m.keys(t),e=r.length;if(null==n)return!e;for(var u=Object(n),i=0;e>i;i++){var o=r[i];if(t[o]!==u[o]||!(o in u))return!1}return!0};var N=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof m&&(n=n._wrapped),t instanceof m&&(t=t._wrapped);var u=s.call(n);if(u!==s.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!=+n?+t!=+t:0==+n?1/+n==1/t:+n==+t;case"[object Date]":case"[object Boolean]":return+n==+t}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof t)return!1;var o=n.constructor,a=t.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in t)return!1}e=e||[];for(var c=(r=r||[]).length;c--;)if(r[c]===n)return e[c]===t;if(r.push(n),e.push(t),i){if((c=n.length)!==t.length)return!1;for(;c--;)if(!N(n[c],t[c],r,e))return!1}else{var f,l=m.keys(n);if(c=l.length,m.keys(t).length!==c)return!1;for(;c--;)if(f=l[c],!m.has(t,f)||!N(n[f],t[f],r,e))return!1}return r.pop(),e.pop(),!0};m.isEqual=function(n,t){return N(n,t)},m.isEmpty=function(n){return null==n||(k(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length)},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=h||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],(function(n){m["is"+n]=function(t){return s.call(t)==="[object "+n+"]"}})),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return void 0===n},m.has=function(n,t){return null!=n&&p.call(n,t)},m.noConflict=function(){return u._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=w,m.propertyOf=function(n){return null==n?function(){}:function(t){return n[t]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(t){return m.isMatch(t,n)}},m.times=function(n,t,r){var e=Array(Math.max(0,n));t=b(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},m.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=m.invert(B),R=function(n){var t=function(t){return n[t]},r="(?:"+m.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};m.escape=R(B),m.unescape=R(T),m.result=function(n,t,r){var e=null==n?void 0:n[t];return void 0===e&&(e=r),m.isFunction(e)?e.call(n):e};var q=0;m.uniqueId=function(n){var t=++q+"";return n?n+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,L=function(n){return"\\"+z[n]};m.template=function(n,t,r){!t&&r&&(t=r),t=m.defaults({},t,m.templateSettings);var e=RegExp([(t.escape||K).source,(t.interpolate||K).source,(t.evaluate||K).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,(function(t,r,e,o,a){return i+=n.slice(u,a).replace(D,L),u=a+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t})),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(a){throw a.source=i,a}var c=function(n){return o.call(this,n,m)},f=t.variable||"obj";return c.source="function("+f+"){\n"+i+"}",c},m.chain=function(n){var t=m(n);return t._chain=!0,t};var P=function(n,t){return n._chain?m(t).chain():t};m.mixin=function(n){m.each(m.functions(n),(function(t){var r=m[t]=n[t];m.prototype[t]=function(){var n=[this._wrapped];return f.apply(n,arguments),P(this,r.apply(m,n))}}))},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(n){var t=o[n];m.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],P(this,r)}})),m.each(["concat","join","slice"],(function(n){var t=o[n];m.prototype[n]=function(){return P(this,t.apply(this._wrapped,arguments))}})),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],(function(){return m}))}.call(this),define("class",["require","exports","module"],(function(require,exports,module){var initializing=!1,fnTest=/xyz/.test((function(){xyz}))?/\b_super\b/:/.*/;module.exports=function(){},module.exports.extend=function(prop){var _super=this.prototype;initializing=!0;var prototype=new this;for(var name in initializing=!1,prop)prototype[name]="function"==typeof prop[name]&&"function"==typeof _super[name]&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}return Class.prototype=prototype,Class.prototype.constructor=Class,Class.extend=arguments.callee,Class}})),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");
/*! ========================================================================
 * Bootstrap Toggle: bootstrap-toggle.js v2.2.0
 * http://www.bootstraptoggle.com
 * ========================================================================
 * Copyright 2014 Min Hur, The New York Times Company
 * Licensed under MIT
 * ======================================================================== */
if(function($){"use strict";var version=jQuery.fn.jquery.split(" ")[0].split(".");if(version[0]<2&&version[1]<9||1==version[0]&&9==version[1]&&version[2]<1||version[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function($){"use strict";$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",(function(){called=!0}));return setTimeout((function(){called||$($el).trigger($.support.transition.end)}),duration),this},$((function(){$.support.transition=function(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})}))}(jQuery),function($){"use strict";var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.3.7",Alert.TRANSITION_DURATION=150,Alert.prototype.close=function(e){var $this=$(this),selector=$this.attr("data-target");selector||(selector=(selector=$this.attr("href"))&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$("#"===selector?[]:selector);function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}e&&e.preventDefault(),$parent.length||($parent=$this.closest(".alert")),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(Alert.TRANSITION_DURATION):removeElement())};var old=$.fn.alert;$.fn.alert=function(option){return this.each((function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)}))},$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),function($){"use strict";var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};function Plugin(option){return this.each((function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||$this.data("bs.button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)}))}Button.VERSION="3.3.7",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),setTimeout($.proxy((function(){$el[val](null==data[state]?this.options[state]:data[state]),"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d).prop(d,!0)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d).prop(d,!1))}),this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")?($input.prop("checked")&&(changed=!1),$parent.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==$input.prop("type")&&($input.prop("checked")!==this.$element.hasClass("active")&&(changed=!1),this.$element.toggleClass("active")),$input.prop("checked",this.$element.hasClass("active")),changed&&$input.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',(function(e){var $btn=$(e.target).closest(".btn");Plugin.call($btn,"toggle"),$(e.target).is('input[type="radio"], input[type="checkbox"]')||(e.preventDefault(),$btn.is("input,button")?$btn.trigger("focus"):$btn.find("input:visible,button:visible").first().trigger("focus"))})).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',(function(e){$(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))}))}(jQuery),function($){"use strict";var Carousel=function(element,options){this.$element=$(element),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",$.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};function Plugin(option){return this.each((function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()}))}Carousel.VERSION="3.3.7",Carousel.TRANSITION_DURATION=600,Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},Carousel.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.getItemForDirection=function(direction,active){var activeIndex=this.getItemIndex(active);if(("prev"==direction&&0===activeIndex||"next"==direction&&activeIndex==this.$items.length-1)&&!this.options.wrap)return active;var itemIndex=(activeIndex+("prev"==direction?-1:1))%this.$items.length;return this.$items.eq(itemIndex)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(pos>this.$items.length-1||pos<0))return this.sliding?this.$element.one("slid.bs.carousel",(function(){that.to(pos)})):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",this.$items.eq(pos))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){if(!this.sliding)return this.slide("next")},Carousel.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||this.getItemForDirection(type,$active),isCycling=this.interval,direction="next"==type?"left":"right",that=this;if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",(function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout((function(){that.$element.trigger(slidEvent)}),0)})).emulateTransitionEnd(Carousel.TRANSITION_DURATION)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this};var clickHandler=function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}};$(document).on("click.bs.carousel.data-api","[data-slide]",clickHandler).on("click.bs.carousel.data-api","[data-slide-to]",clickHandler),$(window).on("load",(function(){$('[data-ride="carousel"]').each((function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())}))}))}(jQuery),function($){"use strict";var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.$trigger=$('[data-toggle="collapse"][href="#'+element.id+'"],[data-toggle="collapse"][data-target="#'+element.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function getTargetFromTrigger($trigger){var href,target=$trigger.attr("data-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"");return $(target)}function Plugin(option){return this.each((function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&/show|hide/.test(option)&&(options.toggle=!1),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()}))}Collapse.VERSION="3.3.7",Collapse.TRANSITION_DURATION=350,Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var activesData,actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(actives&&actives.length&&(activesData=actives.data("bs.collapse"))&&activesData.transitioning)){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){actives&&actives.length&&(Plugin.call(actives,"hide"),activesData||actives.data("bs.collapse",null));var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!$.support.transition)return complete.call(this);this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},Collapse.prototype.getParent=function(){return $(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each($.proxy((function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)}),this)).end()},Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen),$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',(function(e){var $this=$(this);$this.attr("data-target")||e.preventDefault();var $target=getTargetFromTrigger($this),option=$target.data("bs.collapse")?"toggle":$this.data();Plugin.call($target,option)}))}(jQuery),function($){"use strict";var toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};function getParent($this){var selector=$this.attr("data-target");selector||(selector=(selector=$this.attr("href"))&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function clearMenus(e){e&&3===e.which||($(".dropdown-backdrop").remove(),$(toggle).each((function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&$.contains($parent[0],e.target)||($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger($.Event("hidden.bs.dropdown",relatedTarget)))))})))}Dropdown.VERSION="3.3.7",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$(document.createElement("div")).addClass("dropdown-backdrop").insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger($.Event("shown.bs.dropdown",relatedTarget))}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var $items=$parent.find(".dropdown-menu li:not(.disabled):visible a");if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=function(option){return this.each((function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)}))},$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",(function(e){e.stopPropagation()})).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",Dropdown.prototype.keydown)}(jQuery),function($){"use strict";var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy((function(){this.$element.trigger("loaded.bs.modal")}),this))};function Plugin(option,_relatedTarget){return this.each((function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)}))}Modal.VERSION="3.3.7",Modal.TRANSITION_DURATION=300,Modal.BACKDROP_TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",(function(){that.$element.one("mouseup.dismiss.bs.modal",(function(e){$(e.target).is(that.$element)&&(that.ignoreBackdropClick=!0)}))})),this.backdrop((function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),that.adjustDialog(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in"),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$dialog.one("bsTransitionEnd",(function(){that.$element.trigger("focus").trigger(e)})).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)})))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy((function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")}),this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy((function(e){27==e.which&&this.hide()}),this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop((function(){that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")}))},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$(document.createElement("div")).addClass("modal-backdrop "+animate).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy((function(e){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())}),this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()}else callback&&callback()},Modal.prototype.handleUpdate=function(){this.adjustDialog()},Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})},Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},Modal.prototype.checkScrollbar=function(){var fullWindowWidth=window.innerWidth;if(!fullWindowWidth){var documentElementRect=document.documentElement.getBoundingClientRect();fullWindowWidth=documentElementRect.right-Math.abs(documentElementRect.left)}this.bodyIsOverflowing=document.body.clientWidth<fullWindowWidth,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",(function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",(function(){$this.is(":visible")&&$this.trigger("focus")}))})),Plugin.call($target,option,this)}))}(jQuery),function($){"use strict";var Tooltip=function(element,options){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.7",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){if(this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$($.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return(options=$.extend({},this.getDefaults(),this.$element.data(),options)).delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,(function(key,value){defaults[key]!=value&&(options[key]=value)})),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);if(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusin"==obj.type?"focus":"hover"]=!0),self.tip().hasClass("in")||"in"==self.hoverState)self.hoverState="in";else{if(clearTimeout(self.timeout),self.hoverState="in",!self.options.delay||!self.options.delay.show)return self.show();self.timeout=setTimeout((function(){"in"==self.hoverState&&self.show()}),self.options.delay.show)}},Tooltip.prototype.isInStateTrue=function(){for(var key in this.inState)if(this.inState[key])return!0;return!1},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);if(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusout"==obj.type?"focus":"hover"]=!1),!self.isInStateTrue()){if(clearTimeout(self.timeout),self.hoverState="out",!self.options.delay||!self.options.delay.hide)return self.hide();self.timeout=setTimeout((function(){"out"==self.hoverState&&self.hide()}),self.options.delay.hide)}},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,viewportDim=this.getPosition(this.$viewport);placement="bottom"==placement&&pos.bottom+actualHeight>viewportDim.bottom?"top":"top"==placement&&pos.top-actualHeight<viewportDim.top?"bottom":"right"==placement&&pos.right+actualWidth>viewportDim.width?"left":"left"==placement&&pos.left-actualWidth<viewportDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top+=marginTop,offset.left+=marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isVertical){this.arrow().css(isVertical?"left":"top",50*(1-delta/dimension)+"%").css(isVertical?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){var that=this,$tip=$(this.$tip),e=$.Event("hide.bs."+this.type);function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element&&that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}if(this.$element.trigger(e),!e.isDefaultPrevented())return $tip.removeClass("in"),$.support.transition&&$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){var el=($element=$element||this.$element)[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var isSvg=window.SVGElement&&el instanceof window.SVGElement,elOffset=isBody?{top:0,left:0}:isSvg?null:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.right&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var $e=this.$element,o=this.options;return $e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do{prefix+=~~(1e6*Math.random())}while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){if(!this.$tip&&(this.$tip=$(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&((self=$(e.currentTarget).data("bs."+this.type))||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),e?(self.inState.click=!self.inState.click,self.isInStateTrue()?self.enter(self):self.leave(self)):self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide((function(){that.$element.off("."+that.type).removeData("bs."+that.type),that.$tip&&that.$tip.detach(),that.$tip=null,that.$arrow=null,that.$viewport=null,that.$element=null}))};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each((function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;!data&&/destroy|hide/.test(option)||(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())}))},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.3.7",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),(Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype)).constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var old=$.fn.popover;$.fn.popover=function(option){return this.each((function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;!data&&/destroy|hide/.test(option)||(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())}))},$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),function($){"use strict";function ScrollSpy(element,options){this.$body=$(document.body),this.$scrollElement=$(element).is(document.body)?$(window):$(element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",$.proxy(this.process,this)),this.refresh(),this.process()}function Plugin(option){return this.each((function(){var $this=$(this),data=$this.data("bs.scrollspy"),options="object"==typeof option&&option;data||$this.data("bs.scrollspy",data=new ScrollSpy(this,options)),"string"==typeof option&&data[option]()}))}ScrollSpy.VERSION="3.3.7",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var that=this,offsetMethod="offset",offsetBase=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map((function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(href);return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null})).sort((function(a,b){return a[0]-b[0]})).each((function(){that.offsets.push(this[0]),that.targets.push(this[1])}))},ScrollSpy.prototype.process=function(){var i,scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget;if(this.scrollHeight!=scrollHeight&&this.refresh(),scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<offsets[0])return this.activeTarget=null,this.clear();for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(void 0===offsets[i+1]||scrollTop<offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,this.clear();var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]',active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")},ScrollSpy.prototype.clear=function(){$(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",(function(){$('[data-spy="scroll"]').each((function(){var $spy=$(this);Plugin.call($spy,$spy.data())}))}))}(jQuery),function($){"use strict";var Tab=function(element){this.element=$(element)};function Plugin(option){return this.each((function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),"string"==typeof option&&data[option]()}))}Tab.VERSION="3.3.7",Tab.TRANSITION_DURATION=150,Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");if(selector||(selector=(selector=$this.attr("href"))&&selector.replace(/.*(?=#[^\s]*$)/,"")),!$this.parent("li").hasClass("active")){var $previous=$ul.find(".active:last a"),hideEvent=$.Event("hide.bs.tab",{relatedTarget:$this[0]}),showEvent=$.Event("show.bs.tab",{relatedTarget:$previous[0]});if($previous.trigger(hideEvent),$this.trigger(showEvent),!showEvent.isDefaultPrevented()&&!hideEvent.isDefaultPrevented()){var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),(function(){$previous.trigger({type:"hidden.bs.tab",relatedTarget:$this[0]}),$this.trigger({type:"shown.bs.tab",relatedTarget:$previous[0]})}))}}},Tab.prototype.activate=function(element,container,callback){var $active=container.find("> .active"),transition=callback&&$.support.transition&&($active.length&&$active.hasClass("fade")||!!container.find("> .fade").length);function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),element.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu").length&&element.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),callback&&callback()}$active.length&&transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(Tab.TRANSITION_DURATION):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this};var clickHandler=function(e){e.preventDefault(),Plugin.call($(this),"show")};$(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',clickHandler).on("click.bs.tab.data-api",'[data-toggle="pill"]',clickHandler)}(jQuery),function($){"use strict";var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function Plugin(option){return this.each((function(){var $this=$(this),data=$this.data("bs.affix"),options="object"==typeof option&&option;data||$this.data("bs.affix",data=new Affix(this,options)),"string"==typeof option&&data[option]()}))}Affix.VERSION="3.3.7",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getState=function(scrollHeight,height,offsetTop,offsetBottom){var scrollTop=this.$target.scrollTop(),position=this.$element.offset(),targetHeight=this.$target.height();if(null!=offsetTop&&"top"==this.affixed)return scrollTop<offsetTop&&"top";if("bottom"==this.affixed)return null!=offsetTop?!(scrollTop+this.unpin<=position.top)&&"bottom":!(scrollTop+targetHeight<=scrollHeight-offsetBottom)&&"bottom";var initializing=null==this.affixed,colliderTop=initializing?scrollTop:position.top;return null!=offsetTop&&scrollTop<=offsetTop?"top":null!=offsetBottom&&colliderTop+(initializing?targetHeight:height)>=scrollHeight-offsetBottom&&"bottom"},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var height=this.$element.height(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom,scrollHeight=Math.max($(document).height(),$(document.body).height());"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=this.getState(scrollHeight,height,offsetTop,offsetBottom);if(this.affixed!=affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");if(this.$element.trigger(e),e.isDefaultPrevented())return;this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger(affixType.replace("affix","affixed")+".bs.affix")}"bottom"==affix&&this.$element.offset({top:scrollHeight-height-offsetBottom})}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",(function(){$('[data-spy="affix"]').each((function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},null!=data.offsetBottom&&(data.offset.bottom=data.offsetBottom),null!=data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)}))}))}(jQuery),define("bootstrap",["jquery"],(function(){})),new function(settings){var $separator=settings.separator||"&",$spaces=!1!==settings.spaces,$hash=(settings.suffix,!1!==settings.prefix?!0===settings.hash?"#":"?":""),$numbers=!1!==settings.numbers;jQuery.query=new function(){var is=function(o,t){return null!=o&&null!==o&&(!t||o.constructor==t)},parse=function(path){for(var m,rx=/\[([^[]*)\]/g,match=/^([^[]+)(\[.*\])?$/.exec(path),base=match[1],tokens=[];m=rx.exec(match[2]);)tokens.push(m[1]);return[base,tokens]},set=function(target,tokens,value){var token=tokens.shift();if("object"!=typeof target&&(target=null),""===token)if(target||(target=[]),is(target,Array))target.push(0==tokens.length?value:set(null,tokens.slice(0),value));else if(is(target,Object)){for(var i=0;null!=target[i++];);target[--i]=0==tokens.length?value:set(target[i],tokens.slice(0),value)}else(target=[]).push(0==tokens.length?value:set(null,tokens.slice(0),value));else if(token&&token.match(/^\s*[0-9]+\s*$/)){target||(target=[]),target[index=parseInt(token,10)]=0==tokens.length?value:set(target[index],tokens.slice(0),value)}else{if(!token)return value;var index=token.replace(/^\s*|\s*$/g,"");if(target||(target={}),is(target,Array)){var temp={};for(i=0;i<target.length;++i)temp[i]=target[i];target=temp}target[index]=0==tokens.length?value:set(target[index],tokens.slice(0),value)}return target},queryObject=function(a){var self=this;return self.keys={},a.queryObject?jQuery.each(a.get(),(function(key,val){self.SET(key,val)})):self.parseNew.apply(self,arguments),self};return queryObject.prototype={queryObject:!0,parseNew:function(){var self=this;return self.keys={},jQuery.each(arguments,(function(){var q=""+this;q=(q=q.replace(/^[?#]/,"")).replace(/[;&]$/,""),$spaces&&(q=q.replace(/[+]/g," ")),jQuery.each(q.split(/[&;]/),(function(){var key=decodeURIComponent(this.split("=")[0]||""),val=decodeURIComponent(this.split("=")[1]||"");key&&($numbers&&(/^[+-]?[0-9]+\.[0-9]*$/.test(val)?val=parseFloat(val):/^[+-]?[1-9][0-9]*$/.test(val)&&(val=parseInt(val,10))),val=!val&&0!==val||val,self.SET(key,val))}))})),self},has:function(key,type){var value=this.get(key);return is(value,type)},GET:function(key){if(!is(key))return this.keys;for(var parsed=parse(key),base=parsed[0],tokens=parsed[1],target=this.keys[base];null!=target&&0!=tokens.length;)target=target[tokens.shift()];return"number"==typeof target?target:target||""},get:function(key){var target=this.GET(key);return is(target,Object)?jQuery.extend(!0,{},target):is(target,Array)?target.slice(0):target},SET:function(key,val){var value=is(val)?val:null,parsed=parse(key),base=parsed[0],tokens=parsed[1],target=this.keys[base];return this.keys[base]=set(target,tokens.slice(0),value),this},set:function(key,val){return this.copy().SET(key,val)},REMOVE:function(key,val){if(val){var target=this.GET(key);if(is(target,Array)){for(tval in target)target[tval]=target[tval].toString();var index=$.inArray(val,target);if(!(index>=0))return;key=(key=target.splice(index,1))[index]}else if(val!=target)return}return this.SET(key,null).COMPACT()},remove:function(key,val){return this.copy().REMOVE(key,val)},EMPTY:function(){var self=this;return jQuery.each(self.keys,(function(key,value){delete self.keys[key]})),self},load:function(url){var hash=url.replace(/^.*?[#](.+?)(?:\?.+)?$/,"$1"),search=url.replace(/^.*?[?](.+?)(?:#.+)?$/,"$1");return new queryObject(url.length==search.length?"":search,url.length==hash.length?"":hash)},empty:function(){return this.copy().EMPTY()},copy:function(){return new queryObject(this)},COMPACT:function(){return this.keys=function build(orig){var obj="object"==typeof orig?is(orig,Array)?[]:{}:orig;if("object"==typeof orig){jQuery.each(orig,(function(key,value){if(!is(value))return!0;!function(o,key,value){is(o,Array)?o.push(value):o[key]=value}(obj,key,build(value))}))}return obj}(this.keys),this},compact:function(){return this.copy().COMPACT()},toString:function(){var queryString=[],chunks=[],encode=function(str){return str+="",str=encodeURIComponent(str),$spaces&&(str=str.replace(/%20/g,"+")),str},build=function(obj,base){var newKey=function(key){return base&&""!=base?[base,"[",key,"]"].join(""):[key].join("")};jQuery.each(obj,(function(key,value){"object"==typeof value?build(value,newKey(key)):function(arr,key,value){if(is(value)&&!1!==value){var o=[encode(key)];!0!==value&&(o.push("="),o.push(encode(value))),arr.push(o.join(""))}}(chunks,newKey(key),value)}))};return build(this.keys),chunks.length>0&&queryString.push($hash),queryString.push(chunks.join($separator)),queryString.join("")}},new queryObject(location.search,location.hash)}}(jQuery.query||{}),define("jquery.query",(function(){})),define("pgui.page_settings",["class","underscore","bootstrap","jquery.query"],(function(Class,_){var PageControl=Class.extend({init:function($context){this.container=$context,this._initializeElements(),this._initializeParameters(),this._initializeEvents(),this._selectDefaults()},_initializeElements:function(){this.$Dialog=this.container.find(".js-page-settings-dialog"),this.$PageSizeContainer=this.container.find(".js-page-settings-page-size-container"),this.$PageSizeControl=this.container.find(".js-page-settings-page-size-control"),this.$PageSizeCustomContainer=this.container.find(".js-page-settings-custom-page-size-container"),this.$PageSizeCustomControl=this.container.find(".js-page-settings-custom-page-size-control"),this.$PageSizeCustomCounter=this.container.find(".js-page-settings-custom-page-size-pager"),this.$PageSizeSave=this.container.find(".js-page-settings-save"),this.$PageSizeCancel=this.container.find(".js-page-settings-cancel"),this.$ViewModeControl=this.container.find(".js-page-settings-viewmode-control"),this.$CardColumnCount=this.container.find(".js-page-settings-card-column-count")},_initializeParameters:function(){this.totalRecordCount=this.$Dialog.data("total-record-count"),this.defaultRecordCountPerPage=parseInt(this.$Dialog.data("record-count-per-page")),this.pageSizeIsCustom=!1,this.initValues={viewMode:this.$ViewModeControl.val(),cardsCount:this._getCardCountValues(),recordPerPage:this.defaultRecordCountPerPage}},_getCardCountValues:function(){return _.reduce(this.$CardColumnCount.toArray(),(function(acc,el){var $el=$(el);return acc[$el.data("size")]=$el.val(),acc}),{})},_initializeEvents:function(){var self=this;this.$PageSizeControl.on("change",(function(){"custom"==$(this).val()&&self._selectCustomPageSize()})),this.$PageSizeCustomControl.on("keyup, change",(function(){self._calcCustomCountPage($(this).val())})),this.$PageSizeSave.on("click",(function(){self._applyPageSettings()})),this.$ViewModeControl.on("change",(function(){self._changeModeHandler()})),this.$PageSizeCancel.on("click",(function(){self.$ViewModeControl.val(self.initValues.viewMode),self.$CardColumnCount.each((function(i,el){var $el=$(el);$el.val(self.initValues.cardsCount[$el.data("size")])})),self._selectDefaults()}))},_pageSizeValues:[],_getPageSizeValues:function(){if(0==this._pageSizeValues.length){var values=[];this.$PageSizeControl.find("option").each((function(){values.push(parseInt($(this).val()))})),this._pageSizeValues=values}return this._pageSizeValues},_selectDefaults:function(){(this._changeModeHandler(),this._isPageSizeVariable())&&(-1===this._getPageSizeValues().indexOf(this.defaultRecordCountPerPage)?(this._selectCustomPageSize(),this._calcCustomCountPage(this.defaultRecordCountPerPage)):(this._selectPredefinedPageSize(),this.$PageSizeControl.val(this.defaultRecordCountPerPage)))},_isPageSizeVariable:function(){return this.$PageSizeCustomControl.length>0&&this.$PageSizeControl.length>0},_getPageCountForPageSize:function(pageSize,rowCount){return pageSize>0?Math.floor(rowCount/pageSize)+(Math.floor(rowCount/pageSize)==rowCount/pageSize?0:1):1},_calcCustomCountPage:function(val){this.$PageSizeCustomCounter.text(this._getPageCountForPageSize(val,this.totalRecordCount))},_selectCustomPageSize:function(){this.$PageSizeContainer.hide(),this.$PageSizeCustomContainer.show(),this.pageSizeIsCustom=!0,this.$PageSizeCustomControl.val(this.defaultRecordCountPerPage),this._calcCustomCountPage(this.defaultRecordCountPerPage)},_selectPredefinedPageSize:function(){this.$PageSizeContainer.show(),this.$PageSizeCustomContainer.hide(),this.pageSizeIsCustom=!1},_changeModeHandler:function(){var name=this.$ViewModeControl.find("option:selected").data("name");this.$CardColumnCount.prop("disabled","CardViewMode"!=name)},_applyPageSettings:function(){var query=jQuery.query;query=(query=query.set("viewmode",this.$ViewModeControl.val())).set("cardcountinrow",this._getCardCountValues()),this._isPageSizeVariable()&&(query=query.set("recperpage",this.pageSizeIsCustom?this.$PageSizeCustomControl.val():this.$PageSizeControl.val())),window.location=query}});return function($context){new PageControl($context)}})),define("pgui.filter_common",["class","underscore"],(function(Class,_){var Component=Class.extend({init:function(operator){this.operator=operator,this.enabled=!0},isEnabled:function(){return this.enabled},setEnabled:function(enabled){return this.enabled=enabled,this},getOperator:function(){return this.operator},setOperator:function(operator){return this.operator=operator,this},isGroup:function(){return!1},isCondition:function(){return!1}}),Group=Component.extend({init:function(operator,children){this._super(operator||GroupOperator.OPERATOR_AND),this.children=children||{}},setChildren:function(children){return this.children=children,this},addChild:function(child,index){return index=index||Date.now(),this.children[index]=child,this},removeChild:function(childToRemove){var key=_.findKey(this.children,(function(child){return child===childToRemove}));return _.isUndefined(key)?_.each(this.children,(function(child){child.removeChild(childToRemove)})):delete this.children[key],this},getChildren:function(){return this.children},getChild:function(key){return this.children[key]},deserialize:function(columns,data){return this.setOperator(data.operator).setEnabled(data.isEnabled).setChildren(_.mapObject(data.children,_.bind((function(childData){return(childData.type===ComponentType.GROUP?new this.constructor:this.createCondition()).deserialize(columns,childData)}),this)))},serialize:function(){return{type:ComponentType.GROUP,isEnabled:this.isEnabled(),operator:this.getOperator(),children:_.mapObject(this.children,(function(child){return child.serialize()}))}},isEmpty:function(){return!_.find(this.children,(function(child){return!child.isEmpty()}))},createCondition:function(){return new Condition},isGroup:function(){return!0}}),Condition=Component.extend({init:function(column,operator,values){this._super(operator||column?_.first(column.getOperators()):ConditionOperator.EQUALS),this.column=column,this.values=values||[],this.displayValues=_.clone(this.values)},getColumnName:function(){return this.column.getName()},setColumn:function(column){return this.column=column,this.values=[],this.displayValues=[],this.setOperator(_.first(column.getOperators())),this},getValues:function(){return this.values},getValueAt:function(index){return void 0===this.values[index]?null:this.values[index]},setValues:function(values){return this.values=values,this},setValueAt:function(index,value){return this.values[index]=value,this},setDisplayValues:function(values){return this.displayValues=values,this},setDisplayValueAt:function(index,value){return this.displayValues[index]=value,this},getDisplayValues:function(values){return this.displayValues},getDisplayValueAt:function(index){return void 0===this.displayValues[index]?null:this.displayValues[index]},serialize:function(){return{type:ComponentType.CONDITION,isEnabled:this.isEnabled(),column:this.column.getName(),operator:this.getOperator(),values:this.getValues(),displayValues:this.getDisplayValues()}},deserialize:function(columns,data){return this.setColumn(_.find(columns,(function(column){return column.getName()===data.column}))).setOperator(data.operator).setValues(data.values).setDisplayValues(data.displayValues).setEnabled(data.isEnabled)},isEmpty:function(){return!1},removeChild:function(){},isCondition:function(){return!0}}),Column=Class.extend({init:function(name,caption,operators){this.name=name,this.caption=caption,this.operators=operators},getName:function(){return this.name},getCaption:function(){return this.caption},getOperators:function(){return this.operators}}),ComponentType={GROUP:"group",CONDITION:"condition"},ConditionOperator={EQUALS:"Equals",DOES_NOT_EQUAL:"DoesNotEqual",IS_GREATER_THAN:"IsGreaterThan",IS_GREATER_THAN_OR_EQUAL_TO:"IsGreaterThanOrEqualTo",IS_LESS_THAN:"IsLessThan",IS_LESS_THAN_OR_EQUAL_TO:"IsLessThanOrEqualTo",IS_BETWEEN:"IsBetween",IS_NOT_BETWEEN:"IsNotBetween",CONTAINS:"Contains",DOES_NOT_CONTAIN:"DoesNotContain",BEGINS_WITH:"BeginsWith",ENDS_WITH:"EndsWith",IS_LIKE:"IsLike",IS_NOT_LIKE:"IsNotLike",IS_BLANK:"IsBlank",IS_NOT_BLANK:"IsNotBlank",DATE_EQUALS:"DateEquals",DATE_DOES_NOT_EQUAL:"DateDoesNotEqual",YEAR_EQUALS:"YearEquals",YEAR_DOES_NOT_EQUAL:"YearDoesNotEqual",MONTH_EQUALS:"MonthEquals",MONTH_DOES_NOT_EQUAL:"MonthDoesNotEqual",IN:"In",NOT_IN:"NotIn",TODAY:"Today",THIS_MONTH:"ThisMonth",PREV_MONTH:"PrevMonth",THIS_YEAR:"ThisYear",PREV_YEAR:"PrevYear"},GroupOperator={OPERATOR_AND:"AND",OPERATOR_OR:"OR",OPERATOR_NONE:"NONE"};return{Column:Column,Group:Group,Condition:Condition,ComponentType:ComponentType,ConditionOperator:ConditionOperator,GroupOperator:GroupOperator}})),define("microevent",["require","exports","module"],(function(require,exports,module){var MicroEvent=function(){};MicroEvent.prototype={bind:function(event,fct){this._events=this._events||{},this._events[event]=this._events[event]||[],this._events[event].push(fct)},once:function(event,fct){this._onceEvents=this._onceEvents||{},this._onceEvents[event]=this._onceEvents[event]||[],this._onceEvents[event].push(fct)},unbind:function(event,fct){this._events=this._events||{},event in this._events!=!1&&this._events[event].splice(this._events[event].indexOf(fct),1)},trigger:function(event){var i;if(this._events=this._events||{},this._onceEvents=this._onceEvents||{},event in this._events!=!1)for(i=0;i<this._events[event].length;i++)this._events[event][i].apply(this,Array.prototype.slice.call(arguments,1));if(event in this._onceEvents!=!1){for(i=0;i<this._onceEvents[event].length;i++)this._onceEvents[event][i].apply(this,Array.prototype.slice.call(arguments,1));this._onceEvents[event].splice(0,this._onceEvents[event].length)}}},MicroEvent.mixin=function(destObject){for(var props=["bind","unbind","trigger","once"],i=0;i<props.length;i++)destObject.prototype[props[i]]=MicroEvent.prototype[props[i]];return destObject},void 0!==module&&"exports"in module&&(module.exports=MicroEvent)})),define("pgui.events",["class","microevent"],(function(Class,events){var InputEvents=Class.extend({init:function($input){this.$input=$input},onChange:function(callback){this.bind("changed",callback)},changed:function(){this.trigger("changed")}});return{InputEvents:events.mixin(InputEvents),setupInputEvents:function($input){$input.data("pg-events",new InputEvents($input))}}})),define("pgui.editors/custom",["class","microevent","underscore"],(function(Class,events,_){return events.mixin(Class.extend({init:function(rootElement,readyCallback){this.rootElement=rootElement,this.fieldName=this.rootElement.attr("data-field-name");var isVisible=rootElement.data("editor-visible");_.isUndefined(isVisible)||this.setVisible(isVisible),_.isFunction(readyCallback)&&readyCallback(this)},doChanged:function(){this.trigger("onChangeEvent",this,0)},getValue:function(){return null},getValueEx:function(){return this.getValue()},setValue:function(value){return this},setValueEx:function(value){this.setValue(value)},getDisplayValue:function(){return this.getValue()},getData:function(){return this.getValue()},setData:function(data){return this.setValue(data),this},onChange:function(callback){return this.bind("onChangeEvent",callback),this},getRootElement:function(){return this.rootElement},getFieldName:function(){return this.fieldName},isReadOnly:function(){return this.readonly()},getVisible:function(){return this.rootElement.closest(".form-group").is(":visible")},setVisible:function(value){return this.rootElement.closest(".form-group").toggle(value).prev(".form-group-label").toggle(value),this._getLabelGroup().toggle(value),this},visible:function(value){if(0!==this.rootElement.closest(".form-group").length)return _.isUndefined(value)?this.getVisible():void this.setVisible(value)},enabled:function(value){if(_.isUndefined(value))return this.getEnabled();this.getEnabled()!=value&&this.setEnabled(value)},getEnabled:function(){return!0},setEnabled:function(value){return this},readonly:function(value){if(_.isUndefined(value))return this.getReadonly();this.getReadonly()!=value&&this.setReadonly(value)},getReadonly:function(){return!1},setReadonly:function(value){return this},setValidationErrorMessage:function(validatorName,message){var validation=this.rootElement.closest("form").data("validator");if(!validation)return this;var name=this.rootElement.closest(".col-input").find("input,select,textarea").first().attr("name");return name&&validation.settings.messages[name]&&(validation.settings.messages[name][validatorName]=message,"required"===validatorName&&(validation.settings.messages[name].required_custom=message)),this},getState:function(){var $formGroup=this.rootElement.closest(".form-group"),states=["warning","error","success"];for(var i in states)if($formGroup.hasClass("has-"+states[i]))return states[i];return"normal"},setState:function(state){if(-1!==["normal","warning","error","info","success"].indexOf(state)){var classes="has-warning has-error has-success",$labelGroup=this._getLabelGroup().removeClass(classes),$inputGroup=this.rootElement.closest(".form-group").removeClass(classes);return"normal"===state||($labelGroup.addClass("has-"+state),$inputGroup.addClass("has-"+state)),this}},setHint:function(hint){var $formGroup=this.rootElement.closest(".form-group"),$helpBlock=$formGroup.find(".help-block");return hint?(0===$helpBlock.length?$formGroup.append($("<p>").addClass("help-block").html(hint)):$helpBlock.html(hint),this):($helpBlock.remove(),this)},isMultivalue:function(){return!1},destroy:function(){},setRequired:function(isRequired){this._getLabelGroup().find("span.required-mark").toggle(Boolean(isRequired));var command=isRequired?"add":"remove",$target=this._getSetRequiredTarget();return $target.rules(command,"required_custom"),$target.rules(command,"required"),this},getRequired:function(){return this._getLabelGroup().find("span.required-mark").is(":visible")},_getSetRequiredTarget:function(){return this.getRootElement()},_getLabelGroup:function(){return $(".control-label[for="+this._getId()+"]").closest(".form-group")},_getId:function(){return this.rootElement.attr("id")}}))})),define("pgui.editors/select2_format",["class"],(function(Class){return Class.extend({init:function(){this._formatCallbacks=[]},setCallback:function(prop,callback,level){"function"==typeof callback?(level=level||0,this._formatCallbacks[level]||(this._formatCallbacks[level]={}),this._formatCallbacks[level][prop]=callback):console.error("select2: callback argument must be a valid function")},setFormatCallbacksFromElement:function($el,level){level=level||0;var attrFormatResult=this._evalFormatFunction($el.data("format-result")),attrFormatSelection=this._evalFormatFunction($el.data("format-selection"));attrFormatResult&&this.setCallback("result",attrFormatResult,level),attrFormatSelection&&this.setCallback("selection",attrFormatSelection,level)},getFormatClojure:function(prop,level){var self=this;return level=level||0,function(item){return self._hasFormatCallback(prop,level)?self._formatCallbacks[level][prop](item):item.text}},_hasFormatCallback:function(prop,level){return!!this._formatCallbacks[level]&&!!this._formatCallbacks[level][prop]},_evalFormatFunction:function(expr){if(!expr)return null;var result=void 0;return eval("var result = function (item) { "+expr+" };"),result}})})),function(window){var re={not_string:/[^s]/,number:/[dief]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function sprintf(){var key=arguments[0],cache=sprintf.cache;return cache[key]&&cache.hasOwnProperty(key)||(cache[key]=sprintf.parse(key)),sprintf.format.call(null,cache[key],arguments)}sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,input,cursor=1,tree_length=parse_tree.length,node_type="",output=[],is_positive=!0,sign="";for(i=0;i<tree_length;i++)if("string"===(node_type=get_type(parse_tree[i])))output[output.length]=parse_tree[i];else if("array"===node_type){if((match=parse_tree[i])[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if("function"==get_type(arg)&&(arg=arg()),re.not_string.test(match[8])&&re.not_json.test(match[8])&&"number"!=get_type(arg)&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}re.json.test(match[8])?output[output.length]=arg:(!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?(input=pad_character,Array(pad_length+1).join(input)):"",output[output.length]=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg)}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree[parse_tree.length]=match[0];else if(null!==(match=re.modulo.exec(_fmt)))parse_tree[parse_tree.length]="%";else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list[field_list.length]=field_match[1];""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list[field_list.length]=field_match[1];else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list[field_list.length]=field_match[1]}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree[parse_tree.length]=match}_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){return(_argv=(argv||[]).slice(0)).splice(0,0,fmt),sprintf.apply(null,_argv)};function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}"undefined"!=typeof exports?(exports.sprintf=sprintf,exports.vsprintf=vsprintf):(window.sprintf=sprintf,window.vsprintf=vsprintf,"function"==typeof define&&define.amd&&define("libs/sprintf",[],(function(){return{sprintf:sprintf,vsprintf:vsprintf}})))}("undefined"==typeof window?this:window),function($){void 0===$.fn.each2&&$.extend($.fn,{each2:function(c){for(var j=$([0]),i=-1,l=this.length;++i<l&&(j.context=j[0]=this[i])&&!1!==c.call(j[0],i,j););return this}})}(jQuery),function($,undefined){"use strict";if(window.Select2===undefined){var AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer,$document,scrollBarDimensions,counter,lastMousePosition={x:0,y:0},KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){switch(k=k.which?k.which:k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return!0}return!!e.metaKey},isFunctionKey:function(k){return(k=k.which?k.which:k)>=112&&k<=123}},DIACRITICS={"â¶":"A","ï¼¡":"A","Ã":"A","Ã":"A","Ã":"A","áº¦":"A","áº¤":"A","áºª":"A","áº¨":"A","Ã":"A","Ä":"A","Ä":"A","áº°":"A","áº®":"A","áº´":"A","áº²":"A","È¦":"A","Ç ":"A","Ã":"A","Ç":"A","áº¢":"A","Ã":"A","Çº":"A","Ç":"A","È":"A","È":"A","áº ":"A","áº¬":"A","áº¶":"A","á¸":"A","Ä":"A","Èº":"A","â±¯":"A","ê²":"AA","Ã":"AE","Ç¼":"AE","Ç¢":"AE","ê´":"AO","ê¶":"AU","ê¸":"AV","êº":"AV","ê¼":"AY","â·":"B","ï¼¢":"B","á¸":"B","á¸":"B","á¸":"B","É":"B","Æ":"B","Æ":"B","â¸":"C","ï¼£":"C","Ä":"C","Ä":"C","Ä":"C","Ä":"C","Ã":"C","á¸":"C","Æ":"C","È»":"C","ê¾":"C","â¹":"D","ï¼¤":"D","á¸":"D","Ä":"D","á¸":"D","á¸":"D","á¸":"D","á¸":"D","Ä":"D","Æ":"D","Æ":"D","Æ":"D","ê¹":"D","Ç±":"DZ","Ç":"DZ","Ç²":"Dz","Ç":"Dz","âº":"E","ï¼¥":"E","Ã":"E","Ã":"E","Ã":"E","á»":"E","áº¾":"E","á»":"E","á»":"E","áº¼":"E","Ä":"E","á¸":"E","á¸":"E","Ä":"E","Ä":"E","Ã":"E","áºº":"E","Ä":"E","È":"E","È":"E","áº¸":"E","á»":"E","È¨":"E","á¸":"E","Ä":"E","á¸":"E","á¸":"E","Æ":"E","Æ":"E","â»":"F","ï¼¦":"F","á¸":"F","Æ":"F","ê»":"F","â¼":"G","ï¼§":"G","Ç´":"G","Ä":"G","á¸ ":"G","Ä":"G","Ä ":"G","Ç¦":"G","Ä¢":"G","Ç¤":"G","Æ":"G","ê ":"G","ê½":"G","ê¾":"G","â½":"H","ï¼¨":"H","Ä¤":"H","á¸¢":"H","á¸¦":"H","È":"H","á¸¤":"H","á¸¨":"H","á¸ª":"H","Ä¦":"H","â±§":"H","â±µ":"H","ê":"H","â¾":"I","ï¼©":"I","Ã":"I","Ã":"I","Ã":"I","Ä¨":"I","Äª":"I","Ä¬":"I","Ä°":"I","Ã":"I","á¸®":"I","á»":"I","Ç":"I","È":"I","È":"I","á»":"I","Ä®":"I","á¸¬":"I","Æ":"I","â¿":"J","ï¼ª":"J","Ä´":"J","É":"J","â":"K","ï¼«":"K","á¸°":"K","Ç¨":"K","á¸²":"K","Ä¶":"K","á¸´":"K","Æ":"K","â±©":"K","ê":"K","ê":"K","ê":"K","ê¢":"K","â":"L","ï¼¬":"L","Ä¿":"L","Ä¹":"L","Ä½":"L","á¸¶":"L","á¸¸":"L","Ä»":"L","á¸¼":"L","á¸º":"L","Å":"L","È½":"L","â±¢":"L","â± ":"L","ê":"L","ê":"L","ê":"L","Ç":"LJ","Ç":"Lj","â":"M","ï¼­":"M","á¸¾":"M","á¹":"M","á¹":"M","â±®":"M","Æ":"M","â":"N","ï¼®":"N","Ç¸":"N","Å":"N","Ã":"N","á¹":"N","Å":"N","á¹":"N","Å":"N","á¹":"N","á¹":"N","È ":"N","Æ":"N","ê":"N","ê¤":"N","Ç":"NJ","Ç":"Nj","â":"O","ï¼¯":"O","Ã":"O","Ã":"O","Ã":"O","á»":"O","á»":"O","á»":"O","á»":"O","Ã":"O","á¹":"O","È¬":"O","á¹":"O","Å":"O","á¹":"O","á¹":"O","Å":"O","È®":"O","È°":"O","Ã":"O","Èª":"O","á»":"O","Å":"O","Ç":"O","È":"O","È":"O","Æ ":"O","á»":"O","á»":"O","á» ":"O","á»":"O","á»¢":"O","á»":"O","á»":"O","Çª":"O","Ç¬":"O","Ã":"O","Ç¾":"O","Æ":"O","Æ":"O","ê":"O","ê":"O","Æ¢":"OI","ê":"OO","È¢":"OU","â":"P","ï¼°":"P","á¹":"P","á¹":"P","Æ¤":"P","â±£":"P","ê":"P","ê":"P","ê":"P","â":"Q","ï¼±":"Q","ê":"Q","ê":"Q","É":"Q","â":"R","ï¼²":"R","Å":"R","á¹":"R","Å":"R","È":"R","È":"R","á¹":"R","á¹":"R","Å":"R","á¹":"R","É":"R","â±¤":"R","ê":"R","ê¦":"R","ê":"R","â":"S","ï¼³":"S","áº":"S","Å":"S","á¹¤":"S","Å":"S","á¹ ":"S","Å ":"S","á¹¦":"S","á¹¢":"S","á¹¨":"S","È":"S","Å":"S","â±¾":"S","ê¨":"S","ê":"S","â":"T","ï¼´":"T","á¹ª":"T","Å¤":"T","á¹¬":"T","È":"T","Å¢":"T","á¹°":"T","á¹®":"T","Å¦":"T","Æ¬":"T","Æ®":"T","È¾":"T","ê":"T","ê¨":"TZ","â":"U","ï¼µ":"U","Ã":"U","Ã":"U","Ã":"U","Å¨":"U","á¹¸":"U","Åª":"U","á¹º":"U","Å¬":"U","Ã":"U","Ç":"U","Ç":"U","Ç":"U","Ç":"U","á»¦":"U","Å®":"U","Å°":"U","Ç":"U","È":"U","È":"U","Æ¯":"U","á»ª":"U","á»¨":"U","á»®":"U","á»¬":"U","á»°":"U","á»¤":"U","á¹²":"U","Å²":"U","á¹¶":"U","á¹´":"U","É":"U","â":"V","ï¼¶":"V","á¹¼":"V","á¹¾":"V","Æ²":"V","ê":"V","É":"V","ê ":"VY","â":"W","ï¼·":"W","áº":"W","áº":"W","Å´":"W","áº":"W","áº":"W","áº":"W","â±²":"W","â":"X","ï¼¸":"X","áº":"X","áº":"X","â":"Y","ï¼¹":"Y","á»²":"Y","Ã":"Y","Å¶":"Y","á»¸":"Y","È²":"Y","áº":"Y","Å¸":"Y","á»¶":"Y","á»´":"Y","Æ³":"Y","É":"Y","á»¾":"Y","â":"Z","ï¼º":"Z","Å¹":"Z","áº":"Z","Å»":"Z","Å½":"Z","áº":"Z","áº":"Z","Æµ":"Z","È¤":"Z","â±¿":"Z","â±«":"Z","ê¢":"Z","â":"a","ï½":"a","áº":"a","Ã ":"a","Ã¡":"a","Ã¢":"a","áº§":"a","áº¥":"a","áº«":"a","áº©":"a","Ã£":"a","Ä":"a","Ä":"a","áº±":"a","áº¯":"a","áºµ":"a","áº³":"a","È§":"a","Ç¡":"a","Ã¤":"a","Ç":"a","áº£":"a","Ã¥":"a","Ç»":"a","Ç":"a","È":"a","È":"a","áº¡":"a","áº­":"a","áº·":"a","á¸":"a","Ä":"a","â±¥":"a","É":"a","ê³":"aa","Ã¦":"ae","Ç½":"ae","Ç£":"ae","êµ":"ao","ê·":"au","ê¹":"av","ê»":"av","ê½":"ay","â":"b","ï½":"b","á¸":"b","á¸":"b","á¸":"b","Æ":"b","Æ":"b","É":"b","â":"c","ï½":"c","Ä":"c","Ä":"c","Ä":"c","Ä":"c","Ã§":"c","á¸":"c","Æ":"c","È¼":"c","ê¿":"c","â":"c","â":"d","ï½":"d","á¸":"d","Ä":"d","á¸":"d","á¸":"d","á¸":"d","á¸":"d","Ä":"d","Æ":"d","É":"d","É":"d","êº":"d","Ç³":"dz","Ç":"dz","â":"e","ï½":"e","Ã¨":"e","Ã©":"e","Ãª":"e","á»":"e","áº¿":"e","á»":"e","á»":"e","áº½":"e","Ä":"e","á¸":"e","á¸":"e","Ä":"e","Ä":"e","Ã«":"e","áº»":"e","Ä":"e","È":"e","È":"e","áº¹":"e","á»":"e","È©":"e","á¸":"e","Ä":"e","á¸":"e","á¸":"e","É":"e","É":"e","Ç":"e","â":"f","ï½":"f","á¸":"f","Æ":"f","ê¼":"f","â":"g","ï½":"g","Çµ":"g","Ä":"g","á¸¡":"g","Ä":"g","Ä¡":"g","Ç§":"g","Ä£":"g","Ç¥":"g","É ":"g","ê¡":"g","áµ¹":"g","ê¿":"g","â":"h","ï½":"h","Ä¥":"h","á¸£":"h","á¸§":"h","È":"h","á¸¥":"h","á¸©":"h","á¸«":"h","áº":"h","Ä§":"h","â±¨":"h","â±¶":"h","É¥":"h","Æ":"hv","â":"i","ï½":"i","Ã¬":"i","Ã­":"i","Ã®":"i","Ä©":"i","Ä«":"i","Ä­":"i","Ã¯":"i","á¸¯":"i","á»":"i","Ç":"i","È":"i","È":"i","á»":"i","Ä¯":"i","á¸­":"i","É¨":"i","Ä±":"i","â":"j","ï½":"j","Äµ":"j","Ç°":"j","É":"j","â":"k","ï½":"k","á¸±":"k","Ç©":"k","á¸³":"k","Ä·":"k","á¸µ":"k","Æ":"k","â±ª":"k","ê":"k","ê":"k","ê":"k","ê£":"k","â":"l","ï½":"l","Å":"l","Äº":"l","Ä¾":"l","á¸·":"l","á¸¹":"l","Ä¼":"l","á¸½":"l","á¸»":"l","Å¿":"l","Å":"l","Æ":"l","É«":"l","â±¡":"l","ê":"l","ê":"l","ê":"l","Ç":"lj","â":"m","ï½":"m","á¸¿":"m","á¹":"m","á¹":"m","É±":"m","É¯":"m","â":"n","ï½":"n","Ç¹":"n","Å":"n","Ã±":"n","á¹":"n","Å":"n","á¹":"n","Å":"n","á¹":"n","á¹":"n","Æ":"n","É²":"n","Å":"n","ê":"n","ê¥":"n","Ç":"nj","â":"o","ï½":"o","Ã²":"o","Ã³":"o","Ã´":"o","á»":"o","á»":"o","á»":"o","á»":"o","Ãµ":"o","á¹":"o","È­":"o","á¹":"o","Å":"o","á¹":"o","á¹":"o","Å":"o","È¯":"o","È±":"o","Ã¶":"o","È«":"o","á»":"o","Å":"o","Ç":"o","È":"o","È":"o","Æ¡":"o","á»":"o","á»":"o","á»¡":"o","á»":"o","á»£":"o","á»":"o","á»":"o","Ç«":"o","Ç­":"o","Ã¸":"o","Ç¿":"o","É":"o","ê":"o","ê":"o","Éµ":"o","Æ£":"oi","È£":"ou","ê":"oo","â":"p","ï½":"p","á¹":"p","á¹":"p","Æ¥":"p","áµ½":"p","ê":"p","ê":"p","ê":"p","â ":"q","ï½":"q","É":"q","ê":"q","ê":"q","â¡":"r","ï½":"r","Å":"r","á¹":"r","Å":"r","È":"r","È":"r","á¹":"r","á¹":"r","Å":"r","á¹":"r","É":"r","É½":"r","ê":"r","ê§":"r","ê":"r","â¢":"s","ï½":"s","Ã":"s","Å":"s","á¹¥":"s","Å":"s","á¹¡":"s","Å¡":"s","á¹§":"s","á¹£":"s","á¹©":"s","È":"s","Å":"s","È¿":"s","ê©":"s","ê":"s","áº":"s","â£":"t","ï½":"t","á¹«":"t","áº":"t","Å¥":"t","á¹­":"t","È":"t","Å£":"t","á¹±":"t","á¹¯":"t","Å§":"t","Æ­":"t","Ê":"t","â±¦":"t","ê":"t","ê©":"tz","â¤":"u","ï½":"u","Ã¹":"u","Ãº":"u","Ã»":"u","Å©":"u","á¹¹":"u","Å«":"u","á¹»":"u","Å­":"u","Ã¼":"u","Ç":"u","Ç":"u","Ç":"u","Ç":"u","á»§":"u","Å¯":"u","Å±":"u","Ç":"u","È":"u","È":"u","Æ°":"u","á»«":"u","á»©":"u","á»¯":"u","á»­":"u","á»±":"u","á»¥":"u","á¹³":"u","Å³":"u","á¹·":"u","á¹µ":"u","Ê":"u","â¥":"v","ï½":"v","á¹½":"v","á¹¿":"v","Ê":"v","ê":"v","Ê":"v","ê¡":"vy","â¦":"w","ï½":"w","áº":"w","áº":"w","Åµ":"w","áº":"w","áº":"w","áº":"w","áº":"w","â±³":"w","â§":"x","ï½":"x","áº":"x","áº":"x","â¨":"y","ï½":"y","á»³":"y","Ã½":"y","Å·":"y","á»¹":"y","È³":"y","áº":"y","Ã¿":"y","á»·":"y","áº":"y","á»µ":"y","Æ´":"y","É":"y","á»¿":"y","â©":"z","ï½":"z","Åº":"z","áº":"z","Å¼":"z","Å¾":"z","áº":"z","áº":"z","Æ¶":"z","È¥":"z","É":"z","â±¬":"z","ê£":"z","Î":"Î","Î":"Î","Î":"Î","Î":"Î","Îª":"Î","Î":"Î","Î":"Î¥","Î«":"Î¥","Î":"Î©","Î¬":"Î±","Î­":"Îµ","Î®":"Î·","Î¯":"Î¹","Ï":"Î¹","Î":"Î¹","Ï":"Î¿","Ï":"Ï","Ï":"Ï","Î°":"Ï","Ï":"Ï","Ï":"Ï"};$document=$(document),counter=1,nextUid=function(){return counter++},AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments)}},init:function(opts){var results,search;this.opts=opts=this.prepareOpts(opts),this.id=opts.id,opts.element.data("select2")!==undefined&&null!==opts.element.data("select2")&&opts.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=$(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(opts.element.attr("id")||"autogen"+nextUid()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",opts.element.attr("title")),this.body=$(document.body),syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",opts.element.attr("style")),this.container.css(evaluate(opts.containerCss,this.opts.element)),this.container.addClass(evaluate(opts.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",killEvent),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(evaluate(opts.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",killEvent),this.results=results=this.container.find(".select2-results"),this.search=search=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",killEvent),this.results.on("mousemove",(function(e){var lastpos=lastMousePosition;lastpos!==undefined&&lastpos.x===e.pageX&&lastpos.y===e.pageY||$(e.target).trigger("mousemove-filtered",e)})),this.dropdown.on("mousemove-filtered",".select2-results",this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",".select2-results",this.bind((function(event){this._touchEvent=!0,this.highlightUnderEvent(event)}))),this.dropdown.on("touchmove",".select2-results",this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",".select2-results",this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind((function(event){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())}))),function(threshold,element){var notify=debounce(threshold,(function(e){element.trigger("scroll-debounced",e)}));element.on("scroll",(function(e){indexOf(e.target,element.get())>=0&&notify(e)}))}(80,this.results),this.dropdown.on("scroll-debounced",".select2-results",this.bind(this.loadMoreIfNeeded)),$(this.container).on("change",".select2-input",(function(e){e.stopPropagation()})),$(this.dropdown).on("change",".select2-input",(function(e){e.stopPropagation()})),$.fn.mousewheel&&results.mousewheel((function(e,delta,deltaX,deltaY){var top=results.scrollTop();deltaY>0&&top-deltaY<=0?(results.scrollTop(0),killEvent(e)):deltaY<0&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()&&(results.scrollTop(results.get(0).scrollHeight-results.height()),killEvent(e))})),installKeyUpChangeEvent(search),search.on("keyup-change input paste",this.bind(this.updateResults)),search.on("focus",(function(){search.addClass("select2-focused")})),search.on("blur",(function(){search.removeClass("select2-focused")})),this.dropdown.on("mouseup",".select2-results",this.bind((function(e){$(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))}))),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",(function(e){e.stopPropagation()})),this.nextSearchTerm=undefined,$.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==opts.maximumInputLength&&this.search.attr("maxlength",opts.maximumInputLength);var disabled=opts.element.prop("disabled");disabled===undefined&&(disabled=!1),this.enable(!disabled);var readonly=opts.element.prop("readonly");readonly===undefined&&(readonly=!1),this.readonly(readonly),scrollBarDimensions=scrollBarDimensions||function(){var $template=$("<div class='select2-measure-scrollbar'></div>");$template.appendTo(document.body);var dim={width:$template.width()-$template[0].clientWidth,height:$template.height()-$template[0].clientHeight};return $template.remove(),dim}(),this.autofocus=opts.element.prop("autofocus"),opts.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",opts.searchInputPlaceholder)},destroy:function(){var element=this.opts.element,select2=element.data("select2"),self=this;this.close(),element.length&&element[0].detachEvent&&self._sync&&element.each((function(){self._sync&&this.detachEvent("onpropertychange",self._sync)})),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,select2!==undefined&&(select2.container.remove(),select2.liveRegion.remove(),select2.dropdown.remove(),element.show().removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?element.attr({tabindex:this.elementTabIndex}):element.removeAttr("tabindex"),element.show()),cleanupJQueryElements.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(element){return element.is("option")?{id:element.prop("value"),text:element.text(),element:element.get(),css:element.attr("class"),disabled:element.prop("disabled"),locked:equal(element.attr("locked"),"locked")||equal(element.data("locked"),!0)}:element.is("optgroup")?{text:element.attr("label"),children:[],element:element.get(),css:element.attr("class")}:void 0},prepareOpts:function(opts){var element,select,idKey,ajaxUrl,self=this;if("select"===(element=opts.element).get(0).tagName.toLowerCase()&&(this.select=select=opts.element),select&&$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],(function(){if(this in opts)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")})),"function"!=typeof(opts=$.extend({},{populateResults:function(container,results,query){var populate,id=this.opts.id,liveRegion=this.liveRegion;populate=function(results,container,depth){var i,l,result,selectable,disabled,compound,node,label,innerContainer,formatted,nodes=[];for(i=0,l=(results=opts.sortResults(results,container,query)).length;i<l;i+=1)selectable=!(disabled=!0===(result=results[i]).disabled)&&id(result)!==undefined,compound=result.children&&result.children.length>0,(node=$("<li></li>")).addClass("select2-results-dept-"+depth),node.addClass("select2-result"),node.addClass(selectable?"select2-result-selectable":"select2-result-unselectable"),disabled&&node.addClass("select2-disabled"),compound&&node.addClass("select2-result-with-children"),node.addClass(self.opts.formatResultCssClass(result)),node.attr("role","presentation"),(label=$(document.createElement("div"))).addClass("select2-result-label"),label.attr("id","select2-result-label-"+nextUid()),label.attr("role","option"),(formatted=opts.formatResult(result,label,query,self.opts.escapeMarkup))!==undefined&&(label.html(formatted),node.append(label)),compound&&((innerContainer=$("<ul></ul>")).addClass("select2-result-sub"),populate(result.children,innerContainer,depth+1),node.append(innerContainer)),node.data("select2-data",result),nodes.push(node[0]);container.append(nodes),liveRegion.text(opts.formatMatches(results.length))},populate(results,container,0)}},$.fn.select2.defaults,opts)).id&&(idKey=opts.id,opts.id=function(e){return e[idKey]}),$.isArray(opts.element.data("select2Tags"))){if("tags"in opts)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+opts.element.attr("id");opts.tags=opts.element.data("select2Tags")}if(select?(opts.query=this.bind((function(query){var children,placeholderOption,process,data={results:[],more:!1},term=query.term;process=function(element,collection){var group;element.is("option")?query.matcher(term,element.text(),element)&&collection.push(self.optionToData(element)):element.is("optgroup")&&(group=self.optionToData(element),element.children().each2((function(i,elm){process(elm,group.children)})),group.children.length>0&&collection.push(group))},children=element.children(),this.getPlaceholder()!==undefined&&children.length>0&&(placeholderOption=this.getPlaceholderOption())&&(children=children.not(placeholderOption)),children.each2((function(i,elm){process(elm,data.results)})),query.callback(data)})),opts.id=function(e){return e.id}):"query"in opts||("ajax"in opts?((ajaxUrl=opts.element.data("ajax-url"))&&ajaxUrl.length>0&&(opts.ajax.url=ajaxUrl),opts.query=ajax.call(opts.element,opts.ajax)):"data"in opts?opts.query=local(opts.data):"tags"in opts&&(opts.query=tags(opts.tags),opts.createSearchChoice===undefined&&(opts.createSearchChoice=function(term){return{id:$.trim(term),text:$.trim(term)}}),opts.initSelection===undefined&&(opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator,opts.transformVal)).each((function(){var obj={id:this,text:this},tags=opts.tags;$.isFunction(tags)&&(tags=tags()),$(tags).each((function(){if(equal(this.id,obj.id))return obj=this,!1})),data.push(obj)})),callback(data)}))),"function"!=typeof opts.query)throw"query function not defined for Select2 "+opts.element.attr("id");if("top"===opts.createSearchChoicePosition)opts.createSearchChoicePosition=function(list,item){list.unshift(item)};else if("bottom"===opts.createSearchChoicePosition)opts.createSearchChoicePosition=function(list,item){list.push(item)};else if("function"!=typeof opts.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return opts},monitorSource:function(){var observer,el=this.opts.element,self=this;el.on("change.select2",this.bind((function(e){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()}))),this._sync=this.bind((function(){var disabled=el.prop("disabled");disabled===undefined&&(disabled=!1),this.enable(!disabled);var readonly=el.prop("readonly");readonly===undefined&&(readonly=!1),this.readonly(readonly),this.container&&(syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(evaluate(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(evaluate(this.opts.dropdownCssClass,this.opts.element)))})),el.length&&el[0].attachEvent&&el.each((function(){this.attachEvent("onpropertychange",self._sync)})),(observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==undefined&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new observer((function(mutations){$.each(mutations,self._sync)})),this.propertyObserver.observe(el.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(data){var evt=$.Event("select2-selecting",{val:this.id(data),object:data,choice:data});return this.opts.element.trigger(evt),!evt.isDefaultPrevented()},triggerChange:function(details){details=details||{},details=$.extend({},details,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(details),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var enabled=this._enabled&&!this._readonly,disabled=!enabled;return enabled!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",disabled),this.close(),this.enabledInterface=enabled,!0)},enable:function(enabled){enabled===undefined&&(enabled=!0),this._enabled!==enabled&&(this._enabled=enabled,this.opts.element.prop("disabled",!enabled),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(enabled){enabled===undefined&&(enabled=!1),this._readonly!==enabled&&(this._readonly=enabled,this.opts.element.prop("readonly",enabled),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var bodyOffset,above,changeDirection,css,resultsListNode,$dropdown=this.dropdown,container=this.container,offset=container.offset(),height=container.outerHeight(!1),width=container.outerWidth(!1),dropHeight=$dropdown.outerHeight(!1),$window=$(window),windowWidth=$window.width(),windowHeight=$window.height(),viewPortRight=$window.scrollLeft()+windowWidth,viewportBottom=$window.scrollTop()+windowHeight,dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=dropTop+dropHeight<=viewportBottom,enoughRoomAbove=offset.top-dropHeight>=$window.scrollTop(),dropWidth=$dropdown.outerWidth(!1);$dropdown.hasClass("select2-drop-above")?(above=!0,!enoughRoomAbove&&enoughRoomBelow&&(changeDirection=!0,above=!1)):(above=!1,!enoughRoomBelow&&enoughRoomAbove&&(changeDirection=!0,above=!0)),changeDirection&&($dropdown.hide(),offset=this.container.offset(),height=this.container.outerHeight(!1),width=this.container.outerWidth(!1),dropHeight=$dropdown.outerHeight(!1),viewPortRight=$window.scrollLeft()+windowWidth,viewportBottom=$window.scrollTop()+windowHeight,dropTop=offset.top+height,dropLeft=offset.left,dropWidth=$dropdown.outerWidth(!1),$dropdown.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(resultsListNode=$(".select2-results",$dropdown)[0],$dropdown.addClass("select2-drop-auto-width"),$dropdown.css("width",""),(dropWidth=$dropdown.outerWidth(!1)+(resultsListNode.scrollHeight===resultsListNode.clientHeight?0:scrollBarDimensions.width))>width?width=dropWidth:dropWidth=width,dropHeight=$dropdown.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(dropTop-=(bodyOffset=this.body.offset()).top,dropLeft-=bodyOffset.left),!(dropLeft+dropWidth<=viewPortRight)&&offset.left+viewPortRight+container.outerWidth(!1)>dropWidth&&(dropLeft=offset.left+this.container.outerWidth(!1)-dropWidth),css={left:dropLeft,width:width},above?(css.top=offset.top-dropHeight,css.bottom="auto",this.container.addClass("select2-drop-above"),$dropdown.addClass("select2-drop-above")):(css.top=dropTop,css.bottom="auto",this.container.removeClass("select2-drop-above"),$dropdown.removeClass("select2-drop-above")),css=$.extend(css,evaluate(this.opts.dropdownCss,this.opts.element)),$dropdown.css(css)},shouldOpen:function(){var event;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(event=$.Event("select2-opening"),this.opts.element.trigger(event),!event.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),$document.on("mousemove.select2Event",(function(e){lastMousePosition.x=e.pageX,lastMousePosition.y=e.pageY})),!0)},opening:function(){var mask,cid=this.containerEventName,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0===(mask=$("#select2-drop-mask")).length&&((mask=$(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),mask.hide(),mask.appendTo(this.body),mask.on("mousedown touchstart click",(function(e){reinsertElement(mask);var self,dropdown=$("#select2-drop");dropdown.length>0&&((self=dropdown.data("select2")).opts.selectOnBlur&&self.selectHighlighted({noFocus:!0}),self.close(),e.preventDefault(),e.stopPropagation())}))),this.dropdown.prev()[0]!==mask[0]&&this.dropdown.before(mask),$("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),mask.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var that=this;this.container.parents().add(window).each((function(){$(this).on(resize+" "+scroll+" "+orient,(function(e){that.opened()&&that.positionDropdown()}))}))},close:function(){if(this.opened()){var cid=this.containerEventName,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.parents().add(window).each((function(){$(this).off(scroll).off(resize).off(orient)})),this.clearDropdownAlignmentPreference(),$("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),$document.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger($.Event("select2-close"))}},externalSearch:function(term){this.open(),this.search.val(term),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return evaluate(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var children,index,child,hb,rb,y,more,topOffset,results=this.results;(index=this.highlight())<0||(0!=index?(children=this.findHighlightableChoices().find(".select2-result-label"),hb=(topOffset=((child=$(children[index])).offset()||{}).top||0)+child.outerHeight(!0),index===children.length-1&&(more=results.find("li.select2-more-results")).length>0&&(hb=more.offset().top+more.outerHeight(!0)),hb>(rb=results.offset().top+results.outerHeight(!1))&&results.scrollTop(results.scrollTop()+(hb-rb)),(y=topOffset-results.offset().top)<0&&"none"!=child.css("display")&&results.scrollTop(results.scrollTop()+y)):results.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(delta){for(var choices=this.findHighlightableChoices(),index=this.highlight();index>-1&&index<choices.length;){var choice=$(choices[index+=delta]);if(choice.hasClass("select2-result-selectable")&&!choice.hasClass("select2-disabled")&&!choice.hasClass("select2-selected")){this.highlight(index);break}}},highlight:function(index){var choice,data,choices=this.findHighlightableChoices();if(0===arguments.length)return indexOf(choices.filter(".select2-highlighted")[0],choices.get());index>=choices.length&&(index=choices.length-1),index<0&&(index=0),this.removeHighlight(),(choice=$(choices[index])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",choice.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(choice.text()),(data=choice.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(data),choice:data})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(event){var el=$(event.target).closest(".select2-result-selectable");if(el.length>0&&!el.is(".select2-highlighted")){var choices=this.findHighlightableChoices();this.highlight(choices.index(el))}else 0==el.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var results=this.results,more=results.find("li.select2-more-results"),page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;0!==more.length&&more.offset().top-results.offset().top-results.height()<=this.opts.loadMorePadding&&(more.addClass("select2-active"),this.opts.query({element:this.opts.element,term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind((function(data){self.opened()&&(self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context}),self.postprocessResults(data,!1,!1),!0===data.more?(more.detach().appendTo(results).html(self.opts.escapeMarkup(evaluate(self.opts.formatLoadMore,self.opts.element,page+1))),window.setTimeout((function(){self.loadMoreIfNeeded()}),10)):more.remove(),self.positionDropdown(),self.resultsPage=page,self.context=data.context,this.opts.element.trigger({type:"select2-loaded",items:data}))}))}))},tokenize:function(){},updateResults:function(initial){var data,input,queryNumber,search=this.search,results=this.results,opts=this.opts,self=this,term=search.val(),lastTerm=$.data(this.container,"select2-last-term");if((!0===initial||!lastTerm||!equal(term,lastTerm))&&($.data(this.container,"select2-last-term",term),!0===initial||!1!==this.showSearchInput&&this.opened())){queryNumber=++this.queryCount;var maxSelSize=this.getMaximumSelectionSize();if(!(maxSelSize>=1&&(data=this.data(),$.isArray(data)&&data.length>=maxSelSize&&checkFormatter(opts.formatSelectionTooBig,"formatSelectionTooBig"))))return search.val().length<opts.minimumInputLength?(checkFormatter(opts.formatInputTooShort,"formatInputTooShort")?render("<li class='select2-no-results'>"+evaluate(opts.formatInputTooShort,opts.element,search.val(),opts.minimumInputLength)+"</li>"):render(""),void(initial&&this.showSearch&&this.showSearch(!0))):void(opts.maximumInputLength&&search.val().length>opts.maximumInputLength?checkFormatter(opts.formatInputTooLong,"formatInputTooLong")?render("<li class='select2-no-results'>"+evaluate(opts.formatInputTooLong,opts.element,search.val(),opts.maximumInputLength)+"</li>"):render(""):(opts.formatSearching&&0===this.findHighlightableChoices().length&&render("<li class='select2-searching'>"+evaluate(opts.formatSearching,opts.element)+"</li>"),search.addClass("select2-active"),this.removeHighlight(),(input=this.tokenize())!=undefined&&null!=input&&search.val(input),this.resultsPage=1,opts.query({element:opts.element,term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind((function(data){var def;queryNumber==this.queryCount&&(this.opened()?data.hasError!==undefined&&checkFormatter(opts.formatAjaxError,"formatAjaxError")?render("<li class='select2-ajax-error'>"+evaluate(opts.formatAjaxError,opts.element,data.jqXHR,data.textStatus,data.errorThrown)+"</li>"):(this.context=data.context===undefined?null:data.context,this.opts.createSearchChoice&&""!==search.val()&&(def=this.opts.createSearchChoice.call(self,search.val(),data.results))!==undefined&&null!==def&&self.id(def)!==undefined&&null!==self.id(def)&&0===$(data.results).filter((function(){return equal(self.id(this),self.id(def))})).length&&this.opts.createSearchChoicePosition(data.results,def),0===data.results.length&&checkFormatter(opts.formatNoMatches,"formatNoMatches")?render("<li class='select2-no-results'>"+evaluate(opts.formatNoMatches,opts.element,search.val())+"</li>"):(results.empty(),self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null}),!0===data.more&&checkFormatter(opts.formatLoadMore,"formatLoadMore")&&(results.append("<li class='select2-more-results'>"+opts.escapeMarkup(evaluate(opts.formatLoadMore,opts.element,this.resultsPage))+"</li>"),window.setTimeout((function(){self.loadMoreIfNeeded()}),10)),this.postprocessResults(data,initial),postRender(),this.opts.element.trigger({type:"select2-loaded",items:data}))):this.search.removeClass("select2-active"))}))})));render("<li class='select2-selection-limit'>"+evaluate(opts.formatSelectionTooBig,opts.element,maxSelSize)+"</li>")}function postRender(){search.removeClass("select2-active"),self.positionDropdown(),results.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?self.liveRegion.text(results.text()):self.liveRegion.text(self.opts.formatMatches(results.find('.select2-result-selectable:not(".select2-selected")').length))}function render(html){results.html(html),postRender()}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var $el;($el=this.search)[0]!==document.activeElement&&window.setTimeout((function(){var range,el=$el[0],pos=$el.val().length;$el.focus(),(el.offsetWidth>0||el.offsetHeight>0)&&el===document.activeElement&&(el.setSelectionRange?el.setSelectionRange(pos,pos):el.createTextRange&&((range=el.createTextRange()).collapse(!1),range.select()))}),0)},selectHighlighted:function(options){if(this._touchMoved)this.clearTouchMoved();else{var index=this.highlight(),data=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");data?(this.highlight(index),this.onSelect(data,options)):options&&options.noFocus&&this.close()}},getPlaceholder:function(){var placeholderOption;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((placeholderOption=this.getPlaceholderOption())!==undefined?placeholderOption.text():undefined)},getPlaceholderOption:function(){if(this.select){var firstOption=this.select.children("option").first();if(this.opts.placeholderOption!==undefined)return"first"===this.opts.placeholderOption&&firstOption||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===$.trim(firstOption.text())&&""===firstOption.val())return firstOption}},initContainerWidth:function(){var width=function(){var style,attrs,matches,i,l;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if((style=this.opts.element.attr("style"))!==undefined)for(i=0,l=(attrs=style.split(";")).length;i<l;i+=1)if(null!==(matches=attrs[i].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&matches.length>=1)return matches[1];return"resolve"===this.opts.width?(style=this.opts.element.css("width")).indexOf("%")>0?style:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}return $.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==width&&this.container.css("width",width)}}),SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){return $(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var el,range,len;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(el=this.search.get(0)).createTextRange?((range=el.createTextRange()).collapse(!1),range.select()):el.setSelectionRange&&(len=this.search.val().length,el.setSelectionRange(len,len))),""===this.search.val()&&this.nextSearchTerm!=undefined&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger($.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){$("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),cleanupJQueryElements.call(this,"selection","focusser")},initContainer:function(){var selection,elementLabel,container=this.container,dropdown=this.dropdown,idSuffix=nextUid();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=selection=container.find(".select2-choice"),this.focusser=container.find(".select2-focusser"),selection.find(".select2-chosen").attr("id","select2-chosen-"+idSuffix),this.focusser.attr("aria-labelledby","select2-chosen-"+idSuffix),this.results.attr("id","select2-results-"+idSuffix),this.search.attr("aria-owns","select2-results-"+idSuffix),this.focusser.attr("id","s2id_autogen"+idSuffix),elementLabel=$("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.focus(this.bind((function(){this.focus()}))),this.focusser.prev().text(elementLabel.text()).attr("for",this.focusser.attr("id"));var originalTitle=this.opts.element.attr("title");this.opts.element.attr("title",originalTitle||elementLabel.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text($("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind((function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode)if(e.which!==KEY.PAGE_UP&&e.which!==KEY.PAGE_DOWN)switch(e.which){case KEY.UP:case KEY.DOWN:return this.moveHighlight(e.which===KEY.UP?-1:1),void killEvent(e);case KEY.ENTER:return this.selectHighlighted(),void killEvent(e);case KEY.TAB:return void this.selectHighlighted({noFocus:!0});case KEY.ESC:return this.cancel(e),void killEvent(e)}else killEvent(e)}))),this.search.on("blur",this.bind((function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind((function(){this.opened()&&this.search.focus()})),0)}))),this.focusser.on("keydown",this.bind((function(e){if(this.isInterfaceEnabled()&&e.which!==KEY.TAB&&!KEY.isControl(e)&&!KEY.isFunctionKey(e)&&e.which!==KEY.ESC){if(!1!==this.opts.openOnEnter||e.which!==KEY.ENTER){if(e.which==KEY.DOWN||e.which==KEY.UP||e.which==KEY.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void killEvent(e)}return e.which==KEY.DELETE||e.which==KEY.BACKSPACE?(this.opts.allowClear&&this.clear(),void killEvent(e)):void 0}killEvent(e)}}))),installKeyUpChangeEvent(this.focusser),this.focusser.on("keyup-change input",this.bind((function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}}))),selection.on("mousedown touchstart","abbr",this.bind((function(e){this.isInterfaceEnabled()&&(this.clear(),function(event){event.preventDefault(),event.stopImmediatePropagation()}(e),this.close(),this.selection&&this.selection.focus())}))),selection.on("mousedown touchstart",this.bind((function(e){reinsertElement(selection),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),killEvent(e)}))),dropdown.on("mousedown touchstart",this.bind((function(){this.opts.shouldFocusInput(this)&&this.search.focus()}))),selection.on("focus",this.bind((function(e){killEvent(e)}))),this.focusser.on("focus",this.bind((function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")}))).on("blur",this.bind((function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger($.Event("select2-blur")))}))),this.search.on("focus",this.bind((function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")}))),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(triggerChange){var data=this.selection.data("select2-data");if(data){var evt=$.Event("select2-clearing");if(this.opts.element.trigger(evt),evt.isDefaultPrevented())return;var placeholderOption=this.getPlaceholderOption();this.opts.element.val(placeholderOption?placeholderOption.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==triggerChange&&(this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data}),this.triggerChange({removed:data}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var self=this;this.opts.initSelection.call(null,this.opts.element,(function(selected){selected!==undefined&&null!==selected&&(self.updateSelection(selected),self.close(),self.setPlaceholder(),self.nextSearchTerm=self.opts.nextSearchTerm(selected,self.search.val()))}))}},isPlaceholderOptionSelected:function(){var placeholderOption;return this.getPlaceholder()!==undefined&&((placeholderOption=this.getPlaceholderOption())!==undefined&&placeholderOption.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===undefined||null===this.opts.element.val())},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;return"select"===opts.element.get(0).tagName.toLowerCase()?opts.initSelection=function(element,callback){var selected=element.find("option").filter((function(){return this.selected&&!this.disabled}));callback(self.optionToData(selected))}:"data"in opts&&(opts.initSelection=opts.initSelection||function(element,callback){var id=element.val(),match=null;opts.query({matcher:function(term,text,el){var is_match=equal(id,opts.id(el));return is_match&&(match=el),is_match},callback:$.isFunction(callback)?function(){callback(match)}:$.noop})}),opts},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===undefined?undefined:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&placeholder!==undefined){if(this.select&&this.getPlaceholderOption()===undefined)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(placeholder)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(data,initial,noHighlightUpdate){var selected=0,self=this;if(this.findHighlightableChoices().each2((function(i,elm){if(equal(self.id(elm.data("select2-data")),self.opts.element.val()))return selected=i,!1})),!1!==noHighlightUpdate&&(!0===initial&&selected>=0?this.highlight(selected):this.highlight(0)),!0===initial){var min=this.opts.minimumResultsForSearch;min>=0&&this.showSearch(countResults(data.results)>=min)}},showSearch:function(showSearchInput){this.showSearchInput!==showSearchInput&&(this.showSearchInput=showSearchInput,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!showSearchInput),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!showSearchInput),$(this.dropdown,this.container).toggleClass("select2-with-searchbox",showSearchInput))},onSelect:function(data,options){if(this.triggerSelect(data)){var old=this.opts.element.val(),oldData=this.data();this.opts.element.val(this.id(data)),this.updateSelection(data),this.opts.element.trigger({type:"select2-selected",val:this.id(data),choice:data}),this.nextSearchTerm=this.opts.nextSearchTerm(data,this.search.val()),this.close(),options&&options.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),equal(old,this.id(data))||this.triggerChange({added:data,removed:oldData})}},updateSelection:function(data){var formatted,cssClass,container=this.selection.find(".select2-chosen");this.selection.data("select2-data",data),container.empty(),null!==data&&(formatted=this.opts.formatSelection(data,container,this.opts.escapeMarkup)),formatted!==undefined&&container.append(formatted),(cssClass=this.opts.formatSelectionCssClass(data,container))!==undefined&&container.addClass(cssClass),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==undefined&&this.container.addClass("select2-allowclear")},val:function(){var val,triggerChange=!1,data=null,self=this,oldData=this.data();if(0===arguments.length)return this.opts.element.val();if(val=arguments[0],arguments.length>1&&(triggerChange=arguments[1]),this.select)this.select.val(val).find("option").filter((function(){return this.selected})).each2((function(i,elm){return data=self.optionToData(elm),!1})),this.updateSelection(data),this.setPlaceholder(),triggerChange&&this.triggerChange({added:data,removed:oldData});else{if(!val&&0!==val)return void this.clear(triggerChange);if(this.opts.initSelection===undefined)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(val),this.opts.initSelection(this.opts.element,(function(data){self.opts.element.val(data?self.id(data):""),self.updateSelection(data),self.setPlaceholder(),triggerChange&&self.triggerChange({added:data,removed:oldData})}))}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(value){var data,triggerChange=!1;if(0===arguments.length)return(data=this.selection.data("select2-data"))==undefined&&(data=null),data;arguments.length>1&&(triggerChange=arguments[1]),value?(data=this.data(),this.opts.element.val(value?this.id(value):""),this.updateSelection(value),triggerChange&&this.triggerChange({added:value,removed:data})):this.clear(triggerChange)}}),MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){return $(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;return"select"===opts.element.get(0).tagName.toLowerCase()?opts.initSelection=function(element,callback){var data=[];element.find("option").filter((function(){return this.selected&&!this.disabled})).each2((function(i,elm){data.push(self.optionToData(elm))})),callback(data)}:"data"in opts&&(opts.initSelection=opts.initSelection||function(element,callback){var ids=splitVal(element.val(),opts.separator,opts.transformVal),matches=[];opts.query({matcher:function(term,text,el){var is_match=$.grep(ids,(function(id){return equal(id,opts.id(el))})).length;return is_match&&matches.push(el),is_match},callback:$.isFunction(callback)?function(){for(var ordered=[],i=0;i<ids.length;i++)for(var id=ids[i],j=0;j<matches.length;j++){var match=matches[j];if(equal(id,opts.id(match))){ordered.push(match),matches.splice(j,1);break}}callback(ordered)}:$.noop})}),opts},selectChoice:function(choice){var selected=this.container.find(".select2-search-choice-focus");selected.length&&choice&&choice[0]==selected[0]||(selected.length&&this.opts.element.trigger("choice-deselected",selected),selected.removeClass("select2-search-choice-focus"),choice&&choice.length&&(this.close(),choice.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",choice)))},destroy:function(){$("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),cleanupJQueryElements.call(this,"searchContainer","selection")},initContainer:function(){var selection,selector=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=selection=this.container.find(selector);var _this=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",(function(e){_this.search[0].focus(),_this.selectChoice($(this))})),this.search.attr("id","s2id_autogen"+nextUid()),this.search.prev().text($("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.focus(this.bind((function(){this.focus()}))),this.search.on("input paste",this.bind((function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())}))),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind((function(e){if(this.isInterfaceEnabled()){++this.keydowns;var selected=selection.find(".select2-search-choice-focus"),prev=selected.prev(".select2-search-choice:not(.select2-locked)"),next=selected.next(".select2-search-choice:not(.select2-locked)"),pos=function(el){var offset=0,length=0;if("selectionStart"in(el=$(el)[0]))offset=el.selectionStart,length=el.selectionEnd-offset;else if("selection"in document){el.focus();var sel=document.selection.createRange();length=document.selection.createRange().text.length,sel.moveStart("character",-el.value.length),offset=sel.text.length-length}return{offset:offset,length:length}}(this.search);if(selected.length&&(e.which==KEY.LEFT||e.which==KEY.RIGHT||e.which==KEY.BACKSPACE||e.which==KEY.DELETE||e.which==KEY.ENTER)){var selectedChoice=selected;return e.which==KEY.LEFT&&prev.length?selectedChoice=prev:e.which==KEY.RIGHT?selectedChoice=next.length?next:null:e.which===KEY.BACKSPACE?this.unselect(selected.first())&&(this.search.width(10),selectedChoice=prev.length?prev:next):e.which==KEY.DELETE?this.unselect(selected.first())&&(this.search.width(10),selectedChoice=next.length?next:null):e.which==KEY.ENTER&&(selectedChoice=null),this.selectChoice(selectedChoice),killEvent(e),void(selectedChoice&&selectedChoice.length||this.open())}if((e.which===KEY.BACKSPACE&&1==this.keydowns||e.which==KEY.LEFT)&&0==pos.offset&&!pos.length)return this.selectChoice(selection.find(".select2-search-choice:not(.select2-locked)").last()),void killEvent(e);if(this.selectChoice(null),this.opened())switch(e.which){case KEY.UP:case KEY.DOWN:return this.moveHighlight(e.which===KEY.UP?-1:1),void killEvent(e);case KEY.ENTER:return this.selectHighlighted(),void killEvent(e);case KEY.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case KEY.ESC:return this.cancel(e),void killEvent(e)}if(e.which!==KEY.TAB&&!KEY.isControl(e)&&!KEY.isFunctionKey(e)&&e.which!==KEY.BACKSPACE&&e.which!==KEY.ESC){if(e.which===KEY.ENTER){if(!1===this.opts.openOnEnter)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),e.which!==KEY.PAGE_UP&&e.which!==KEY.PAGE_DOWN||killEvent(e),e.which===KEY.ENTER&&killEvent(e)}}}))),this.search.on("keyup",this.bind((function(e){this.keydowns=0,this.resizeSearch()}))),this.search.on("blur",this.bind((function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger($.Event("select2-blur"))}))),this.container.on("click",selector,this.bind((function(e){this.isInterfaceEnabled()&&($(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))}))),this.container.on("focus",selector,this.bind((function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())}))),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var self=this;this.opts.initSelection.call(null,this.opts.element,(function(data){data!==undefined&&null!==data&&(self.updateSelection(data),self.close(),self.clearSearch())}))}},clearSearch:function(){var placeholder=this.getPlaceholder(),maxWidth=this.getMaxSearchWidth();placeholder!==undefined&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(placeholder).addClass("select2-default"),this.search.width(maxWidth>0?maxWidth:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=undefined&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger($.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each((function(){indexOf(self.id(this),ids)<0&&(ids.push(self.id(this)),filtered.push(this))})),data=filtered,this.selection.find(".select2-search-choice").remove(),$(data).each((function(){self.addSelectedChoice(this)})),self.postprocessResults()},tokenize:function(){var input=this.search.val();null!=(input=this.opts.tokenizer.call(this,input,this.data(),this.bind(this.onSelect),this.opts))&&input!=undefined&&(this.search.val(input),input.length>0&&this.open())},onSelect:function(data,options){this.triggerSelect(data)&&""!==data.text&&(this.addSelectedChoice(data),this.opts.element.trigger({type:"selected",val:this.id(data),choice:data}),this.nextSearchTerm=this.opts.nextSearchTerm(data,this.search.val()),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(data,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=undefined&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:data}),options&&options.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(data){var formatted,cssClass,enableChoice=!data.locked,enabledItem=$("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),disabledItem=$("<li class='select2-search-choice select2-locked'><div></div></li>"),choice=enableChoice?enabledItem:disabledItem,id=this.id(data),val=this.getVal();(formatted=this.opts.formatSelection(data,choice.find("div"),this.opts.escapeMarkup))!=undefined&&choice.find("div").replaceWith($("<div></div>").html(formatted)),(cssClass=this.opts.formatSelectionCssClass(data,choice.find("div")))!=undefined&&choice.addClass(cssClass),enableChoice&&choice.find(".select2-search-choice-close").on("mousedown",killEvent).on("click dblclick",this.bind((function(e){this.isInterfaceEnabled()&&(this.unselect($(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),killEvent(e),this.close(),this.focusSearch())}))).on("focus",this.bind((function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))}))),choice.data("select2-data",data),choice.insertBefore(this.searchContainer),val.push(id),this.setVal(val)},unselect:function(selected){var data,index,val=this.getVal();if(0===(selected=selected.closest(".select2-search-choice")).length)throw"Invalid argument: "+selected+". Must be .select2-search-choice";if(data=selected.data("select2-data")){var evt=$.Event("select2-removing");if(evt.val=this.id(data),evt.choice=data,this.opts.element.trigger(evt),evt.isDefaultPrevented())return!1;for(;(index=indexOf(this.id(data),val))>=0;)val.splice(index,1),this.setVal(val),this.select&&this.postprocessResults();return selected.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data}),this.triggerChange({removed:data}),!0}},postprocessResults:function(data,initial,noHighlightUpdate){var val=this.getVal(),choices=this.results.find(".select2-result"),compound=this.results.find(".select2-result-with-children"),self=this;choices.each2((function(i,choice){indexOf(self.id(choice.data("select2-data")),val)>=0&&(choice.addClass("select2-selected"),choice.find(".select2-result-selectable").addClass("select2-selected"))})),compound.each2((function(i,choice){choice.is(".select2-result-selectable")||0!==choice.find(".select2-result-selectable:not(.select2-selected)").length||choice.addClass("select2-selected")})),-1==this.highlight()&&!1!==noHighlightUpdate&&!0===this.opts.closeOnSelect&&self.highlight(0),!this.opts.createSearchChoice&&!choices.filter(".select2-result:not(.select2-selected)").length>0&&(!data||data&&!data.more&&0===this.results.find(".select2-no-results").length)&&checkFormatter(self.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+evaluate(self.opts.formatNoMatches,self.opts.element,self.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-getSideBorderPadding(this.search)},resizeSearch:function(){var minimumWidth,left,maxWidth,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=function(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);(sizer=$(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),$(document.body).append(sizer)}return sizer.text(e.val()),sizer.width()}(this.search)+10,left=this.search.offset().left,(searchWidth=(maxWidth=this.selection.width())-(left-this.selection.offset().left)-sideBorderPadding)<minimumWidth&&(searchWidth=maxWidth-sideBorderPadding),searchWidth<40&&(searchWidth=maxWidth-sideBorderPadding),searchWidth<=0&&(searchWidth=minimumWidth),this.search.width(Math.floor(searchWidth))},getVal:function(){var val;return this.select?null===(val=this.select.val())?[]:val:splitVal(val=this.opts.element.val(),this.opts.separator,this.opts.transformVal)},setVal:function(val){var unique;this.select?this.select.val(val):(unique=[],$(val).each((function(){indexOf(this,unique)<0&&unique.push(this)})),this.opts.element.val(0===unique.length?"":unique.join(this.opts.separator)))},buildChangeDetails:function(old,current){current=current.slice(0),old=old.slice(0);for(var i=0;i<current.length;i++)for(var j=0;j<old.length;j++)equal(this.opts.id(current[i]),this.opts.id(old[j]))&&(current.splice(i,1),i>0&&i--,old.splice(j,1),j--);return{added:current,removed:old}},val:function(val,triggerChange){var oldData,self=this;if(0===arguments.length)return this.getVal();if((oldData=this.data()).length||(oldData=[]),!val&&0!==val)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(triggerChange&&this.triggerChange({added:this.data(),removed:oldData}));if(this.setVal(val),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),triggerChange&&this.triggerChange(this.buildChangeDetails(oldData,this.data()));else{if(this.opts.initSelection===undefined)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,(function(data){var ids=$.map(data,self.id);self.setVal(ids),self.updateSelection(data),self.clearSearch(),triggerChange&&self.triggerChange(self.buildChangeDetails(oldData,self.data()))}))}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var val=[],self=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each((function(){val.push(self.opts.id($(this).data("select2-data")))})),this.setVal(val),this.triggerChange()},data:function(values,triggerChange){var ids,old,self=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map((function(){return $(this).data("select2-data")})).get();old=this.data(),values||(values=[]),ids=$.map(values,(function(e){return self.opts.id(e)})),this.setVal(ids),this.updateSelection(values),this.clearSearch(),triggerChange&&this.triggerChange(this.buildChangeDetails(old,this.data()))}}),$.fn.select2=function(){var opts,select2,method,value,multiple,args=Array.prototype.slice.call(arguments,0),allowedMethods=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],valueMethods=["opened","isFocused","container","dropdown"],propertyMethods=["val","data"],methodsMap={search:"externalSearch"};return this.each((function(){if(0===args.length||"object"==typeof args[0])(opts=0===args.length?{}:$.extend({},args[0])).element=$(this),"select"===opts.element.get(0).tagName.toLowerCase()?multiple=opts.element.prop("multiple"):(multiple=opts.multiple||!1,"tags"in opts&&(opts.multiple=multiple=!0)),(select2=multiple?new window.Select2.class.multi:new window.Select2.class.single).init(opts);else{if("string"!=typeof args[0])throw"Invalid arguments to select2 plugin: "+args;if(indexOf(args[0],allowedMethods)<0)throw"Unknown method: "+args[0];if(value=undefined,(select2=$(this).data("select2"))===undefined)return;if("container"===(method=args[0])?value=select2.container:"dropdown"===method?value=select2.dropdown:(methodsMap[method]&&(method=methodsMap[method]),value=select2[method].apply(select2,args.slice(1))),indexOf(args[0],valueMethods)>=0||indexOf(args[0],propertyMethods)>=0&&1==args.length)return!1}})),value===undefined?this:value},$.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(result,container,query,escapeMarkup){var markup=[];return markMatch(this.text(result),query.term,markup,escapeMarkup),markup.join("")},transformVal:function(val){return $.trim(val)},formatSelection:function(data,container,escapeMarkup){return data?escapeMarkup(this.text(data)):undefined},sortResults:function(results,container,query){return results},formatResultCssClass:function(data){return data.css},formatSelectionCssClass:function(data,container){return undefined},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==undefined?null:e.id},text:function(e){return e&&this.data&&this.data.text?$.isFunction(this.data.text)?this.data.text(e):e[this.data.text]:e.text},matcher:function(term,text){return stripDiacritics(""+text).toUpperCase().indexOf(stripDiacritics(""+term).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:function(input,selection,selectCallback,opts){var token,index,i,l,separator,original=input,dupe=!1;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;for(;;){for(index=-1,i=0,l=opts.tokenSeparators.length;i<l&&(separator=opts.tokenSeparators[i],!((index=input.indexOf(separator))>=0));i++);if(index<0)break;if(token=input.substring(0,index),input=input.substring(index+separator.length),token.length>0&&(token=opts.createSearchChoice.call(this,token,selection))!==undefined&&null!==token&&opts.id(token)!==undefined&&null!==opts.id(token)){for(dupe=!1,i=0,l=selection.length;i<l;i++)if(equal(opts.id(token),opts.id(selection[i]))){dupe=!0;break}dupe||selectCallback(token)}}return original!==input?input:void 0},escapeMarkup:defaultEscapeMarkup,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(c){return c},adaptDropdownCssClass:function(c){return null},nextSearchTerm:function(selectedObject,currentSearchTerm){return undefined},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(instance){return!("ontouchstart"in window||navigator.msMaxTouchPoints>0)||!(instance.opts.minimumResultsForSearch<0)}},$.fn.select2.locales=[],$.fn.select2.locales.en={formatMatches:function(matches){return 1===matches?"One result is available, press enter to select it.":matches+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(jqXHR,textStatus,errorThrown){return"Loading failed"},formatInputTooShort:function(input,min){var n=min-input.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(input,max){var n=input.length-max;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(limit){return"You can only select "+limit+" item"+(1==limit?"":"s")},formatLoadMore:function(pageNumber){return"Loading more resultsâ¦"},formatSearching:function(){return"Searchingâ¦"}},$.extend($.fn.select2.defaults,$.fn.select2.locales.en),$.fn.select2.ajaxDefaults={transport:$.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch,escapeMarkup:defaultEscapeMarkup,stripDiacritics:stripDiacritics},class:{abstract:AbstractSelect2,single:SingleSelect2,multi:MultiSelect2}}}function reinsertElement(element){var placeholder=$(document.createTextNode(""));element.before(placeholder),placeholder.before(element),placeholder.remove()}function stripDiacritics(str){return str.replace(/[^\u0000-\u007E]/g,(function(a){return DIACRITICS[a]||a}))}function indexOf(value,array){for(var i=0,l=array.length;i<l;i+=1)if(equal(value,array[i]))return i;return-1}function equal(a,b){return a===b||a!==undefined&&b!==undefined&&(null!==a&&null!==b&&(a.constructor===String?a+""==b+"":b.constructor===String&&b+""==a+""))}function splitVal(string,separator,transform){var val,i,l;if(null===string||string.length<1)return[];for(i=0,l=(val=string.split(separator)).length;i<l;i+=1)val[i]=transform(val[i]);return val}function getSideBorderPadding(element){return element.outerWidth(!1)-element.width()}function installKeyUpChangeEvent(element){var key="keyup-change-value";element.on("keydown",(function(){$.data(element,key)===undefined&&$.data(element,key,element.val())})),element.on("keyup",(function(){var val=$.data(element,key);val!==undefined&&element.val()!==val&&($.removeData(element,key),element.trigger("keyup-change"))}))}function debounce(quietMillis,fn,ctx){var timeout;return ctx=ctx||undefined,function(){var args=arguments;window.clearTimeout(timeout),timeout=window.setTimeout((function(){fn.apply(ctx,args)}),quietMillis)}}function killEvent(event){event.preventDefault(),event.stopPropagation()}function syncCssClasses(dest,src,adapter){var classes,adapted,replacements=[];(classes=$.trim(dest.attr("class")))&&$((classes=""+classes).split(/\s+/)).each2((function(){0===this.indexOf("select2-")&&replacements.push(this)})),(classes=$.trim(src.attr("class")))&&$((classes=""+classes).split(/\s+/)).each2((function(){0!==this.indexOf("select2-")&&(adapted=adapter(this))&&replacements.push(adapted)})),dest.attr("class",replacements.join(" "))}function markMatch(text,term,markup,escapeMarkup){var match=stripDiacritics(text.toUpperCase()).indexOf(stripDiacritics(term.toUpperCase())),tl=term.length;match<0?markup.push(escapeMarkup(text)):(markup.push(escapeMarkup(text.substring(0,match))),markup.push("<span class='select2-match'>"),markup.push(escapeMarkup(text.substring(match,match+tl))),markup.push("</span>"),markup.push(escapeMarkup(text.substring(match+tl,text.length))))}function defaultEscapeMarkup(markup){var replace_map={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(markup).replace(/[&<>"'\/\\]/g,(function(match){return replace_map[match]}))}function ajax(options){var timeout,handler=null,quietMillis=options.quietMillis||100,ajaxUrl=options.url,self=this;return function(query){window.clearTimeout(timeout),timeout=window.setTimeout((function(){var data=options.data,url=ajaxUrl,transport=options.transport||$.fn.select2.ajaxDefaults.transport,deprecated={type:options.type||"GET",cache:options.cache||!1,jsonpCallback:options.jsonpCallback||undefined,dataType:options.dataType||"json"},params=$.extend({},$.fn.select2.ajaxDefaults.params,deprecated);data=data?data.call(self,query.term,query.page,query.context):null,url="function"==typeof url?url.call(self,query.term,query.page,query.context):url,handler&&"function"==typeof handler.abort&&handler.abort(),options.params&&($.isFunction(options.params)?$.extend(params,options.params.call(self)):$.extend(params,options.params)),$.extend(params,{url:url,dataType:options.dataType,data:data,success:function(data){var results=options.results(data,query.page,query);query.callback(results)},error:function(jqXHR,textStatus,errorThrown){var results={hasError:!0,jqXHR:jqXHR,textStatus:textStatus,errorThrown:errorThrown};query.callback(results)}}),handler=transport.call(self,params)}),quietMillis)}}function local(options){var dataText,tmp,data=options,text=function(item){return""+item.text};$.isArray(data)&&(data={results:tmp=data}),!1===$.isFunction(data)&&(tmp=data,data=function(){return tmp});var dataItem=data();return dataItem.text&&(text=dataItem.text,$.isFunction(text)||(dataText=dataItem.text,text=function(item){return item[dataText]})),function(query){var process,t=query.term,filtered={results:[]};""!==t?(process=function(datum,collection){var group,attr;if((datum=datum[0]).children){for(attr in group={},datum)datum.hasOwnProperty(attr)&&(group[attr]=datum[attr]);group.children=[],$(datum.children).each2((function(i,childDatum){process(childDatum,group.children)})),(group.children.length||query.matcher(t,text(group),datum))&&collection.push(group)}else query.matcher(t,text(datum),datum)&&collection.push(datum)},$(data().results).each2((function(i,datum){process(datum,filtered.results)})),query.callback(filtered)):query.callback(data())}}function tags(data){var isFunc=$.isFunction(data);return function(query){var t=query.term,filtered={results:[]},result=isFunc?data(query):data;$.isArray(result)&&($(result).each((function(){var isObject=this.text!==undefined,text=isObject?this.text:this;(""===t||query.matcher(t,text))&&filtered.results.push(isObject?this:{id:this,text:this})})),query.callback(filtered))}}function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return!0;if(!formatter)return!1;if("string"==typeof formatter)return!0;throw new Error(formatterName+" must be a string, function, or falsy value")}function evaluate(val,context){if($.isFunction(val)){var args=Array.prototype.slice.call(arguments,2);return val.apply(context,args)}return val}function countResults(results){var count=0;return $.each(results,(function(i,item){item.children?count+=countResults(item.children):count++})),count}function cleanupJQueryElements(){var self=this;$.each(arguments,(function(i,element){self[element].remove(),self[element]=null}))}function clazz(SuperClass,methods){var constructor=function(){};return(constructor.prototype=new SuperClass).constructor=constructor,constructor.prototype.parent=SuperClass.prototype,constructor.prototype=$.extend(constructor.prototype,methods),constructor}}(jQuery),define("libs/select2",(function(){})),define("locales/select2_locale",["libs/sprintf","pgui.localizer","libs/select2"],(function(s,localizer){var sprintf=s.sprintf;$.fn.select2.locales.php_gen={formatMatches:function(matches){return 1===matches?localizer.getString("Select2MatchesOne"):sprintf(localizer.getString("Select2MatchesMoreOne"),matches)},formatNoMatches:function(){return localizer.getString("Select2NoMatches")},formatAjaxError:function(jqXHR,textStatus,errorThrown){return localizer.getString(localizer.getString("Select2AjaxError"))},formatInputTooShort:function(input,min){var n=min-input.length;return sprintf(localizer.getString("Select2InputTooShort"),n)},formatInputTooLong:function(input,max){var n=input.length-max;return sprintf(localizer.getString("Select2InputTooLong"),n)},formatSelectionTooBig:function(limit){return sprintf(localizer.getString("Select2SelectionTooBig"),limit)},formatLoadMore:function(pageNumber){return localizer.getString("Select2LoadMore")},formatSearching:function(){return localizer.getString("Select2Searching")}},$.extend($.fn.select2.defaults,$.fn.select2.locales.php_gen)})),define("pgui.editors/dynamic_combobox",["pgui.editors/custom","pgui.editors/select2_format","locales/select2_locale","libs/select2"],(function(CustomEditor,FormatFunctions){return CustomEditor.extend({init:function(rootElement,readyCallback){this.queryFunction=function(term){return{term:term}},this._super(rootElement,readyCallback),this.formatFunctions=new FormatFunctions,this.formatFunctions.setFormatCallbacksFromElement($(rootElement)),this.processElement(rootElement),this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey){this.setValue(primaryKey)}.bind(this))},processElement:function(){var self=this,$el=$(this.rootElement);$el.on("change",(function(e,ignoreInternal){if("function"==typeof $el.valid){var $form=$(this.form);$form.length&&_.keys($form.data("validator").submitted).length&&$el.valid()}ignoreInternal||self.doChanged()})),$("label[for="+$el.attr("id")+"]").on("click",(function(){$el.select2("focus")})),$el.select2({ajax:{url:$el.attr("data-url"),dataType:"json",results:function(data){return{results:$.map(data,(function(item){return{id:item.id,text:item.value,formatted_value:item.formatted_value,fields:item.fields}}))}},data:function(term){return self.queryFunction(term)}},initSelection:function(element,callback){var id=element.val();$.ajax({url:$el.data("url"),data:{id:id},dataType:"json"}).done((function(data){$.each(data,(function(k,item){if(item.id==id)return callback({id:item.id,text:item.value,formatted_value:item.formatted_value,fields:item.fields}),self.rootElement.trigger("select2-init"),!1}))}))},width:"100%",minimumInputLength:$el.data("minimal-input-length"),allowClear:$el.data("allowclear"),formatSelection:self.formatFunctions.getFormatClojure("selection"),formatResult:self.formatFunctions.getFormatClojure("result")})},setValue:function(id){return this.rootElement.val(id),this.rootElement.select2&&(this.rootElement.select2("val",this.rootElement.val()),this.rootElement.trigger("change")),this},getValue:function(){return this.rootElement.select2("val")},getDisplayValue:function(){var data=this.getData();return data&&data.text?data.text:this.getValue()},getData:function(){return this.rootElement.select2("data")},setData:function(data){return this.rootElement.select2("data",data),this},setEnabled:function(value){return this.rootElement.prop("disabled",!value),this.rootElement.select2("enable",!!value),this},getEnabled:function(){return!this.rootElement.prop("disabled")},getReadonly:function(){return!!this.rootElement.prop("readonly")},setReadonly:function(value){return this.rootElement.select2("readonly",!!value),this.rootElement.prop("readonly",!!value),this},setFormatSelection:function(callback){return this.formatFunctions.setCallback("selection",callback),$(this.rootElement).trigger("change",!0),this},setFormatResult:function(callback){return this.formatFunctions.setCallback("result",callback),$(this.rootElement).trigger("change",!0),this},setQueryFunction:function(fn){return this.queryFunction=fn,this}})})),define("pgui.editors/plain",["underscore","pgui.editors/custom"],(function(_,CustomEditor){return CustomEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback),this.rootElement.change(_.bind((function(){this.doChanged()}),this))},_getAttribute:function(attrName){return this.rootElement.attr(attrName)},_setAttribute:function(attrName,value){this.rootElement.attr(attrName,value)},getValue:function(){return this.rootElement.val()},setValue:function(value){return this.rootElement.val(value),this},getEnabled:function(){return!this.rootElement.prop("disabled")},setEnabled:function(value){return this.rootElement.prop("disabled",!value),this},getReadonly:function(){return Boolean(this.rootElement.attr("readonly"))},setReadonly:function(value){return this.rootElement.prop("readonly",value),this},doChanged:function(){this.trigger("onChangeEvent",this,0)},onChange:function(callback){return this.bind("onChangeEvent",callback),this}})})),
/*
 * jQuery.bind-first library v0.2.3
 * Copyright (c) 2013 Vladimir Zhuravlev
 *
 * Released under MIT License
 * @license
 *
 * Date: Thu Feb  6 10:13:59 ICT 2014
 **/
function($){var splitVersion=$.fn.jquery.split("."),major=parseInt(splitVersion[0]),minor=parseInt(splitVersion[1]),JQ_LT_17=major<1||1==major&&minor<7;function moveHandlerToTop($el,eventName,isDelegated){var data=function($el){return JQ_LT_17?$el.data("events"):$._data($el[0]).events}($el),events=data[eventName];if(JQ_LT_17)isDelegated?data.live.unshift(data.live.pop()):events.unshift(events.pop());else{var handler=isDelegated?events.splice(events.delegateCount-1,1)[0]:events.pop();events.splice(isDelegated?0:events.delegateCount||0,0,handler)}}function moveEventHandlers($elems,eventsString,isDelegate){var events=eventsString.split(/\s+/);$elems.each((function(){for(var i=0;i<events.length;++i){var pureEventName=$.trim(events[i]).match(/[^\.]+/i)[0];moveHandlerToTop($(this),pureEventName,isDelegate)}}))}function makeMethod(methodName){$.fn[methodName+"First"]=function(){var eventsString=$.makeArray(arguments).shift();return eventsString&&($.fn[methodName].apply(this,arguments),moveEventHandlers(this,eventsString)),this}}makeMethod("bind"),makeMethod("one"),$.fn.delegateFirst=function(){var args=$.makeArray(arguments),eventsString=args[1];return eventsString&&(args.splice(0,2),$.fn.delegate.apply(this,arguments),moveEventHandlers(this,eventsString,!0)),this},$.fn.liveFirst=function(){var args=$.makeArray(arguments);return args.unshift(this.selector),$.fn.delegateFirst.apply($(document),args),this},JQ_LT_17||($.fn.onFirst=function(types,selector){var $el=$(this),isDelegated="string"==typeof selector;if($.fn.on.apply($el,arguments),"object"==typeof types)for(type in types)types.hasOwnProperty(type)&&moveEventHandlers($el,type,isDelegated);else"string"==typeof types&&moveEventHandlers($el,types,isDelegated);return $el})}(jQuery),define("jquery.bind-first",(function(){})),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function($){"use strict";var Toggle=function(element,options){this.$element=$(element),this.options=$.extend({},this.defaults(),options),this.render()};Toggle.VERSION="2.2.0",Toggle.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"small",style:"",width:null,height:null},Toggle.prototype.defaults=function(){return{on:this.$element.attr("data-on")||Toggle.DEFAULTS.on,off:this.$element.attr("data-off")||Toggle.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||Toggle.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||Toggle.DEFAULTS.offstyle,size:this.$element.attr("data-size")||Toggle.DEFAULTS.size,style:this.$element.attr("data-style")||Toggle.DEFAULTS.style,width:this.$element.attr("data-width")||Toggle.DEFAULTS.width,height:this.$element.attr("data-height")||Toggle.DEFAULTS.height}},Toggle.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var size="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",$toggleOn=$('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+size),$toggleOnCalcSize=$toggleOn.clone(),$toggleOff=$('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+size+" active"),$toggleOffCalcSize=$toggleOff.clone(),$toggleHandle=$('<span class="toggle-handle btn btn-default">').addClass(size),$toggleHandleCalcSize=$toggleHandle.clone(),$toggleGroup=$('<div class="toggle-group">').append($toggleOn,$toggleOff,$toggleHandle),$toggle=$('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(size).addClass(this.options.style);this.$element.wrap($toggle),$.extend(this,{$toggle:this.$element.parent(),$toggleOn:$toggleOn,$toggleOff:$toggleOff,$toggleGroup:$toggleGroup}),this.$toggle.append($toggleGroup),$toggleOnCalcSize.hide().appendTo(document.body),$toggleOffCalcSize.hide().appendTo(document.body),$toggleHandleCalcSize.hide().appendTo(document.body);var width=this.options.width||Math.max($toggleOnCalcSize.outerWidth(),$toggleOffCalcSize.outerWidth())+$toggleHandleCalcSize.outerWidth()/2,height=this.options.height||Math.max($toggleOnCalcSize.outerHeight(),$toggleOffCalcSize.outerHeight());$toggleOnCalcSize.remove(),$toggleOffCalcSize.remove(),$toggleHandleCalcSize.remove(),$toggleOn.addClass("toggle-on"),$toggleOff.addClass("toggle-off"),this.$toggle.css({width:width,height:height}),this.options.height&&($toggleOn.css("line-height",$toggleOn.height()+"px"),$toggleOff.css("line-height",$toggleOff.height()+"px")),this.update(!0),this.trigger(!0)},Toggle.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},Toggle.prototype.on=function(silent){if(this.$element.prop("disabled")||this.$element.prop("readonly"))return!1;this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),silent||this.trigger()},Toggle.prototype.off=function(silent){if(this.$element.prop("disabled")||this.$element.prop("readonly"))return!1;this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),silent||this.trigger()},Toggle.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},Toggle.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},Toggle.prototype.update=function(silent){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(silent):this.off(silent)},Toggle.prototype.trigger=function(silent){this.$element.off("change.bs.toggle"),silent||this.$element.change(),this.$element.on("change.bs.toggle",$.proxy((function(){this.update()}),this))},Toggle.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var old=$.fn.bootstrapToggle;$.fn.bootstrapToggle=function(option){return this.each((function(){var $this=$(this),data=$this.data("bs.toggle"),options="object"==typeof option&&option;data||$this.data("bs.toggle",data=new Toggle(this,options)),"string"==typeof option&&data[option]&&data[option]()}))},$.fn.bootstrapToggle.Constructor=Toggle,$.fn.toggle.noConflict=function(){return $.fn.bootstrapToggle=old,this},$((function(){$("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()})),$(document).on("click.bs.toggle","div[data-toggle^=toggle]",(function(e){$(this).find("input[type=checkbox]").bootstrapToggle("toggle"),e.preventDefault()}))}(jQuery),define("bootstrap.toggle",["jquery"],(function(){})),define("pgui.editors/checkbox",["pgui.editors/plain","jquery.bind-first","bootstrap.toggle"],(function(PlainEditor){return PlainEditor.extend({init:function(rootElement,readyCallback){if(this._super(rootElement,readyCallback),"toggle"===rootElement.attr("data-editor")){var toggleOptions={on:rootElement.data("toggle-on-caption"),off:rootElement.data("toggle-off-caption"),size:rootElement.data("toggle-size"),onstyle:rootElement.data("toggle-on-style"),offstyle:rootElement.data("toggle-off-style")};rootElement.data("toggle-width")&&(toggleOptions.width=rootElement.data("toggle-width")),rootElement.data("toggle-height")&&(toggleOptions.height=rootElement.data("toggle-height")),rootElement.bootstrapToggle(toggleOptions)}},getValue:function(){return this.rootElement.is(":checked")},setValue:function(value){return this.rootElement.prop("checked",!!value),this},setReadonly:function(value){this._super(value);var $editor=this.rootElement;return value?($editor.onFirst("click.AUX",(function(){return event.preventDefault(),event.stopImmediatePropagation(),!1})),$editor.onFirst("change.AUX",(function(event){return event.preventDefault(),event.stopImmediatePropagation(),!1}))):($editor.off("click.AUX"),$editor.off("change.AUX")),this}})})),define("pgui.editors/checkboxgroup",["pgui.editors/plain","underscore","pgui.editors/checkbox"],(function(PlainEditor,_,CheckBox){var inputTemplateString='<input type="checkbox" name="<%=editorName%>[]" value="<%=value%>"><%=caption%>',stackedItemTemplate=_.template('<div class="checkbox js-value"><label>'+inputTemplateString+"</label></div>"),inlineItemTemplate=_.template('<label class="checkbox-inline js-value">'+inputTemplateString+"</label>");return PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback),this.rootElement.find("input").change(_.bind((function(){this.doChanged()}),this)),this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey,record){this.addItem(record[$insertButton.data("stored-field-name")],record[$insertButton.data("display-field-name")],!0)}.bind(this))},getValue:function(){return _.toArray(this.rootElement.find("input:checked").map((function(index,item){return $(item).attr("value")})))},getDisplayValue:function(){return _.toArray(this.rootElement.find("input:checked").map((function(index,item){return $(item).closest("label").text()})))},setValue:function(value){if(value.split){var index,checkedValues=value.split(",");this.rootElement.find("input").each((function(i,item){var isChecked=!1;for(index=0;index<checkedValues.length;++index)if($(item).attr("value")==checkedValues[index]){$(item).prop("checked",!0),isChecked=!0;break}isChecked||$(item).prop("checked",!1)}))}},getEnabled:function(){return this.rootElement.find("input:enabled").length>0},setEnabled:function(value){this.rootElement.find("input").each((function(i,item){new CheckBox($(item)).setEnabled(value)}))},getReadonly:function(){return 1===this.rootElement.find("input:enabled").length},setReadonly:function(value){this.rootElement.find("input").each((function(i,item){new CheckBox($(item)).setReadonly(value)}))},clear:function(){this.rootElement.find(".checkbox, .checkbox-inline").remove()},addItem:function(value,caption,checked){var $editor=this.rootElement,isInline=$editor.data("inline"),data={editorName:$editor.attr("data-editor-name"),value:value,caption:caption},$newItem=$(isInline?inlineItemTemplate(data):stackedItemTemplate(data));return"boolean"==typeof checked&&checked&&$newItem.find("input").prop("checked",!0),this.getItemCount()>0?$editor.find(".js-value").last().after($newItem):$editor.prepend($newItem),this},removeItem:function(value){this.rootElement.find("input[value='"+value+"']").parent().remove()},getItems:function(){return this.rootElement.find("input").map((function(i,item){return{value:$(item).attr("value"),caption:$(item).closest("label").text()}}))},getItemCount:function(){return this.rootElement.find("input").length},isMultivalue:function(){return!0},_getSetRequiredTarget:function(){return this.rootElement.find("input[type=checkbox]")}})})),define("pgui.editors/combobox",["pgui.editors/plain"],(function(PlainEditor){return PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback),this.setReadonly(this.getReadonly()),this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey,record){this.addItem(primaryKey,record[$insertButton.data("display-field-name")]),this.setValue(primaryKey)}.bind(this))},clear:function(){return this.rootElement.find("option:enabled[value!='']").remove(),this},addItem:function(value,caption){return this.rootElement.append($("<option></option>").attr("value",value).html(caption)),this},removeItem:function(value){return this.rootElement.find("option[value='"+value+"']").remove(),this},getItems:function(){return this.rootElement.find("option:enabled[value!='']").map((function(i,item){return{value:$(item).attr("value"),caption:$(item).text()}}))},getItemCount:function(){return this.rootElement.find("option[value!='']").length},setValue:function(value){this.setReadonly(!1),this._super(value),this.setReadonly(this.getReadonly())},getReadonly:function(){return Boolean(this.rootElement.attr("readonly"))||this.rootElement.prop("readonly")},setReadonly:function(isReadonly){this._super(isReadonly),isReadonly?(this.rootElement.attr("readonly","readonly"),this.rootElement.closest(".input-group").find(".js-nested-insert").first().attr("disabled","disabled")):(this.rootElement.removeAttr("readonly"),this.rootElement.closest(".input-group").find(".js-nested-insert").first().removeAttr("disabled"));var value=this.getValue();return this.rootElement.find("option").each((function(i,item){var $item=$(item);$item.prop("disabled",isReadonly&&$item.attr("value")!=value)})),this},getCaption:function(){return this.rootElement.find("option:selected").text()},getDisplayValue:function(){return this.rootElement.find("option:selected").first().text()}})})),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("moment",factory):global.moment=factory()}(this,(function(){"use strict";var hookCallback,some;function hooks(){return hookCallback.apply(null,arguments)}function isArray(input){return input instanceof Array||"[object Array]"===Object.prototype.toString.call(input)}function isObject(input){return null!=input&&"[object Object]"===Object.prototype.toString.call(input)}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function isObjectEmpty(obj){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(obj).length;var k;for(k in obj)if(hasOwnProp(obj,k))return!1;return!0}function isUndefined(input){return void 0===input}function isNumber(input){return"number"==typeof input||"[object Number]"===Object.prototype.toString.call(input)}function isDate(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(arr,fn){var i,res=[],arrLen=arr.length;for(i=0;i<arrLen;++i)res.push(fn(arr[i],i));return res}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!0).utc()}function getParsingFlags(m){return null==m._pf&&(m._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),m._pf}function isValid(m){if(null==m._isValid){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,(function(i){return null!=i})),isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict&&(isNowValid=isNowValid&&0===flags.charsLeftOver&&0===flags.unusedTokens.length&&void 0===flags.bigHour),null!=Object.isFrozen&&Object.isFrozen(m))return isNowValid;m._isValid=isNowValid}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);return null!=flags?extend(getParsingFlags(m),flags):getParsingFlags(m).userInvalidated=!0,m}some=Array.prototype.some?Array.prototype.some:function(fun){var i,t=Object(this),len=t.length>>>0;for(i=0;i<len;i++)if(i in t&&fun.call(this,t[i],i,t))return!0;return!1};var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(to,from){var i,prop,val,momentPropertiesLen=momentProperties.length;if(isUndefined(from._isAMomentObject)||(to._isAMomentObject=from._isAMomentObject),isUndefined(from._i)||(to._i=from._i),isUndefined(from._f)||(to._f=from._f),isUndefined(from._l)||(to._l=from._l),isUndefined(from._strict)||(to._strict=from._strict),isUndefined(from._tzm)||(to._tzm=from._tzm),isUndefined(from._isUTC)||(to._isUTC=from._isUTC),isUndefined(from._offset)||(to._offset=from._offset),isUndefined(from._pf)||(to._pf=getParsingFlags(from)),isUndefined(from._locale)||(to._locale=from._locale),momentPropertiesLen>0)for(i=0;i<momentPropertiesLen;i++)isUndefined(val=from[prop=momentProperties[i]])||(to[prop]=val);return to}function Moment(config){copyConfig(this,config),this._d=new Date(null!=config._d?config._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===updateInProgress&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(obj){return obj instanceof Moment||null!=obj&&null!=obj._isAMomentObject}function warn(msg){!1===hooks.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend((function(){if(null!=hooks.deprecationHandler&&hooks.deprecationHandler(null,msg),firstTime){var arg,i,key,args=[],argLen=arguments.length;for(i=0;i<argLen;i++){if(arg="","object"==typeof arguments[i]){for(key in arg+="\n["+i+"] ",arguments[0])hasOwnProp(arguments[0],key)&&(arg+=key+": "+arguments[0][key]+", ");arg=arg.slice(0,-2)}else arg=arguments[i];args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack),firstTime=!1}return fn.apply(this,arguments)}),fn)}var keys,deprecations={};function deprecateSimple(name,msg){null!=hooks.deprecationHandler&&hooks.deprecationHandler(name,msg),deprecations[name]||(warn(msg),deprecations[name]=!0)}function isFunction(input){return"undefined"!=typeof Function&&input instanceof Function||"[object Function]"===Object.prototype.toString.call(input)}function mergeConfigs(parentConfig,childConfig){var prop,res=extend({},parentConfig);for(prop in childConfig)hasOwnProp(childConfig,prop)&&(isObject(parentConfig[prop])&&isObject(childConfig[prop])?(res[prop]={},extend(res[prop],parentConfig[prop]),extend(res[prop],childConfig[prop])):null!=childConfig[prop]?res[prop]=childConfig[prop]:delete res[prop]);for(prop in parentConfig)hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])&&(res[prop]=extend({},res[prop]));return res}function Locale(config){null!=config&&this.set(config)}hooks.suppressDeprecationWarnings=!1,hooks.deprecationHandler=null,keys=Object.keys?Object.keys:function(obj){var i,res=[];for(i in obj)hasOwnProp(obj,i)&&res.push(i);return res};function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length;return(number>=0?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;"string"==typeof callback&&(func=function(){return this[callback]()}),token&&(formatTokenFunctions[token]=func),padded&&(formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}),ordinal&&(formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)})}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]=formatFunctions[format]||function(format){var i,length,input,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=(input=array[i]).match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"");return function(mom){var i,output="";for(i=0;i<length;i++)output+=isFunction(array[i])?array[i].call(mom,format):array[i];return output}}(format),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return"string"==typeof units?aliases[units]||aliases[units.toLowerCase()]:void 0}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop))&&(normalizedInput[normalizedProp]=inputObject[prop]);return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0}function absFloor(number){return number<0?Math.ceil(number)||0:Math.floor(number)}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=absFloor(coercedNumber)),value}function makeGetSet(unit,keepTime){return function(value){return null!=value?(set$1(this,unit,value),hooks.updateOffset(this,keepTime),this):get(this,unit)}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){mom.isValid()&&!isNaN(value)&&("FullYear"===unit&&isLeapYear(mom.year())&&1===mom.month()&&29===mom.date()?(value=toInt(value),mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value))}var regexes,match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){return hasOwnProp(regexes,token)?regexes[token](config._strict,config._locale):new RegExp(regexEscape(token.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}regexes={};var tokens={};function addParseToken(token,callback){var i,tokenLen,func=callback;for("string"==typeof token&&(token=[token]),isNumber(callback)&&(func=function(input,array){array[callback]=toInt(input)}),tokenLen=token.length,i=0;i<tokenLen;i++)tokens[token[i]]=func}function addWeekParseToken(token,callback){addParseToken(token,(function(input,array,config,token){config._w=config._w||{},callback(input,config._w,config,token)}))}function addTimeToArrayFromToken(token,input,config){null!=input&&hasOwnProp(tokens,token)&&tokens[token](input,config._a,config,token)}var indexOf,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function daysInMonth(year,month){if(isNaN(year)||isNaN(month))return NaN;var x,modMonth=(month%(x=12)+x)%x;return year+=(month-modMonth)/12,1===modMonth?isLeapYear(year)?29:28:31-modMonth%7%2}indexOf=Array.prototype.indexOf?Array.prototype.indexOf:function(o){var i;for(i=0;i<this.length;++i)if(this[i]===o)return i;return-1},addFormatToken("M",["MM",2],"Mo",(function(){return this.month()+1})),addFormatToken("MMM",0,0,(function(format){return this.localeData().monthsShort(this,format)})),addFormatToken("MMMM",0,0,(function(format){return this.localeData().months(this,format)})),addUnitAlias("month","M"),addUnitPriority("month",8),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",(function(isStrict,locale){return locale.monthsShortRegex(isStrict)})),addRegexToken("MMMM",(function(isStrict,locale){return locale.monthsRegex(isStrict)})),addParseToken(["M","MM"],(function(input,array){array[MONTH]=toInt(input)-1})),addParseToken(["MMM","MMMM"],(function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);null!=month?array[MONTH]=month:getParsingFlags(config).invalidMonth=input}));var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)mom=createUTC([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase();return strict?"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))||-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))||-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid())return mom;if("string"==typeof value)if(/^\d+$/.test(value))value=toInt(value);else if(!isNumber(value=mom.localeData().monthsParse(value)))return mom;return dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom}function getSetMonth(value){return null!=value?(setMonth(this,value),hooks.updateOffset(this,!0),this):get(this,"Month")}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<12;i++)mom=createUTC([2e3,i]),shortPieces.push(this.monthsShort(mom,"")),longPieces.push(this.months(mom,"")),mixedPieces.push(this.months(mom,"")),mixedPieces.push(this.monthsShort(mom,""));for(shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),i=0;i<12;i++)shortPieces[i]=regexEscape(shortPieces[i]),longPieces[i]=regexEscape(longPieces[i]);for(i=0;i<24;i++)mixedPieces[i]=regexEscape(mixedPieces[i]);this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function daysInYear(year){return isLeapYear(year)?366:365}addFormatToken("Y",0,0,(function(){var y=this.year();return y<=9999?zeroFill(y,4):"+"+y})),addFormatToken(0,["YY",2],0,(function(){return this.year()%100})),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addUnitAlias("year","y"),addUnitPriority("year",1),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",(function(input,array){array[YEAR]=2===input.length?hooks.parseTwoDigitYear(input):toInt(input)})),addParseToken("YY",(function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)})),addParseToken("Y",(function(input,array){array[YEAR]=parseInt(input,10)})),hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function createDate(y,m,d,h,M,s,ms){var date;return y<100&&y>=0?(date=new Date(y+400,m,d,h,M,s,ms),isFinite(date.getFullYear())&&date.setFullYear(y)):date=new Date(y,m,d,h,M,s,ms),date}function createUTCDate(y){var date,args;return y<100&&y>=0?((args=Array.prototype.slice.call(arguments))[0]=y+400,date=new Date(Date.UTC.apply(null,args)),isFinite(date.getUTCFullYear())&&date.setUTCFullYear(y)):date=new Date(Date.UTC.apply(null,arguments)),date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy;return-((7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7)+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var resYear,resDayOfYear,dayOfYear=1+7*(week-1)+(7+weekday-dow)%7+firstWeekOffset(year,dow,doy);return dayOfYear<=0?resDayOfYear=daysInYear(resYear=year-1)+dayOfYear:dayOfYear>daysInYear(year)?(resYear=year+1,resDayOfYear=dayOfYear-daysInYear(year)):(resYear=year,resDayOfYear=dayOfYear),{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var resWeek,resYear,weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1;return week<1?resWeek=week+weeksInYear(resYear=mom.year()-1,dow,doy):week>weeksInYear(mom.year(),dow,doy)?(resWeek=week-weeksInYear(mom.year(),dow,doy),resYear=mom.year()+1):(resYear=mom.year(),resWeek=week),{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addUnitPriority("week",5),addUnitPriority("isoWeek",5),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],(function(input,week,config,token){week[token.substr(0,1)]=toInt(input)}));function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,(function(format){return this.localeData().weekdaysMin(this,format)})),addFormatToken("ddd",0,0,(function(format){return this.localeData().weekdaysShort(this,format)})),addFormatToken("dddd",0,0,(function(format){return this.localeData().weekdays(this,format)})),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addUnitPriority("day",11),addUnitPriority("weekday",11),addUnitPriority("isoWeekday",11),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",(function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)})),addRegexToken("ddd",(function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)})),addRegexToken("dddd",(function(isStrict,locale){return locale.weekdaysRegex(isStrict)})),addWeekParseToken(["dd","ddd","dddd"],(function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);null!=weekday?week.d=weekday:getParsingFlags(config).invalidWeekday=input})),addWeekParseToken(["d","e","E"],(function(input,week,config,token){week[token]=toInt(input)}));var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)mom=createUTC([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase();return strict?"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))||-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))||-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))||-1!==(ii=indexOf.call(this._weekdaysParse,llc))||-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))||-1!==(ii=indexOf.call(this._weekdaysParse,llc))||-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,minp,shortp,longp,minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<7;i++)mom=createUTC([2e3,1]).day(i),minp=regexEscape(this.weekdaysMin(mom,"")),shortp=regexEscape(this.weekdaysShort(mom,"")),longp=regexEscape(this.weekdays(mom,"")),minPieces.push(minp),shortPieces.push(shortp),longPieces.push(longp),mixedPieces.push(minp),mixedPieces.push(shortp),mixedPieces.push(longp);minPieces.sort(cmpLenRev),shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function meridiem(token,lowercase){addFormatToken(token,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)}))}function matchMeridiem(isStrict,locale){return locale._meridiemParse}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,(function(){return this.hours()||24})),addFormatToken("hmm",0,0,(function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)})),addFormatToken("hmmss",0,0,(function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)})),addFormatToken("Hmm",0,0,(function(){return""+this.hours()+zeroFill(this.minutes(),2)})),addFormatToken("Hmmss",0,0,(function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)})),meridiem("a",!0),meridiem("A",!1),addUnitAlias("hour","h"),addUnitPriority("hour",13),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("k",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],(function(input,array,config){var kInput=toInt(input);array[HOUR]=24===kInput?0:kInput})),addParseToken(["a","A"],(function(input,array,config){config._isPm=config._locale.isPM(input),config._meridiem=input})),addParseToken(["h","hh"],(function(input,array,config){array[HOUR]=toInt(input),getParsingFlags(config).bigHour=!0})),addParseToken("hmm",(function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos)),getParsingFlags(config).bigHour=!0})),addParseToken("hmmss",(function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2)),getParsingFlags(config).bigHour=!0})),addParseToken("Hmm",(function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos))})),addParseToken("Hmmss",(function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2))}));var getSetHour=makeGetSet("Hours",!0);var globalLocale,baseConfig={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:{dow:0,doy:6},weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:/[ap]\.?m?\.?/i},locales={},localeFamilies={};function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1)if(arr1[i]!==arr2[i])return i;return minl}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function loadLocale(name){var oldLocale=null;if(void 0===locales[name]&&"undefined"!=typeof module&&module&&module.exports&&function(name){return null!=name.match("^[^/\\\\]*$")}(name))try{oldLocale=globalLocale._abbr,require("./locale/"+name),getSetGlobalLocale(oldLocale)}catch(e){locales[name]=null}return locales[name]}function getSetGlobalLocale(key,values){var data;return key&&((data=isUndefined(values)?getLocale(key):defineLocale(key,values))?globalLocale=data:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+key+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(name,config){if(null!==config){var locale,parentConfig=baseConfig;if(config.abbr=name,null!=locales[name])deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),parentConfig=locales[name]._config;else if(null!=config.parentLocale)if(null!=locales[config.parentLocale])parentConfig=locales[config.parentLocale]._config;else{if(null==(locale=loadLocale(config.parentLocale)))return localeFamilies[config.parentLocale]||(localeFamilies[config.parentLocale]=[]),localeFamilies[config.parentLocale].push({name:name,config:config}),null;parentConfig=locale._config}return locales[name]=new Locale(mergeConfigs(parentConfig,config)),localeFamilies[name]&&localeFamilies[name].forEach((function(x){defineLocale(x.name,x.config)})),getSetGlobalLocale(name),locales[name]}return delete locales[name],null}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return globalLocale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return function(names){for(var j,next,locale,split,i=0;i<names.length;){for(j=(split=normalizeLocale(names[i]).split("-")).length,next=(next=normalizeLocale(names[i+1]))?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&commonPrefix(split,next)>=j-1)break;j--}i++}return globalLocale}(key)}function checkOverflow(m){var overflow,a=m._a;return a&&-2===getParsingFlags(m).overflow&&(overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||24===a[HOUR]&&(0!==a[MINUTE]||0!==a[SECOND]||0!==a[MILLISECOND])?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),getParsingFlags(m)._overflowWeeks&&-1===overflow&&(overflow=WEEK),getParsingFlags(m)._overflowWeekday&&-1===overflow&&(overflow=WEEKDAY),getParsingFlags(m).overflow=overflow),m}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromISO(config){var i,l,allowTime,dateFormat,timeFormat,tzFormat,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),isoDatesLen=isoDates.length,isoTimesLen=isoTimes.length;if(match){for(getParsingFlags(config).iso=!0,i=0,l=isoDatesLen;i<l;i++)if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0],allowTime=!1!==isoDates[i][2];break}if(null==dateFormat)return void(config._isValid=!1);if(match[3]){for(i=0,l=isoTimesLen;i<l;i++)if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}if(null==timeFormat)return void(config._isValid=!1)}if(!allowTime&&null!=timeFormat)return void(config._isValid=!1);if(match[4]){if(!tzRegex.exec(match[4]))return void(config._isValid=!1);tzFormat="Z"}config._f=dateFormat+(timeFormat||"")+(tzFormat||""),configFromStringAndFormat(config)}else config._isValid=!1}function untruncateYear(yearStr){var year=parseInt(yearStr,10);return year<=49?2e3+year:year<=999?1900+year:year}function configFromRFC2822(config){var parsedArray,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr,result,match=rfc2822.exec(config._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(match){if(yearStr=match[4],monthStr=match[3],dayStr=match[2],hourStr=match[5],minuteStr=match[6],secondStr=match[7],result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)],secondStr&&result.push(parseInt(secondStr,10)),parsedArray=result,!function(weekdayStr,parsedInput,config){return!weekdayStr||defaultLocaleWeekdaysShort.indexOf(weekdayStr)===new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay()||(getParsingFlags(config).weekdayMismatch=!0,config._isValid=!1,!1)}(match[1],parsedArray,config))return;config._a=parsedArray,config._tzm=function(obsOffset,militaryOffset,numOffset){if(obsOffset)return obsOffsets[obsOffset];if(militaryOffset)return 0;var hm=parseInt(numOffset,10),m=hm%100;return(hm-m)/100*60+m}(match[8],match[9],match[10]),config._d=createUTCDate.apply(null,config._a),config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),getParsingFlags(config).rfc2822=!0}else config._isValid=!1}function defaults(a,b,c){return null!=a?a:null!=b?b:c}function configFromArray(config){var i,date,currentDate,expectedWeekday,yearToUse,input=[];if(!config._d){for(currentDate=function(config){var nowValue=new Date(hooks.now());return config._useUTC?[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]:[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&function(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year),week=defaults(w.W,1),((weekday=defaults(w.E,1))<1||weekday>7)&&(weekdayOverflow=!0)):(dow=config._locale._week.dow,doy=config._locale._week.doy,curWeek=weekOfYear(createLocal(),dow,doy),weekYear=defaults(w.gg,config._a[YEAR],curWeek.year),week=defaults(w.w,curWeek.week),null!=w.d?((weekday=w.d)<0||weekday>6)&&(weekdayOverflow=!0):null!=w.e?(weekday=w.e+dow,(w.e<0||w.e>6)&&(weekdayOverflow=!0)):weekday=dow);week<1||week>weeksInYear(weekYear,dow,doy)?getParsingFlags(config)._overflowWeeks=!0:null!=weekdayOverflow?getParsingFlags(config)._overflowWeekday=!0:(temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear)}(config),null!=config._dayOfYear&&(yearToUse=defaults(config._a[YEAR],currentDate[YEAR]),(config._dayOfYear>daysInYear(yearToUse)||0===config._dayOfYear)&&(getParsingFlags(config)._overflowDayOfYear=!0),date=createUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?createUTCDate:createDate).apply(null,input),expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay(),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24),config._w&&void 0!==config._w.d&&config._w.d!==expectedWeekday&&(getParsingFlags(config).weekdayMismatch=!0)}}function configFromStringAndFormat(config){if(config._f!==hooks.ISO_8601)if(config._f!==hooks.RFC_2822){config._a=[],getParsingFlags(config).empty=!0;var i,parsedInput,tokens,token,skipped,era,tokenLen,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokenLen=(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[]).length,i=0;i<tokenLen;i++)token=tokens[i],(parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0])&&((skipped=string.substr(0,string.indexOf(parsedInput))).length>0&&getParsingFlags(config).unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?getParsingFlags(config).empty=!1:getParsingFlags(config).unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&getParsingFlags(config).unusedTokens.push(token);getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&getParsingFlags(config).unusedInput.push(string),config._a[HOUR]<=12&&!0===getParsingFlags(config).bigHour&&config._a[HOUR]>0&&(getParsingFlags(config).bigHour=void 0),getParsingFlags(config).parsedDateParts=config._a.slice(0),getParsingFlags(config).meridiem=config._meridiem,config._a[HOUR]=function(locale,hour,meridiem){var isPm;if(null==meridiem)return hour;return null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?((isPm=locale.isPM(meridiem))&&hour<12&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}(config._locale,config._a[HOUR],config._meridiem),null!==(era=getParsingFlags(config).era)&&(config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR])),configFromArray(config),checkOverflow(config)}else configFromRFC2822(config);else configFromISO(config)}function prepareConfig(config){var input=config._i,format=config._f;return config._locale=config._locale||getLocale(config._l),null===input||void 0===format&&""===input?createInvalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),isMoment(input)?new Moment(checkOverflow(input)):(isDate(input)?config._d=input:isArray(format)?function(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=!1,configfLen=config._f.length;if(0===configfLen)return getParsingFlags(config).invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<configfLen;i++)currentScore=0,validFormatFound=!1,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._f=config._f[i],configFromStringAndFormat(tempConfig),isValid(tempConfig)&&(validFormatFound=!0),currentScore+=getParsingFlags(tempConfig).charsLeftOver,currentScore+=10*getParsingFlags(tempConfig).unusedTokens.length,getParsingFlags(tempConfig).score=currentScore,bestFormatIsValid?currentScore<scoreToBeat&&(scoreToBeat=currentScore,bestMoment=tempConfig):(null==scoreToBeat||currentScore<scoreToBeat||validFormatFound)&&(scoreToBeat=currentScore,bestMoment=tempConfig,validFormatFound&&(bestFormatIsValid=!0));extend(config,bestMoment||tempConfig)}(config):format?configFromStringAndFormat(config):function(config){var input=config._i;isUndefined(input)?config._d=new Date(hooks.now()):isDate(input)?config._d=new Date(input.valueOf()):"string"==typeof input?function(config){var matched=aspNetJsonRegex.exec(config._i);null===matched?(configFromISO(config),!1===config._isValid&&(delete config._isValid,configFromRFC2822(config),!1===config._isValid&&(delete config._isValid,config._strict?config._isValid=!1:hooks.createFromInputFallback(config)))):config._d=new Date(+matched[1])}(config):isArray(input)?(config._a=map(input.slice(0),(function(obj){return parseInt(obj,10)})),configFromArray(config)):isObject(input)?function(config){if(!config._d){var i=normalizeObjectUnits(config._i),dayOrDate=void 0===i.day?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],(function(obj){return obj&&parseInt(obj,10)})),configFromArray(config)}}(config):isNumber(input)?config._d=new Date(input):hooks.createFromInputFallback(config)}(config),isValid(config)||(config._d=null),config))}function createLocalOrUTC(input,format,locale,strict,isUTC){var res,c={};return!0!==format&&!1!==format||(strict=format,format=void 0),!0!==locale&&!1!==locale||(strict=locale,locale=void 0),(isObject(input)&&isObjectEmpty(input)||isArray(input)&&0===input.length)&&(input=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=isUTC,c._l=locale,c._i=input,c._f=format,c._strict=strict,(res=new Moment(checkOverflow(prepareConfig(c))))._nextDay&&(res.add(1,"d"),res._nextDay=void 0),res}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!1)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))})),hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other<this?this:other:createInvalid()})),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other>this?this:other:createInvalid()}));function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return createLocal();for(res=moments[0],i=1;i<moments.length;++i)moments[i].isValid()&&!moments[i][fn](res)||(res=moments[i]);return res}var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=function(m){var key,i,unitHasDecimal=!1,orderLen=ordering.length;for(key in m)if(hasOwnProp(m,key)&&(-1===indexOf.call(ordering,key)||null!=m[key]&&isNaN(m[key])))return!1;for(i=0;i<orderLen;++i)if(m[ordering[i]]){if(unitHasDecimal)return!1;parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])&&(unitHasDecimal=!0)}return!0}(normalizedInput),this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+1e3*hours*60*60,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){return number<0?-1*Math.round(-1*number):Math.round(number)}function offset(token,separator){addFormatToken(token,0,0,(function(){var offset=this.utcOffset(),sign="+";return offset<0&&(offset=-offset,sign="-"),sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)}))}offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],(function(input,array,config){config._useUTC=!0,config._tzm=offsetFromString(matchShortOffset,input)}));var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var parts,minutes,matches=(string||"").match(matcher);return null===matches?null:0===(minutes=60*(parts=((matches[matches.length-1]||[])+"").match(chunkOffset)||["-",0,0])[1]+toInt(parts[2]))?0:"+"===parts[0]?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf(),res._d.setTime(res._d.valueOf()+diff),hooks.updateOffset(res,!1),res):createLocal(input).local()}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset())}function isUtc(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}hooks.updateOffset=function(){};var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var sign,ret,diffRes,duration=input,match=null;return isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:isNumber(input)||!isNaN(+input)?(duration={},key?duration[key]=+input:duration.milliseconds=+input):(match=aspNetRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(1e3*match[MILLISECOND]))*sign}):(match=isoRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=function(base,other){var res;if(!base.isValid()||!other.isValid())return{milliseconds:0,months:0};other=cloneWithOffset(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):((res=positiveMomentsDifference(other,base)).milliseconds=-res.milliseconds,res.months=-res.months);return res}(createLocal(duration.from),createLocal(duration.to)),(duration={}).ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),isDuration(input)&&hasOwnProp(input,"_isValid")&&(ret._isValid=input._isValid),ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function createAdder(direction,name){return function(val,period){var tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),tmp=val,val=period,period=tmp),addSubtract(this,createDuration(val,period),direction),this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);mom.isValid()&&(updateOffset=null==updateOffset||updateOffset,months&&setMonth(mom,get(mom,"Month")+months*isAdding),days&&set$1(mom,"Date",get(mom,"Date")+days*isAdding),milliseconds&&mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding),updateOffset&&hooks.updateOffset(mom,days||months))}createDuration.fn=Duration.prototype,createDuration.invalid=function(){return createDuration(NaN)};var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(input){return"string"==typeof input||input instanceof String}function isMomentInput(input){return isMoment(input)||isDate(input)||isString(input)||isNumber(input)||function(input){var arrayTest=isArray(input),dataTypeTest=!1;arrayTest&&(dataTypeTest=0===input.filter((function(item){return!isNumber(item)&&isString(input)})).length);return arrayTest&&dataTypeTest}(input)||function(input){var i,property,objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=!1,properties=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],propertyLen=properties.length;for(i=0;i<propertyLen;i+=1)property=properties[i],propertyTest=propertyTest||hasOwnProp(input,property);return objectTest&&propertyTest}(input)||null==input}function monthDiff(a,b){if(a.date()<b.date())return-monthDiff(b,a);var wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return-(wholeMonthDiff+(b-anchor<0?(b-anchor)/(anchor-a.clone().add(wholeMonthDiff-1,"months")):(b-anchor)/(a.clone().add(wholeMonthDiff+1,"months")-anchor)))||0}function locale(key){var newLocaleData;return void 0===key?this._locale._abbr:(null!=(newLocaleData=getLocale(key))&&(this._locale=newLocaleData),this)}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(key){return void 0===key?this.localeData():this.locale(key)}));function localeData(){return this._locale}var MS_PER_400_YEARS=126227808e5;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){return y<100&&y>=0?new Date(y+400,m,d)-MS_PER_400_YEARS:new Date(y,m,d).valueOf()}function utcStartOfDate(y,m,d){return y<100&&y>=0?Date.UTC(y+400,m,d)-MS_PER_400_YEARS:Date.UTC(y,m,d)}function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict)}function computeErasParse(){var i,l,abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],eras=this.eras();for(i=0,l=eras.length;i<l;++i)namePieces.push(regexEscape(eras[i].name)),abbrPieces.push(regexEscape(eras[i].abbr)),narrowPieces.push(regexEscape(eras[i].narrow)),mixedPieces.push(regexEscape(eras[i].name)),mixedPieces.push(regexEscape(eras[i].abbr)),mixedPieces.push(regexEscape(eras[i].narrow));this._erasRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+namePieces.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+abbrPieces.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+narrowPieces.join("|")+")","i")}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;return null==input?weekOfYear(this,dow,doy).year:(week>(weeksTarget=weeksInYear(input,dow,doy))&&(week=weeksTarget),setWeekAll.call(this,input,week,weekday,dow,doy))}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);return this.year(date.getUTCFullYear()),this.month(date.getUTCMonth()),this.date(date.getUTCDate()),this}addFormatToken("N",0,0,"eraAbbr"),addFormatToken("NN",0,0,"eraAbbr"),addFormatToken("NNN",0,0,"eraAbbr"),addFormatToken("NNNN",0,0,"eraName"),addFormatToken("NNNNN",0,0,"eraNarrow"),addFormatToken("y",["y",1],"yo","eraYear"),addFormatToken("y",["yy",2],0,"eraYear"),addFormatToken("y",["yyy",3],0,"eraYear"),addFormatToken("y",["yyyy",4],0,"eraYear"),addRegexToken("N",matchEraAbbr),addRegexToken("NN",matchEraAbbr),addRegexToken("NNN",matchEraAbbr),addRegexToken("NNNN",(function(isStrict,locale){return locale.erasNameRegex(isStrict)})),addRegexToken("NNNNN",(function(isStrict,locale){return locale.erasNarrowRegex(isStrict)})),addParseToken(["N","NN","NNN","NNNN","NNNNN"],(function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);era?getParsingFlags(config).era=era:getParsingFlags(config).invalidEra=input})),addRegexToken("y",matchUnsigned),addRegexToken("yy",matchUnsigned),addRegexToken("yyy",matchUnsigned),addRegexToken("yyyy",matchUnsigned),addRegexToken("yo",(function(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned})),addParseToken(["y","yy","yyy","yyyy"],YEAR),addParseToken(["yo"],(function(input,array,config,token){var match;config._locale._eraYearOrdinalRegex&&(match=input.match(config._locale._eraYearOrdinalRegex)),config._locale.eraYearOrdinalParse?array[YEAR]=config._locale.eraYearOrdinalParse(input,match):array[YEAR]=parseInt(input,10)})),addFormatToken(0,["gg",2],0,(function(){return this.weekYear()%100})),addFormatToken(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addUnitPriority("weekYear",1),addUnitPriority("isoWeekYear",1),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],(function(input,week,config,token){week[token.substr(0,2)]=toInt(input)})),addWeekParseToken(["gg","GG"],(function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)})),addFormatToken("Q",0,"Qo","quarter"),addUnitAlias("quarter","Q"),addUnitPriority("quarter",7),addRegexToken("Q",match1),addParseToken("Q",(function(input,array){array[MONTH]=3*(toInt(input)-1)})),addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addUnitPriority("date",9),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",(function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient})),addParseToken(["D","DD"],DATE),addParseToken("Do",(function(input,array){array[DATE]=toInt(input.match(match1to2)[0])}));var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addUnitPriority("dayOfYear",4),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],(function(input,array,config){config._dayOfYear=toInt(input)})),addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addUnitPriority("minute",14),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addUnitPriority("second",15),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var token,getSetMillisecond,getSetSecond=makeGetSet("Seconds",!1);for(addFormatToken("S",0,0,(function(){return~~(this.millisecond()/100)})),addFormatToken(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),addFormatToken(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),addFormatToken(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),addFormatToken(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),addFormatToken(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),addFormatToken(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),addUnitAlias("millisecond","ms"),addUnitPriority("millisecond",16),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3),token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(input,array){array[MILLISECOND]=toInt(1e3*("0."+input))}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1),addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var proto=Moment.prototype;function preParsePostFormat(string){return string}proto.add=add,proto.calendar=function(time,formats){1===arguments.length&&(arguments[0]?isMomentInput(arguments[0])?(time=arguments[0],formats=void 0):function(input){var i,objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=!1,properties=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(i=0;i<properties.length;i+=1)propertyTest=propertyTest||hasOwnProp(input,properties[i]);return objectTest&&propertyTest}(arguments[0])&&(formats=arguments[0],time=void 0):(time=void 0,formats=void 0));var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))},proto.clone=function(){return new Moment(this)},proto.diff=function(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid())return NaN;if(!(that=cloneWithOffset(input,this)).isValid())return NaN;switch(zoneDelta=6e4*(that.utcOffset()-this.utcOffset()),units=normalizeUnits(units)){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)},proto.endOf=function(units){var time,startOfDate;if(void 0===(units=normalizeUnits(units))||"millisecond"===units||!this.isValid())return this;switch(startOfDate=this._isUTC?utcStartOfDate:localStartOfDate,units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf(),time+=36e5-mod$1(time+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":time=this._d.valueOf(),time+=6e4-mod$1(time,6e4)-1;break;case"second":time=this._d.valueOf(),time+=1e3-mod$1(time,1e3)-1}return this._d.setTime(time),hooks.updateOffset(this,!0),this},proto.format=function(inputString){inputString||(inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var output=formatMoment(this,inputString);return this.localeData().postformat(output)},proto.from=function(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()},proto.fromNow=function(withoutSuffix){return this.from(createLocal(),withoutSuffix)},proto.to=function(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()},proto.toNow=function(withoutSuffix){return this.to(createLocal(),withoutSuffix)},proto.get=function(units){return isFunction(this[units=normalizeUnits(units)])?this[units]():this},proto.invalidAt=function(){return getParsingFlags(this).overflow},proto.isAfter=function(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()>localInput.valueOf():localInput.valueOf()<this.clone().startOf(units).valueOf())},proto.isBefore=function(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()<localInput.valueOf():this.clone().endOf(units).valueOf()<localInput.valueOf())},proto.isBetween=function(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);return!!(this.isValid()&&localFrom.isValid()&&localTo.isValid())&&(("("===(inclusivity=inclusivity||"()")[0]?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(")"===inclusivity[1]?this.isBefore(localTo,units):!this.isAfter(localTo,units)))},proto.isSame=function(input,units){var inputMs,localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()===localInput.valueOf():(inputMs=localInput.valueOf(),this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()))},proto.isSameOrAfter=function(input,units){return this.isSame(input,units)||this.isAfter(input,units)},proto.isSameOrBefore=function(input,units){return this.isSame(input,units)||this.isBefore(input,units)},proto.isValid=function(){return isValid(this)},proto.lang=lang,proto.locale=locale,proto.localeData=localeData,proto.max=prototypeMax,proto.min=prototypeMin,proto.parsingFlags=function(){return extend({},getParsingFlags(this))},proto.set=function(units,value){if("object"==typeof units){var i,prioritized=function(unitsObj){var u,units=[];for(u in unitsObj)hasOwnProp(unitsObj,u)&&units.push({unit:u,priority:priorities[u]});return units.sort((function(a,b){return a.priority-b.priority})),units}(units=normalizeObjectUnits(units)),prioritizedLen=prioritized.length;for(i=0;i<prioritizedLen;i++)this[prioritized[i].unit](units[prioritized[i].unit])}else if(isFunction(this[units=normalizeUnits(units)]))return this[units](value);return this},proto.startOf=function(units){var time,startOfDate;if(void 0===(units=normalizeUnits(units))||"millisecond"===units||!this.isValid())return this;switch(startOfDate=this._isUTC?utcStartOfDate:localStartOfDate,units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf(),time-=mod$1(time+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":time=this._d.valueOf(),time-=mod$1(time,6e4);break;case"second":time=this._d.valueOf(),time-=mod$1(time,1e3)}return this._d.setTime(time),hooks.updateOffset(this,!0),this},proto.subtract=subtract,proto.toArray=function(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]},proto.toObject=function(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}},proto.toDate=function(){return new Date(this.valueOf())},proto.toISOString=function(keepOffset){if(!this.isValid())return null;var utc=!0!==keepOffset,m=utc?this.clone().utc():this;return m.year()<0||m.year()>9999?formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction(Date.prototype.toISOString)?utc?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",formatMoment(m,"Z")):formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},proto.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var prefix,year,suffix,func="moment",zone="";return this.isLocal()||(func=0===this.utcOffset()?"moment.utc":"moment.parseZone",zone="Z"),prefix="["+func+'("]',year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY","-MM-DD[T]HH:mm:ss.SSS",suffix=zone+'[")]',this.format(prefix+year+"-MM-DD[T]HH:mm:ss.SSS"+suffix)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),proto.toJSON=function(){return this.isValid()?this.toISOString():null},proto.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},proto.unix=function(){return Math.floor(this.valueOf()/1e3)},proto.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},proto.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},proto.eraName=function(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].name;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].name}return""},proto.eraNarrow=function(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].narrow;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].narrow}return""},proto.eraAbbr=function(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].abbr;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].abbr}return""},proto.eraYear=function(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i)if(dir=eras[i].since<=eras[i].until?1:-1,val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until||eras[i].until<=val&&val<=eras[i].since)return(this.year()-hooks(eras[i].since).year())*dir+eras[i].offset;return this.year()},proto.year=getSetYear,proto.isLeapYear=function(){return isLeapYear(this.year())},proto.weekYear=function(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},proto.isoWeekYear=function(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)},proto.quarter=proto.quarters=function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},proto.month=getSetMonth,proto.daysInMonth=function(){return daysInMonth(this.year(),this.month())},proto.week=proto.weeks=function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},proto.isoWeek=proto.isoWeeks=function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},proto.weeksInYear=function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},proto.weeksInWeekYear=function(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy)},proto.isoWeeksInYear=function(){return weeksInYear(this.year(),1,4)},proto.isoWeeksInISOWeekYear=function(){return weeksInYear(this.isoWeekYear(),1,4)},proto.date=getSetDayOfMonth,proto.day=proto.days=function(input){if(!this.isValid())return null!=input?this:NaN;var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=function(input,locale){return"string"!=typeof input?input:isNaN(input)?"number"==typeof(input=locale.weekdaysParse(input))?input:null:parseInt(input,10)}(input,this.localeData()),this.add(input-day,"d")):day},proto.weekday=function(input){if(!this.isValid())return null!=input?this:NaN;var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},proto.isoWeekday=function(input){if(!this.isValid())return null!=input?this:NaN;if(null!=input){var weekday=function(input,locale){return"string"==typeof input?locale.weekdaysParse(input)%7||7:isNaN(input)?null:input}(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}return this.day()||7},proto.dayOfYear=function(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},proto.hour=proto.hours=getSetHour,proto.minute=proto.minutes=getSetMinute,proto.second=proto.seconds=getSetSecond,proto.millisecond=proto.milliseconds=getSetMillisecond,proto.utcOffset=function(input,keepLocalTime,keepMinutes){var localAdjust,offset=this._offset||0;if(!this.isValid())return null!=input?this:NaN;if(null!=input){if("string"==typeof input){if(null===(input=offsetFromString(matchShortOffset,input)))return this}else Math.abs(input)<16&&!keepMinutes&&(input*=60);return!this._isUTC&&keepLocalTime&&(localAdjust=getDateOffset(this)),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addSubtract(this,createDuration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?offset:getDateOffset(this)},proto.utc=function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},proto.local=function(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(getDateOffset(this),"m")),this},proto.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var tZone=offsetFromString(matchOffset,this._i);null!=tZone?this.utcOffset(tZone):this.utcOffset(0,!0)}return this},proto.hasAlignedHourOffset=function(input){return!!this.isValid()&&(input=input?createLocal(input).utcOffset():0,(this.utcOffset()-input)%60==0)},proto.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},proto.isLocal=function(){return!!this.isValid()&&!this._isUTC},proto.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},proto.isUtc=isUtc,proto.isUTC=isUtc,proto.zoneAbbr=function(){return this._isUTC?"UTC":""},proto.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()})),proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!isUndefined(this._isDSTShifted))return this._isDSTShifted;var other,c={};return copyConfig(c,this),(c=prepareConfig(c))._a?(other=c._isUTC?createUTC(c._a):createLocal(c._a),this._isDSTShifted=this.isValid()&&function(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}(c._a,other.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var proto$1=Locale.prototype;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)&&(index=format,format=void 0),format=format||"",null!=index)return get$1(format,index,field,"month");var i,out=[];for(i=0;i<12;i++)out[i]=get$1(format,i,field,"month");return out}function listWeekdaysImpl(localeSorted,format,index,field){"boolean"==typeof localeSorted?(isNumber(format)&&(index=format,format=void 0),format=format||""):(index=format=localeSorted,localeSorted=!1,isNumber(format)&&(index=format,format=void 0),format=format||"");var i,locale=getLocale(),shift=localeSorted?locale._week.dow:0,out=[];if(null!=index)return get$1(format,(index+shift)%7,field,"day");for(i=0;i<7;i++)out[i]=get$1(format,(i+shift)%7,field,"day");return out}proto$1.calendar=function(key,mom,now){var output=this._calendar[key]||this._calendar.sameElse;return isFunction(output)?output.call(mom,now):output},proto$1.longDateFormat=function(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];return format||!formatUpper?format:(this._longDateFormat[key]=formatUpper.match(formattingTokens).map((function(tok){return"MMMM"===tok||"MM"===tok||"DD"===tok||"dddd"===tok?tok.slice(1):tok})).join(""),this._longDateFormat[key])},proto$1.invalidDate=function(){return this._invalidDate},proto$1.ordinal=function(number){return this._ordinal.replace("%d",number)},proto$1.preparse=preParsePostFormat,proto$1.postformat=preParsePostFormat,proto$1.relativeTime=function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},proto$1.pastFuture=function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)},proto$1.set=function(config){var prop,i;for(i in config)hasOwnProp(config,i)&&(isFunction(prop=config[i])?this[i]=prop:this["_"+i]=prop);this._config=config,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},proto$1.eras=function(m,format){var i,l,date,eras=this._eras||getLocale("en")._eras;for(i=0,l=eras.length;i<l;++i){if("string"==typeof eras[i].since)date=hooks(eras[i].since).startOf("day"),eras[i].since=date.valueOf();switch(typeof eras[i].until){case"undefined":eras[i].until=1/0;break;case"string":date=hooks(eras[i].until).startOf("day").valueOf(),eras[i].until=date.valueOf()}}return eras},proto$1.erasParse=function(eraName,format,strict){var i,l,name,abbr,narrow,eras=this.eras();for(eraName=eraName.toUpperCase(),i=0,l=eras.length;i<l;++i)if(name=eras[i].name.toUpperCase(),abbr=eras[i].abbr.toUpperCase(),narrow=eras[i].narrow.toUpperCase(),strict)switch(format){case"N":case"NN":case"NNN":if(abbr===eraName)return eras[i];break;case"NNNN":if(name===eraName)return eras[i];break;case"NNNNN":if(narrow===eraName)return eras[i]}else if([name,abbr,narrow].indexOf(eraName)>=0)return eras[i]},proto$1.erasConvertYear=function(era,year){var dir=era.since<=era.until?1:-1;return void 0===year?hooks(era.since).year():hooks(era.since).year()+(year-era.offset)*dir},proto$1.erasAbbrRegex=function(isStrict){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),isStrict?this._erasAbbrRegex:this._erasRegex},proto$1.erasNameRegex=function(isStrict){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),isStrict?this._erasNameRegex:this._erasRegex},proto$1.erasNarrowRegex=function(isStrict){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),isStrict?this._erasNarrowRegex:this._erasRegex},proto$1.months=function(m,format){return m?isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]:isArray(this._months)?this._months:this._months.standalone},proto$1.monthsShort=function(m,format){return m?isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]:isArray(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},proto$1.monthsParse=function(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact)return handleStrictParse.call(this,monthName,format,strict);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=createUTC([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},proto$1.monthsRegex=function(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex)},proto$1.monthsShortRegex=function(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex)},proto$1.week=function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},proto$1.firstDayOfYear=function(){return this._week.doy},proto$1.firstDayOfWeek=function(){return this._week.dow},proto$1.weekdays=function(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&!0!==m&&this._weekdays.isFormat.test(format)?"format":"standalone"];return!0===m?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays},proto$1.weekdaysMin=function(m){return!0===m?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin},proto$1.weekdaysShort=function(m){return!0===m?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort},proto$1.weekdaysParse=function(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,weekdayName,format,strict);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(mom=createUTC([2e3,1]).day(i),strict&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"dddd"===format&&this._fullWeekdaysParse[i].test(weekdayName))return i;if(strict&&"ddd"===format&&this._shortWeekdaysParse[i].test(weekdayName))return i;if(strict&&"dd"===format&&this._minWeekdaysParse[i].test(weekdayName))return i;if(!strict&&this._weekdaysParse[i].test(weekdayName))return i}},proto$1.weekdaysRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex)},proto$1.weekdaysShortRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},proto$1.weekdaysMinRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},proto$1.isPM=function(input){return"p"===(input+"").toLowerCase().charAt(0)},proto$1.meridiem=function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10;return number+(1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);return duration._milliseconds+=direction*other._milliseconds,duration._days+=direction*other._days,duration._months+=direction*other._months,duration._bubble()}function absCeil(number){return number<0?Math.floor(number):Math.ceil(number)}function daysToMonths(days){return 4800*days/146097}function monthsToDays(months){return 146097*months/4800}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var minutes,hours,years,s,totalSign,ymSign,daysSign,hmsSign,seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months),total=this.asSeconds();return total?(minutes=absFloor(seconds/60),hours=absFloor(minutes/60),seconds%=60,minutes%=60,years=absFloor(months/12),months%=12,s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"",totalSign=total<0?"-":"",ymSign=sign(this._months)!==sign(total)?"-":"",daysSign=sign(this._days)!==sign(total)?"-":"",hmsSign=sign(this._milliseconds)!==sign(total)?"-":"",totalSign+"P"+(years?ymSign+years+"Y":"")+(months?ymSign+months+"M":"")+(days?daysSign+days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hmsSign+hours+"H":"")+(minutes?hmsSign+minutes+"M":"")+(seconds?hmsSign+s+"S":"")):"P0D"}var proto$2=Duration.prototype;return proto$2.isValid=function(){return this._isValid},proto$2.abs=function(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this},proto$2.add=function(input,value){return addSubtract$1(this,input,value,1)},proto$2.subtract=function(input,value){return addSubtract$1(this,input,value,-1)},proto$2.as=function(units){if(!this.isValid())return NaN;var days,months,milliseconds=this._milliseconds;if("month"===(units=normalizeUnits(units))||"quarter"===units||"year"===units)switch(days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),units){case"month":return months;case"quarter":return months/3;case"year":return months/12}else switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}},proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asQuarters=asQuarters,proto$2.asYears=asYears,proto$2.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12):NaN},proto$2._bubble=function(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;return milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),days=0,months=0),data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),months+=monthsFromDays=absFloor(daysToMonths(days)),days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this},proto$2.clone=function(){return createDuration(this)},proto$2.get=function(units){return units=normalizeUnits(units),this.isValid()?this[units+"s"]():NaN},proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=function(){return absFloor(this.days()/7)},proto$2.months=months,proto$2.years=years,proto$2.humanize=function(argWithSuffix,argThresholds){if(!this.isValid())return this.localeData().invalidDate();var locale,output,withSuffix=!1,th=thresholds;return"object"==typeof argWithSuffix&&(argThresholds=argWithSuffix,argWithSuffix=!1),"boolean"==typeof argWithSuffix&&(withSuffix=argWithSuffix),"object"==typeof argThresholds&&(th=Object.assign({},thresholds,argThresholds),null!=argThresholds.s&&null==argThresholds.ss&&(th.ss=argThresholds.s-1)),output=function(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),weeks=round(duration.as("w")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days];return null!=thresholds.w&&(a=a||weeks<=1&&["w"]||weeks<thresholds.w&&["ww",weeks]),(a=a||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years])[2]=withoutSuffix,a[3]=+posNegDuration>0,a[4]=locale,substituteTimeAgo.apply(null,a)}(this,!withSuffix,th,locale=this.localeData()),withSuffix&&(output=locale.pastFuture(+this,output)),locale.postformat(output)},proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",/[+-]?\d+(\.\d{1,3})?/),addParseToken("X",(function(input,array,config){config._d=new Date(1e3*parseFloat(input))})),addParseToken("x",(function(input,array,config){config._d=new Date(toInt(input))})),
//! moment.js
hooks.version="2.29.4",hookCallback=createLocal,hooks.fn=proto,hooks.min=function(){return pickBy("isBefore",[].slice.call(arguments,0))},hooks.max=function(){return pickBy("isAfter",[].slice.call(arguments,0))},hooks.now=function(){return Date.now?Date.now():+new Date},hooks.utc=createUTC,hooks.unix=function(input){return createLocal(1e3*input)},hooks.months=function(format,index){return listMonthsImpl(format,index,"months")},hooks.isDate=isDate,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")},hooks.parseZone=function(){return createLocal.apply(null,arguments).parseZone()},hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=function(format,index){return listMonthsImpl(format,index,"monthsShort")},hooks.weekdaysMin=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")},hooks.defineLocale=defineLocale,hooks.updateLocale=function(name,config){if(null!=config){var locale,tmpLocale,parentConfig=baseConfig;null!=locales[name]&&null!=locales[name].parentLocale?locales[name].set(mergeConfigs(locales[name]._config,config)):(null!=(tmpLocale=loadLocale(name))&&(parentConfig=tmpLocale._config),config=mergeConfigs(parentConfig,config),null==tmpLocale&&(config.abbr=name),(locale=new Locale(config)).parentLocale=locales[name],locales[name]=locale),getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?(locales[name]=locales[name].parentLocale,name===getSetGlobalLocale()&&getSetGlobalLocale(name)):null!=locales[name]&&delete locales[name]);return locales[name]},hooks.locales=function(){return keys(locales)},hooks.weekdaysShort=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")},hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=function(roundingFunction){return void 0===roundingFunction?round:"function"==typeof roundingFunction&&(round=roundingFunction,!0)},hooks.relativeTimeThreshold=function(threshold,limit){return void 0!==thresholds[threshold]&&(void 0===limit?thresholds[threshold]:(thresholds[threshold]=limit,"s"===threshold&&(thresholds.ss=limit-1),!0))},hooks.calendarFormat=function(myMoment,now){var diff=myMoment.diff(now,"days",!0);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"},hooks.prototype=proto,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},hooks})),function(e){"use strict";if("function"==typeof define&&define.amd)define("datepicker",["jquery","moment"],e);else if("object"==typeof exports)module.exports=e(require("jquery"),require("moment"));else{if("undefined"==typeof jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if("undefined"==typeof moment)throw"bootstrap-datetimepicker requires Moment.js to be loaded first";e(jQuery,moment)}}((function($,_){"use strict";if(!_)throw new Error("bootstrap-datetimepicker requires Moment.js to be loaded first");function i(i,p){function a(){return void 0!==_.tz&&void 0!==p.timeZone&&null!==p.timeZone&&""!==p.timeZone}function c(e){var t;return t=null==e?_():_.isDate(e)||_.isMoment(e)?_(e):a()?_.tz(e,B,p.useStrict,p.timeZone):_(e,B,p.useStrict),a()&&t.tz(p.timeZone),t}function d(e){if("string"!=typeof e||1<e.length)throw new TypeError("isEnabled expects a single character string parameter");switch(e){case"y":return-1!==q.indexOf("Y");case"M":return-1!==q.indexOf("M");case"d":return-1!==q.toLowerCase().indexOf("d");case"h":case"H":return-1!==q.toLowerCase().indexOf("h");case"m":return-1!==q.indexOf("m");case"s":return-1!==q.indexOf("s");default:return!1}}function l(){return d("h")||d("m")||d("s")}function u(){return d("y")||d("M")||d("d")}function t(){var e,t,a,n=$("<div>").addClass("bootstrap-datetimepicker-widget dropdown-menu"),r=$("<div>").addClass("datepicker").append((t=$("<thead>").append($("<tr>").append($("<th>").addClass("prev").attr("data-action","previous").append($("<span>").addClass(p.icons.previous))).append($("<th>").addClass("picker-switch").attr("data-action","pickerSwitch").attr("colspan",p.calendarWeeks?"6":"5")).append($("<th>").addClass("next").attr("data-action","next").append($("<span>").addClass(p.icons.next)))),a=$("<tbody>").append($("<tr>").append($("<td>").attr("colspan",p.calendarWeeks?"8":"7"))),[$("<div>").addClass("datepicker-days").append($("<table>").addClass("table-condensed").append(t).append($("<tbody>"))),$("<div>").addClass("datepicker-months").append($("<table>").addClass("table-condensed").append(t.clone()).append(a.clone())),$("<div>").addClass("datepicker-years").append($("<table>").addClass("table-condensed").append(t.clone()).append(a.clone())),$("<div>").addClass("datepicker-decades").append($("<table>").addClass("table-condensed").append(t.clone()).append(a.clone()))])),i=$("<div>").addClass("timepicker").append(function(){var e,t,a,n=$("<div>").addClass("timepicker-hours").append($("<table>").addClass("table-condensed")),r=$("<div>").addClass("timepicker-minutes").append($("<table>").addClass("table-condensed")),i=$("<div>").addClass("timepicker-seconds").append($("<table>").addClass("table-condensed")),o=[(e=$("<tr>"),t=$("<tr>"),a=$("<tr>"),d("h")&&(e.append($("<td>").append($("<a>").attr({href:"#",tabindex:"-1",title:p.tooltips.incrementHour}).addClass("btn").attr("data-action","incrementHours").append($("<span>").addClass(p.icons.up)))),t.append($("<td>").append($("<span>").addClass("timepicker-hour").attr({"data-time-component":"hours",title:p.tooltips.pickHour}).attr("data-action","showHours"))),a.append($("<td>").append($("<a>").attr({href:"#",tabindex:"-1",title:p.tooltips.decrementHour}).addClass("btn").attr("data-action","decrementHours").append($("<span>").addClass(p.icons.down))))),d("m")&&(d("h")&&(e.append($("<td>").addClass("separator")),t.append($("<td>").addClass("separator").html(":")),a.append($("<td>").addClass("separator"))),e.append($("<td>").append($("<a>").attr({href:"#",tabindex:"-1",title:p.tooltips.incrementMinute}).addClass("btn").attr("data-action","incrementMinutes").append($("<span>").addClass(p.icons.up)))),t.append($("<td>").append($("<span>").addClass("timepicker-minute").attr({"data-time-component":"minutes",title:p.tooltips.pickMinute}).attr("data-action","showMinutes"))),a.append($("<td>").append($("<a>").attr({href:"#",tabindex:"-1",title:p.tooltips.decrementMinute}).addClass("btn").attr("data-action","decrementMinutes").append($("<span>").addClass(p.icons.down))))),d("s")&&(d("m")&&(e.append($("<td>").addClass("separator")),t.append($("<td>").addClass("separator").html(":")),a.append($("<td>").addClass("separator"))),e.append($("<td>").append($("<a>").attr({href:"#",tabindex:"-1",title:p.tooltips.incrementSecond}).addClass("btn").attr("data-action","incrementSeconds").append($("<span>").addClass(p.icons.up)))),t.append($("<td>").append($("<span>").addClass("timepicker-second").attr({"data-time-component":"seconds",title:p.tooltips.pickSecond}).attr("data-action","showSeconds"))),a.append($("<td>").append($("<a>").attr({href:"#",tabindex:"-1",title:p.tooltips.decrementSecond}).addClass("btn").attr("data-action","decrementSeconds").append($("<span>").addClass(p.icons.down))))),Y||(e.append($("<td>").addClass("separator")),t.append($("<td>").append($("<button>").addClass("btn btn-primary").attr({"data-action":"togglePeriod",tabindex:"-1",title:p.tooltips.togglePeriod}))),a.append($("<td>").addClass("separator"))),$("<div>").addClass("timepicker-picker").append($("<table>").addClass("table-condensed").append([e,t,a])))];return d("h")&&o.push(n),d("m")&&o.push(r),d("s")&&o.push(i),o}()),o=$("<ul>").addClass("list-unstyled"),s=$("<li>").addClass("picker-switch"+(p.collapse?" accordion-toggle":"")).append((e=[],p.showTodayButton&&e.push($("<td>").append($("<a>").attr({"data-action":"today",title:p.tooltips.today}).append($("<span>").addClass(p.icons.today)))),!p.sideBySide&&u()&&l()&&e.push($("<td>").append($("<a>").attr({"data-action":"togglePicker",title:p.tooltips.selectTime}).append($("<span>").addClass(p.icons.time)))),p.showClear&&e.push($("<td>").append($("<a>").attr({"data-action":"clear",title:p.tooltips.clear}).append($("<span>").addClass(p.icons.clear)))),p.showClose&&e.push($("<td>").append($("<a>").attr({"data-action":"close",title:p.tooltips.close}).append($("<span>").addClass(p.icons.close)))),$("<table>").addClass("table-condensed").append($("<tbody>").append($("<tr>").append(e)))));return p.inline&&n.removeClass("dropdown-menu"),Y&&n.addClass("usetwentyfour"),d("s")&&!Y&&n.addClass("wider"),p.sideBySide&&u()&&l()?(n.addClass("timepicker-sbs"),"top"===p.toolbarPlacement&&n.append(s),n.append($("<div>").addClass("row").append(r.addClass("col-md-6")).append(i.addClass("col-md-6"))),"bottom"===p.toolbarPlacement&&n.append(s),n):("top"===p.toolbarPlacement&&o.append(s),u()&&o.append($("<li>").addClass(p.collapse&&l()?"collapse in":"").append(r)),"default"===p.toolbarPlacement&&o.append(s),l()&&o.append($("<li>").addClass(p.collapse&&u()?"collapse":"").append(i)),"bottom"===p.toolbarPlacement&&o.append(s),n.append(o))}function n(){var e,t=(z||i).position(),a=(z||i).offset(),n=p.widgetPositioning.vertical,r=p.widgetPositioning.horizontal;if(p.widgetParent)e=p.widgetParent.append(N);else if(i.is("input"))e=i.after(N).parent();else{if(p.inline)return void(e=i.append(N));(e=i).children().first().after(N)}if("auto"===n&&(n=a.top+1.5*N.height()>=$(window).height()+$(window).scrollTop()&&N.height()+i.outerHeight()<a.top?"top":"bottom"),"auto"===r&&(r=e.width()<a.left+N.outerWidth()/2&&a.left+N.outerWidth()>$(window).width()?"right":"left"),"top"===n?N.addClass("top").removeClass("bottom"):N.addClass("bottom").removeClass("top"),"right"===r?N.addClass("pull-right"):N.removeClass("pull-right"),"static"===e.css("position")&&(e=e.parents().filter((function(){return"static"!==$(this).css("position")})).first()),0===e.length)throw new Error("datetimepicker component should be placed within a non-static positioned container");N.css({top:"top"===n?"auto":t.top+i.outerHeight(),bottom:"top"===n?e.outerHeight()-(e===i?0:t.top):"auto",left:"left"===r?e===i?0:t.left:"auto",right:"left"===r?"auto":e.outerWidth()-i.outerWidth()-(e===i?0:t.left)})}function h(e){"dp.change"===e.type&&(e.date&&e.date.isSame(e.oldDate)||!e.date&&!e.oldDate)||i.trigger(e)}function r(e){"y"===e&&(e="YYYY"),h({type:"dp.update",change:e,viewDate:H.clone()})}function o(e){N&&(e&&(j=Math.max(V,Math.min(3,j+e))),N.find(".datepicker > div").hide().filter(".datepicker-"+Z[j].clsName).show())}function m(e,t){var a,n,r,i;if(e.isValid()&&!(p.disabledDates&&"d"===t&&(a=e,!0===p.disabledDates[a.format("YYYY-MM-DD")])||p.enabledDates&&"d"===t&&(n=e,!0!==p.enabledDates[n.format("YYYY-MM-DD")])||p.minDate&&e.isBefore(p.minDate,t)||p.maxDate&&e.isAfter(p.maxDate,t)||p.daysOfWeekDisabled&&"d"===t&&-1!==p.daysOfWeekDisabled.indexOf(e.day())||p.disabledHours&&("h"===t||"m"===t||"s"===t)&&(r=e,!0===p.disabledHours[r.format("H")])||p.enabledHours&&("h"===t||"m"===t||"s"===t)&&(i=e,!0!==p.enabledHours[i.format("H")]))){if(p.disabledTimeIntervals&&("h"===t||"m"===t||"s"===t)){var o=!1;if($.each(p.disabledTimeIntervals,(function(){if(e.isBetween(this[0],this[1]))return!(o=!0)})),o)return}return 1}}function s(){var e,t,a,n=N.find(".datepicker-days"),r=n.find("th"),i=[],o=[];if(u()){for(r.eq(0).find("span").attr("title",p.tooltips.prevMonth),r.eq(1).attr("title",p.tooltips.selectMonth),r.eq(2).find("span").attr("title",p.tooltips.nextMonth),n.find(".disabled").removeClass("disabled"),r.eq(1).text(H.format(p.dayViewHeaderFormat)),m(H.clone().subtract(1,"M"),"M")||r.eq(0).addClass("disabled"),m(H.clone().add(1,"M"),"M")||r.eq(2).addClass("disabled"),e=H.clone().startOf("M").startOf("w").startOf("d"),a=0;a<42;a++)0===e.weekday()&&(t=$("<tr>"),p.calendarWeeks&&t.append('<td class="cw">'+e.week()+"</td>"),i.push(t)),o=["day"],e.isBefore(H,"M")&&o.push("old"),e.isAfter(H,"M")&&o.push("new"),e.isSame(E,"d")&&!W&&o.push("active"),m(e,"d")||o.push("disabled"),e.isSame(c(),"d")&&o.push("today"),0!==e.day()&&6!==e.day()||o.push("weekend"),h({type:"dp.classify",date:e,classNames:o}),t.append('<td data-action="selectDay" data-day="'+e.format("L")+'" class="'+o.join(" ")+'">'+e.date()+"</td>"),e.add(1,"d");var s,d,l;n.find("tbody").empty().append(i),d=(s=N.find(".datepicker-months")).find("th"),l=s.find("tbody").find("span"),d.eq(0).find("span").attr("title",p.tooltips.prevYear),d.eq(1).attr("title",p.tooltips.selectYear),d.eq(2).find("span").attr("title",p.tooltips.nextYear),s.find(".disabled").removeClass("disabled"),m(H.clone().subtract(1,"y"),"y")||d.eq(0).addClass("disabled"),d.eq(1).text(H.year()),m(H.clone().add(1,"y"),"y")||d.eq(2).addClass("disabled"),l.removeClass("active"),E.isSame(H,"y")&&!W&&l.eq(E.month()).addClass("active"),l.each((function(e){m(H.clone().month(e),"M")||$(this).addClass("disabled")})),function(){var e=N.find(".datepicker-years"),t=e.find("th"),a=H.clone().subtract(5,"y"),n=H.clone().add(6,"y"),r="";for(t.eq(0).find("span").attr("title",p.tooltips.prevDecade),t.eq(1).attr("title",p.tooltips.selectDecade),t.eq(2).find("span").attr("title",p.tooltips.nextDecade),e.find(".disabled").removeClass("disabled"),p.minDate&&p.minDate.isAfter(a,"y")&&t.eq(0).addClass("disabled"),t.eq(1).text(a.year()+"-"+n.year()),p.maxDate&&p.maxDate.isBefore(n,"y")&&t.eq(2).addClass("disabled");!a.isAfter(n,"y");)r+='<span data-action="selectYear" class="year'+(a.isSame(E,"y")&&!W?" active":"")+(m(a,"y")?"":" disabled")+'">'+a.year()+"</span>",a.add(1,"y");e.find("td").html(r)}(),function(){var e,t=N.find(".datepicker-decades"),a=t.find("th"),n=_({y:H.year()-H.year()%100-1}),r=n.clone().add(100,"y"),i=n.clone(),o=!1,s=!1,d="";for(a.eq(0).find("span").attr("title",p.tooltips.prevCentury),a.eq(2).find("span").attr("title",p.tooltips.nextCentury),t.find(".disabled").removeClass("disabled"),(n.isSame(_({y:1900}))||p.minDate&&p.minDate.isAfter(n,"y"))&&a.eq(0).addClass("disabled"),a.eq(1).text(n.year()+"-"+r.year()),(n.isSame(_({y:2e3}))||p.maxDate&&p.maxDate.isBefore(r,"y"))&&a.eq(2).addClass("disabled");!n.isAfter(r,"y");)e=n.year()+12,o=p.minDate&&p.minDate.isAfter(n,"y")&&p.minDate.year()<=e,s=p.maxDate&&p.maxDate.isAfter(n,"y")&&p.maxDate.year()<=e,d+='<span data-action="selectDecade" class="decade'+(E.isAfter(n)&&E.year()<=e?" active":"")+(m(n,"y")||o||s?"":" disabled")+'" data-selection="'+(n.year()+6)+'">'+(n.year()+1)+" - "+(n.year()+12)+"</span>",n.add(12,"y");d+="<span></span><span></span><span></span>",t.find("td").html(d),a.eq(1).text(i.year()+1+"-"+n.year())}()}}function y(){N&&(s(),function(){var e,t,a=N.find(".timepicker span[data-time-component]");Y||(e=N.find(".timepicker [data-action=togglePeriod]"),t=E.clone().add(12<=E.hours()?-12:12,"h"),e.text(E.format("A")),m(t,"h")?e.removeClass("disabled"):e.addClass("disabled")),a.filter("[data-time-component=hours]").text(E.format(Y?"HH":"hh")),a.filter("[data-time-component=minutes]").text(E.format("mm")),a.filter("[data-time-component=seconds]").text(E.format("ss")),function(){var e=N.find(".timepicker-hours table"),t=H.clone().startOf("d"),a=[],n=$("<tr>");for(11<H.hour()&&!Y&&t.hour(12);t.isSame(H,"d")&&(Y||H.hour()<12&&t.hour()<12||11<H.hour());)t.hour()%4==0&&(n=$("<tr>"),a.push(n)),n.append('<td data-action="selectHour" class="hour'+(m(t,"h")?"":" disabled")+'">'+t.format(Y?"HH":"hh")+"</td>"),t.add(1,"h");e.empty().append(a)}(),function(){for(var e=N.find(".timepicker-minutes table"),t=H.clone().startOf("h"),a=[],n=$("<tr>"),r=1===p.stepping?5:p.stepping;H.isSame(t,"h");)t.minute()%(4*r)==0&&(n=$("<tr>"),a.push(n)),n.append('<td data-action="selectMinute" class="minute'+(m(t,"m")?"":" disabled")+'">'+t.format("mm")+"</td>"),t.add(r,"m");e.empty().append(a)}(),function(){for(var e=N.find(".timepicker-seconds table"),t=H.clone().startOf("m"),a=[],n=$("<tr>");H.isSame(t,"m");)t.second()%20==0&&(n=$("<tr>"),a.push(n)),n.append('<td data-action="selectSecond" class="second'+(m(t,"s")?"":" disabled")+'">'+t.format("ss")+"</td>"),t.add(5,"s");e.empty().append(a)}()}())}function g(e){var t=W?null:E;if(!e)return W=!0,I.val(""),i.data("date",""),h({type:"dp.change",date:!1,oldDate:t}),void y();if(e=e.clone().locale(p.locale),a()&&e.tz(p.timeZone),1!==p.stepping)for(e.minutes(Math.round(e.minutes()/p.stepping)*p.stepping).seconds(0);p.minDate&&e.isBefore(p.minDate);)e.add(p.stepping,"minutes");m(e)?(H=(E=e).clone(),I.val(E.format(q)),i.data("date",E.format(q)),W=!1,y(),h({type:"dp.change",date:E.clone(),oldDate:t})):(p.keepInvalid?h({type:"dp.change",date:e,oldDate:t}):I.val(W?"":E.format(q)),h({type:"dp.error",date:e,oldDate:t}))}function b(){var t=!1;return N?(N.find(".collapse").each((function(){var e=$(this).data("collapse");return!e||!e.transitioning||!(t=!0)})),t||(z&&z.hasClass("btn")&&z.toggleClass("active"),N.hide(),$(window).off("resize",n),N.off("click","[data-action]"),N.off("mousedown",!1),N.remove(),N=!1,h({type:"dp.hide",date:E.clone()}),I.blur(),H=E.clone()),L):L}function w(){g(null)}function v(e){return void 0===p.parseInputDate?(!_.isMoment(e)||e instanceof Date)&&(e=c(e)):e=p.parseInputDate(e),e}function k(e){return $(e.currentTarget).is(".disabled")||X[$(e.currentTarget).data("action")].apply(L,arguments),!1}function D(){var e;return I.prop("disabled")||!p.ignoreReadonly&&I.prop("readonly")||N||(void 0!==I.val()&&0!==I.val().trim().length?g(v(I.val().trim())):W&&p.useCurrent&&(p.inline||I.is("input")&&0===I.val().trim().length)&&(e=c(),"string"==typeof p.useCurrent&&(e={year:function(e){return e.month(0).date(1).hours(0).seconds(0).minutes(0)},month:function(e){return e.date(1).hours(0).seconds(0).minutes(0)},day:function(e){return e.hours(0).seconds(0).minutes(0)},hour:function(e){return e.seconds(0).minutes(0)},minute:function(e){return e.seconds(0)}}[p.useCurrent](e)),g(e)),N=t(),function(){var e=$("<tr>"),t=H.clone().startOf("w").startOf("d");for(!0===p.calendarWeeks&&e.append($("<th>").addClass("cw").text("#"));t.isBefore(H.clone().endOf("w"));)e.append($("<th>").addClass("dow").text(t.format("dd"))),t.add(1,"d");N.find(".datepicker-days thead").append(e)}(),function(){for(var e=[],t=H.clone().startOf("y").startOf("d");t.isSame(H,"y");)e.push($("<span>").attr("data-action","selectMonth").addClass("month").text(t.format("MMM"))),t.add(1,"M");N.find(".datepicker-months td").empty().append(e)}(),N.find(".timepicker-hours").hide(),N.find(".timepicker-minutes").hide(),N.find(".timepicker-seconds").hide(),y(),o(),$(window).on("resize",n),N.on("click","[data-action]",k),N.on("mousedown",!1),z&&z.hasClass("btn")&&z.toggleClass("active"),n(),N.show(),p.focusOnShow&&!I.is(":focus")&&I.focus(),h({type:"dp.show"})),L}function C(){return(N?b:D)()}function x(e){var t,a,n,r,i=null,o=[],s={},d=e.which;for(t in K[d]="p",K)K.hasOwnProperty(t)&&"p"===K[t]&&(o.push(t),parseInt(t,10)!==d&&(s[t]=!0));for(t in p.keyBinds)if(p.keyBinds.hasOwnProperty(t)&&"function"==typeof p.keyBinds[t]&&(n=t.split(" ")).length===o.length&&J[d]===n[n.length-1]){for(r=!0,a=n.length-2;0<=a;a--)if(!(J[n[a]]in s)){r=!1;break}if(r){i=p.keyBinds[t];break}}i&&(i.call(L,N),e.stopPropagation(),e.preventDefault())}function T(e){K[e.which]="r",e.stopPropagation(),e.preventDefault()}function M(e){var t=$(e.target).val().trim();return g(t?v(t):null),e.stopImmediatePropagation(),!1}function S(e){var t={};return $.each(e,(function(){var e=v(this);e.isValid()&&(t[e.format("YYYY-MM-DD")]=!0)})),!!Object.keys(t).length&&t}function O(e){var t={};return $.each(e,(function(){t[this]=!0})),!!Object.keys(t).length&&t}function P(){var e=p.format||"L LT";q=e.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,(function(e){return(E.localeData().longDateFormat(e)||e).replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,(function(e){return E.localeData().longDateFormat(e)||e}))})),(B=p.extraFormats?p.extraFormats.slice():[]).indexOf(e)<0&&B.indexOf(q)<0&&B.push(q),Y=q.toLowerCase().indexOf("a")<1&&q.replace(/\[.*?\]/g,"").indexOf("h")<1,d("y")&&(V=2),d("M")&&(V=1),d("d")&&(V=0),j=Math.max(V,j),W||g(E)}var E,H,I,Y,q,B,j,A,F,L={},W=!0,z=!1,N=!1,V=0,Z=[{clsName:"days",navFnc:"M",navStep:1},{clsName:"months",navFnc:"y",navStep:1},{clsName:"years",navFnc:"y",navStep:10},{clsName:"decades",navFnc:"y",navStep:100}],R=["days","months","years","decades"],Q=["top","bottom","auto"],U=["left","right","auto"],G=["default","top","bottom"],J={up:38,38:"up",down:40,40:"down",left:37,37:"left",right:39,39:"right",tab:9,9:"tab",escape:27,27:"escape",enter:13,13:"enter",pageUp:33,33:"pageUp",pageDown:34,34:"pageDown",shift:16,16:"shift",control:17,17:"control",space:32,32:"space",t:84,84:"t",delete:46,46:"delete"},K={},X={next:function(){var e=Z[j].navFnc;H.add(Z[j].navStep,e),s(),r(e)},previous:function(){var e=Z[j].navFnc;H.subtract(Z[j].navStep,e),s(),r(e)},pickerSwitch:function(){o(1)},selectMonth:function(e){var t=$(e.target).closest("tbody").find("span").index($(e.target));H.month(t),j===V?(g(E.clone().year(H.year()).month(H.month())),p.inline||b()):(o(-1),s()),r("M")},selectYear:function(e){var t=parseInt($(e.target).text(),10)||0;H.year(t),j===V?(g(E.clone().year(H.year())),p.inline||b()):(o(-1),s()),r("YYYY")},selectDecade:function(e){var t=parseInt($(e.target).data("selection"),10)||0;H.year(t),j===V?(g(E.clone().year(H.year())),p.inline||b()):(o(-1),s()),r("YYYY")},selectDay:function(e){var t=H.clone();$(e.target).is(".old")&&t.subtract(1,"M"),$(e.target).is(".new")&&t.add(1,"M"),g(t.date(parseInt($(e.target).text(),10))),l()||p.keepOpen||p.inline||b()},incrementHours:function(){var e=E.clone().add(1,"h");m(e,"h")&&g(e)},incrementMinutes:function(){var e=E.clone().add(p.stepping,"m");m(e,"m")&&g(e)},incrementSeconds:function(){var e=E.clone().add(1,"s");m(e,"s")&&g(e)},decrementHours:function(){var e=E.clone().subtract(1,"h");m(e,"h")&&g(e)},decrementMinutes:function(){var e=E.clone().subtract(p.stepping,"m");m(e,"m")&&g(e)},decrementSeconds:function(){var e=E.clone().subtract(1,"s");m(e,"s")&&g(e)},togglePeriod:function(){g(E.clone().add(12<=E.hours()?-12:12,"h"))},togglePicker:function(e){var t,a=$(e.target),n=a.closest("ul"),r=n.find(".in"),i=n.find(".collapse:not(.in)");if(r&&r.length){if((t=r.data("collapse"))&&t.transitioning)return;r.collapse?(r.collapse("hide"),i.collapse("show")):(r.removeClass("in"),i.addClass("in")),a.is("span")?a.toggleClass(p.icons.time+" "+p.icons.date):a.find("span").toggleClass(p.icons.time+" "+p.icons.date)}},showPicker:function(){N.find(".timepicker > div:not(.timepicker-picker)").hide(),N.find(".timepicker .timepicker-picker").show()},showHours:function(){N.find(".timepicker .timepicker-picker").hide(),N.find(".timepicker .timepicker-hours").show()},showMinutes:function(){N.find(".timepicker .timepicker-picker").hide(),N.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){N.find(".timepicker .timepicker-picker").hide(),N.find(".timepicker .timepicker-seconds").show()},selectHour:function(e){var t=parseInt($(e.target).text(),10);Y||(12<=E.hours()?12!==t&&(t+=12):12===t&&(t=0)),g(E.clone().hours(t)),X.showPicker.call(L)},selectMinute:function(e){g(E.clone().minutes(parseInt($(e.target).text(),10))),X.showPicker.call(L)},selectSecond:function(e){g(E.clone().seconds(parseInt($(e.target).text(),10))),X.showPicker.call(L)},clear:w,today:function(){var e=c();m(e,"d")&&g(e)},close:b};if(L.destroy=function(){b(),I.off({change:M,blur:blur,keydown:x,keyup:T,focus:p.allowInputToggle?b:""}),i.is("input")?I.off({focus:D}):z&&(z.off("click",C),z.off("mousedown",!1)),i.removeData("DateTimePicker"),i.removeData("date")},L.toggle=C,L.show=D,L.hide=b,L.disable=function(){return b(),z&&z.hasClass("btn")&&z.addClass("disabled"),I.prop("disabled",!0),L},L.enable=function(){return z&&z.hasClass("btn")&&z.removeClass("disabled"),I.prop("disabled",!1),L},L.ignoreReadonly=function(e){if(0===arguments.length)return p.ignoreReadonly;if("boolean"!=typeof e)throw new TypeError("ignoreReadonly () expects a boolean parameter");return p.ignoreReadonly=e,L},L.options=function(e){if(0===arguments.length)return $.extend(!0,{},p);if(!(e instanceof Object))throw new TypeError("options() options parameter should be an object");return $.extend(!0,p,e),$.each(p,(function(e,t){if(void 0===L[e])throw new TypeError("option "+e+" is not recognized!");L[e](t)})),L},L.date=function(e){if(0===arguments.length)return W?null:E.clone();if(!(null===e||"string"==typeof e||_.isMoment(e)||e instanceof Date))throw new TypeError("date() parameter must be one of [null, string, moment or Date]");return g(null===e?null:v(e)),L},L.format=function(e){if(0===arguments.length)return p.format;if("string"!=typeof e&&("boolean"!=typeof e||!1!==e))throw new TypeError("format() expects a string or boolean:false parameter "+e);return p.format=e,q&&P(),L},L.timeZone=function(e){if(0===arguments.length)return p.timeZone;if("string"!=typeof e)throw new TypeError("newZone() expects a string parameter");return p.timeZone=e,L},L.dayViewHeaderFormat=function(e){if(0===arguments.length)return p.dayViewHeaderFormat;if("string"!=typeof e)throw new TypeError("dayViewHeaderFormat() expects a string parameter");return p.dayViewHeaderFormat=e,L},L.extraFormats=function(e){if(0===arguments.length)return p.extraFormats;if(!1!==e&&!(e instanceof Array))throw new TypeError("extraFormats() expects an array or false parameter");return p.extraFormats=e,B&&P(),L},L.disabledDates=function(e){if(0===arguments.length)return p.disabledDates?$.extend({},p.disabledDates):p.disabledDates;if(!e)return p.disabledDates=!1,y(),L;if(!(e instanceof Array))throw new TypeError("disabledDates() expects an array parameter");return p.disabledDates=S(e),p.enabledDates=!1,y(),L},L.enabledDates=function(e){if(0===arguments.length)return p.enabledDates?$.extend({},p.enabledDates):p.enabledDates;if(!e)return p.enabledDates=!1,y(),L;if(!(e instanceof Array))throw new TypeError("enabledDates() expects an array parameter");return p.enabledDates=S(e),p.disabledDates=!1,y(),L},L.daysOfWeekDisabled=function(e){if(0===arguments.length)return p.daysOfWeekDisabled.splice(0);if("boolean"==typeof e&&!e)return p.daysOfWeekDisabled=!1,y(),L;if(!(e instanceof Array))throw new TypeError("daysOfWeekDisabled() expects an array parameter");if(p.daysOfWeekDisabled=e.reduce((function(e,t){return 6<(t=parseInt(t,10))||t<0||isNaN(t)||-1===e.indexOf(t)&&e.push(t),e}),[]).sort(),p.useCurrent&&!p.keepInvalid){for(var t=0;!m(E,"d");){if(E.add(1,"d"),31===t)throw"Tried 31 times to find a valid date";t++}g(E)}return y(),L},L.maxDate=function(e){if(0===arguments.length)return p.maxDate?p.maxDate.clone():p.maxDate;if("boolean"==typeof e&&!1===e)return p.maxDate=!1,y(),L;"string"==typeof e&&("now"!==e&&"moment"!==e||(e=c()));var t=v(e);if(!t.isValid())throw new TypeError("maxDate() Could not parse date parameter: "+e);if(p.minDate&&t.isBefore(p.minDate))throw new TypeError("maxDate() date parameter is before options.minDate: "+t.format(q));return p.maxDate=t,p.useCurrent&&!p.keepInvalid&&E.isAfter(e)&&g(p.maxDate),H.isAfter(t)&&(H=t.clone().subtract(p.stepping,"m")),y(),L},L.minDate=function(e){if(0===arguments.length)return p.minDate?p.minDate.clone():p.minDate;if("boolean"==typeof e&&!1===e)return p.minDate=!1,y(),L;"string"==typeof e&&("now"!==e&&"moment"!==e||(e=c()));var t=v(e);if(!t.isValid())throw new TypeError("minDate() Could not parse date parameter: "+e);if(p.maxDate&&t.isAfter(p.maxDate))throw new TypeError("minDate() date parameter is after options.maxDate: "+t.format(q));return p.minDate=t,p.useCurrent&&!p.keepInvalid&&E.isBefore(e)&&g(p.minDate),H.isBefore(t)&&(H=t.clone().add(p.stepping,"m")),y(),L},L.defaultDate=function(e){if(0===arguments.length)return p.defaultDate?p.defaultDate.clone():p.defaultDate;if(!e)return p.defaultDate=!1,L;"string"==typeof e&&(e="now"===e||"moment"===e?c():c(e));var t=v(e);if(!t.isValid())throw new TypeError("defaultDate() Could not parse date parameter: "+e);if(!m(t))throw new TypeError("defaultDate() date passed is invalid according to component setup validations");return p.defaultDate=t,(p.defaultDate&&p.inline||""===I.val().trim())&&g(p.defaultDate),L},L.locale=function(e){if(0===arguments.length)return p.locale;if(!_.localeData(e))throw new TypeError("locale() locale "+e+" is not loaded from moment locales!");return p.locale=e,E.locale(p.locale),H.locale(p.locale),q&&P(),N&&(b(),D()),L},L.stepping=function(e){return 0===arguments.length?p.stepping:(e=parseInt(e,10),(isNaN(e)||e<1)&&(e=1),p.stepping=e,L)},L.useCurrent=function(e){var t=["year","month","day","hour","minute"];if(0===arguments.length)return p.useCurrent;if("boolean"!=typeof e&&"string"!=typeof e)throw new TypeError("useCurrent() expects a boolean or string parameter");if("string"==typeof e&&-1===t.indexOf(e.toLowerCase()))throw new TypeError("useCurrent() expects a string parameter of "+t.join(", "));return p.useCurrent=e,L},L.collapse=function(e){if(0===arguments.length)return p.collapse;if("boolean"!=typeof e)throw new TypeError("collapse() expects a boolean parameter");return p.collapse===e||(p.collapse=e,N&&(b(),D())),L},L.icons=function(e){if(0===arguments.length)return $.extend({},p.icons);if(!(e instanceof Object))throw new TypeError("icons() expects parameter to be an Object");return $.extend(p.icons,e),N&&(b(),D()),L},L.tooltips=function(e){if(0===arguments.length)return $.extend({},p.tooltips);if(!(e instanceof Object))throw new TypeError("tooltips() expects parameter to be an Object");return $.extend(p.tooltips,e),N&&(b(),D()),L},L.useStrict=function(e){if(0===arguments.length)return p.useStrict;if("boolean"!=typeof e)throw new TypeError("useStrict() expects a boolean parameter");return p.useStrict=e,L},L.sideBySide=function(e){if(0===arguments.length)return p.sideBySide;if("boolean"!=typeof e)throw new TypeError("sideBySide() expects a boolean parameter");return p.sideBySide=e,N&&(b(),D()),L},L.viewMode=function(e){if(0===arguments.length)return p.viewMode;if("string"!=typeof e)throw new TypeError("viewMode() expects a string parameter");if(-1===R.indexOf(e))throw new TypeError("viewMode() parameter must be one of ("+R.join(", ")+") value");return p.viewMode=e,j=Math.max(R.indexOf(e),V),o(),L},L.toolbarPlacement=function(e){if(0===arguments.length)return p.toolbarPlacement;if("string"!=typeof e)throw new TypeError("toolbarPlacement() expects a string parameter");if(-1===G.indexOf(e))throw new TypeError("toolbarPlacement() parameter must be one of ("+G.join(", ")+") value");return p.toolbarPlacement=e,N&&(b(),D()),L},L.widgetPositioning=function(e){if(0===arguments.length)return $.extend({},p.widgetPositioning);if("[object Object]"!=={}.toString.call(e))throw new TypeError("widgetPositioning() expects an object variable");if(e.horizontal){if("string"!=typeof e.horizontal)throw new TypeError("widgetPositioning() horizontal variable must be a string");if(e.horizontal=e.horizontal.toLowerCase(),-1===U.indexOf(e.horizontal))throw new TypeError("widgetPositioning() expects horizontal parameter to be one of ("+U.join(", ")+")");p.widgetPositioning.horizontal=e.horizontal}if(e.vertical){if("string"!=typeof e.vertical)throw new TypeError("widgetPositioning() vertical variable must be a string");if(e.vertical=e.vertical.toLowerCase(),-1===Q.indexOf(e.vertical))throw new TypeError("widgetPositioning() expects vertical parameter to be one of ("+Q.join(", ")+")");p.widgetPositioning.vertical=e.vertical}return y(),L},L.calendarWeeks=function(e){if(0===arguments.length)return p.calendarWeeks;if("boolean"!=typeof e)throw new TypeError("calendarWeeks() expects parameter to be a boolean value");return p.calendarWeeks=e,y(),L},L.showTodayButton=function(e){if(0===arguments.length)return p.showTodayButton;if("boolean"!=typeof e)throw new TypeError("showTodayButton() expects a boolean parameter");return p.showTodayButton=e,N&&(b(),D()),L},L.showClear=function(e){if(0===arguments.length)return p.showClear;if("boolean"!=typeof e)throw new TypeError("showClear() expects a boolean parameter");return p.showClear=e,N&&(b(),D()),L},L.widgetParent=function(e){if(0===arguments.length)return p.widgetParent;if("string"==typeof e&&(e=$(e)),null!==e&&"string"!=typeof e&&!(e instanceof $))throw new TypeError("widgetParent() expects a string or a jQuery object parameter");return p.widgetParent=e,N&&(b(),D()),L},L.keepOpen=function(e){if(0===arguments.length)return p.keepOpen;if("boolean"!=typeof e)throw new TypeError("keepOpen() expects a boolean parameter");return p.keepOpen=e,L},L.focusOnShow=function(e){if(0===arguments.length)return p.focusOnShow;if("boolean"!=typeof e)throw new TypeError("focusOnShow() expects a boolean parameter");return p.focusOnShow=e,L},L.inline=function(e){if(0===arguments.length)return p.inline;if("boolean"!=typeof e)throw new TypeError("inline() expects a boolean parameter");return p.inline=e,L},L.clear=function(){return w(),L},L.keyBinds=function(e){return 0===arguments.length?p.keyBinds:(p.keyBinds=e,L)},L.getMoment=function(e){return c(e)},L.debug=function(e){if("boolean"!=typeof e)throw new TypeError("debug() expects a boolean parameter");return p.debug=e,L},L.allowInputToggle=function(e){if(0===arguments.length)return p.allowInputToggle;if("boolean"!=typeof e)throw new TypeError("allowInputToggle() expects a boolean parameter");return p.allowInputToggle=e,L},L.showClose=function(e){if(0===arguments.length)return p.showClose;if("boolean"!=typeof e)throw new TypeError("showClose() expects a boolean parameter");return p.showClose=e,L},L.keepInvalid=function(e){if(0===arguments.length)return p.keepInvalid;if("boolean"!=typeof e)throw new TypeError("keepInvalid() expects a boolean parameter");return p.keepInvalid=e,L},L.datepickerInput=function(e){if(0===arguments.length)return p.datepickerInput;if("string"!=typeof e)throw new TypeError("datepickerInput() expects a string parameter");return p.datepickerInput=e,L},L.parseInputDate=function(e){if(0===arguments.length)return p.parseInputDate;if("function"!=typeof e)throw new TypeError("parseInputDate() sholud be as function");return p.parseInputDate=e,L},L.disabledTimeIntervals=function(e){if(0===arguments.length)return p.disabledTimeIntervals?$.extend({},p.disabledTimeIntervals):p.disabledTimeIntervals;if(!e)return p.disabledTimeIntervals=!1,y(),L;if(!(e instanceof Array))throw new TypeError("disabledTimeIntervals() expects an array parameter");return p.disabledTimeIntervals=e,y(),L},L.disabledHours=function(e){if(0===arguments.length)return p.disabledHours?$.extend({},p.disabledHours):p.disabledHours;if(!e)return p.disabledHours=!1,y(),L;if(!(e instanceof Array))throw new TypeError("disabledHours() expects an array parameter");if(p.disabledHours=O(e),p.enabledHours=!1,p.useCurrent&&!p.keepInvalid){for(var t=0;!m(E,"h");){if(E.add(1,"h"),24===t)throw"Tried 24 times to find a valid date";t++}g(E)}return y(),L},L.enabledHours=function(e){if(0===arguments.length)return p.enabledHours?$.extend({},p.enabledHours):p.enabledHours;if(!e)return p.enabledHours=!1,y(),L;if(!(e instanceof Array))throw new TypeError("enabledHours() expects an array parameter");if(p.enabledHours=O(e),p.disabledHours=!1,p.useCurrent&&!p.keepInvalid){for(var t=0;!m(E,"h");){if(E.add(1,"h"),24===t)throw"Tried 24 times to find a valid date";t++}g(E)}return y(),L},L.viewDate=function(e){if(0===arguments.length)return H.clone();if(!e)return H=E.clone(),L;if(!("string"==typeof e||_.isMoment(e)||e instanceof Date))throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");return H=v(e),r(),L},i.is("input"))I=i;else if(0===(I=i.find(p.datepickerInput)).length)I=i.find("input");else if(!I.is("input"))throw new Error('CSS class "'+p.datepickerInput+'" cannot be applied to non input element');if(i.hasClass("input-group")&&(z=0===i.find(".datepickerbutton").length?i.find(".input-group-addon"):i.find(".datepickerbutton")),!p.inline&&!I.is("input"))throw new Error("Could not initialize DateTimePicker without an input element");return E=c(),H=E.clone(),$.extend(!0,p,(F={},(A=i.is("input")||p.inline?i.data():i.find("input").data()).dateOptions&&A.dateOptions instanceof Object&&(F=$.extend(!0,F,A.dateOptions)),$.each(p,(function(e){var t="date"+e.charAt(0).toUpperCase()+e.slice(1);void 0!==A[t]&&(F[e]=A[t])})),F)),L.options(p),P(),I.on({change:M,blur:p.debug?"":b,keydown:x,keyup:T,focus:p.allowInputToggle?D:""}),i.is("input")?I.on({focus:D}):z&&(z.on("click",C),z.on("mousedown",!1)),I.prop("disabled")&&L.disable(),I.is("input")&&0!==I.val().trim().length?g(v(I.val().trim())):p.defaultDate&&void 0===I.attr("placeholder")&&g(p.defaultDate),p.inline&&D(),L}return $.fn.datetimepicker=function(a){a=a||{};var t,n=Array.prototype.slice.call(arguments,1),r=!0;if("object"==typeof a)return this.each((function(){var e,t=$(this);t.data("DateTimePicker")||(e=$.extend(!0,{},$.fn.datetimepicker.defaults,a),t.data("DateTimePicker",i(t,e)))}));if("string"==typeof a)return this.each((function(){var e=$(this).data("DateTimePicker");if(!e)throw new Error('bootstrap-datetimepicker("'+a+'") method was called on an element that is not using DateTimePicker');t=e[a].apply(e,n),r=t===e})),r||-1<$.inArray(a,["destroy","hide","show","toggle"])?this:t;throw new TypeError("Invalid arguments for DateTimePicker: "+a)},$.fn.datetimepicker.defaults={timeZone:"",format:!1,dayViewHeaderFormat:"MMMM YYYY",extraFormats:!1,stepping:1,minDate:!1,maxDate:!1,useCurrent:!0,collapse:!0,locale:_.locale(),defaultDate:!1,disabledDates:!1,enabledDates:!1,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",previous:"glyphicon glyphicon-chevron-left",next:"glyphicon glyphicon-chevron-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"},tooltips:{today:"Go to today",clear:"Clear selection",close:"Close the picker",selectMonth:"Select Month",prevMonth:"Previous Month",nextMonth:"Next Month",selectYear:"Select Year",prevYear:"Previous Year",nextYear:"Next Year",selectDecade:"Select Decade",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevCentury:"Previous Century",nextCentury:"Next Century",pickHour:"Pick Hour",incrementHour:"Increment Hour",decrementHour:"Decrement Hour",pickMinute:"Pick Minute",incrementMinute:"Increment Minute",decrementMinute:"Decrement Minute",pickSecond:"Pick Second",incrementSecond:"Increment Second",decrementSecond:"Decrement Second",togglePeriod:"Toggle Period",selectTime:"Select Time"},useStrict:!1,sideBySide:!1,daysOfWeekDisabled:!1,calendarWeeks:!1,viewMode:"days",toolbarPlacement:"default",showTodayButton:!1,showClear:!1,showClose:!1,widgetPositioning:{horizontal:"auto",vertical:"auto"},widgetParent:null,ignoreReadonly:!1,keepOpen:!1,focusOnShow:!0,inline:!1,keepInvalid:!1,datepickerInput:".datepickerinput",keyBinds:{up:function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().subtract(7,"d")):this.date(t.clone().add(this.stepping(),"m"))}},down:function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().add(7,"d")):this.date(t.clone().subtract(this.stepping(),"m"))}else this.show()},"control up":function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().subtract(1,"y")):this.date(t.clone().add(1,"h"))}},"control down":function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")?this.date(t.clone().add(1,"y")):this.date(t.clone().subtract(1,"h"))}},left:function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().subtract(1,"d"))}},right:function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().add(1,"d"))}},pageUp:function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().subtract(1,"M"))}},pageDown:function(e){if(e){var t=this.date()||this.getMoment();e.find(".datepicker").is(":visible")&&this.date(t.clone().add(1,"M"))}},enter:function(){this.hide()},escape:function(){this.hide()},"control space":function(e){e&&e.find(".timepicker").is(":visible")&&e.find('.btn[data-action="togglePeriod"]').click()},t:function(){this.date(this.getMoment())},delete:function(){this.clear()}},debug:!1,allowInputToggle:!1,disabledTimeIntervals:!1,disabledHours:!1,enabledHours:!1,viewDate:!1},$.fn.datetimepicker})),define("locales/datetimepicker_locale",["pgui.localizer","moment"],(function(localizer,moment){localizer.load().done((function(){var localeData={months:localizer.getString("CalendarMonths").split("_"),monthsShort:localizer.getString("CalendarMonthsShort").split("_"),weekdays:localizer.getString("CalendarWeekdays").split("_"),weekdaysShort:localizer.getString("CalendarWeekdaysShort").split("_"),weekdaysMin:localizer.getString("CalendarWeekdaysMin").split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10;return number+(1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")},week:{dow:localizer.getFirstDayOfWeek(),doy:4}};moment.locale("php_gen",localeData)}))})),define("pgui.editors/datetime",["pgui.editors/plain","datepicker","locales/datetimepicker_locale","moment"],(function(PlainEditor,datepicker,datetimepicker_locale,moment){return PlainEditor.extend({init:function(rootElement,readyCallback){var $container,format,verticalPosition,$wrapper;this._super(rootElement,readyCallback),($container=rootElement,format=$container.data("picker-format"),verticalPosition=$container.data("vertical")||"auto",$wrapper=$container.closest(".js-datetime-editor-wrap"),0==$wrapper.length&&($wrapper=$container),$wrapper.datetimepicker({format:format,useCurrent:!1,showClear:!0,showClose:!0,showTodayButton:!0,widgetPositioning:{vertical:verticalPosition},allowInputToggle:!1,locale:"php_gen",icons:{time:"icon-time",date:"icon-calendar",up:"icon-chevron-up",down:"icon-chevron-down",previous:"icon-chevron-left",next:"icon-chevron-right",today:"icon-today",clear:"icon-remove",close:"icon-ok"}}),$wrapper).on("dp.change",_.bind(this.doChanged,this)).on("dp.hide",(function(){rootElement.trigger("keyup")}))},_enableCalendarButton:function(value){var $calendarButton=this._getCalendarButton();0!==$calendarButton.length&&(value?$calendarButton.removeAttr("disabled"):$calendarButton.attr("disabled",!0))},_getCalendarButton:function(){return this.rootElement.find(".js-datetime-editor-button")},setEnabled:function(value){return this._super(value),this._enableCalendarButton(value),this},setReadonly:function(value){return this._super(value),this._enableCalendarButton(!value),this},getValueEx:function(){var inputFormat=this.rootElement.data("picker-format");return moment(this._super(),inputFormat).format("YYYY-MM-DD HH:mm:ss")},setValueEx:function(value){var inputFormat=this.rootElement.data("picker-format");this._super(moment(value,"YYYY-MM-DD HH:mm:ss").format(inputFormat))}})})),
/**
 * Trumbowyg v2.18.0 - A lightweight WYSIWYG editor
 * Trumbowyg core file
 * ------------------------
 * @link http://alex-d.github.io/Trumbowyg
 * @license MIT
 * @author Alexandre Demode (Alex-D)
 *         Twitter : @AlexandreDemode
 *         Website : alex-d.fr
 */
jQuery.trumbowyg={langs:{en:{viewHTML:"View HTML",undo:"Undo",redo:"Redo",formatting:"Formatting",p:"Paragraph",blockquote:"Quote",code:"Code",header:"Header",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",strong:"Strong",em:"Emphasis",del:"Deleted",superscript:"Superscript",subscript:"Subscript",unorderedList:"Unordered list",orderedList:"Ordered list",insertImage:"Insert Image",link:"Link",createLink:"Insert link",unlink:"Remove link",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",horizontalRule:"Insert horizontal rule",removeformat:"Remove format",fullscreen:"Fullscreen",close:"Close",submit:"Confirm",reset:"Cancel",required:"Required",description:"Description",title:"Title",text:"Text",target:"Target",width:"Width"}},plugins:{},svgPath:null,hideButtonTexts:null},Object.defineProperty(jQuery.trumbowyg,"defaultOptions",{value:{lang:"en",fixedBtnPane:!1,fixedFullWidth:!1,autogrow:!1,autogrowOnEnter:!1,imageWidthModalEdit:!1,prefix:"trumbowyg-",semantic:!0,semanticKeepAttributes:!1,resetCss:!1,removeformatPasted:!1,tabToIndent:!1,tagsToRemove:[],tagsToKeep:["hr","img","embed","iframe","input"],btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["insertImage"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["fullscreen"]],btnsDef:{},changeActiveDropdownIcon:!1,inlineElementsSelector:"a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u",pasteHandlers:[],plugins:{},urlProtocol:!1,minimalLinks:!1},writable:!1,enumerable:!0,configurable:!1}),function(navigator,window,document,$){"use strict";$.fn.trumbowyg=function(options,params){if(options===Object(options)||!options)return this.each((function(){$(this).data("trumbowyg")||$(this).data("trumbowyg",new Trumbowyg(this,options))}));if(1===this.length)try{var t=$(this).data("trumbowyg");switch(options){case"execCmd":return t.execCmd(params.cmd,params.param,params.forceCss);case"openModal":return t.openModal(params.title,params.content);case"closeModal":return t.closeModal();case"openModalInsert":return t.openModalInsert(params.title,params.fields,params.callback);case"saveRange":return t.saveRange();case"getRange":return t.range;case"getRangeText":return t.getRangeText();case"restoreRange":return t.restoreRange();case"enable":return t.setDisabled(!1);case"disable":return t.setDisabled(!0);case"toggle":return t.toggle();case"destroy":return t.destroy();case"empty":return t.empty();case"html":return t.html(params)}}catch(c){}return!1};var Trumbowyg=function(editorElem,options){var t=this,$trumbowyg=$.trumbowyg;t.doc=editorElem.ownerDocument||document,t.$ta=$(editorElem),t.$c=$(editorElem),null!=(options=options||{}).lang||null!=$trumbowyg.langs[options.lang]?t.lang=$.extend(!0,{},$trumbowyg.langs.en,$trumbowyg.langs[options.lang]):t.lang=$trumbowyg.langs.en,t.hideButtonTexts=null!=$trumbowyg.hideButtonTexts?$trumbowyg.hideButtonTexts:options.hideButtonTexts;var svgPathOption=null!=$trumbowyg.svgPath?$trumbowyg.svgPath:options.svgPath;if(t.hasSvg=!1!==svgPathOption,t.svgPath=t.doc.querySelector("base")?window.location.href.split("#")[0]:"",0===$("#trumbowyg-icons",t.doc).length&&!1!==svgPathOption){if(null==svgPathOption){for(var scriptElements=document.getElementsByTagName("script"),i=0;i<scriptElements.length;i+=1){var source=scriptElements[i].src,matches=source.match("trumbowyg(.min)?.js");null!=matches&&(svgPathOption=source.substring(0,source.indexOf(matches[0]))+"ui/icons.svg")}null==svgPathOption&&console.warn("You must define svgPath: https://goo.gl/CfTY9U")}var div=t.doc.createElement("div");div.id="trumbowyg-icons",t.doc.body.insertBefore(div,t.doc.body.childNodes[0]),$.ajax({async:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"xml",crossDomain:!0,url:svgPathOption,data:null,beforeSend:null,complete:null,success:function(data){div.innerHTML=(new XMLSerializer).serializeToString(data.documentElement)}})}var h=t.lang.header,isBlinkFunction=function(){return(window.chrome||window.Intl&&Intl.v8BreakIterator)&&"CSS"in window};t.btnsDef={viewHTML:{fn:"toggle",class:"trumbowyg-not-disable"},undo:{isSupported:isBlinkFunction,key:"Z"},redo:{isSupported:isBlinkFunction,key:"Y"},p:{fn:"formatBlock"},blockquote:{fn:"formatBlock"},h1:{fn:"formatBlock",title:h+" 1"},h2:{fn:"formatBlock",title:h+" 2"},h3:{fn:"formatBlock",title:h+" 3"},h4:{fn:"formatBlock",title:h+" 4"},h5:{fn:"formatBlock",title:h+" 5"},h6:{fn:"formatBlock",title:h+" 6"},subscript:{tag:"sub"},superscript:{tag:"sup"},bold:{key:"B",tag:"b"},italic:{key:"I",tag:"i"},underline:{tag:"u"},strikethrough:{tag:"strike"},strong:{fn:"bold",key:"B"},em:{fn:"italic",key:"I"},del:{fn:"strikethrough"},createLink:{key:"K",tag:"a"},unlink:{},insertImage:{},justifyLeft:{tag:"left",forceCss:!0},justifyCenter:{tag:"center",forceCss:!0},justifyRight:{tag:"right",forceCss:!0},justifyFull:{tag:"justify",forceCss:!0},unorderedList:{fn:"insertUnorderedList",tag:"ul"},orderedList:{fn:"insertOrderedList",tag:"ol"},horizontalRule:{fn:"insertHorizontalRule"},removeformat:{},fullscreen:{class:"trumbowyg-not-disable"},close:{fn:"destroy",class:"trumbowyg-not-disable"},formatting:{dropdown:["p","blockquote","h1","h2","h3","h4"],ico:"p"},link:{dropdown:["createLink","unlink"]}},t.o=$.extend(!0,{},$trumbowyg.defaultOptions,options),t.o.hasOwnProperty("imgDblClickHandler")||(t.o.imgDblClickHandler=t.getDefaultImgDblClickHandler()),t.urlPrefix=t.setupUrlPrefix(),t.disabled=t.o.disabled||"TEXTAREA"===editorElem.nodeName&&(editorElem.disabled||editorElem.readOnly),options.btns?t.o.btns=options.btns:t.o.semantic||(t.o.btns[3]=["bold","italic","underline","strikethrough"]),$.each(t.o.btnsDef,(function(btnName,btnDef){t.addBtnDef(btnName,btnDef)})),t.eventNamespace="trumbowyg-event",t.keys=[],t.tagToButton={},t.tagHandlers=[],t.pasteHandlers=[].concat(t.o.pasteHandlers),t.isIE=-1!==navigator.userAgent.indexOf("MSIE")||-1!==navigator.appVersion.indexOf("Trident/"),t.isMac=-1!==navigator.platform.toUpperCase().indexOf("MAC"),t.init()};Trumbowyg.prototype={DEFAULT_SEMANTIC_MAP:{b:"strong",i:"em",s:"del",strike:"del",div:"p"},init:function(){var t=this;t.height=t.$ta.height(),t.initPlugins();try{t.doc.execCommand("enableObjectResizing",!1,!1),t.doc.execCommand("defaultParagraphSeparator",!1,"p")}catch(e){}t.buildEditor(),t.buildBtnPane(),t.fixedBtnPaneEvents(),t.buildOverlay(),setTimeout((function(){t.disabled&&t.setDisabled(!0),t.$c.trigger("tbwinit")}))},addBtnDef:function(btnName,btnDef){this.btnsDef[btnName]=$.extend(btnDef,this.btnsDef[btnName]||{})},setupUrlPrefix:function(){var protocol=this.o.urlProtocol;if(protocol)return"string"!=typeof protocol?"https://":protocol.replace("://","")+"://"},buildEditor:function(){var t=this,prefix=t.o.prefix,html="";t.$box=$("<div/>",{class:prefix+"box "+prefix+"editor-visible "+prefix+t.o.lang+" trumbowyg"}),t.isTextarea=t.$ta.is("textarea"),t.isTextarea?(html=t.$ta.val(),t.$ed=$("<div/>"),t.$box.insertAfter(t.$ta).append(t.$ed,t.$ta)):(t.$ed=t.$ta,html=t.$ed.html(),t.$ta=$("<textarea/>",{name:t.$ta.attr("id"),height:t.height}).val(html),t.$box.insertAfter(t.$ed).append(t.$ta,t.$ed),t.syncCode()),t.$ta.addClass(prefix+"textarea").attr("tabindex",-1),t.$ed.addClass(prefix+"editor").attr({contenteditable:!0,dir:t.lang._dir||"ltr"}).html(html),t.o.tabindex&&t.$ed.attr("tabindex",t.o.tabindex),t.$c.is("[placeholder]")&&t.$ed.attr("placeholder",t.$c.attr("placeholder")),t.$c.is("[spellcheck]")&&t.$ed.attr("spellcheck",t.$c.attr("spellcheck")),t.o.resetCss&&t.$ed.addClass(prefix+"reset-css"),t.o.autogrow||t.$ta.add(t.$ed).css({height:t.height}),t.semanticCode(),t.o.autogrowOnEnter&&t.$ed.addClass(prefix+"autogrow-on-enter");var debounceButtonPaneStatus,ctrl=!1,composition=!1;t.$ed.on("dblclick","img",t.o.imgDblClickHandler).on("keydown",(function(e){if(!e.ctrlKey&&!e.metaKey||e.altKey){if(t.o.tabToIndent&&"Tab"===e.key)try{return e.shiftKey?t.execCmd("outdent",!0,null):t.execCmd("indent",!0,null),!1}catch(c){}}else{ctrl=!0;var key=t.keys[String.fromCharCode(e.which).toUpperCase()];try{return t.execCmd(key.fn,key.param),!1}catch(c){}}})).on("compositionstart compositionupdate",(function(){composition=!0})).on("keyup compositionend",(function(e){if("compositionend"===e.type)composition=!1;else if(composition)return;var keyCode=e.which;if(!(keyCode>=37&&keyCode<=40)){if(!e.ctrlKey&&!e.metaKey||89!==keyCode&&90!==keyCode)if(ctrl||17===keyCode)void 0===e.which&&t.semanticCode(!1,!1,!0);else{var compositionEndIE=!t.isIE||"compositionend"===e.type;t.semanticCode(!1,compositionEndIE&&13===keyCode),t.$c.trigger("tbwchange")}else t.semanticCode(!1,!0),t.$c.trigger("tbwchange");setTimeout((function(){ctrl=!1}),50)}})).on("mouseup keydown keyup",(function(e){(!e.ctrlKey&&!e.metaKey||e.altKey)&&setTimeout((function(){ctrl=!1}),50),clearTimeout(debounceButtonPaneStatus),debounceButtonPaneStatus=setTimeout((function(){t.updateButtonPaneStatus()}),50)})).on("focus blur",(function(e){if(t.$c.trigger("tbw"+e.type),"blur"===e.type&&t.clearButtonPaneStatus(),t.o.autogrowOnEnter){if(t.autogrowOnEnterDontClose)return;"focus"===e.type?(t.autogrowOnEnterWasFocused=!0,t.autogrowEditorOnEnter()):t.o.autogrow||(t.$ed.css({height:t.$ed.css("min-height")}),t.$c.trigger("tbwresize"))}})).on("cut drop",(function(){setTimeout((function(){t.semanticCode(!1,!0),t.$c.trigger("tbwchange")}),0)})).on("paste",(function(e){if(t.o.removeformatPasted){e.preventDefault(),window.getSelection&&window.getSelection().deleteFromDocument&&window.getSelection().deleteFromDocument();try{var text=window.clipboardData.getData("Text");try{t.doc.selection.createRange().pasteHTML(text)}catch(c){t.doc.getSelection().getRangeAt(0).insertNode(t.doc.createTextNode(text))}t.$c.trigger("tbwchange",e)}catch(d){t.execCmd("insertText",(e.originalEvent||e).clipboardData.getData("text/plain"))}}$.each(t.pasteHandlers,(function(i,pasteHandler){pasteHandler(e)})),setTimeout((function(){t.semanticCode(!1,!0),t.$c.trigger("tbwpaste",e),t.$c.trigger("tbwchange")}),0)})),t.$ta.on("keyup",(function(){t.$c.trigger("tbwchange")})).on("paste",(function(){setTimeout((function(){t.$c.trigger("tbwchange")}),0)})),t.$box.on("keydown",(function(e){if(27===e.which&&1===$("."+prefix+"modal-box",t.$box).length)return t.closeModal(),!1}))},autogrowEditorOnEnter:function(){var t=this;t.$ed.removeClass("autogrow-on-enter");var oldHeight=t.$ed[0].clientHeight;t.$ed.height("auto");var totalHeight=t.$ed[0].scrollHeight;t.$ed.addClass("autogrow-on-enter"),oldHeight!==totalHeight&&(t.$ed.height(oldHeight),setTimeout((function(){t.$ed.css({height:totalHeight}),t.$c.trigger("tbwresize")}),0))},buildBtnPane:function(){var t=this,prefix=t.o.prefix,$btnPane=t.$btnPane=$("<div/>",{class:prefix+"button-pane"});$.each(t.o.btns,(function(i,btnGrp){$.isArray(btnGrp)||(btnGrp=[btnGrp]);var $btnGroup=$("<div/>",{class:prefix+"button-group "+(btnGrp.indexOf("fullscreen")>=0?prefix+"right":"")});$.each(btnGrp,(function(i,btn){try{t.isSupportedBtn(btn)&&$btnGroup.append(t.buildBtn(btn))}catch(c){}})),$btnGroup.html().trim().length>0&&$btnPane.append($btnGroup)})),t.$box.prepend($btnPane)},buildBtn:function(btnName){var t=this,prefix=t.o.prefix,btn=t.btnsDef[btnName],isDropdown=btn.dropdown,hasIcon=null==btn.hasIcon||btn.hasIcon,textDef=t.lang[btnName]||btnName,$btn=$("<button/>",{type:"button",class:prefix+btnName+"-button "+(btn.class||"")+(hasIcon?"":" "+prefix+"textual-button"),html:t.hasSvg&&hasIcon?'<svg><use xlink:href="'+t.svgPath+"#"+prefix+(btn.ico||btnName).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>':t.hideButtonTexts?"":btn.text||btn.title||t.lang[btnName]||btnName,title:(btn.title||btn.text||textDef)+(btn.key?" ("+(t.isMac?"Cmd":"Ctrl")+" + "+btn.key+")":""),tabindex:-1,mousedown:function(){return isDropdown&&!$("."+btnName+"-"+prefix+"dropdown",t.$box).is(":hidden")||$("body",t.doc).trigger("mousedown"),!((t.$btnPane.hasClass(prefix+"disable")||t.$box.hasClass(prefix+"disabled"))&&!$(this).hasClass(prefix+"active")&&!$(this).hasClass(prefix+"not-disable"))&&(t.execCmd((!isDropdown?btn.fn:"dropdown")||btnName,btn.param||btnName,btn.forceCss),!1)}});if(isDropdown){$btn.addClass(prefix+"open-dropdown");var dropdownPrefix=prefix+"dropdown",dropdownOptions={class:dropdownPrefix+"-"+btnName+" "+dropdownPrefix+" "+prefix+"fixed-top "+(btn.dropdownClass||"")};dropdownOptions["data-"+dropdownPrefix]=btnName;var $dropdown=$("<div/>",dropdownOptions);$.each(isDropdown,(function(i,def){t.btnsDef[def]&&t.isSupportedBtn(def)&&$dropdown.append(t.buildSubBtn(def))})),t.$box.append($dropdown.hide())}else btn.key&&(t.keys[btn.key]={fn:btn.fn||btnName,param:btn.param||btnName});return isDropdown||(t.tagToButton[(btn.tag||btnName).toLowerCase()]=btnName),$btn},buildSubBtn:function(btnName){var t=this,prefix=t.o.prefix,btn=t.btnsDef[btnName],hasIcon=null==btn.hasIcon||btn.hasIcon;return btn.key&&(t.keys[btn.key]={fn:btn.fn||btnName,param:btn.param||btnName}),t.tagToButton[(btn.tag||btnName).toLowerCase()]=btnName,$("<button/>",{type:"button",class:prefix+btnName+"-dropdown-button "+(btn.class||"")+(btn.ico?" "+prefix+btn.ico+"-button":""),html:t.hasSvg&&hasIcon?'<svg><use xlink:href="'+t.svgPath+"#"+prefix+(btn.ico||btnName).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>'+(btn.text||btn.title||t.lang[btnName]||btnName):btn.text||btn.title||t.lang[btnName]||btnName,title:btn.key?"("+(t.isMac?"Cmd":"Ctrl")+" + "+btn.key+")":null,style:btn.style||null,mousedown:function(){return $("body",t.doc).trigger("mousedown"),t.execCmd(btn.fn||btnName,btn.param||btnName,btn.forceCss),!1}})},isSupportedBtn:function(btnName){try{return this.btnsDef[btnName].isSupported()}catch(e){}return!0},buildOverlay:function(){var t=this;return t.$overlay=$("<div/>",{class:t.o.prefix+"overlay"}).appendTo(t.$box),t.$overlay},showOverlay:function(){var t=this;$(window).trigger("scroll"),t.$overlay.fadeIn(200),t.$box.addClass(t.o.prefix+"box-blur")},hideOverlay:function(){var t=this;t.$overlay.fadeOut(50),t.$box.removeClass(t.o.prefix+"box-blur")},fixedBtnPaneEvents:function(){var t=this,fixedFullWidth=t.o.fixedFullWidth,$box=t.$box;t.o.fixedBtnPane&&(t.isFixed=!1,$(window).on("scroll."+t.eventNamespace+" resize."+t.eventNamespace,(function(){if($box){t.syncCode();var scrollTop=$(window).scrollTop(),offset=$box.offset().top+1,$buttonPane=t.$btnPane,buttonPaneOuterHeight=$buttonPane.outerHeight()-2;scrollTop-offset>0&&scrollTop-offset-t.height<0?(t.isFixed||(t.isFixed=!0,$buttonPane.css({position:"fixed",top:0,left:fixedFullWidth?0:"auto",zIndex:7}),t.$box.css({paddingTop:$buttonPane.height()})),$buttonPane.css({width:fixedFullWidth?"100%":$box.width()-1}),$("."+t.o.prefix+"fixed-top",$box).css({position:fixedFullWidth?"fixed":"absolute",top:fixedFullWidth?buttonPaneOuterHeight:buttonPaneOuterHeight+(scrollTop-offset),zIndex:15})):t.isFixed&&(t.isFixed=!1,$buttonPane.removeAttr("style"),t.$box.css({paddingTop:0}),$("."+t.o.prefix+"fixed-top",$box).css({position:"absolute",top:buttonPaneOuterHeight}))}})))},setDisabled:function(disable){var t=this,prefix=t.o.prefix;t.disabled=disable,disable?t.$ta.attr("disabled",!0):t.$ta.removeAttr("disabled"),t.$box.toggleClass(prefix+"disabled",disable),t.$ed.attr("contenteditable",!disable)},destroy:function(){var t=this,prefix=t.o.prefix;t.isTextarea?t.$box.after(t.$ta.css({height:""}).val(t.html()).removeClass(prefix+"textarea").show()):t.$box.after(t.$ed.css({height:""}).removeClass(prefix+"editor").removeAttr("contenteditable").removeAttr("dir").html(t.html()).show()),t.$ed.off("dblclick","img"),t.destroyPlugins(),t.$box.remove(),t.$c.removeData("trumbowyg"),$("body").removeClass(prefix+"body-fullscreen"),t.$c.trigger("tbwclose"),$(window).off("scroll."+t.eventNamespace+" resize."+t.eventNamespace)},empty:function(){this.$ta.val(""),this.syncCode(!0)},toggle:function(){var t=this,prefix=t.o.prefix;t.o.autogrowOnEnter&&(t.autogrowOnEnterDontClose=!t.$box.hasClass(prefix+"editor-hidden")),t.semanticCode(!1,!0),setTimeout((function(){t.doc.activeElement.blur(),t.$box.toggleClass(prefix+"editor-hidden "+prefix+"editor-visible"),t.$btnPane.toggleClass(prefix+"disable"),$("."+prefix+"viewHTML-button",t.$btnPane).toggleClass(prefix+"active"),t.$box.hasClass(prefix+"editor-visible")?t.$ta.attr("tabindex",-1):t.$ta.removeAttr("tabindex"),t.o.autogrowOnEnter&&!t.autogrowOnEnterDontClose&&t.autogrowEditorOnEnter()}),0)},dropdown:function(name){var t=this,$body=$("body",t.doc),prefix=t.o.prefix,$dropdown=$("[data-"+prefix+"dropdown="+name+"]",t.$box),$btn=$("."+prefix+name+"-button",t.$btnPane),show=$dropdown.is(":hidden");if($body.trigger("mousedown"),show){var btnOffsetLeft=$btn.offset().left;$btn.addClass(prefix+"active"),$dropdown.css({position:"absolute",top:$btn.offset().top-t.$btnPane.offset().top+$btn.outerHeight(),left:t.o.fixedFullWidth&&t.isFixed?btnOffsetLeft:btnOffsetLeft-t.$btnPane.offset().left}).show(),$(window).trigger("scroll"),$body.on("mousedown."+t.eventNamespace,(function(e){$dropdown.is(e.target)||($("."+prefix+"dropdown",t.$box).hide(),$("."+prefix+"active",t.$btnPane).removeClass(prefix+"active"),$body.off("mousedown."+t.eventNamespace))}))}},html:function(html){var t=this;return null!=html?(t.$ta.val(html),t.syncCode(!0),t.$c.trigger("tbwchange"),t):t.$ta.val()},syncTextarea:function(){var t=this;t.$ta.val(t.$ed.text().trim().length>0||t.$ed.find(t.o.tagsToKeep.join(",")).length>0?t.$ed.html():"")},syncCode:function(force){var t=this;if(!force&&t.$ed.is(":visible"))t.syncTextarea();else{var html=$("<div>").html(t.$ta.val()),safe=$("<div>").append(html);$(t.o.tagsToRemove.join(","),safe).remove(),t.$ed.html(safe.contents().html())}if(t.o.autogrow&&(t.height=t.$ed.height(),t.height!==t.$ta.css("height")&&(t.$ta.css({height:t.height}),t.$c.trigger("tbwresize"))),t.o.autogrowOnEnter){t.$ed.height("auto");var totalheight=t.autogrowOnEnterWasFocused?t.$ed[0].scrollHeight:t.$ed.css("min-height");totalheight!==t.$ta.css("height")&&(t.$ed.css({height:totalheight}),t.$c.trigger("tbwresize"))}},semanticCode:function(force,full,keepRange){var t=this;if(t.saveRange(),t.syncCode(force),t.o.semantic){if(t.semanticTag("b",t.o.semanticKeepAttributes),t.semanticTag("i",t.o.semanticKeepAttributes),t.semanticTag("s",t.o.semanticKeepAttributes),t.semanticTag("strike",t.o.semanticKeepAttributes),full){var inlineElementsSelector=t.o.inlineElementsSelector,blockElementsSelector=":not("+inlineElementsSelector+")";t.$ed.contents().filter((function(){return 3===this.nodeType&&this.nodeValue.trim().length>0})).wrap("<span data-tbw/>");var wrapInlinesInParagraphsFrom=function($from){if(0!==$from.length){var $finalParagraph=$from.nextUntil(blockElementsSelector).addBack().wrapAll("<p/>").parent(),$nextElement=$finalParagraph.nextAll(inlineElementsSelector).first();$finalParagraph.next("br").remove(),wrapInlinesInParagraphsFrom($nextElement)}};wrapInlinesInParagraphsFrom(t.$ed.children(inlineElementsSelector).first()),t.semanticTag("div",!0),t.$ed.find("p").filter((function(){return(!t.range||this!==t.range.startContainer)&&(0===$(this).text().trim().length&&0===$(this).children().not("br,span").length)})).contents().unwrap(),$("[data-tbw]",t.$ed).contents().unwrap(),t.$ed.find("p:empty").remove()}keepRange||t.restoreRange(),t.syncTextarea()}},semanticTag:function(oldTag,copyAttributes){var newTag;if(null!=this.o.semantic&&"object"==typeof this.o.semantic&&this.o.semantic.hasOwnProperty(oldTag))newTag=this.o.semantic[oldTag];else{if(!0!==this.o.semantic||!this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(oldTag))return;newTag=this.DEFAULT_SEMANTIC_MAP[oldTag]}$(oldTag,this.$ed).each((function(){var $oldTag=$(this);if(0===$oldTag.contents().length)return!1;$oldTag.wrap("<"+newTag+"/>"),copyAttributes&&$.each($oldTag.prop("attributes"),(function(){$oldTag.parent().attr(this.name,this.value)})),$oldTag.contents().unwrap()}))},createLink:function(){for(var url,title,target,t=this,documentSelection=t.doc.getSelection(),node=documentSelection.focusNode,text=(new XMLSerializer).serializeToString(documentSelection.getRangeAt(0).cloneContents());["A","DIV"].indexOf(node.nodeName)<0;)node=node.parentNode;if(node&&"A"===node.nodeName){var $a=$(node);text=$a.text(),url=$a.attr("href"),t.o.minimalLinks||(title=$a.attr("title"),target=$a.attr("target"));var range=t.doc.createRange();range.selectNode(node),documentSelection.removeAllRanges(),documentSelection.addRange(range)}t.saveRange();var options={url:{label:"URL",required:!0,value:url},text:{label:t.lang.text,value:text}};t.o.minimalLinks||Object.assign(options,{title:{label:t.lang.title,value:title},target:{label:t.lang.target,value:target}}),t.openModalInsert(t.lang.createLink,options,(function(v){var url=t.prependUrlPrefix(v.url);if(!url.length)return!1;var link=$(['<a href="',url,'">',v.text||v.url,"</a>"].join(""));return t.o.minimalLinks||(v.title.length>0&&link.attr("title",v.title),v.target.length>0&&link.attr("target",v.target)),t.range.deleteContents(),t.range.insertNode(link[0]),t.syncCode(),t.$c.trigger("tbwchange"),!0}))},prependUrlPrefix:function(url){if(!this.urlPrefix)return url;if(/^([a-z][-+.a-z0-9]*:|\/|#)/i.test(url))return url;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(url)?"mailto:"+url:this.urlPrefix+url},unlink:function(){var t=this,documentSelection=t.doc.getSelection(),node=documentSelection.focusNode;if(documentSelection.isCollapsed){for(;["A","DIV"].indexOf(node.nodeName)<0;)node=node.parentNode;if(node&&"A"===node.nodeName){var range=t.doc.createRange();range.selectNode(node),documentSelection.removeAllRanges(),documentSelection.addRange(range)}}t.execCmd("unlink",void 0,void 0,!0)},insertImage:function(){var t=this;t.saveRange();var options={url:{label:"URL",required:!0},alt:{label:t.lang.description,value:t.getRangeText()}};t.o.imageWidthModalEdit&&(options.width={}),t.openModalInsert(t.lang.insertImage,options,(function(v){t.execCmd("insertImage",v.url,!1,!0);var $img=$('img[src="'+v.url+'"]:not([alt])',t.$box);return $img.attr("alt",v.alt),t.o.imageWidthModalEdit&&$img.attr({width:v.width}),t.syncCode(),t.$c.trigger("tbwchange"),!0}))},fullscreen:function(){var isFullscreen,t=this,prefix=t.o.prefix,fullscreenCssClass=prefix+"fullscreen",fullscreenPlaceholderClass=fullscreenCssClass+"-placeholder",editorHeight=t.$box.outerHeight();t.$box.toggleClass(fullscreenCssClass),(isFullscreen=t.$box.hasClass(fullscreenCssClass))?t.$box.before($("<div/>",{class:fullscreenPlaceholderClass}).css({height:editorHeight})):$("."+fullscreenPlaceholderClass).remove(),$("body").toggleClass(prefix+"body-fullscreen",isFullscreen),$(window).trigger("scroll"),t.$c.trigger("tbw"+(isFullscreen?"open":"close")+"fullscreen")},execCmd:function(cmd,param,forceCss,skipTrumbowyg){var t=this;skipTrumbowyg=!!skipTrumbowyg||"","dropdown"!==cmd&&t.$ed.focus();try{t.doc.execCommand("styleWithCSS",!1,forceCss||!1)}catch(c){}try{t[cmd+skipTrumbowyg](param)}catch(c){try{cmd(param)}catch(e2){"insertHorizontalRule"===cmd?param=void 0:"formatBlock"===cmd&&t.isIE&&(param="<"+param+">"),t.doc.execCommand(cmd,!1,param),t.syncCode(),t.semanticCode(!1,!0)}"dropdown"!==cmd&&(t.updateButtonPaneStatus(),t.$c.trigger("tbwchange"))}},openModal:function(title,content){var t=this,prefix=t.o.prefix;if($("."+prefix+"modal-box",t.$box).length>0)return!1;t.o.autogrowOnEnter&&(t.autogrowOnEnterDontClose=!0),t.saveRange(),t.showOverlay(),t.$btnPane.addClass(prefix+"disable");var parentModal=$(t.doc).find(".modal:visible").last(),parentElement=parentModal.length>0?parentModal:$(t.doc.body),$modal=$("<div/>",{class:prefix+"modal "+prefix+"fixed-top"}).css({top:t.$box.offset().top+t.$btnPane.height(),zIndex:99999}).appendTo(parentElement);t.$overlay.one("click",(function(){return $modal.trigger("tbwcancel"),!1}));var $form=$("<form/>",{action:"",html:content}).on("submit",(function(){return $modal.trigger("tbwconfirm"),!1})).on("reset",(function(){return $modal.trigger("tbwcancel"),!1})).on("submit reset",(function(){t.o.autogrowOnEnter&&(t.autogrowOnEnterDontClose=!1)})),$box=$("<div/>",{class:prefix+"modal-box",html:$form}).css({top:"-"+t.$btnPane.outerHeight(),opacity:0}).appendTo($modal).animate({top:0,opacity:1},100);return $("<span/>",{text:title,class:prefix+"modal-title"}).prependTo($box),$modal.height($box.outerHeight()+10),$("input:first",$box).focus(),t.buildModalBtn("submit",$box),t.buildModalBtn("reset",$box),$(window).trigger("scroll"),$modal},buildModalBtn:function(n,$modal){var prefix=this.o.prefix;return $("<button/>",{class:prefix+"modal-button "+prefix+"modal-"+n,type:n,text:this.lang[n]||n}).appendTo($("form",$modal))},closeModal:function(){var t=this,prefix=t.o.prefix;t.$btnPane.removeClass(prefix+"disable"),t.$overlay.off();var $modalBox=$("."+prefix+"modal-box",$(t.doc.body));$modalBox.animate({top:"-"+$modalBox.height()},100,(function(){$modalBox.parent().remove(),t.hideOverlay()})),t.restoreRange()},openModalInsert:function(title,fields,cmd){var t=this,prefix=t.o.prefix,lg=t.lang,html="";return $.each(fields,(function(fieldName,field){var l=field.label||fieldName,n=field.name||fieldName,a=field.attributes||{},attr=Object.keys(a).map((function(prop){return prop+'="'+a[prop]+'"'})).join(" ");html+='<label><input type="'+(field.type||"text")+'" name="'+n+'"'+("checkbox"===field.type&&field.value?' checked="checked"':' value="'+(field.value||"").replace(/"/g,"&quot;"))+'"'+attr+'><span class="'+prefix+'input-infos"><span>'+(lg[l]?lg[l]:l)+"</span></span></label>"})),t.openModal(title,html).on("tbwconfirm",(function(){var $form=$("form",$(this)),valid=!0,values={};$.each(fields,(function(fieldName,field){var n=field.name||fieldName,$field=$('input[name="'+n+'"]',$form);switch($field.attr("type").toLowerCase()){case"checkbox":values[n]=$field.is(":checked");break;case"radio":values[n]=$field.filter(":checked").val();break;default:values[n]=$.trim($field.val())}field.required&&""===values[n]?(valid=!1,t.addErrorOnModalField($field,t.lang.required)):field.pattern&&!field.pattern.test(values[n])&&(valid=!1,t.addErrorOnModalField($field,field.patternError))})),valid&&(t.restoreRange(),cmd(values,fields)&&(t.syncCode(),t.$c.trigger("tbwchange"),t.closeModal(),$(this).off("tbwconfirm")))})).one("tbwcancel",(function(){$(this).off("tbwconfirm"),t.closeModal()}))},addErrorOnModalField:function($field,err){var prefix=this.o.prefix,spanErrorClass=prefix+"msg-error",$label=$field.parent();$field.on("change keyup",(function(){$label.removeClass(prefix+"input-error"),setTimeout((function(){$label.find("."+spanErrorClass).remove()}),150)})),$label.addClass(prefix+"input-error").find("input+span").append($("<span/>",{class:spanErrorClass,text:err}))},getDefaultImgDblClickHandler:function(){var t=this;return function(){var $img=$(this),src=$img.attr("src");0===src.indexOf("data:image")&&(src="(Base64)");var options={url:{label:"URL",value:src,required:!0},alt:{label:t.lang.description,value:$img.attr("alt")}};return t.o.imageWidthModalEdit&&(options.width={value:$img.attr("width")?$img.attr("width"):""}),t.openModalInsert(t.lang.insertImage,options,(function(v){return"(Base64)"!==v.url&&$img.attr({src:v.url}),$img.attr({alt:v.alt}),t.o.imageWidthModalEdit&&(parseInt(v.width)>0?$img.attr({width:v.width}):$img.removeAttr("width")),!0})),!1}},saveRange:function(){var t=this,documentSelection=t.doc.getSelection();if(t.range=null,documentSelection&&documentSelection.rangeCount){var rangeStart,savedRange=t.range=documentSelection.getRangeAt(0),range=t.doc.createRange();range.selectNodeContents(t.$ed[0]),range.setEnd(savedRange.startContainer,savedRange.startOffset),rangeStart=(range+"").length,t.metaRange={start:rangeStart,end:rangeStart+(savedRange+"").length}}},restoreRange:function(){var range,t=this,metaRange=t.metaRange,savedRange=t.range,documentSelection=t.doc.getSelection();if(savedRange){if(metaRange&&metaRange.start!==metaRange.end){var node,charIndex=0,nodeStack=[t.$ed[0]],foundStart=!1,stop=!1;for(range=t.doc.createRange();!stop&&(node=nodeStack.pop());)if(3===node.nodeType){var nextCharIndex=charIndex+node.length;!foundStart&&metaRange.start>=charIndex&&metaRange.start<=nextCharIndex&&(range.setStart(node,metaRange.start-charIndex),foundStart=!0),foundStart&&metaRange.end>=charIndex&&metaRange.end<=nextCharIndex&&(range.setEnd(node,metaRange.end-charIndex),stop=!0),charIndex=nextCharIndex}else for(var cn=node.childNodes,i=cn.length;i>0;)i-=1,nodeStack.push(cn[i])}try{documentSelection.removeAllRanges()}catch(e){}documentSelection.addRange(range||savedRange)}},getRangeText:function(){return this.range+""},clearButtonPaneStatus:function(){var t=this,prefix=t.o.prefix,activeClasses=prefix+"active-button "+prefix+"active",originalIconClass=prefix+"original-icon";$("."+prefix+"active-button",t.$btnPane).removeClass(activeClasses),$("."+originalIconClass,t.$btnPane).each((function(){$(this).find("svg use").attr("xlink:href",$(this).data(originalIconClass))}))},updateButtonPaneStatus:function(){var t=this,prefix=t.o.prefix,activeClasses=prefix+"active-button "+prefix+"active",originalIconClass=prefix+"original-icon",tags=t.getTagsRecursive(t.doc.getSelection().focusNode);t.clearButtonPaneStatus(),$.each(tags,(function(i,tag){var btnName=t.tagToButton[tag.toLowerCase()],$btn=$("."+prefix+btnName+"-button",t.$btnPane);if($btn.length>0)$btn.addClass(activeClasses);else try{var $btnSvgUse=($btn=$("."+prefix+"dropdown ."+prefix+btnName+"-dropdown-button",t.$box)).find("svg use"),dropdownBtnName=$btn.parent().data(prefix+"dropdown"),$dropdownBtn=$("."+prefix+dropdownBtnName+"-button",t.$box),$dropdownBtnSvgUse=$dropdownBtn.find("svg use");$dropdownBtn.addClass(activeClasses),t.o.changeActiveDropdownIcon&&$btnSvgUse.length>0&&($dropdownBtn.addClass(originalIconClass).data(originalIconClass,$dropdownBtnSvgUse.attr("xlink:href")),$dropdownBtnSvgUse.attr("xlink:href",$btnSvgUse.attr("xlink:href")))}catch(e){}}))},getTagsRecursive:function(element,tags){var t=this;if(tags=tags||(element&&element.tagName?[element.tagName]:[]),!element||!element.parentNode)return tags;var tag=(element=element.parentNode).tagName;return"DIV"===tag?tags:("P"===tag&&""!==element.style.textAlign&&tags.push(element.style.textAlign),$.each(t.tagHandlers,(function(i,tagHandler){tags=tags.concat(tagHandler(element,t))})),tags.push(tag),t.getTagsRecursive(element,tags).filter((function(tag){return null!=tag})))},initPlugins:function(){var t=this;t.loadedPlugins=[],$.each($.trumbowyg.plugins,(function(name,plugin){plugin.shouldInit&&!plugin.shouldInit(t)||(plugin.init(t),plugin.tagHandler&&t.tagHandlers.push(plugin.tagHandler),t.loadedPlugins.push(plugin))}))},destroyPlugins:function(){var t=this;$.each(this.loadedPlugins,(function(i,plugin){plugin.destroy&&plugin.destroy(t)}))}}}(navigator,window,document,jQuery),define("trumbowyg",(function(){})),function(o){"use strict";function r(o){return("0"+parseInt(o).toString(16)).slice(-2)}function e(o){return-1===o.search("rgb")?o.replace("#",""):"rgba(0, 0, 0, 0)"===o?"transparent":r((o=o.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/))[1])+r(o[2])+r(o[3])}function a(r,e){var l=[],a=e.o.plugins.colors,c=a[r+"List"]||a.colorList;o.each(c,(function(o,c){var f=r+c,t={fn:r,forceCss:!0,hasIcon:!1,text:e.lang["#"+c]||"#"+c,param:"#"+c,style:"background-color: #"+c+";"};a.displayAsList&&"foreColor"===r&&(t.style="color: #"+c+" !important;"),e.addBtnDef(f,t),l.push(f)}));var f=r+"Remove",t={fn:"removeFormat",hasIcon:!1,param:r,style:"background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAG0lEQVQIW2NkQAAfEJMRmwBYhoGBYQtMBYoAADziAp0jtJTgAAAAAElFTkSuQmCC);"};if(a.displayAsList&&(t.style=""),e.addBtnDef(f,t),l.push(f),a["allowCustom"+r.charAt(0).toUpperCase()+r.substr(1)]){var d=r+"Free",n={fn:function(){e.openModalInsert(e.lang[r],{color:{label:r,forceCss:!0,type:"color",value:"#FFFFFF"}},(function(o){return e.execCmd(r,o.color),!0}))},hasIcon:!1,text:"#",style:"text-indent: 0; line-height: 20px; padding: 0 5px;"};e.addBtnDef(d,n),l.push(d)}return l}o.extend(!0,o.trumbowyg,{langs:{cs:{foreColor:"Barva textu",backColor:"Barva pozadÃ­"},en:{foreColor:"Text color",backColor:"Background color",foreColorRemove:"Remove text color",backColorRemove:"Remove background color"},da:{foreColor:"Tekstfarve",backColor:"Baggrundsfarve"},fr:{foreColor:"Couleur du texte",backColor:"Couleur de fond",foreColorRemove:"Supprimer la couleur du texte",backColorRemove:"Supprimer la couleur de fond"},de:{foreColor:"Textfarbe",backColor:"Hintergrundfarbe"},nl:{foreColor:"Tekstkleur",backColor:"Achtergrondkleur"},sk:{foreColor:"Farba textu",backColor:"Farba pozadia"},zh_cn:{foreColor:"æå­é¢è²",backColor:"èæ¯é¢è²"},zh_tw:{foreColor:"æå­é¡è²",backColor:"èæ¯é¡è²"},ru:{foreColor:"Ð¦Ð²ÐµÑ ÑÐµÐºÑÑÐ°",backColor:"Ð¦Ð²ÐµÑ Ð²ÑÐ´ÐµÐ»ÐµÐ½Ð¸Ñ ÑÐµÐºÑÑÐ°"},ja:{foreColor:"æå­è²",backColor:"èæ¯è²"},tr:{foreColor:"YazÄ± rengi",backColor:"Arkaplan rengi"},pt_br:{foreColor:"Cor de fonte",backColor:"Cor de fundo"},ko:{foreColor:"ê¸ìì",backColor:"ë°°ê²½ì",foreColorRemove:"ê¸ìì ì§ì°ê¸°",backColorRemove:"ë°°ê²½ì ì§ì°ê¸°"}}});var c={colorList:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646","ffff00","f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada","fff2ca","d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5","ffe694","bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","b7dde8","fac08f","f2c314","a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","92cddc","e36c09","c09100","7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","31859b","974806","7f6000"],foreColorList:null,backColorList:null,allowCustomForeColor:!0,allowCustomBackColor:!0,displayAsList:!1};o.extend(!0,o.trumbowyg,{plugins:{color:{init:function(o){o.o.plugins.colors=o.o.plugins.colors||c;var r=o.o.plugins.colors.displayAsList?o.o.prefix+"dropdown--color-list":"",e={dropdown:a("foreColor",o),dropdownClass:r},l={dropdown:a("backColor",o),dropdownClass:r};o.addBtnDef("foreColor",e),o.addBtnDef("backColor",l)},tagHandler:function(o,r){var c,l=[];if(!o.style)return l;if(""!==o.style.backgroundColor){var a=e(o.style.backgroundColor);r.o.plugins.colors.colorList.indexOf(a)>=0?l.push("backColor"+a):l.push("backColorFree")}return""!==o.style.color?c=e(o.style.color):o.hasAttribute("color")&&(c=e(o.getAttribute("color"))),c&&(r.o.plugins.colors.colorList.indexOf(c)>=0?l.push("foreColor"+c):l.push("foreColorFree")),l}}}})}(jQuery),define("trumbowyg.colors",["trumbowyg"],(function(){})),function(s){"use strict";function a(a){var n=[];return s.each(a.o.plugins.specialchars.symbolList,(function(s,e){var l="symbol-"+(e=null===e?"&nbsp":"&#x"+e).replace(/:/g,""),c={text:e,hasIcon:!1,fn:function(){var s=String.fromCodePoint(parseInt(e.replace("&#","0")));return a.execCmd("insertText",s),!0}};a.addBtnDef(l,c),n.push(l)})),n}var n={symbolList:["0024","20AC","00A3","00A2","00A5","00A4","2030",null,"00A9","00AE","2122",null,"00A7","00B6","00C6","00E6","0152","0153",null,"2022","25CF","2023","25B6","2B29","25C6",null,"00B1","00D7","00F7","21D2","21D4","220F","2211","2243","2264","2265"]};s.extend(!0,s.trumbowyg,{langs:{en:{specialChars:"Special characters"},fr:{specialChars:"CaractÃ¨res spÃ©ciaux"},ko:{specialChars:"í¹ìë¬¸ì"}},plugins:{specialchars:{init:function(s){s.o.plugins.specialchars=s.o.plugins.specialchars||n;var e={dropdown:a(s)};s.addBtnDef("specialChars",e)}}}})}(jQuery),define("trumbowyg.specialchars",["trumbowyg"],(function(){})),function(e){"use strict";var a=function(){return"undefined"!=typeof FileReader};e.extend(!0,e.trumbowyg,{langs:{en:{base64:"Image as base64",file:"File",errFileReaderNotSupported:"FileReader is not supported by your browser.",errInvalidImage:"Invalid image file."},da:{base64:"Billede som base64",file:"Fil",errFileReaderNotSupported:"FileReader er ikke understÃ¸ttet af din browser.",errInvalidImage:"Ugyldig billedfil."},fr:{base64:"Image en base64",file:"Fichier"},cs:{base64:"VloÅ¾it obrÃ¡zek",file:"Soubor"},zh_cn:{base64:"å¾çï¼Base64ç¼ç ï¼",file:"æä»¶"},nl:{base64:"Afbeelding inline",file:"Bestand",errFileReaderNotSupported:"Uw browser ondersteunt deze functionaliteit niet.",errInvalidImage:"De gekozen afbeelding is ongeldig."},ru:{base64:"ÐÐ·Ð¾Ð±ÑÐ°Ð¶ÐµÐ½Ð¸Ðµ ÐºÐ°Ðº ÐºÐ¾Ð´ Ð² base64",file:"Ð¤Ð°Ð¹Ð»",errFileReaderNotSupported:"FileReader Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑÐ¶Ð¸Ð²Ð°ÐµÑÑÑ Ð²Ð°ÑÐ¸Ð¼ Ð±ÑÐ°ÑÐ·ÐµÑÐ¾Ð¼.",errInvalidImage:"ÐÐµÐ´Ð¾Ð¿ÑÑÑÐ¸Ð¼ÑÐ¹ ÑÐ°Ð¹Ð» Ð¸Ð·Ð¾Ð±ÑÐ°Ð¶ÐµÐ½Ð¸Ñ."},ja:{base64:"ç»å (Base64å½¢å¼)",file:"ãã¡ã¤ã«",errFileReaderNotSupported:"ããªãã®ãã©ã¦ã¶ã¼ã¯FileReaderããµãã¼ããã¦ãã¾ãã",errInvalidImage:"ç»åå½¢å¼ãæ­£ããããã¾ãã"},tr:{base64:"Base64 olarak resim",file:"Dosya",errFileReaderNotSupported:"FileReader tarayÄ±cÄ±nÄ±z tarafÄ±ndan desteklenmiyor.",errInvalidImage:"GeÃ§ersiz resim dosyasÄ±."},zh_tw:{base64:"åç(base64ç·¨ç¢¼)",file:"æªæ¡",errFileReaderNotSupported:"ä½ ççè¦½å¨ä¸æ¯æ´FileReader",errInvalidImage:"ä¸æ­£ç¢ºçæªæ¡æ ¼å¼"},pt_br:{base64:"Imagem em base64",file:"Arquivo",errFileReaderNotSupported:"FileReader nÃ£o Ã© suportado pelo seu navegador.",errInvalidImage:"Arquivo de imagem invÃ¡lido."},ko:{base64:"ê·¸ë¦¼ ë£ê¸°(base64)",file:"íì¼",errFileReaderNotSupported:"FileReaderê° íì¬ ë¸ë¼ì°ì ë¥¼ ì§ìíì§ ììµëë¤.",errInvalidImage:"ì í¨íì§ ìì íì¼"}},plugins:{base64:{shouldInit:a,init:function(i){var t={isSupported:a,fn:function(){i.saveRange();var a,t=i.openModalInsert(i.lang.base64,{file:{type:"file",required:!0,attributes:{accept:"image/*"}},alt:{label:"description",value:i.getRangeText()}},(function(l){var n=new FileReader;n.onloadend=function(a){!function(e){return/^data:image\/[a-z]?/i.test(e)}(a.target.result)?i.addErrorOnModalField(e("input[type=file]",t),i.lang.errInvalidImage):(i.execCmd("insertImage",n.result,!1,!0),e(['img[src="',n.result,'"]:not([alt])'].join(""),i.$box).attr("alt",l.alt),i.closeModal())},n.readAsDataURL(a)}));e("input[type=file]").on("change",(function(e){a=e.target.files[0]}))}};i.addBtnDef("base64",t)}}}})}(jQuery),define("trumbowyg.base64",["trumbowyg"],(function(){})),function(a){"use strict";function n(n){var i=[];return a.each(n.o.plugins.fontfamily.fontList,(function(a,e){n.addBtnDef("fontfamily_"+a,{title:'<span style="font-family: '+e.family+';">'+e.name+"</span>",hasIcon:!1,fn:function(){n.execCmd("fontName",e.family,!0)}}),i.push("fontfamily_"+a)})),i}a.extend(!0,a.trumbowyg,{langs:{en:{fontFamily:"Font"},es:{fontFamily:"Fuente"},da:{fontFamily:"Skrifttype"},fr:{fontFamily:"Police"},de:{fontFamily:"Schriftart"},nl:{fontFamily:"Lettertype"},tr:{fontFamily:"YazÄ± Tipi"},zh_tw:{fontFamily:"å­é«"},pt_br:{fontFamily:"Fonte"},ko:{fontFamily:"ê¸ê¼´"}}});var i={fontList:[{name:"Arial",family:"Arial, Helvetica, sans-serif"},{name:"Arial Black",family:"'Arial Black', Gadget, sans-serif"},{name:"Comic Sans",family:"'Comic Sans MS', Textile, cursive, sans-serif"},{name:"Courier New",family:"'Courier New', Courier, monospace"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, Charcoal, sans-serif"},{name:"Lucida Console",family:"'Lucida Console', Monaco, monospace"},{name:"Lucida Sans",family:"'Lucida Sans Uncide', 'Lucida Grande', sans-serif"},{name:"Palatino",family:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"},{name:"Tahoma",family:"Tahoma, Geneva, sans-serif"},{name:"Times New Roman",family:"'Times New Roman', Times, serif"},{name:"Trebuchet",family:"'Trebuchet MS', Helvetica, sans-serif"},{name:"Verdana",family:"Verdana, Geneva, sans-serif"}]};a.extend(!0,a.trumbowyg,{plugins:{fontfamily:{init:function(e){e.o.plugins.fontfamily=a.extend({},i,e.o.plugins.fontfamily||{}),e.addBtnDef("fontfamily",{dropdown:n(e),hasIcon:!1,text:e.lang.fontFamily})}}}})}(jQuery),define("trumbowyg.fontfamily",["trumbowyg"],(function(){})),function(e){"use strict";function t(t){var l=[];if(e.each(t.o.plugins.fontsize.sizeList,(function(e,a){t.addBtnDef("fontsize_"+a,{text:'<span style="font-size: '+a+';">'+(t.lang.fontsizes[a]||a)+"</span>",hasIcon:!1,fn:function(){t.execCmd("fontSize",e+1,!0)}}),l.push("fontsize_"+a)})),t.o.plugins.fontsize.allowCustomSize){var a="fontsize_custom",s={fn:function(){t.openModalInsert(t.lang.fontCustomSize.title,{size:{label:t.lang.fontCustomSize.label,value:t.lang.fontCustomSize.value}},(function(l){var a=t.range.startContainer.parentElement,s=t.getRangeText();if(e(a).html()===s)e(a).css("font-size",l.size);else{t.range.deleteContents();var o='<span style="font-size: '+l.size+';">'+s+"</span>",n=e(o)[0];t.range.insertNode(n)}return t.saveRange(),!0}))},text:'<span style="font-size: medium;">'+t.lang.fontsizes.custom+"</span>",hasIcon:!1};t.addBtnDef(a,s),l.push(a)}return l}e.extend(!0,e.trumbowyg,{langs:{en:{fontsize:"Font size",fontsizes:{"x-small":"Extra small",small:"Small",medium:"Regular",large:"Large","x-large":"Extra large",custom:"Custom"},fontCustomSize:{title:"Custom Font Size",label:"Font Size",value:"48px"}},es:{fontsize:"TamaÃ±o de Fuente",fontsizes:{"x-small":"Extra pequeÃ±a",small:"PegueÃ±a",medium:"Regular",large:"Grande","x-large":"Extra Grande",custom:"Customizada"},fontCustomSize:{title:"TamaÃ±o de Fuente Customizada",label:"TamaÃ±o de Fuente",value:"48px"}},da:{fontsize:"SkriftstÃ¸rrelse",fontsizes:{"x-small":"Ekstra lille",small:"Lille",medium:"Normal",large:"Stor","x-large":"Ekstra stor",custom:"Brugerdefineret"}},fr:{fontsize:"Taille de la police",fontsizes:{"x-small":"TrÃ¨s petit",small:"Petit",medium:"Normal",large:"Grand","x-large":"TrÃ¨s grand",custom:"Taille personnalisÃ©e"},fontCustomSize:{title:"Taille de police personnalisÃ©e",label:"Taille de la police",value:"48px"}},de:{fontsize:"Font size",fontsizes:{"x-small":"Sehr klein",small:"Klein",medium:"Normal",large:"GroÃ","x-large":"Sehr groÃ",custom:"Benutzerdefiniert"},fontCustomSize:{title:"Benutzerdefinierte SchriftgrÃ¶Ãe",label:"SchriftgrÃ¶Ãe",value:"48px"}},nl:{fontsize:"Lettergrootte",fontsizes:{"x-small":"Extra klein",small:"Klein",medium:"Normaal",large:"Groot","x-large":"Extra groot",custom:"Tilpasset"}},tr:{fontsize:"YazÄ± Boyutu",fontsizes:{"x-small":"Ãok KÃ¼Ã§Ã¼k",small:"KÃ¼Ã§Ã¼k",medium:"Normal",large:"BÃ¼yÃ¼k","x-large":"Ãok BÃ¼yÃ¼k",custom:"GÃ¶renek"}},zh_tw:{fontsize:"å­é«å¤§å°",fontsizes:{"x-small":"æå°",small:"å°",medium:"ä¸­",large:"å¤§","x-large":"æå¤§",custom:"èªè¨å¤§å°"},fontCustomSize:{title:"èªè¨ç¾©å­é«å¤§å°",label:"å­é«å¤§å°",value:"48px"}},pt_br:{fontsize:"Tamanho da fonte",fontsizes:{"x-small":"Extra pequeno",small:"Pequeno",regular:"MÃ©dio",large:"Grande","x-large":"Extra grande",custom:"Personalizado"},fontCustomSize:{title:"Tamanho de Fonte Personalizado",label:"Tamanho de Fonte",value:"48px"}},it:{fontsize:"Dimensioni del testo",fontsizes:{"x-small":"Molto piccolo",small:"piccolo",regular:"normale",large:"grande","x-large":"Molto grande",custom:"Personalizzato"},fontCustomSize:{title:"Dimensioni del testo personalizzato",label:"Dimensioni del testo",value:"48px"}},ko:{fontsize:"ê¸ê¼´ í¬ê¸°",fontsizes:{"x-small":"ìì£¼ ìê²",small:"ìê²",medium:"ë³´íµ",large:"í¬ê²","x-large":"ìì£¼ í¬ê²",custom:"ì¬ì©ì ì§ì "},fontCustomSize:{title:"ì¬ì©ì ì§ì  ê¸ê¼´ í¬ê¸°",label:"ê¸ê¼´ í¬ê¸°",value:"48px"}}}});var l={sizeList:["x-small","small","medium","large","x-large"],allowCustomSize:!0};e.extend(!0,e.trumbowyg,{plugins:{fontsize:{init:function(a){a.o.plugins.fontsize=e.extend({},l,a.o.plugins.fontsize||{}),a.addBtnDef("fontsize",{dropdown:t(a)})}}}})}(jQuery),define("trumbowyg.fontsize",["trumbowyg"],(function(){})),function(e){"use strict";var t={rows:8,columns:8,styler:"table"};e.extend(!0,e.trumbowyg,{langs:{en:{table:"Insert table",tableAddRow:"Add row",tableAddColumn:"Add column",tableDeleteRow:"Delete row",tableDeleteColumn:"Delete column",tableDestroy:"Delete table",error:"Error"},da:{table:"IndsÃ¦t tabel",tableAddRow:"TilfÃ¸j rÃ¦kke",tableAddColumn:"TilfÃ¸j kolonne",tableDeleteRow:"Slet rÃ¦kke",tableDeleteColumn:"Slet kolonne",tableDestroy:"Slet tabel",error:"Fejl"},de:{table:"Tabelle einfÃ¼gen",tableAddRow:"Zeile hinzufÃ¼gen",tableAddColumn:"Spalte hinzufÃ¼gen",tableDeleteRow:"Zeile lÃ¶schen",tableDeleteColumn:"Spalte lÃ¶schen",tableDestroy:"Tabelle lÃ¶schen",error:"Error"},sk:{table:"VytvoriÅ¥ tabuÄ¾ky",tableAddRow:"PridaÅ¥ riadok",tableAddColumn:"PridaÅ¥ stÄºpec",error:"Chyba"},fr:{table:"InsÃ©rer un tableau",tableAddRow:"Ajouter des lignes",tableAddColumn:"Ajouter des colonnes",tableDeleteRow:"Effacer la ligne",tableDeleteColumn:"Effacer la colonne",tableDestroy:"Effacer le tableau",error:"Erreur"},cs:{table:"VytvoÅit pÅÃ­kaz Table",tableAddRow:"PÅidat ÅÃ¡dek",tableAddColumn:"PÅidat sloupec",error:"Chyba"},ru:{table:"ÐÑÑÐ°Ð²Ð¸ÑÑ ÑÐ°Ð±Ð»Ð¸ÑÑ",tableAddRow:"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÑÑÐ¾ÐºÑ",tableAddColumn:"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÑÐ¾Ð»Ð±ÐµÑ",tableDeleteRow:"Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÑÐ¾ÐºÑ",tableDeleteColumn:"Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÐ¾Ð»Ð±ÐµÑ",tableDestroy:"Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÐ°Ð±Ð»Ð¸ÑÑ",error:"ÐÑÐ¸Ð±ÐºÐ°"},ja:{table:"è¡¨ã®æ¿å¥",tableAddRow:"è¡ã®è¿½å ",tableAddColumn:"åã®è¿½å ",error:"ã¨ã©ã¼"},tr:{table:"Tablo ekle",tableAddRow:"SatÄ±r ekle",tableAddColumn:"Kolon ekle",error:"Hata"},zh_tw:{table:"æå¥è¡¨æ ¼",tableAddRow:"å å¥è¡",tableAddColumn:"å å¥å",tableDeleteRow:"åªé¤è¡",tableDeleteColumn:"åªé¤å",tableDestroy:"åªé¤è¡¨æ ¼",error:"é¯èª¤"},id:{table:"Sisipkan tabel",tableAddRow:"Sisipkan baris",tableAddColumn:"Sisipkan kolom",tableDeleteRow:"Hapus baris",tableDeleteColumn:"Hapus kolom",tableDestroy:"Hapus tabel",error:"Galat"},pt_br:{table:"Inserir tabela",tableAddRow:"Adicionar linha",tableAddColumn:"Adicionar coluna",tableDeleteRow:"Deletar linha",tableDeleteColumn:"Deletar coluna",tableDestroy:"Deletar tabela",error:"Erro"},ko:{table:"í ë£ê¸°",tableAddRow:"ì¤ ì¶ê°",tableAddColumn:"ì¹¸ ì¶ê°",tableDeleteRow:"ì¤ ì­ì ",tableDeleteColumn:"ì¹¸ ì­ì ",tableDestroy:"í ì§ì°ê¸°",error:"ìë¬"}},plugins:{table:{init:function(l){l.o.plugins.table=e.extend(!0,{},t,l.o.plugins.table||{});var a={fn:function(){l.saveRange();var t="table",a=l.o.prefix+"dropdown",d={class:a+"-"+t+" "+a+" "+l.o.prefix+"fixed-top"};d["data-"+a]=t;var r=e("<div/>",d);if(0===l.$box.find("."+a+"-"+t).length?l.$box.append(r.hide()):r=l.$box.find("."+a+"-"+t),r.html(""),l.$box.find("."+l.o.prefix+"table-button").hasClass(l.o.prefix+"active-button"))r.append(l.buildSubBtn("tableAddRow")),r.append(l.buildSubBtn("tableAddColumn")),r.append(l.buildSubBtn("tableDeleteRow")),r.append(l.buildSubBtn("tableDeleteColumn")),r.append(l.buildSubBtn("tableDestroy"));else{for(var b=e("<table/>"),i=0;i<l.o.plugins.table.rows;i+=1)for(var s=e("<tr/>").appendTo(b),u=0;u<l.o.plugins.table.columns;u+=1)e("<td/>").appendTo(s);b.find("td").on("mouseover",o),b.find("td").on("mousedown",n),r.append(b),r.append(e('<div class="trumbowyg-table-size">1x1</div>'))}l.dropdown(t)}},o=function(t){var a=e(t.target).closest("table"),o=this.cellIndex,n=this.parentNode.rowIndex;a.find("td").removeClass("active");for(var d=0;d<=n;d+=1)for(var r=0;r<=o;r+=1)a.find("tr:nth-of-type("+(d+1)+")").find("td:nth-of-type("+(r+1)+")").addClass("active");a.next(".trumbowyg-table-size").html(o+1+"x"+(n+1))},n=function(){l.saveRange();var t=e("<table/>");l.o.plugins.table.styler&&t.attr("class",l.o.plugins.table.styler);for(var a=this.cellIndex,o=this.parentNode.rowIndex,n=0;n<=o;n+=1)for(var d=e("<tr></tr>").appendTo(t),r=0;r<=a;r+=1)e("<td/>").appendTo(d);l.range.deleteContents(),l.range.insertNode(t[0]),l.$c.trigger("tbwchange")},d={title:l.lang.tableAddRow,text:l.lang.tableAddRow,ico:"row-below",fn:function(){l.saveRange();var t=l.doc.getSelection().focusNode,a=e(t).closest("table");if(a.length>0){for(var o=e("<tr/>"),n=0;n<a.find("tr")[0].childElementCount;n+=1)e("<td/>").appendTo(o);o.appendTo(a)}l.syncCode()}},r={title:l.lang.tableAddColumn,text:l.lang.tableAddColumn,ico:"col-right",fn:function(){l.saveRange();var t=l.doc.getSelection().focusNode,a=e(t).closest("table");a.length>0&&e(a).find("tr").each((function(){e(this).find("td:last").after("<td></td>")})),l.syncCode()}},b={title:l.lang.tableDestroy,text:l.lang.tableDestroy,ico:"table-delete",fn:function(){l.saveRange();var t=l.doc.getSelection().focusNode;e(t).closest("table").remove(),l.syncCode()}},i={title:l.lang.tableDeleteRow,text:l.lang.tableDeleteRow,ico:"row-delete",fn:function(){l.saveRange();var t=l.doc.getSelection().focusNode;e(t).closest("tr").remove(),l.syncCode()}},s={title:l.lang.tableDeleteColumn,text:l.lang.tableDeleteColumn,ico:"col-delete",fn:function(){l.saveRange();var t=l.doc.getSelection().focusNode,a=e(t).closest("table"),n=e(t).closest("td").index();e(a).find("tr").each((function(){e(this).find("td:eq("+n+")").remove()})),l.syncCode()}};l.addBtnDef("table",a),l.addBtnDef("tableAddRow",d),l.addBtnDef("tableAddColumn",r),l.addBtnDef("tableDeleteRow",i),l.addBtnDef("tableDeleteColumn",s),l.addBtnDef("tableDestroy",b)}}}})}(jQuery),define("trumbowyg.table",["trumbowyg"],(function(){})),function(e){"use strict";function n(){var t=null;if(document.selection)t=document.selection.createRange().parentElement();else{var r=window.getSelection();r.rangeCount>0&&(t=r.getRangeAt(0).startContainer.parentNode)}var n=e(t).contents().closest("pre").length,o=e(t).contents().closest("code").length;n&&o?e(t).contents().unwrap("code").unwrap("pre"):n?e(t).contents().unwrap("pre"):o&&e(t).contents().unwrap("code")}e.extend(!0,e.trumbowyg,{langs:{en:{preformatted:"Code sample <pre>"},da:{preformatted:"PrÃ¦formateret <pre>"},fr:{preformatted:"Exemple de code <pre>"},it:{preformatted:"Codice <pre>"},zh_cn:{preformatted:"ä»£ç ç¤ºä¾ <pre>"},ru:{preformatted:"ÐÑÐ¸Ð¼ÐµÑ ÐºÐ¾Ð´Ð° <pre>"},ja:{preformatted:"ã³ã¼ããµã³ãã« <pre>"},tr:{preformatted:"Kod Ã¶rneÄi <pre>"},zh_tw:{preformatted:"ä»£ç¢¼ç¯ä¾ <pre>"},pt_br:{preformatted:"Exemple de cÃ³digo <pre>"},ko:{preformatted:"ì½ë ìì  <pre>"}},plugins:{preformatted:{init:function(e){var o={fn:function(){e.saveRange();var o=e.getRangeText();if(""!==o.replace(/\s/g,""))try{var a=function(){var e,t=null;return window.getSelection?(e=window.getSelection()).rangeCount&&1!==(t=e.getRangeAt(0).commonAncestorContainer).nodeType&&(t=t.parentNode):(e=document.selection)&&"Control"!==e.type&&(t=e.createRange().parentElement()),t}().tagName.toLowerCase();if("code"===a||"pre"===a)return n();e.execCmd("insertHTML","<pre><code>"+function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}(o)+"</code></pre>")}catch(p){}},tag:"pre"};e.addBtnDef("preformatted",o)}}}})}(jQuery),define("trumbowyg.preformatted",["trumbowyg"],(function(){})),function(o){"use strict";o.extend(!0,o.trumbowyg,{langs:{de:{history:{redo:"Wiederholen",undo:"RÃ¼ckgÃ¤ngig"}},en:{history:{redo:"Redo",undo:"Undo"}},da:{history:{redo:"Annuller fortryd",undo:"Fortryd"}},fr:{history:{redo:"Annuler",undo:"RÃ©tablir"}},zh_tw:{history:{redo:"éå",undo:"å¾©å"}},pt_br:{history:{redo:"Refazer",undo:"Desfazer"}},ko:{history:{redo:"ë¤ì ì¤í",undo:"ëëë¦¬ê¸°"}}},plugins:{history:{init:function(i){i.o.plugins.history=o.extend(!0,{_stack:[],_index:-1,_focusEl:void 0},i.o.plugins.history||{});var t={title:i.lang.history.redo,ico:"redo",key:"Y",fn:function(){if(i.o.plugins.history._index<i.o.plugins.history._stack.length-1){i.o.plugins.history._index+=1;var o=i.o.plugins.history._index,t=i.o.plugins.history._stack[o];i.execCmd("html",t),i.o.plugins.history._stack[o]=i.$ed.html(),l(),s()}}},n={title:i.lang.history.undo,ico:"undo",key:"Z",fn:function(){if(i.o.plugins.history._index>0){i.o.plugins.history._index-=1;var o=i.o.plugins.history._index,t=i.o.plugins.history._stack[o];i.execCmd("html",t),i.o.plugins.history._stack[o]=i.$ed.html(),l(),s()}}},s=function(){var o=i.o.plugins.history._index,t=i.o.plugins.history._stack.length,e=0!==t&&o!==t-1;r("historyUndo",o>0),r("historyRedo",e)},r=function(o,t){var n=i.$box.find(".trumbowyg-"+o+"-button");t?n.removeClass("trumbowyg-disable"):n.hasClass("trumbowyg-disable")||n.addClass("trumbowyg-disable")},d=function(o,i){if(o===i)return!0;if(null==o||null==i)return!1;if(o.length!==i.length)return!1;for(var t=0;t<o.length;t+=1)if(o[t]!==i[t])return!1;return!0},l=function(){var o=i.doc.getSelection().focusNode,t=i.doc.createRange();o.childNodes.length>0&&(t.setStartAfter(o.childNodes[o.childNodes.length-1]),t.setEndAfter(o.childNodes[o.childNodes.length-1]),i.doc.getSelection().removeAllRanges(),i.doc.getSelection().addRange(t))};i.$c.on("tbwinit tbwchange",(function(){var t,n,e=i.o.plugins.history._index,r=i.o.plugins.history._stack,l=r.slice(-1)[0]||"<p></p>",u=r[e],h=i.$ed.html(),c=i.doc.getSelection().focusNode,g="",a=i.o.plugins.history._focusEl;t=o("<div>"+l+"</div>").find("*").map((function(){return this.localName})),n=o("<div>"+h+"</div>").find("*").map((function(){return this.localName})),c&&(i.o.plugins.history._focusEl=c,g=c.outerHTML||c.textContent),h!==u&&(g.slice(-1).match(/\s/)||!d(t,n)||i.o.plugins.history._index<=0||c!==a?(i.o.plugins.history._index+=1,i.o.plugins.history._stack=r.slice(0,i.o.plugins.history._index),i.o.plugins.history._stack.push(h)):i.o.plugins.history._stack[e]=h,s())})),i.addBtnDef("historyRedo",t),i.addBtnDef("historyUndo",n)}}}})}(jQuery),define("trumbowyg.history",["trumbowyg"],(function(){})),function($){"use strict";function templateSelector(trumbowyg){var available=trumbowyg.o.plugins.templates,templates=[];return $.each(available,(function(index,template){trumbowyg.addBtnDef("template_"+index,{fn:function(){trumbowyg.execCmd("insertHTML",template.html)},hasIcon:!1,title:template.name}),templates.push("template_"+index)})),templates}$.extend(!0,$.trumbowyg,{langs:{en:{template:"Template"},da:{template:"Skabelon"},fr:{template:"Patron"},nl:{template:"Sjabloon"},ru:{template:"Ð¨Ð°Ð±Ð»Ð¾Ð½"},ja:{template:"ãã³ãã¬ã¼ã"},tr:{template:"Åablon"},zh_tw:{template:"æ¨¡æ¿"},pt_br:{template:"Modelo"},ko:{template:"ìì"}}}),$.extend(!0,$.trumbowyg,{plugins:{template:{shouldInit:function(trumbowyg){return trumbowyg.o.plugins.hasOwnProperty("templates")},init:function(trumbowyg){trumbowyg.addBtnDef("template",{dropdown:templateSelector(trumbowyg),hasIcon:!1,text:trumbowyg.lang.template})}}}})}(jQuery),define("trumbowyg.template",["trumbowyg"],(function(){})),define("pgui.editors/html",["pgui.editors/plain","underscore","trumbowyg","trumbowyg.colors","trumbowyg.specialchars","trumbowyg.base64","trumbowyg.fontfamily","trumbowyg.fontsize","trumbowyg.table","trumbowyg.preformatted","trumbowyg.history","trumbowyg.template"],(function(PlainEditor){return $.trumbowyg.svgPath="components/assets/img/vendor/trumbowyg/trumbowyg-icons.svg",PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback);var self=this,templates=[];rootElement.closest(".form-group").find(".html-templates").children().each((function(i,el){var $el=$(el);templates.push({name:$el.data("template-name"),html:$el.html()})})),rootElement.trumbowyg({resetCss:!0,btnsDef:{image:{dropdown:["insertImage","base64"],ico:"insertImage"}},btns:[["viewHTML"],["historyUndo","historyRedo"],["formatting"],["strong","em","underline","del"],["superscript","subscript"],["fontfamily","fontsize"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["link"],["table","image","specialChars"],["template"],["foreColor","backColor"],"btnGrp-justify","btnGrp-lists",["preformatted"],["horizontalRule"],["removeformat"],["fullscreen"]],plugins:{templates:templates}}),this.rootElement.on("tbwchange",(function(){self.doChanged()}))},getValue:function(value){return this.rootElement.trumbowyg("html")},setValue:function(value){return this.rootElement.trumbowyg("html",value),this},setEnabled:function(value){return this._super(value),this.rootElement.trumbowyg(value?"enable":"disable"),this},setReadonly:function(value){return this._super(value),this.setEnabled(!value),this},destroy:function(){this.rootElement.trumbowyg("destroy")}})})),define("pgui.editors/image_uploader",["pgui.editors/plain"],(function(PlainEditor){return PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback);var $formGroup=rootElement.closest(".form-group"),$btnGroup=$formGroup.find(".btn-group[data-toggle-name]"),$toggleTarget=$formGroup.find("[name="+$btnGroup.data("toggle-name")+"]");this.$replaceButton=$btnGroup.find(".js-replace").first(),this.$image=$formGroup.find("img").first(),this.isImageBased=1==this.$image.length,this.oldImageSource=this.$image.attr("src"),this.newImageSource=this.oldImageSource;var self=this;$btnGroup.on("click","button",(function(){$btnGroup.find("button").removeClass("active");var $button=$(this).addClass("active");$toggleTarget.val($button.val()),self.isImageBased&&self._setImageProperties($button.val())})),$btnGroup.find("button[value="+$toggleTarget.val()+"]").addClass("active")},doChanged:function(){this.isImageBased?this._processNewImage():(this.$replaceButton.prop("disabled",!1),this.$replaceButton.click()),this._super()},_setImageProperties:function(action){this.$image.toggle("Remove"!=action),"Keep"==action?this.$image.attr("src",this.oldImageSource):"Replace"==action&&this.$image.attr("src",this.newImageSource)},_processNewImage:function(){var self=this,reader=new FileReader;reader.addEventListener("load",(function(){self.newImageSource=reader.result,self.$replaceButton.prop("disabled",!1),self.$replaceButton.click()}),!1);var file=this.rootElement.get(0).files[0];file&&reader.readAsDataURL(file)}})})),define("pgui.editors/multivalue_select",["underscore","pgui.editors/custom","libs/select2","locales/select2_locale"],(function(_,CustomEditor){return CustomEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback);var self=this,$el=$(rootElement),maxSelectionSize=$el.attr("data-max-selection-size"),placeholder=$el.attr("data-placeholder");$el.select2({width:"100%",maximumSelectionSize:maxSelectionSize,placeholder:placeholder}),$el.attr("readonly")&&this.setReadonly(!0),$("label[for="+$el.attr("id")+"]").on("click",(function(){$el.select2("focus")})),$el.on("change",(function(){if("function"==typeof $el.valid){var $form=$(this.form);$form.length&&_.keys($form.data("validator").submitted).length&&$el.valid()}self.doChanged()}))},getValue:function(){return this.rootElement.select2("val")},getDisplayValue:function(){return _.map(this.rootElement.select2("data"),(function(item){return item.text}))},setValue:function(value){return value.split?this.rootElement.select2("val",value.split(",")):_.isArray(value)?this.rootElement.select2("val",value):console.error("'value' must be string or array, '"+typeof value+"' given"),this},getEnabled:function(){return!this.rootElement.prop("disabled")},setEnabled:function(value){return this.rootElement.prop("disabled",!value),this.rootElement.select2("enable",!!value),this},getReadonly:function(){return!!this.rootElement.data("readonly")},setReadonly:function(value){return this.rootElement.select2("readonly",!!value),this.rootElement.data("readonly",!!value),this},addItem:function(value,caption){return this.rootElement.append($("<option value='"+value+"'>"+caption+"</option>")),this},removeItem:function(value){return this.rootElement.find("option[value="+value+"]").remove(),this},getItems:function(){return this.rootElement.find("option").map((function(i,option){var $option=$(option);return{value:$option.val(),caption:$option.text()}}))},getItemCount:function(){return this.rootElement.find("option").length},clear:function(){return this.rootElement.find("option").remove(),this},isMultivalue:function(){return!0}})})),define("pgui.editors/remote_multivalue_select",["underscore","pgui.editors/custom","libs/select2","locales/select2_locale"],(function(_,CustomEditor){return CustomEditor.extend({init:function(rootElement,readyCallback){this.queryFunction=function(term){return{term:term}},this._super(rootElement,readyCallback);var $el=$(rootElement),maxSelectionSize=$el.attr("data-max-selection-size"),self=this;this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey,record){var currentValue=this.getValue(),storedValue=record[$insertButton.data("stored-field-name")];currentValue.push(storedValue.toString()),this.setValue(currentValue)}.bind(this)),$el.on("change",this.doChanged.bind(this)),$el.select2({multiple:!0,maximumSelectionSize:maxSelectionSize,ajax:{url:$el.attr("data-url"),dataType:"json",results:function(data){return{results:$.map(data,(function(item){return{id:item.id,text:item.value,fields:item.fields}}))}},data:function(term){return self.queryFunction(term)}},initSelection:function(element,callback){if(0!==element.val().length){var ids=element.val().split(","),results=[];_.each(ids,(function(id,i){results.push({id:id})}));var counter=0;_.each(ids,(function(id,i){$.ajax({url:$el.data("url"),data:{id:id},dataType:"json"}).done((function(data){$.each(data,(function(k,item){if(item.id==id)return counter++,results[i].text=item.value,results[i].fields=item.fields,counter===ids.length&&(callback(results),self.rootElement.trigger("select2-init")),!1}))}))}))}else callback([])},width:"100%"})},getValue:function(){return this.rootElement.select2("val")},getDisplayValue:function(){return _.map(this.rootElement.select2("data"),(function(item){return item.text}))},setValue:function(value){return value.split?this.rootElement.select2("val",value.split(",")):_.isArray(value)?this.rootElement.select2("val",value):console.error("'value' must be string or array, '"+typeof value+"' given"),this},getEnabled:function(){return!this.rootElement.prop("disabled")},setEnabled:function(value){return this.rootElement.prop("disabled",!value),this.rootElement.select2("enable",!!value),this},getReadonly:function(){return!!this.rootElement.data("readonly")},setReadonly:function(value){return this.rootElement.select2("readonly",!!value),this.rootElement.data("readonly",!!value),this},isMultivalue:function(){return!0},setQueryFunction:function(fn){return this.queryFunction=fn,this}})})),define("pgui.editors/radio",["pgui.editors/custom","underscore"],(function(CustomEditor,_){var inputTemplateString='<input type="radio" name="<%=editorName%>" value="<%=value%>"><%=caption%>',stackedItemTemplate=_.template('<div class="radio js-value"><label>'+inputTemplateString+"</label></div>"),inlineItemTemplate=_.template('<label class="radio-inline js-value">'+inputTemplateString+"</label>");return CustomEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback),this.rootElement.find("input").change(_.bind((function(){this.doChanged()}),this)),this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey,record){this.addItem(primaryKey,record[$insertButton.data("display-field-name")]),this.setValue(primaryKey)}.bind(this))},getValue:function(){return this.rootElement.find("input:checked").val()},setValue:function(value){return this.rootElement.find("input").each((function(i,item){$(item).attr("value")==value&&$(item).prop("checked",!0)})),this},getEnabled:function(){return this.rootElement.find("input:enabled").length>0},setEnabled:function(value){return this.rootElement.find("input").each((function(i,item){value?$(item).removeAttr("disabled"):$(item).attr("disabled",!0)})),this},getReadonly:function(){return 1===this.rootElement.find("input:enabled").length},setReadonly:function(value){return this.rootElement.find("input").each((function(i,item){value?$(item).attr("checked")||$(item).attr("disabled",!0):$(item).removeAttr("disabled")})),this},clear:function(){return this.rootElement.find(".radio, .radio-inline").remove(),this},addItem:function(value,caption){var $editor=this.rootElement,isInline=$editor.data("inline"),data={editorName:$editor.attr("data-editor-name"),value:value,caption:caption},$newItem=$(isInline?inlineItemTemplate(data):stackedItemTemplate(data));return this.getItemCount()>0?$editor.find(".js-value").last().after($newItem):$editor.prepend($newItem),this},removeItem:function(value){return this.rootElement.find("input[value='"+value+"']").parent().remove(),this},getItems:function(){return this.rootElement.find("input").map((function(i,item){return{value:$(item).attr("value"),caption:$(item).closest("label").text()}}))},getItemCount:function(){return this.rootElement.find("input").length},getCaption:function(){return this.rootElement.find("input:checked").parent().text()},_getSetRequiredTarget:function(){return this.rootElement.find("input[type=radio]")}})})),define("pgui.editors/text",["pgui.editors/plain"],(function(PlainEditor){return PlainEditor.extend({getPlaceholder:function(){return this._getAttribute("placeholder")},setPlaceholder:function(value){return this._setAttribute("placeholder",value),this}})})),function(a){"function"==typeof define&&define.amd?define("jquery.maskedinput",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}((function(a){var b,c=navigator.userAgent,d=/iphone/i.test(c),e=/chrome/i.test(c),f=/android/i.test(c);a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},a.fn.extend({caret:function(a,b){var c;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof a?(b="number"==typeof b?b:a,this.each((function(){this.setSelectionRange?this.setSelectionRange(a,b):this.createTextRange&&((c=this.createTextRange()).collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select())}))):(this[0].setSelectionRange?(a=this[0].selectionStart,b=this[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length),{begin:a,end:b})},unmask:function(){return this.trigger("unmask")},mask:function(c,g){var i,j,k,l,m,n,o;if(!c&&this.length>0){var p=a(this[0]).data(a.mask.dataName);return p?p():void 0}return g=a.extend({autoclear:a.mask.autoclear,placeholder:a.mask.placeholder,completed:null},g),i=a.mask.definitions,j=[],k=n=c.length,l=null,a.each(c.split(""),(function(a,b){"?"==b?(n--,k=a):i[b]?(j.push(new RegExp(i[b])),null===l&&(l=j.length-1),k>a&&(m=j.length-1)):j.push(null)})),this.trigger("unmask").each((function(){function h(){if(g.completed){for(var a=l;m>=a;a++)if(j[a]&&C[a]===p(a))return;g.completed.call(B)}}function p(a){return g.placeholder.charAt(a<g.placeholder.length?a:0)}function q(a){for(;++a<n&&!j[a];);return a}function s(a,b){var c,d;if(!(0>a)){for(c=a,d=q(b);n>c;c++)if(j[c]){if(!(n>d&&j[c].test(C[d])))break;C[c]=C[d],C[d]=p(d),d=q(d)}z(),B.caret(Math.max(l,a))}}function v(){A(),B.val()!=E&&B.change()}function y(a,b){var c;for(c=a;b>c&&n>c;c++)j[c]&&(C[c]=p(c))}function z(){B.val(C.join(""))}function A(a){var b,c,d,e=B.val(),f=-1;for(b=0,d=0;n>b;b++)if(j[b]){for(C[b]=p(b);d++<e.length;)if(c=e.charAt(d-1),j[b].test(c)){C[b]=c,f=b;break}if(d>e.length){y(b+1,n);break}}else C[b]===e.charAt(d)&&d++,k>b&&(f=b);return a?z():k>f+1?g.autoclear||C.join("")===D?(B.val()&&B.val(""),y(0,n)):z():(z(),B.val(B.val().substring(0,f+1))),k?b:l}var B=a(this),C=a.map(c.split(""),(function(a,b){return"?"!=a?i[a]?p(b):a:void 0})),D=C.join(""),E=B.val();B.data(a.mask.dataName,(function(){return a.map(C,(function(a,b){return j[b]&&a!=p(b)?a:null})).join("")})),B.one("unmask",(function(){B.off(".mask").removeData(a.mask.dataName)})).on("focus.mask",(function(){var a;B.prop("readonly")||(clearTimeout(b),E=B.val(),a=A(),b=setTimeout((function(){B.get(0)===document.activeElement&&(z(),a==c.replace("?","").length?B.caret(0,a):B.caret(a))}),10))})).on("blur.mask",v).on("keydown.mask",(function(a){if(!B.prop("readonly")){var b,c,e,f=a.which||a.keyCode;o=B.val(),8===f||46===f||d&&127===f?(c=(b=B.caret()).begin,(e=b.end)-c==0&&(c=46!==f?function(a){for(;--a>=0&&!j[a];);return a}(c):e=q(c-1),e=46===f?q(e):e),y(c,e),s(c,e-1),a.preventDefault()):13===f?v.call(this,a):27===f&&(B.val(E),B.caret(0,A()),a.preventDefault())}})).on("keypress.mask",(function(b){if(!B.prop("readonly")){var c,d,e,g=b.which||b.keyCode,i=B.caret();if(!(b.ctrlKey||b.altKey||b.metaKey||32>g)&&g&&13!==g){if(i.end-i.begin!=0&&(y(i.begin,i.end),s(i.begin,i.end-1)),c=q(i.begin-1),n>c&&(d=String.fromCharCode(g),j[c].test(d))){if(function(a){var b,c,d,e;for(b=a,c=p(a);n>b;b++)if(j[b]){if(d=q(b),e=C[b],C[b]=c,!(n>d&&j[d].test(e)))break;c=e}}(c),C[c]=d,z(),e=q(c),f){setTimeout((function(){a.proxy(a.fn.caret,B,e)()}),0)}else B.caret(e);i.begin<=m&&h()}b.preventDefault()}}})).on("input.mask paste.mask",(function(){B.prop("readonly")||setTimeout((function(){var a=A(!0);B.caret(a),h()}),0)})),e&&f&&B.off("input.mask").on("input.mask",(function(){var a=B.val(),b=B.caret();if(o&&o.length&&o.length>a.length){for(A(!0);b.begin>0&&!j[b.begin-1];)b.begin--;if(0===b.begin)for(;b.begin<l&&!j[b.begin];)b.begin++;B.caret(b.begin,b.begin)}else{for(A(!0);b.begin<n&&!j[b.begin];)b.begin++;B.caret(b.begin,b.begin)}h()})),A()}))}})})),define("pgui.editors/mask",["pgui.editors/plain","jquery.maskedinput"],(function(PlainEditor){return PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback),""!=rootElement.attr("mask")&&rootElement.mask(rootElement.attr("mask"))}})})),define("pgui.editors/cascading_combobox",["pgui.editors/custom","pgui.editors/combobox","jquery.query"],(function(CustomEditor,Combobox){return CustomEditor.extend({init:function(rootElement,readyCallback){this.levels=[],this._processElement(rootElement),this._super(rootElement,readyCallback),this.setReadonly(this.getReadonly()),this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey,record){for(var $level=$insertButton.closest(".input-group").find("select"),i=0;i<this.levels.length;i++)this.levels[i].rootElement.attr("data-id")==$level.attr("data-id")&&(this._addLevelValue(this.levels[i],$insertButton,primaryKey,record[$insertButton.data("display-field-name")]),i==this.levels.length-1&&this.doChanged())}.bind(this))},_processElement:function(rootElement){var $rootElement=$(rootElement),self=this,$levels=$rootElement.find("select");$levels.each((function(index,item){var $item=$(item);self.levels.push(new Combobox($item))}));for(var i=0;i<self.levels.length;i++)!function(){var level=self.levels[i],parentLevel=i-1<0?null:self.levels[i-1];if(parentLevel){var $insertButton=level.rootElement.closest("td").find(".js-nested-insert");self.updateNestedInsertLink(parentLevel,level,$insertButton),level.setEnabled(parentLevel.getValue()&&parentLevel.getEnabled()),$insertButton.prop("disabled",!level.getEnabled()),parentLevel.onChange((function(){var enabled=this.getValue()&&this.getEnabled();level.setEnabled(!1),$insertButton.prop("disabled",!0),level.clear(),level.doChanged(),enabled&&$.ajax({url:level.rootElement.data("url"),data:{term2:parentLevel.getValue()},dataType:"json"}).done((function(data){$.each(data,(function(k,item){level.addItem(item.id,item.value)})),level.setEnabled(!0),$insertButton.prop("disabled",!1),self.updateNestedInsertLink(parentLevel,level,$insertButton)}))}))}}();$levels.eq($levels.length-1).on("change",(function(){self.doChanged()}))},_addLevelValue:function(level,$insertButton,value,displayValue){level.addItem(value,displayValue),level.setValue(value),level.doChanged()},updateNestedInsertLink:function(parentLevel,level,$insertButton){if(parentLevel.getValue()&&$insertButton.length>0){var url=jQuery.query.load($insertButton.data("content-link")).set("parent-field-name",level.rootElement.data("parent-link-field-name")).set("parent-field-value",parentLevel.getValue()).toString();$insertButton.data("content-link",url)}},_getMainControl:function(){return this.rootElement.find("[data-editor-main]")},getValue:function(){return this._getMainControl().val()},setReadonly:function(value){value?(this.rootElement.attr("readonly","readonly"),this.rootElement.find(".js-nested-insert").attr("disabled","disabled")):(this.rootElement.removeAttr("readonly"),this.rootElement.find(".js-nested-insert").removeAttr("disabled"));for(var i=0;i<this.levels.length;i++){this.levels[i].setReadonly(value)}return this},getReadonly:function(){return Boolean(this.rootElement.attr("readonly"))}})})),define("pgui.editors/dynamic_cascading_combobox",["underscore","pgui.editors/custom","pgui.editors/select2_format","locales/select2_locale","libs/select2"],(function(_,CustomEditor,FormatFunctions){return CustomEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback),this.formatFunctions=new FormatFunctions,this._processElement(rootElement),this.bind("submit.pgui.nested-insert",function($insertButton,primaryKey,record){var $level=$insertButton.closest(".input-group").find("input[name]");$level.length>0&&this.setLevelValue($level,primaryKey,record[$insertButton.data("display-field-name")])}.bind(this))},_processElement:function(rootElement){var $rootElement=$(rootElement),self=this,$inputs=$rootElement.find("input");$inputs.each((function(index,el){var $el=$(el),parentAttr=$el.data("parent-level"),$parentAutoComplete=$rootElement.find("[data-id="+parentAttr+"]"),$insertButton=$el.closest(".input-group").find(".js-nested-insert"),refreshWaitingForParent=function(){var isReadonly=!$parentAutoComplete.val()||$parentAutoComplete.prop("readonly");$el.prop("readonly",isReadonly),$el.select2("readonly",isReadonly),$insertButton.prop("disabled",isReadonly),$parentAutoComplete.length>0&&self.updateNestedInsertLink($parentAutoComplete,$el,$insertButton)};parentAttr&&$parentAutoComplete&&($parentAutoComplete.on("change select2-data-change",(function(){refreshWaitingForParent(),$el.trigger("change",!$el.val()),$el.select2("val",null)})),refreshWaitingForParent()),self.formatFunctions.setFormatCallbacksFromElement($el,index),$el.select2({ajax:{url:$el.attr("data-url"),data:function(term){var params={term:term};return parentAttr&&(params.term2=$parentAutoComplete.val()),params},dataType:"json",method:"GET",results:function(data){return{results:$.map(data,(function(item){return{id:item.id,text:item.value}}))}}},initSelection:function(item,callback){callback({id:item.val(),text:item.data("init-text")})},width:"resolve",allowClear:$el.data("allowclear"),minimumInputLength:$el.data("minimal-input-length"),formatSelection:self.formatFunctions.getFormatClojure("selection",index),formatResult:self.formatFunctions.getFormatClojure("result",index)})})),$inputs.eq($inputs.length-1).on("change",(function(e,ignoreInternal){self.setState("normal"),ignoreInternal||self.doChanged()}))},_getMainControl:function(){return this.rootElement.find("[data-multileveledit-main]")},getValue:function(){return this._getMainControl().val()},getData:function(){return this.rootElement.find("input[type=hidden]").map((function(i,el){return $(el).select2("data")}))},setData:function(data){return this.rootElement.find("input[type=hidden]").each(function(i,el){data[i]&&$(el).select2("data",data[i]).trigger("select2-data-change")}.bind(this)),this},getEnabled:function(){return!this.rootElement.find("input[name]").first().prop("disabled")},setEnabled:function(value){var $inputs=this.rootElement.find("input[name]");return $inputs.prop("disabled",!value),$inputs.select2("enable",!!value),this},getReadonly:function(){return!!this.rootElement.find("input[name]").first().prop("readonly")},setReadonly:function(value){var $inputs=this.rootElement.find("input[name]");return $inputs.prop("readonly",!!value),$inputs.select2("readonly",!!value),this},setFormatSelection:function(level,callback){return this.formatFunctions.setCallback("selection",callback,level),this._triggerChangeLevel(level),this},setFormatResult:function(level,callback){return this.formatFunctions.setCallback("result",callback,level),this._triggerChangeLevel(level),this},_getSetRequiredTarget:function(){return this.rootElement.find("input[data-id]").last()},_triggerChangeLevel:function(level){var $el=$(this.rootElement).find("input[type=hidden]").eq(level);$el?$el.select2&&$el.select2("data",$el.select2("data")):console.error("invalid level "+level)},setLevelValue:function($level,value,displayValue){$level.val(value),$level.data("init-text",displayValue),$level.select2&&($level.select2("val",$level.val()),$level.trigger("change"))},updateNestedInsertLink:function(parentLevel,level,$insertButton){if(parentLevel.val()&&$insertButton.length>0){var url=jQuery.query.load($insertButton.data("content-link")).set("parent-field-name",level.data("parent-link-field-name")).set("parent-field-value",parentLevel.val()).toString();$insertButton.data("content-link",url)}}})})),define("pgui.editors/static_editor",["pgui.editors/custom"],(function(CustomEditor){return CustomEditor.extend({getValue:function(){return this.rootElement.html()},setValue:function(value){return this.rootElement.html(value),this}})})),
/*!
 * bootstrap-fileinput v4.4.7
 * http://plugins.krajee.com/file-input
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2017, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md
 */
function(factory){"use strict";"function"==typeof define&&define.amd?define("bootstrap-file-input",["jquery"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("jquery")):factory(window.jQuery)}((function($){"use strict";var $h,FileInput;$.fn.fileinputLocales={},$.fn.fileinputThemes={},String.prototype.setTokens=function(replacePairs){var key,re,str=this.toString();for(key in replacePairs)replacePairs.hasOwnProperty(key)&&(re=new RegExp("{"+key+"}","g"),str=str.replace(re,replacePairs[key]));return str},$h={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||window.webkitURL,compare:function(input,str,exact){return void 0!==input&&(exact?input===str:input.match(str))},isIE:function(ver){if("Microsoft Internet Explorer"!==navigator.appName)return!1;if(10===ver)return new RegExp("msie\\s"+ver,"i").test(navigator.userAgent);var status,div=document.createElement("div");return div.innerHTML="\x3c!--[if IE "+ver+"]> <i></i> <![endif]--\x3e",status=div.getElementsByTagName("i").length,document.body.appendChild(div),div.parentNode.removeChild(div),status},initModal:function($modal){var $body=$("body");$body.length&&$modal.appendTo($body)},isEmpty:function(value,trim){return null==value||0===value.length||trim&&""===$.trim(value)},isArray:function(a){return Array.isArray(a)||"[object Array]"===Object.prototype.toString.call(a)},ifSet:function(needle,haystack,def){return def=def||"",haystack&&"object"==typeof haystack&&needle in haystack?haystack[needle]:def},cleanArray:function(arr){return arr instanceof Array||(arr=[]),arr.filter((function(e){return null!=e}))},spliceArray:function(arr,index){var i,j=0,out=[];if(!(arr instanceof Array))return[];for(i=0;i<arr.length;i++)i!==index&&(out[j]=arr[i],j++);return out},getNum:function(num,def){return def=def||0,"number"==typeof num?num:("string"==typeof num&&(num=parseFloat(num)),isNaN(num)?def:num)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var div=document.createElement("div");return!$h.isIE(9)&&(void 0!==div.draggable||void 0!==div.ondragstart&&void 0!==div.ondrop)},hasFileUploadSupport:function(){return $h.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&Boolean(new Blob)}catch(e){return!1}},hasArrayBufferViewSupport:function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}},dataURI2Blob:function(dataURI){var byteStr,arrayBuffer,intArray,i,mimeStr,bb,BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,canBlob=$h.hasBlobSupport();if(!((canBlob||BlobBuilder)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;for(byteStr=dataURI.split(",")[0].indexOf("base64")>=0?atob(dataURI.split(",")[1]):decodeURIComponent(dataURI.split(",")[1]),arrayBuffer=new ArrayBuffer(byteStr.length),intArray=new Uint8Array(arrayBuffer),i=0;i<byteStr.length;i+=1)intArray[i]=byteStr.charCodeAt(i);return mimeStr=dataURI.split(",")[0].split(":")[1].split(";")[0],canBlob?new Blob([$h.hasArrayBufferViewSupport()?intArray:arrayBuffer],{type:mimeStr}):((bb=new BlobBuilder).append(arrayBuffer),bb.getBlob(mimeStr))},arrayBuffer2String:function(buffer){if(window.TextDecoder)return new TextDecoder("utf-8").decode(buffer);var len,c,char2,char3,array=Array.prototype.slice.apply(new Uint8Array(buffer)),out="",i=0;for(len=array.length;i<len;)switch((c=array[i++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=String.fromCharCode(c);break;case 12:case 13:char2=array[i++],out+=String.fromCharCode((31&c)<<6|63&char2);break;case 14:char2=array[i++],char3=array[i++],out+=String.fromCharCode((15&c)<<12|(63&char2)<<6|63&char3)}return out},isHtml:function(str){var a=document.createElement("div");a.innerHTML=str;for(var c=a.childNodes,i=c.length;i--;)if(1===c[i].nodeType)return!0;return!1},isSvg:function(str){return str.match(/^\s*<\?xml/i)&&(str.match(/<!DOCTYPE svg/i)||str.match(/<svg/i))},getMimeType:function(signature,contents,type){switch(signature){case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"89504E47":return"image/png";case"47494638":return"image/gif";case"49492a00":return"image/tiff";case"52494646":return"image/webp";case"66747970":return"video/3gp";case"4f676753":return"video/ogg";case"1a45dfa3":return"video/mkv";case"000001ba":case"000001b3":return"video/mpeg";case"3026b275":return"video/wmv";case"25504446":return"application/pdf";case"25215053":return"application/ps";case"504b0304":case"504b0506":case"504b0508":return"application/zip";case"377abcaf":return"application/7z";case"75737461":return"application/tar";case"7801730d":return"application/dmg";default:switch(signature.substring(0,6)){case"435753":return"application/x-shockwave-flash";case"494433":return"audio/mp3";case"425a68":return"application/bzip";default:switch(signature.substring(0,4)){case"424d":return"image/bmp";case"fffb":return"audio/mp3";case"4d5a":return"application/exe";case"1f9d":case"1fa0":return"application/zip";case"1f8b":return"application/gzip";default:return contents&&!contents.match(/[^\u0000-\u007f]/)?"application/text-plain":type}}}},addCss:function($el,css){$el.removeClass(css).addClass(css)},getElement:function(options,param,value){return $h.isEmpty(options)||$h.isEmpty(options[param])?value:$(options[param])},uniqId:function(){return Math.round((new Date).getTime())+"_"+Math.round(100*Math.random())},htmlEncode:function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(str,tags){var out=str;return tags?($.each(tags,(function(key,value){"function"==typeof value&&(value=value()),out=out.split(key).join(value)})),out):out},cleanMemory:function($thumb){var data=$thumb.is("img")?$thumb.attr("src"):$thumb.find("source").attr("src");$h.objUrl.revokeObjectURL(data)},findFileName:function(filePath){var sepIndex=filePath.lastIndexOf("/");return-1===sepIndex&&(sepIndex=filePath.lastIndexOf("\\")),filePath.split(filePath.substring(sepIndex,sepIndex+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(maximize){var doc=document,de=doc.documentElement;de&&maximize&&!$h.checkFullScreen()?de.requestFullscreen?de.requestFullscreen():de.msRequestFullscreen?de.msRequestFullscreen():de.mozRequestFullScreen?de.mozRequestFullScreen():de.webkitRequestFullscreen&&de.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):doc.exitFullscreen?doc.exitFullscreen():doc.msExitFullscreen?doc.msExitFullscreen():doc.mozCancelFullScreen?doc.mozCancelFullScreen():doc.webkitExitFullscreen&&doc.webkitExitFullscreen()},moveArray:function(arr,oldIndex,newIndex){if(newIndex>=arr.length)for(var k=newIndex-arr.length;1+k--;)arr.push(void 0);return arr.splice(newIndex,0,arr.splice(oldIndex,1)[0]),arr},cleanZoomCache:function($el){var $cache=$el.closest(".kv-zoom-cache-theme");$cache.length||($cache=$el.closest(".kv-zoom-cache")),$cache.remove()},setOrientation:function(buffer,callback){var maxBytes,uInt16,scanner=new DataView(buffer),idx=0,value=1;if(65496!==scanner.getUint16(idx)||buffer.length<2)callback&&callback();else{for(idx+=2,maxBytes=scanner.byteLength;idx<maxBytes-2;)switch(uInt16=scanner.getUint16(idx),idx+=2,uInt16){case 65505:maxBytes=scanner.getUint16(idx)-idx,idx+=2;break;case 274:value=scanner.getUint16(idx+6,!1),maxBytes=0}callback&&callback(value)}},validateOrientation:function(file,callback){if(window.FileReader&&window.DataView){var buffer,reader=new FileReader;reader.onloadend=function(){buffer=reader.result,$h.setOrientation(buffer,callback)},reader.readAsArrayBuffer(file)}},adjustOrientedImage:function($img,isZoom){var newTop;$img.hasClass("is-portrait-gt4")&&(isZoom?$img.css({width:$img.parent().height()}):($img.css({height:"auto",width:$img.height()}),newTop=$img.parent().offset().top-$img.offset().top,$img.css("margin-top",newTop)))},closeButton:function(css){return'<button type="button" class="'+(css=css?"close "+css:"close")+'" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>'}},(FileInput=function(element,options){this.$element=$(element),this.$parent=this.$element.parent(),this._validate()&&(this.isPreviewable=$h.hasFileAPISupport(),this.isIE9=$h.isIE(9),this.isIE10=$h.isIE(10),(this.isPreviewable||this.isIE9)&&(this._init(options),this._listen()),this.$element.removeClass("file-loading"))}).prototype={constructor:FileInput,_cleanup:function(){this.reader=null,this.formdata={},this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.uploadAsyncCount=0,this.loadedImages=[],this.totalImagesCount=0,this.ajaxRequests=[],this.clearStack(),this.fileInputCleared=!1,this.fileBatchCompleted=!0,this.isPreviewable||(this.showPreview=!1),this.isError=!1,this.ajaxAborted=!1,this.cancelling=!1},_init:function(options,refreshMode){var f,$cont,t,tmp,self=this,$el=self.$element;self.options=options,$.each(options,(function(key,value){switch(key){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":self[key]=$h.getNum(value);break;default:self[key]=value}})),self.rtl&&(tmp=self.previewZoomButtonIcons.prev,self.previewZoomButtonIcons.prev=self.previewZoomButtonIcons.next,self.previewZoomButtonIcons.next=tmp),refreshMode||self._cleanup(),self.$form=$el.closest("form"),self._initTemplateDefaults(),self.uploadFileAttr=$h.isEmpty($el.attr("name"))?"file_data":$el.attr("name"),t=self._getLayoutTemplate("progress"),self.progressTemplate=t.replace("{class}",self.progressClass),self.progressCompleteTemplate=t.replace("{class}",self.progressCompleteClass),self.progressErrorTemplate=t.replace("{class}",self.progressErrorClass),self.dropZoneEnabled=$h.hasDragDropSupport()&&self.dropZoneEnabled,self.isDisabled=$el.attr("disabled")||$el.attr("readonly"),self.isDisabled&&$el.attr("disabled",!0),self.isAjaxUpload=$h.hasFileUploadSupport()&&!$h.isEmpty(self.uploadUrl),self.isClickable=self.browseOnZoneClick&&self.showPreview&&(self.isAjaxUpload&&self.dropZoneEnabled||!$h.isEmpty(self.defaultPreviewContent)),self.slug="function"==typeof options.slugCallback?options.slugCallback:self._slugDefault,self.mainTemplate=self.showCaption?self._getLayoutTemplate("main1"):self._getLayoutTemplate("main2"),self.captionTemplate=self._getLayoutTemplate("caption"),self.previewGenericTemplate=self._getPreviewTemplate("generic"),!self.imageCanvas&&self.resizeImage&&(self.maxImageWidth||self.maxImageHeight)&&(self.imageCanvas=document.createElement("canvas"),self.imageCanvasContext=self.imageCanvas.getContext("2d")),$h.isEmpty($el.attr("id"))&&$el.attr("id",$h.uniqId()),self.namespace=".fileinput_"+$el.attr("id").replace(/-/g,"_"),void 0===self.$container?self.$container=self._createContainer():self._refreshContainer(),$cont=self.$container,self.$dropZone=$cont.find(".file-drop-zone"),self.$progress=$cont.find(".kv-upload-progress"),self.$btnUpload=$(".fileinput-upload"),self.$captionContainer=$h.getElement(options,"elCaptionContainer",$cont.find(".file-caption")),self.$caption=$h.getElement(options,"elCaptionText",$cont.find(".file-caption-name")),$h.isEmpty(self.msgPlaceholder)||(f=$el.attr("multiple")?self.filePlural:self.fileSingle,self.$caption.attr("placeholder",self.msgPlaceholder.replace("{files}",f))),self.$captionIcon=self.$captionContainer.find(".file-caption-icon"),self.mainClass.indexOf("input-group-lg")>-1?$h.addCss(self.$captionIcon,"icon-lg"):self.$captionIcon.removeClass("icon-lg"),self.$previewContainer=$h.getElement(options,"elPreviewContainer",$cont.find(".file-preview")),self.$preview=$h.getElement(options,"elPreviewImage",$cont.find(".file-preview-thumbnails")),self.$previewStatus=$h.getElement(options,"elPreviewStatus",$cont.find(".file-preview-status")),self.$errorContainer=$h.getElement(options,"elErrorContainer",self.$previewContainer.find(".kv-fileinput-error")),self._validateDisabled(),$h.isEmpty(self.msgErrorClass)||$h.addCss(self.$errorContainer,self.msgErrorClass),refreshMode||(self.$errorContainer.hide(),self.previewInitId="preview-"+$h.uniqId(),self._initPreviewCache(),self._initPreview(!0),self._initPreviewActions(),self._setFileDropZoneTitle(),self.$parent.hasClass("file-loading")&&(self.$container.insertBefore(self.$parent),self.$parent.remove())),$el.attr("disabled")&&self.disable(),self._initZoom(),self.hideThumbnailContent&&$h.addCss(self.$preview,"hide-content")},_initTemplateDefaults:function(){var tClose,tModalMain,tTagBef,tTagBef1,tTagBef2,tVideo,tAudio,tObject,tOther,vDefaultDim,self=this;tClose=$h.closeButton("fileinput-remove"),tModalMain='<div id="'+$h.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+$h.MODAL_ID+'Label"></div>',tTagBef1=(tTagBef='<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"')+'><div class="kv-file-content">\n',tTagBef2=tTagBef+' title="{caption}"><div class="kv-file-content">\n',tVideo='<video class="kv-preview-data file-preview-video" controls {style}>\n<source src="{data}" type="{type}">\n'+$h.DEFAULT_PREVIEW+"\n</video>\n",tAudio='<audio class="kv-preview-data file-preview-audio" controls {style}>\n<source src="{data}" type="{type}">\n'+$h.DEFAULT_PREVIEW+"\n</audio>\n",tObject='<object class="kv-preview-data file-preview-object file-object {typeCss}" data="{data}" type="{type}" {style}>\n<param name="movie" value="{caption}" />\n'+$h.OBJECT_PARAMS+" "+$h.DEFAULT_PREVIEW+"\n</object>\n",tOther='<div class="kv-preview-data file-preview-other-frame" {style}>\n'+$h.DEFAULT_PREVIEW+"\n</div>\n",vDefaultDim={width:"100%",height:"100%","min-height":"480px"},self.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress kv-hidden"></div><div class="clearfix"></div>\n<div class="input-group {class}">\n  {caption}\n<div class="input-group-btn">\n      {remove}\n      {cancel}\n      {upload}\n      {browse}\n    </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress kv-hidden"></div>\n<div class="clearfix"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',close:tClose,fileIcon:'<i class="icon-file"></i>',caption:'<div class="file-caption form-control {class}" tabindex="500">\n  <span class="file-caption-icon"></span>\n  <input class="file-caption-name" onkeydown="return false;" onpaste="return false;">\n</div>',modalMain:tModalMain,modal:'<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <h5 class="modal-title">{heading}</h5>\n      <span class="kv-zoom-title"></span>\n      <div class="kv-zoom-actions">{toggleheader}{fullscreen}{borderless}{close}</div>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">\n        <div class="file-caption-info">{caption}</div>\n        <div class="file-size-info">{size}</div>\n    </div>\n    {progress}\n{indicator}\n{actions}\n</div>',indicator:"",actions:'<div class="file-actions">\n    <div class="file-footer-buttons">\n        {download} {upload} {delete} {zoom} {other}    </div>\n</div>\n{drag}\n<div class="clearfix"></div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionDownload:'<a class="kv-file-download {downloadClass}" title="{downloadTitle}" href="{downloadUrl}" download="{caption}" target="_blank">{downloadIcon}</a>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:tTagBef1,tagBefore2:tTagBef2,tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:'<div class="kv-preview-data file-preview-html" title="{caption}" {style}>{data}</div>\n',image:'<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" {style}>\n',text:'<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly {style}>{data}</textarea>\n',office:'<iframe class="kv-preview-data file-preview-office" src="https://docs.google.com/gview?url={data}&embedded=true" {style}></iframe>',video:tVideo,audio:tAudio,flash:'<embed class="kv-preview-data file-preview-flash" src="{data}" type="application/x-shockwave-flash" {style}>\n',object:tObject,pdf:'<embed class="kv-preview-data file-preview-pdf" src="{data}" type="application/pdf" {style}>\n',other:tOther},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},office:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"100%",height:"30px"},flash:{width:"213px",height:"160px"},object:{width:"213px",height:"160px"},pdf:{width:"213px",height:"160px"},other:{width:"213px",height:"160px"}},previewSettingsSmall:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"100%",height:"160px"},text:{width:"100%",height:"160px"},office:{width:"100%",height:"160px"},video:{width:"100%",height:"auto"},audio:{width:"100%",height:"30px"},flash:{width:"100%",height:"auto"},object:{width:"100%",height:"auto"},pdf:{width:"100%",height:"160px"},other:{width:"100%",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:vDefaultDim,text:vDefaultDim,office:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:vDefaultDim,other:{width:"auto",height:"100%","min-height":"480px"}},fileTypeSettings:{image:function(vType,vName){return $h.compare(vType,"image.*")&&!$h.compare(vType,/(tiff?|wmf)$/i)||$h.compare(vName,/\.(gif|png|jpe?g)$/i)},html:function(vType,vName){return $h.compare(vType,"text/html")||$h.compare(vName,/\.(htm|html)$/i)},office:function(vType,vName){return $h.compare(vType,/(word|excel|powerpoint|office|iwork-pages|tiff?)$/i)||$h.compare(vName,/\.(rtf|docx?|xlsx?|pptx?|pps|potx?|ods|odt|pages|ai|dxf|ttf|tiff?|wmf|e?ps)$/i)},text:function(vType,vName){return $h.compare(vType,"text.*")||$h.compare(vName,/\.(xml|javascript)$/i)||$h.compare(vName,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(vType,vName){return $h.compare(vType,"video.*")&&($h.compare(vType,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||$h.compare(vName,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(vType,vName){return $h.compare(vType,"audio.*")&&($h.compare(vName,/(ogg|mp3|mp?g|wav)$/i)||$h.compare(vName,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(vType,vName){return $h.compare(vType,"application/x-shockwave-flash",!0)||$h.compare(vName,/\.(swf)$/i)},pdf:function(vType,vName){return $h.compare(vType,"application/pdf",!0)||$h.compare(vName,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showDownload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-kv btn-default btn-outline-secondary",removeErrorClass:"btn btn-kv btn-danger",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-kv btn-default btn-outline-secondary",uploadTitle:"Upload file",uploadRetryIcon:'<i class="glyphicon glyphicon-repeat"></i>',uploadRetryTitle:"Retry upload",downloadIcon:'<i class="glyphicon glyphicon-download"></i>',downloadClass:"btn btn-kv btn-default btn-outline-secondary",downloadTitle:"Download file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-kv btn-default btn-outline-secondary",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-move"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-plus-sign text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hourglass text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}},$.each(self.defaults,(function(key,setting){"allowedPreviewTypes"!==key?self[key]=$.extend(!0,{},setting,self[key]):void 0===self.allowedPreviewTypes&&(self.allowedPreviewTypes=setting)})),self._initPreviewTemplates()},_initPreviewTemplates:function(){var tagBef,self=this,cfg=self.defaults,tags=self.previewMarkupTags,tagAft=tags.tagAfter;$.each(cfg.previewContentTemplates,(function(key,value){$h.isEmpty(self.previewTemplates[key])&&(tagBef=tags.tagBefore2,"generic"!==key&&"image"!==key&&"html"!==key&&"text"!==key||(tagBef=tags.tagBefore1),self.previewTemplates[key]=tagBef+value+tagAft)}))},_initPreviewCache:function(){var self=this;self.previewCache={data:{},init:function(){var content=self.initialPreview;content.length>0&&!$h.isArray(content)&&(content=content.split(self.initialPreviewDelimiter)),self.previewCache.data={content:content,config:self.initialPreviewConfig,tags:self.initialPreviewThumbTags}},count:function(){return self.previewCache.data&&self.previewCache.data.content?self.previewCache.data.content.length:0},get:function(i,isDisabled){var out,$tmp,cat,ftr,fname,ftype,frameClass,ind="init_"+i,data=self.previewCache.data,config=data.config[i],content=data.content[i],previewId=self.previewInitId+"-"+ind,asData=$h.ifSet("previewAsData",config,self.initialPreviewAsData),parseTemplate=function(cat,dat,fn,ft,id,ftr,ind,fc,t){return fc=" file-preview-initial "+$h.SORT_CSS+(fc?" "+fc:""),self._generatePreviewTemplate(cat,dat,fn,ft,id,!1,null,fc,ftr,ind,t)};return content?(isDisabled=void 0===isDisabled||isDisabled,cat=$h.ifSet("type",config,self.initialPreviewFileType||"generic"),fname=$h.ifSet("filename",config,$h.ifSet("caption",config)),ftype=$h.ifSet("filetype",config,cat),ftr=self.previewCache.footer(i,isDisabled,config&&config.size||null),frameClass=$h.ifSet("frameClass",config),out=asData?parseTemplate(cat,content,fname,ftype,previewId,ftr,ind,frameClass):parseTemplate("generic",content,fname,ftype,previewId,ftr,ind,frameClass,cat).setTokens({content:data.content[i]}),data.tags.length&&data.tags[i]&&(out=$h.replaceTags(out,data.tags[i])),$h.isEmpty(config)||$h.isEmpty(config.frameAttr)||(($tmp=$(document.createElement("div")).html(out)).find(".file-preview-initial").attr(config.frameAttr),out=$tmp.html(),$tmp.remove()),out):""},add:function(content,config,tags,append){var index,data=self.previewCache.data;return $h.isArray(content)||(content=content.split(self.initialPreviewDelimiter)),append?(index=data.content.push(content)-1,data.config[index]=config,data.tags[index]=tags):(index=content.length-1,data.content=content,data.config=config,data.tags=tags),self.previewCache.data=data,index},set:function(content,config,tags,append){var i,data=self.previewCache.data;if(content&&content.length&&($h.isArray(content)||(content=content.split(self.initialPreviewDelimiter)),content.filter((function(n){return null!==n})).length)){if(void 0===data.content&&(data.content=[]),void 0===data.config&&(data.config=[]),void 0===data.tags&&(data.tags=[]),append){for(i=0;i<content.length;i++)content[i]&&data.content.push(content[i]);for(i=0;i<config.length;i++)config[i]&&data.config.push(config[i]);for(i=0;i<tags.length;i++)tags[i]&&data.tags.push(tags[i])}else data.content=content,data.config=config,data.tags=tags;self.previewCache.data=data}},unset:function(index){var chk=self.previewCache.count();if(chk){if(1===chk)return self.previewCache.data.content=[],self.previewCache.data.config=[],self.previewCache.data.tags=[],self.initialPreview=[],self.initialPreviewConfig=[],void(self.initialPreviewThumbTags=[]);self.previewCache.data.content.splice(index,1),self.previewCache.data.config.splice(index,1),self.previewCache.data.tags.splice(index,1)}},out:function(){var i,html="",len=self.previewCache.count();if(0===len)return{content:"",caption:""};for(i=0;i<len;i++)html+=self.previewCache.get(i);return{content:html,caption:self._getMsgSelected(len)}},footer:function(i,isDisabled,size){var data=self.previewCache.data||{};if($h.isEmpty(data.content))return"";($h.isEmpty(data.config)||$h.isEmpty(data.config[i]))&&(data.config[i]={}),isDisabled=void 0===isDisabled||isDisabled;var a,config=data.config[i],caption=$h.ifSet("caption",config),width=$h.ifSet("width",config,"auto"),url=$h.ifSet("url",config,!1),key=$h.ifSet("key",config,null),fs=self.fileActionSettings,initPreviewShowDel=self.initialPreviewShowDelete||!1,dUrl=config.downloadUrl||self.initialPreviewDownloadUrl||"",dFil=config.filename||config.caption||"",initPreviewShowDwl=!!dUrl,sDel=$h.ifSet("showDelete",config,$h.ifSet("showDelete",fs,initPreviewShowDel)),sDwl=$h.ifSet("showDownload",config,$h.ifSet("showDownload",fs,initPreviewShowDwl)),sZm=$h.ifSet("showZoom",config,$h.ifSet("showZoom",fs,!0)),sDrg=$h.ifSet("showDrag",config,$h.ifSet("showDrag",fs,!0)),dis=!1===url&&isDisabled;return sDwl=sDwl&&!1!==config.downloadUrl&&!!dUrl,a=self._renderFileActions(!1,sDwl,sDel,sZm,sDrg,dis,url,key,!0,dUrl,dFil),self._getLayoutTemplate("footer").setTokens({progress:self._renderThumbProgress(),actions:a,caption:caption,size:self._getSize(size),width:width,indicator:""})}},self.previewCache.init()},_handler:function($el,event,callback){var ns=this.namespace,ev=event.split(" ").join(ns+" ")+ns;$el&&$el.length&&$el.off(ev).on(ev,callback)},_log:function(msg){var id=this.$element.attr("id");id&&(msg='"'+id+'": '+msg),void 0!==window.console.log?window.console.log(msg):window.alert(msg)},_validate:function(){var status="file"===this.$element.attr("type");return status||this._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.'),status},_errorsExist:function(){var $err;return!!this.$errorContainer.find("li").length||(($err=$(document.createElement("div")).html(this.$errorContainer.html())).find(".kv-error-close").remove(),$err.find("ul").remove(),!!$.trim($err.text()).length)},_errorHandler:function(evt,caption){var self=this,err=evt.target.error,showError=function(msg){self._showError(msg.replace("{name}",caption))};err.code===err.NOT_FOUND_ERR?showError(self.msgFileNotFound):err.code===err.SECURITY_ERR?showError(self.msgFileSecured):err.code===err.NOT_READABLE_ERR?showError(self.msgFileNotReadable):err.code===err.ABORT_ERR?showError(self.msgFilePreviewAborted):showError(self.msgFilePreviewError)},_addError:function(msg){var self=this,$error=self.$errorContainer;msg&&$error.length&&($error.html(self.errorCloseButton+msg),self._handler($error.find(".kv-error-close"),"click",(function(){setTimeout((function(){self.showPreview&&!self.getFrames().length&&self.clear(),$error.fadeOut("slow")}),10)})))},_setValidationError:function(css){css=(css?css+" ":"")+"has-error",this.$container.removeClass(css).addClass("has-error"),$h.addCss(this.$captionContainer,"is-invalid")},_resetErrors:function(fade){var $error=this.$errorContainer;this.isError=!1,this.$container.removeClass("has-error"),this.$captionContainer.removeClass("is-invalid"),$error.html(""),fade?$error.fadeOut("slow"):$error.hide()},_showFolderError:function(folders){var msg,$error=this.$errorContainer;folders&&(msg=this.msgFoldersNotAllowed.replace("{n}",folders),this._addError(msg),this._setValidationError(),$error.fadeIn(800),this._raise("filefoldererror",[folders,msg]))},_showUploadError:function(msg,params,event){var $error=this.$errorContainer,ev=event||"fileuploaderror",e=params&&params.id?'<li data-file-id="'+params.id+'">'+msg+"</li>":"<li>"+msg+"</li>";return 0===$error.find("ul").length?this._addError("<ul>"+e+"</ul>"):$error.find("ul").append(e),$error.fadeIn(800),this._raise(ev,[params,msg]),this._setValidationError("file-input-new"),!0},_showError:function(msg,params,event){var $error=this.$errorContainer,ev=event||"fileerror";return(params=params||{}).reader=this.reader,this._addError(msg),$error.fadeIn(800),this._raise(ev,[params,msg]),this.isAjaxUpload||this._clearFileInput(),this._setValidationError("file-input-new"),this.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(params){var label=this.minFileCount>1?this.filePlural:this.fileSingle,msg=this.msgFilesTooLess.replace("{n}",this.minFileCount).replace("{files}",label),$error=this.$errorContainer;this._addError(msg),this.isError=!0,this._updateFileDetails(0),$error.fadeIn(800),this._raise("fileerror",[params,msg]),this._clearFileInput(),this._setValidationError()},_parseError:function(operation,jqXHR,errorThrown,fileName){var textPre,errMsg=$.trim(errorThrown+""),text=void 0!==jqXHR.responseJSON&&void 0!==jqXHR.responseJSON.error?jqXHR.responseJSON.error:jqXHR.responseText;return this.cancelling&&this.msgUploadAborted&&(errMsg=this.msgUploadAborted),this.showAjaxErrorDetails&&text&&(textPre=(text=$.trim(text.replace(/\n\s*\n/g,"\n"))).length?"<pre>"+text+"</pre>":"",errMsg+=errMsg?textPre:text),errMsg||(errMsg=this.msgAjaxError.replace("{operation}",operation)),this.cancelling=!1,fileName?"<b>"+fileName+": </b>"+errMsg:errMsg},_parseFileType:function(type,name){var vType,cat,i,types=this.allowedPreviewTypes||[];if("application/text-plain"===type)return"text";for(i=0;i<types.length;i++)if(cat=types[i],vType=(0,this.fileTypeSettings[cat])(type,name)?cat:"",!$h.isEmpty(vType))return vType;return"other"},_getPreviewIcon:function(fname){var ext,self=this,out=null;return fname&&fname.indexOf(".")>-1&&(ext=fname.split(".").pop(),self.previewFileIconSettings&&(out=self.previewFileIconSettings[ext]||self.previewFileIconSettings[ext.toLowerCase()]||null),self.previewFileExtSettings&&$.each(self.previewFileExtSettings,(function(key,func){self.previewFileIconSettings[key]&&func(ext)&&(out=self.previewFileIconSettings[key])}))),out},_parseFilePreviewIcon:function(content,fname){var icn=this._getPreviewIcon(fname)||this.previewFileIcon,out=content;return out.indexOf("{previewFileIcon}")>-1&&(out=out.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:icn})),out},_raise:function(event,params){var e=$.Event(event);if(void 0!==params?this.$element.trigger(e,params):this.$element.trigger(e),e.isDefaultPrevented()||!1===e.result)return!1;switch(event){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=e.result)}return!0},_listenFullScreen:function(isFullScreen){var $btnFull,$btnBord,$modal=this.$modal;$modal&&$modal.length&&($btnFull=$modal&&$modal.find(".btn-fullscreen"),$btnBord=$modal&&$modal.find(".btn-borderless"),$btnFull.length&&$btnBord.length&&($btnFull.removeClass("active").attr("aria-pressed","false"),$btnBord.removeClass("active").attr("aria-pressed","false"),isFullScreen?$btnFull.addClass("active").attr("aria-pressed","true"):$btnBord.addClass("active").attr("aria-pressed","true"),$modal.hasClass("file-zoom-fullscreen")||isFullScreen?this._maximizeZoomDialog():$btnBord.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var self=this,$el=self.$element,$form=self.$form,$cont=self.$container;self._handler($el,"change",$.proxy(self._change,self)),self.showBrowse&&self._handler(self.$btnFile,"click",$.proxy(self._browse,self)),self._handler($cont.find(".fileinput-remove:not([disabled])"),"click",$.proxy(self.clear,self)),self._handler($cont.find(".fileinput-cancel"),"click",$.proxy(self.cancel,self)),self._initDragDrop(),self._handler($form,"reset",$.proxy(self.clear,self)),self.isAjaxUpload||self._handler($form,"submit",$.proxy(self._submitForm,self)),self._handler($(".fileinput-upload"),"click",$.proxy(self._uploadClick,self)),self._handler($(window),"resize",(function(){self._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)})),self._handler($(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(){self._listenFullScreen($h.checkFullScreen())})),self._autoFitContent(),self._initClickable()},_autoFitContent:function(){var sel,width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,self=this,config=width<400?self.previewSettingsSmall||self.defaults.previewSettingsSmall:self.previewSettings||self.defaults.previewSettings;$.each(config,(function(cat,settings){sel=".file-preview-frame .file-preview-"+cat,self.$preview.find(sel+".kv-preview-data,"+sel+" .kv-preview-data").css(settings)}))},_initClickable:function(){var $zone,self=this;self.isClickable&&($zone=self.isAjaxUpload?self.$dropZone:self.$preview.find(".file-default-preview"),$h.addCss($zone,"clickable"),$zone.attr("tabindex",-1),self._handler($zone,"click",(function(e){var $tar=$(e.target);$zone.find(".kv-fileinput-error:visible").length||$tar.parents(".file-preview-thumbnails").length&&!$tar.parents(".file-default-preview").length||(self.$element.trigger("click"),$zone.blur())})))},_initDragDrop:function(){var $zone=this.$dropZone;this.isAjaxUpload&&this.dropZoneEnabled&&this.showPreview&&(this._handler($zone,"dragenter dragover",$.proxy(this._zoneDragEnter,this)),this._handler($zone,"dragleave",$.proxy(this._zoneDragLeave,this)),this._handler($zone,"drop",$.proxy(this._zoneDrop,this)),this._handler($(document),"dragenter dragover drop",this._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(e){var hasFiles=$.inArray("Files",e.originalEvent.dataTransfer.types)>-1;if(this._zoneDragDropInit(e),this.isDisabled||!hasFiles)return e.originalEvent.dataTransfer.effectAllowed="none",void(e.originalEvent.dataTransfer.dropEffect="none");$h.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){this._zoneDragDropInit(e),this.isDisabled||this.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){e.preventDefault(),this.isDisabled||$h.isEmpty(e.originalEvent.dataTransfer.files)||(this._change(e,"dragdrop"),this.$dropZone.removeClass("file-highlighted"))},_uploadClick:function(e){var $form,$btn=this.$container.find(".fileinput-upload"),isEnabled=!$btn.hasClass("disabled")&&$h.isEmpty($btn.attr("disabled"));e&&e.isDefaultPrevented()||(this.isAjaxUpload?(e.preventDefault(),isEnabled&&this.upload()):isEnabled&&"submit"!==$btn.attr("type")&&(($form=$btn.closest("form")).length&&$form.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var $p=this.$preview;(this.showUploadedThumbs?this.getFrames(":not(.file-preview-success)"):this.getFrames()).each((function(){var $thumb=$(this);$thumb.remove(),$h.cleanZoomCache($p.find("#zoom-"+$thumb.attr("id")))})),this.getFrames().length&&this.showPreview||this._resetUpload(),this._validateDefaultPreview()},_initSortable:function(){var settings,self=this,$el=self.$preview,selector="."+$h.SORT_CSS;window.KvSortable&&0!==$el.find(selector).length&&(settings={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:!1,draggable:selector,onSort:function(e){var oldIndex=e.oldIndex,newIndex=e.newIndex;self.initialPreview=$h.moveArray(self.initialPreview,oldIndex,newIndex),self.initialPreviewConfig=$h.moveArray(self.initialPreviewConfig,oldIndex,newIndex),self.previewCache.init();for(var i=0;i<self.initialPreviewConfig.length;i++)null!==self.initialPreviewConfig[i]&&$(e.item).closest($h.FRAMES).attr("data-fileindex","init_"+i).attr("data-fileindex","init_"+i);self._raise("filesorted",{previewId:$(e.item).attr("id"),oldIndex:oldIndex,newIndex:newIndex,stack:self.initialPreviewConfig})}},$el.data("kvsortable")&&$el.kvsortable("destroy"),$.extend(!0,settings,self.fileActionSettings.dragSettings),$el.kvsortable(settings))},_setPreviewContent:function(content){this.$preview.html(content),this._autoFitContent()},_initPreview:function(isInit){var out,cap=this.initialCaption||"";if(!this.previewCache.count())return this._clearPreview(),void(isInit?this._setCaption(cap):this._initCaption());out=this.previewCache.out(),cap=isInit&&this.initialCaption?this.initialCaption:out.caption,this._setPreviewContent(out.content),this._setInitThumbAttr(),this._setCaption(cap),this._initSortable(),$h.isEmpty(out.content)||this.$container.removeClass("file-input-new")},_getZoomButton:function(type){var label=this.previewZoomButtonIcons[type],css=this.previewZoomButtonClasses[type],params=' title="'+(this.previewZoomButtonTitles[type]||"")+'" '+("close"===type?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==type&&"borderless"!==type&&"toggleheader"!==type||(params+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+css+" btn-"+type+'"'+params+">"+label+"</button>"},_getModalContent:function(){return this._getLayoutTemplate("modal").setTokens({rtl:this.rtl?" kv-rtl":"",zoomFrameClass:this.frameClass,heading:this.msgZoomModalHeading,prev:this._getZoomButton("prev"),next:this._getZoomButton("next"),toggleheader:this._getZoomButton("toggleheader"),fullscreen:this._getZoomButton("fullscreen"),borderless:this._getZoomButton("borderless"),close:this._getZoomButton("close")})},_listenModalEvent:function(event){var self=this,$modal=self.$modal;$modal.on(event+".bs.modal",(function(e){var $btnFull=$modal.find(".btn-fullscreen"),$btnBord=$modal.find(".btn-borderless");self._raise("filezoom"+event,function(e){return{sourceEvent:e,previewId:$modal.data("previewId"),modal:$modal}}(e)),"shown"===event&&($btnBord.removeClass("active").attr("aria-pressed","false"),$btnFull.removeClass("active").attr("aria-pressed","false"),$modal.hasClass("file-zoom-fullscreen")&&(self._maximizeZoomDialog(),$h.checkFullScreen()?$btnFull.addClass("active").attr("aria-pressed","true"):$btnBord.addClass("active").attr("aria-pressed","true")))}))},_initZoom:function(){var $dialog,self=this,modalMain=self._getLayoutTemplate("modalMain"),modalId="#"+$h.MODAL_ID;self.showPreview&&(self.$modal=$(modalId),self.$modal&&self.$modal.length||($dialog=$(document.createElement("div")).html(modalMain).insertAfter(self.$container),self.$modal=$(modalId).insertBefore($dialog),$dialog.remove()),$h.initModal(self.$modal),self.$modal.html(self._getModalContent()),$.each($h.MODAL_EVENTS,(function(key,event){self._listenModalEvent(event)})))},_initZoomButtons:function(){var $first,$last,previewId=this.$modal.data("previewId")||"",thumbs=this.getFrames().toArray(),len=thumbs.length,$prev=this.$modal.find(".btn-prev"),$next=this.$modal.find(".btn-next");if(thumbs.length<2)return $prev.hide(),void $next.hide();$prev.show(),$next.show(),len&&($first=$(thumbs[0]),$last=$(thumbs[len-1]),$prev.removeAttr("disabled"),$next.removeAttr("disabled"),$first.length&&$first.attr("id")===previewId&&$prev.attr("disabled",!0),$last.length&&$last.attr("id")===previewId&&$next.attr("disabled",!0))},_maximizeZoomDialog:function(){var $modal=this.$modal,$head=$modal.find(".modal-header:visible"),$foot=$modal.find(".modal-footer:visible"),$body=$modal.find(".modal-body"),h=$(window).height();$modal.addClass("file-zoom-fullscreen"),$head&&$head.length&&(h-=$head.outerHeight(!0)),$foot&&$foot.length&&(h-=$foot.outerHeight(!0)),$body&&$body.length&&(h-=$body.outerHeight(!0)-$body.height()),$modal.find(".kv-zoom-body").height(h)},_resizeZoomDialog:function(fullScreen){var $modal=this.$modal,$btnFull=$modal.find(".btn-fullscreen"),$btnBord=$modal.find(".btn-borderless");if($modal.hasClass("file-zoom-fullscreen"))$h.toggleFullScreen(!1),fullScreen?$btnFull.hasClass("active")||($modal.removeClass("file-zoom-fullscreen"),this._resizeZoomDialog(!0),$btnBord.hasClass("active")&&$btnBord.removeClass("active").attr("aria-pressed","false")):$btnFull.hasClass("active")?$btnFull.removeClass("active").attr("aria-pressed","false"):($modal.removeClass("file-zoom-fullscreen"),this.$modal.find(".kv-zoom-body").css("height",this.zoomModalHeight));else{if(!fullScreen)return void this._maximizeZoomDialog();$h.toggleFullScreen(!0)}$modal.focus()},_setZoomContent:function($frame,animate){var $content,tmplt,body,title,$body,$dataEl,config,$tmp,self=this,pid=$frame.attr("id"),$modal=self.$modal,$prev=$modal.find(".btn-prev"),$next=$modal.find(".btn-next"),$btnFull=$modal.find(".btn-fullscreen"),$btnBord=$modal.find(".btn-borderless"),$btnTogh=$modal.find(".btn-toggleheader"),$zoomPreview=self.$preview.find("#zoom-"+pid);tmplt=$zoomPreview.attr("data-template")||"generic",body=($content=$zoomPreview.find(".kv-file-content")).length?$content.html():"",title=($frame.data("caption")||"")+" "+($frame.data("size")||""),$modal.find(".kv-zoom-title").attr("title",$("<div/>").html(title).text()).html(title),$body=$modal.find(".kv-zoom-body"),$modal.removeClass("kv-single-content"),animate?($tmp=$body.addClass("file-thumb-loading").clone().insertAfter($body),$body.html(body).hide(),$tmp.fadeOut("fast",(function(){$body.fadeIn("fast",(function(){$body.removeClass("file-thumb-loading")})),$tmp.remove()}))):$body.html(body),(config=self.previewZoomSettings[tmplt])&&($dataEl=$body.find(".kv-preview-data"),$h.addCss($dataEl,"file-zoom-detail"),$.each(config,(function(key,value){$dataEl.css(key,value),($dataEl.attr("width")&&"width"===key||$dataEl.attr("height")&&"height"===key)&&$dataEl.removeAttr(key)}))),$modal.data("previewId",pid);var $img=$body.find("img");$img.length&&$h.adjustOrientedImage($img,!0),self._handler($prev,"click",(function(){self._zoomSlideShow("prev",pid)})),self._handler($next,"click",(function(){self._zoomSlideShow("next",pid)})),self._handler($btnFull,"click",(function(){self._resizeZoomDialog(!0)})),self._handler($btnBord,"click",(function(){self._resizeZoomDialog(!1)})),self._handler($btnTogh,"click",(function(){var ht,$header=$modal.find(".modal-header"),$floatBar=$modal.find(".modal-body .floating-buttons"),$actions=$header.find(".kv-zoom-actions"),resize=function(height){var $body=self.$modal.find(".kv-zoom-body"),h=self.zoomModalHeight;$modal.hasClass("file-zoom-fullscreen")&&(h=$body.outerHeight(!0),height||(h-=$header.outerHeight(!0))),$body.css("height",height?h+height:h)};$header.is(":visible")?(ht=$header.outerHeight(!0),$header.slideUp("slow",(function(){$actions.find(".btn").appendTo($floatBar),resize(ht)}))):($floatBar.find(".btn").appendTo($actions),$header.slideDown("slow",(function(){resize()}))),$modal.focus()})),self._handler($modal,"keydown",(function(e){var key=e.which||e.keyCode;37!==key||$prev.attr("disabled")||self._zoomSlideShow("prev",pid),39!==key||$next.attr("disabled")||self._zoomSlideShow("next",pid)}))},_zoomPreview:function($btn){var $frame,$modal=this.$modal;if(!$btn.length)throw"Cannot zoom to detailed preview!";$h.initModal($modal),$modal.html(this._getModalContent()),$frame=$btn.closest($h.FRAMES),this._setZoomContent($frame),$modal.modal("show"),this._initZoomButtons()},_zoomSlideShow:function(dir,previewId){var $targFrame,i,out,$btn=this.$modal.find(".kv-zoom-actions .btn-"+dir),thumbs=this.getFrames().toArray(),len=thumbs.length;if(!$btn.attr("disabled")){for(i=0;i<len;i++)if($(thumbs[i]).attr("id")===previewId){out="prev"===dir?i-1:i+1;break}out<0||out>=len||!thumbs[out]||(($targFrame=$(thumbs[out])).length&&this._setZoomContent($targFrame,!0),this._initZoomButtons(),this._raise("filezoom"+dir,{previewId:previewId,modal:this.$modal}))}},_initZoomButton:function(){var self=this;self.$preview.find(".kv-file-zoom").each((function(){var $el=$(this);self._handler($el,"click",(function(){self._zoomPreview($el)}))}))},_clearObjects:function($el){$el.find("video audio").each((function(){this.pause(),$(this).remove()})),$el.find("img object div").each((function(){$(this).remove()}))},_clearFileInput:function(){var $srcFrm,$tmpFrm,$tmpEl,$el=this.$element;this.fileInputCleared=!0,$h.isEmpty($el.val())||(this.isIE9||this.isIE10?($srcFrm=$el.closest("form"),$tmpFrm=$(document.createElement("form")),$tmpEl=$(document.createElement("div")),$el.before($tmpEl),$srcFrm.length?$srcFrm.after($tmpFrm):$tmpEl.after($tmpFrm),$tmpFrm.append($el).trigger("reset"),$tmpEl.before($el).remove(),$tmpFrm.remove()):$el.val(""))},_resetUpload:function(){this.uploadCache={content:[],config:[],tags:[],append:!0},this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.uploadAsyncCount=0,this.loadedImages=[],this.totalImagesCount=0,this.$btnUpload.removeAttr("disabled"),this._setProgress(0),this.$progress.hide(),this._resetErrors(!1),this.ajaxAborted=!1,this.ajaxRequests=[],this._resetCanvas(),this.cacheInitialPreview={},this.overwriteInitial&&(this.initialPreview=[],this.initialPreviewConfig=[],this.initialPreviewThumbTags=[],this.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){this.canvas&&this.imageCanvasContext&&this.imageCanvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count()},_resetPreview:function(){var out,cap;this.previewCache.count()?(out=this.previewCache.out(),this._setPreviewContent(out.content),this._setInitThumbAttr(),cap=this.initialCaption?this.initialCaption:out.caption,this._setCaption(cap)):(this._clearPreview(),this._initCaption()),this.showPreview&&(this._initZoom(),this._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){this.showPreview&&!$h.isEmpty(this.defaultPreviewContent)&&(this._setPreviewContent('<div class="file-default-preview">'+this.defaultPreviewContent+"</div>"),this.$container.removeClass("file-input-new"),this._initClickable())},_resetPreviewThumbs:function(isAjax){var out;if(isAjax)return this._clearPreview(),void this.clearStack();this._hasInitialPreview()?(out=this.previewCache.out(),this._setPreviewContent(out.content),this._setInitThumbAttr(),this._setCaption(out.caption),this._initPreviewActions()):this._clearPreview()},_getLayoutTemplate:function(t){var template=this.layoutTemplates[t];return $h.isEmpty(this.customLayoutTags)?template:$h.replaceTags(template,this.customLayoutTags)},_getPreviewTemplate:function(t){var template=this.previewTemplates[t];return $h.isEmpty(this.customPreviewTags)?template:$h.replaceTags(template,this.customPreviewTags)},_getOutData:function(jqXHR,responseData,filesData){return jqXHR=jqXHR||{},responseData=responseData||{},filesData=filesData||this.filestack.slice(0)||{},{form:this.formdata,files:filesData,filenames:this.filenames,filescount:this.getFilesCount(),extra:this._getExtraData(),response:responseData,reader:this.reader,jqXHR:jqXHR}},_getMsgSelected:function(n){var strFiles=1===n?this.fileSingle:this.filePlural;return n>0?this.msgSelected.replace("{n}",n).replace("{files}",strFiles):this.msgNoFilesSelected},_getFrame:function(id){var $frame=$("#"+id);return $frame.length?$frame:(this._log('Invalid thumb frame with id: "'+id+'".'),null)},_getThumbs:function(css){return css=css||"",this.getFrames(":not(.file-preview-initial)"+css)},_getExtraData:function(previewId,index){var data=this.uploadExtraData;return"function"==typeof this.uploadExtraData&&(data=this.uploadExtraData(previewId,index)),data},_initXhr:function(xhrobj,previewId,fileCount){var self=this;return xhrobj.upload&&xhrobj.upload.addEventListener("progress",(function(event){var pct=0,total=event.total,position=event.loaded||event.position;event.lengthComputable&&(pct=Math.floor(position/total*100)),previewId?self._setAsyncUploadStatus(previewId,pct,fileCount):self._setProgress(pct)}),!1),xhrobj},_mergeAjaxCallback:function(funcName,srcFunc,type){var targFunc,settings=this.ajaxSettings,flag=this.mergeAjaxCallbacks;"delete"===type&&(settings=this.ajaxDeleteSettings,flag=this.mergeAjaxDeleteCallbacks),targFunc=settings[funcName],settings[funcName]=flag&&"function"==typeof targFunc?"before"===flag?function(){targFunc.apply(this,arguments),srcFunc.apply(this,arguments)}:function(){srcFunc.apply(this,arguments),targFunc.apply(this,arguments)}:srcFunc,"delete"===type?this.ajaxDeleteSettings=settings:this.ajaxSettings=settings},_ajaxSubmit:function(fnBefore,fnSuccess,fnComplete,fnError,previewId,index){var settings,self=this;self._raise("filepreajax",[previewId,index])&&(self._uploadExtra(previewId,index),self._mergeAjaxCallback("beforeSend",fnBefore),self._mergeAjaxCallback("success",fnSuccess),self._mergeAjaxCallback("complete",fnComplete),self._mergeAjaxCallback("error",fnError),settings=$.extend(!0,{},{xhr:function(){var xhrobj=$.ajaxSettings.xhr();return self._initXhr(xhrobj,previewId,self.getFileStack().length)},url:index&&self.uploadUrlThumb?self.uploadUrlThumb:self.uploadUrl,type:"POST",dataType:"json",data:self.formdata,cache:!1,processData:!1,contentType:!1},self.ajaxSettings),self.ajaxRequests.push($.ajax(settings)))},_mergeArray:function(prop,content){var arr1=$h.cleanArray(this[prop]),arr2=$h.cleanArray(content);this[prop]=arr1.concat(arr2)},_initUploadSuccess:function(out,$thumb,allFiles){var append,data,index,$div,$newCache,content,config,tags,i,self=this;self.showPreview&&"object"==typeof out&&!$.isEmptyObject(out)&&void 0!==out.initialPreview&&out.initialPreview.length>0&&(self.hasInitData=!0,content=out.initialPreview||[],config=out.initialPreviewConfig||[],tags=out.initialPreviewThumbTags||[],append=void 0===out.append||out.append,content.length>0&&!$h.isArray(content)&&(content=content.split(self.initialPreviewDelimiter)),self._mergeArray("initialPreview",content),self._mergeArray("initialPreviewConfig",config),self._mergeArray("initialPreviewThumbTags",tags),void 0!==$thumb?allFiles?(i=$thumb.attr("data-fileindex"),self.uploadCache.content[i]=content[0],self.uploadCache.config[i]=config[0]||[],self.uploadCache.tags[i]=tags[0]||[],self.uploadCache.append=append):(index=self.previewCache.add(content,config[0],tags[0],append),data=self.previewCache.get(index,!1),($newCache=($div=$(document.createElement("div")).html(data).hide().insertAfter($thumb)).find(".kv-zoom-cache"))&&$newCache.length&&$newCache.insertAfter($thumb),$thumb.fadeOut("slow",(function(){var $newThumb=$div.find(".file-preview-frame");$newThumb&&$newThumb.length&&$newThumb.insertBefore($thumb).fadeIn("slow").css("display:inline-block"),self._initPreviewActions(),self._clearFileInput(),$h.cleanZoomCache(self.$preview.find("#zoom-"+$thumb.attr("id"))),$thumb.remove(),$div.remove(),self._initSortable()}))):(self.previewCache.set(content,config,tags,append),self._initPreview(),self._initPreviewActions()))},_initSuccessThumbs:function(){var self=this;self.showPreview&&self._getThumbs($h.FRAMES+".file-preview-success").each((function(){var $thumb=$(this),$preview=self.$preview,$remove=$thumb.find(".kv-file-remove");$remove.removeAttr("disabled"),self._handler($remove,"click",(function(){var id=$thumb.attr("id"),out=self._raise("filesuccessremove",[id,$thumb.attr("data-fileindex")]);$h.cleanMemory($thumb),!1!==out&&$thumb.fadeOut("slow",(function(){$h.cleanZoomCache($preview.find("#zoom-"+id)),$thumb.remove(),self.getFrames().length||self.reset()}))}))}))},_checkAsyncComplete:function(){var previewId,i;for(i=0;i<this.filestack.length;i++)if(this.filestack[i]&&(previewId=this.previewInitId+"-"+i,-1===$.inArray(previewId,this.uploadLog)))return!1;return this.uploadAsyncCount===this.uploadLog.length},_uploadExtra:function(previewId,index){var self=this,data=self._getExtraData(previewId,index);0!==data.length&&$.each(data,(function(key,value){self.formdata.append(key,value)}))},_uploadSingle:function(i,isBatch){var outData,$thumb,chkComplete,$btnUpload,$btnDelete,uploadFailed,fnBefore,fnSuccess,fnComplete,fnError,updateUploadLog,self=this,total=self.getFileStack().length,formdata=new FormData,previewId=self.previewInitId+"-"+i,hasPostData=self.filestack.length>0||!$.isEmptyObject(self.uploadExtraData),$prog=$("#"+previewId).find(".file-thumb-progress"),params={id:previewId,index:i};self.formdata=formdata,self.showPreview&&($thumb=$("#"+previewId+":not(.file-preview-initial)"),$btnUpload=$thumb.find(".kv-file-upload"),$btnDelete=$thumb.find(".kv-file-remove"),$prog.show()),0===total||!hasPostData||$btnUpload&&$btnUpload.hasClass("disabled")||self._abort(params)||(updateUploadLog=function(i,previewId){uploadFailed||self.updateStack(i,void 0),self.uploadLog.push(previewId),self._checkAsyncComplete()&&(self.fileBatchCompleted=!0)},chkComplete=function(){var $initThumbs,i,j,u=self.uploadCache,len=0,data=self.cacheInitialPreview;self.fileBatchCompleted&&(data&&data.content&&(len=data.content.length),setTimeout((function(){var triggerReset=0===self.getFileStack(!0).length;if(self.showPreview){if(self.previewCache.set(u.content,u.config,u.tags,u.append),len){for(i=0;i<u.content.length;i++)j=i+len,data.content[j]=u.content[i],data.config.length&&(data.config[j]=u.config[i]),data.tags.length&&(data.tags[j]=u.tags[i]);self.initialPreview=$h.cleanArray(data.content),self.initialPreviewConfig=$h.cleanArray(data.config),self.initialPreviewThumbTags=$h.cleanArray(data.tags)}else self.initialPreview=u.content,self.initialPreviewConfig=u.config,self.initialPreviewThumbTags=u.tags;self.cacheInitialPreview={},self.hasInitData&&(self._initPreview(),self._initPreviewActions())}self.unlock(triggerReset),triggerReset&&self._clearFileInput(),$initThumbs=self.$preview.find(".file-preview-initial"),self.uploadAsync&&$initThumbs.length&&($h.addCss($initThumbs,$h.SORT_CSS),self._initSortable()),self._raise("filebatchuploadcomplete",[self.filestack,self._getExtraData()]),self.uploadCount=0,self.uploadStatus={},self.uploadLog=[],self._setProgress(101),self.ajaxAborted=!1}),100))},fnBefore=function(jqXHR){outData=self._getOutData(jqXHR),self.fileBatchCompleted=!1,isBatch||(self.ajaxAborted=!1),self.showPreview&&($thumb.hasClass("file-preview-success")||(self._setThumbStatus($thumb,"Loading"),$h.addCss($thumb,"file-uploading")),$btnUpload.attr("disabled",!0),$btnDelete.attr("disabled",!0)),isBatch||self.lock(),self._raise("filepreupload",[outData,previewId,i]),$.extend(!0,params,outData),self._abort(params)&&(jqXHR.abort(),isBatch||(self._setThumbStatus($thumb,"New"),$thumb.removeClass("file-uploading"),$btnUpload.removeAttr("disabled"),$btnDelete.removeAttr("disabled"),self.unlock()),self._setProgressCancelled())},fnSuccess=function(data,textStatus,jqXHR){var pid=self.showPreview&&$thumb.attr("id")?$thumb.attr("id"):previewId;outData=self._getOutData(jqXHR,data),$.extend(!0,params,outData),setTimeout((function(){$h.isEmpty(data)||$h.isEmpty(data.error)?(self.showPreview&&(self._setThumbStatus($thumb,"Success"),$btnUpload.hide(),self._initUploadSuccess(data,$thumb,isBatch),self._setProgress(101,$prog)),self._raise("fileuploaded",[outData,pid,i]),isBatch?updateUploadLog(i,pid):self.updateStack(i,void 0)):(uploadFailed=!0,self._showUploadError(data.error,params),self._setPreviewError($thumb,i,self.filestack[i],self.retryErrorUploads),self.retryErrorUploads||$btnUpload.hide(),isBatch&&updateUploadLog(i,pid),self._setProgress(101,$("#"+pid).find(".file-thumb-progress"),self.msgUploadError))}),100)},fnComplete=function(){setTimeout((function(){self.showPreview&&($btnUpload.removeAttr("disabled"),$btnDelete.removeAttr("disabled"),$thumb.removeClass("file-uploading")),isBatch?chkComplete():(self.unlock(!1),self._clearFileInput()),self._initSuccessThumbs()}),100)},fnError=function(jqXHR,textStatus,errorThrown){var op=self.ajaxOperations.uploadThumb,errMsg=self._parseError(op,jqXHR,errorThrown,isBatch&&self.filestack[i].name?self.filestack[i].name:null);uploadFailed=!0,setTimeout((function(){isBatch&&updateUploadLog(i,previewId),self.uploadStatus[previewId]=100,self._setPreviewError($thumb,i,self.filestack[i],self.retryErrorUploads),self.retryErrorUploads||$btnUpload.hide(),$.extend(!0,params,self._getOutData(jqXHR)),self._setProgress(101,$prog,self.msgAjaxProgressError.replace("{operation}",op)),self._setProgress(101,$("#"+previewId).find(".file-thumb-progress"),self.msgUploadError),self._showUploadError(errMsg,params)}),100)},formdata.append(self.uploadFileAttr,self.filestack[i],self.filenames[i]),formdata.append("file_id",i),self._ajaxSubmit(fnBefore,fnSuccess,fnComplete,fnError,previewId,i))},_uploadBatch:function(){var fnBefore,fnSuccess,fnError,fnComplete,setAllUploaded,self=this,files=self.filestack,total=files.length,hasPostData=self.filestack.length>0||!$.isEmptyObject(self.uploadExtraData);self.formdata=new FormData,0!==total&&hasPostData&&!self._abort({})&&(setAllUploaded=function(){$.each(files,(function(key){self.updateStack(key,void 0)})),self._clearFileInput()},fnBefore=function(jqXHR){self.lock();var outData=self._getOutData(jqXHR);self.ajaxAborted=!1,self.showPreview&&self._getThumbs().each((function(){var $thumb=$(this),$btnUpload=$thumb.find(".kv-file-upload"),$btnDelete=$thumb.find(".kv-file-remove");$thumb.hasClass("file-preview-success")||(self._setThumbStatus($thumb,"Loading"),$h.addCss($thumb,"file-uploading")),$btnUpload.attr("disabled",!0),$btnDelete.attr("disabled",!0)})),self._raise("filebatchpreupload",[outData]),self._abort(outData)&&(jqXHR.abort(),self._getThumbs().each((function(){var $thumb=$(this),$btnUpload=$thumb.find(".kv-file-upload"),$btnDelete=$thumb.find(".kv-file-remove");$thumb.hasClass("file-preview-loading")&&(self._setThumbStatus($thumb,"New"),$thumb.removeClass("file-uploading")),$btnUpload.removeAttr("disabled"),$btnDelete.removeAttr("disabled")})),self._setProgressCancelled())},fnSuccess=function(data,textStatus,jqXHR){var outData=self._getOutData(jqXHR,data),key=0,$thumbs=self._getThumbs(":not(.file-preview-success)"),keys=$h.isEmpty(data)||$h.isEmpty(data.errorkeys)?[]:data.errorkeys;$h.isEmpty(data)||$h.isEmpty(data.error)?(self._raise("filebatchuploadsuccess",[outData]),setAllUploaded(),self.showPreview?($thumbs.each((function(){var $thumb=$(this);self._setThumbStatus($thumb,"Success"),$thumb.removeClass("file-uploading"),$thumb.find(".kv-file-upload").hide().removeAttr("disabled")})),self._initUploadSuccess(data)):self.reset(),self._setProgress(101)):(self.showPreview&&($thumbs.each((function(){var $thumb=$(this),i=$thumb.attr("data-fileindex");$thumb.removeClass("file-uploading"),$thumb.find(".kv-file-upload").removeAttr("disabled"),$thumb.find(".kv-file-remove").removeAttr("disabled"),0===keys.length||-1!==$.inArray(key,keys)?(self._setPreviewError($thumb,i,self.filestack[i],self.retryErrorUploads),self.retryErrorUploads||($thumb.find(".kv-file-upload").hide(),self.updateStack(i,void 0))):($thumb.find(".kv-file-upload").hide(),self._setThumbStatus($thumb,"Success"),self.updateStack(i,void 0)),$thumb.hasClass("file-preview-error")&&!self.retryErrorUploads||key++})),self._initUploadSuccess(data)),self._showUploadError(data.error,outData,"filebatchuploaderror"),self._setProgress(101,self.$progress,self.msgUploadError))},fnComplete=function(){self.unlock(),self._initSuccessThumbs(),self._clearFileInput(),self._raise("filebatchuploadcomplete",[self.filestack,self._getExtraData()])},fnError=function(jqXHR,textStatus,errorThrown){var outData=self._getOutData(jqXHR),op=self.ajaxOperations.uploadBatch,errMsg=self._parseError(op,jqXHR,errorThrown);self._showUploadError(errMsg,outData,"filebatchuploaderror"),self.uploadFileCount=total-1,self.showPreview&&(self._getThumbs().each((function(){var $thumb=$(this),key=$thumb.attr("data-fileindex");$thumb.removeClass("file-uploading"),void 0!==self.filestack[key]&&self._setPreviewError($thumb)})),self._getThumbs().removeClass("file-uploading"),self._getThumbs(" .kv-file-upload").removeAttr("disabled"),self._getThumbs(" .kv-file-delete").removeAttr("disabled"),self._setProgress(101,self.$progress,self.msgAjaxProgressError.replace("{operation}",op)))},$.each(files,(function(key,data){$h.isEmpty(files[key])||self.formdata.append(self.uploadFileAttr,data,self.filenames[key])})),self._ajaxSubmit(fnBefore,fnSuccess,fnComplete,fnError))},_uploadExtraOnly:function(){var fnBefore,fnSuccess,fnComplete,fnError,self=this,params={};self.formdata=new FormData,self._abort(params)||(fnBefore=function(jqXHR){self.lock();var outData=self._getOutData(jqXHR);self._raise("filebatchpreupload",[outData]),self._setProgress(50),params.data=outData,params.xhr=jqXHR,self._abort(params)&&(jqXHR.abort(),self._setProgressCancelled())},fnSuccess=function(data,textStatus,jqXHR){var outData=self._getOutData(jqXHR,data);$h.isEmpty(data)||$h.isEmpty(data.error)?(self._raise("filebatchuploadsuccess",[outData]),self._clearFileInput(),self._initUploadSuccess(data),self._setProgress(101)):self._showUploadError(data.error,outData,"filebatchuploaderror")},fnComplete=function(){self.unlock(),self._clearFileInput(),self._raise("filebatchuploadcomplete",[self.filestack,self._getExtraData()])},fnError=function(jqXHR,textStatus,errorThrown){var outData=self._getOutData(jqXHR),op=self.ajaxOperations.uploadExtra,errMsg=self._parseError(op,jqXHR,errorThrown);params.data=outData,self._showUploadError(errMsg,outData,"filebatchuploaderror"),self._setProgress(101,self.$progress,self.msgAjaxProgressError.replace("{operation}",op))},self._ajaxSubmit(fnBefore,fnSuccess,fnComplete,fnError))},_deleteFileIndex:function($frame){var ind=$frame.attr("data-fileindex");"init_"===ind.substring(0,5)&&(ind=parseInt(ind.replace("init_","")),this.initialPreview=$h.spliceArray(this.initialPreview,ind),this.initialPreviewConfig=$h.spliceArray(this.initialPreviewConfig,ind),this.initialPreviewThumbTags=$h.spliceArray(this.initialPreviewThumbTags,ind),this.getFrames().each((function(){var $nFrame=$(this),nInd=$nFrame.attr("data-fileindex");"init_"===nInd.substring(0,5)&&(nInd=parseInt(nInd.replace("init_","")))>ind&&(nInd--,$nFrame.attr("data-fileindex","init_"+nInd))})),this.uploadAsync&&(this.cacheInitialPreview=this.getPreview()))},_initFileActions:function(){var self=this,$preview=self.$preview;self.showPreview&&(self._initZoomButton(),self.getFrames(" .kv-file-remove").each((function(){var hasError,n,cap,$el=$(this),$frame=$el.closest($h.FRAMES),id=$frame.attr("id"),ind=$frame.attr("data-fileindex");self._handler($el,"click",(function(){if(!1===self._raise("filepreremove",[id,ind])||!self._validateMinCount())return!1;hasError=$frame.hasClass("file-preview-error"),$h.cleanMemory($frame),$frame.fadeOut("slow",(function(){$h.cleanZoomCache($preview.find("#zoom-"+id)),self.updateStack(ind,void 0),self._clearObjects($frame),$frame.remove(),id&&hasError&&self.$errorContainer.find('li[data-file-id="'+id+'"]').fadeOut("fast",(function(){$(this).remove(),self._errorsExist()||self._resetErrors()})),self._clearFileInput();var filestack=self.getFileStack(!0),chk=self.previewCache.count(),len=filestack.length,hasThumb=self.showPreview&&self.getFrames().length;0!==len||0!==chk||hasThumb?(cap=(n=chk+len)>1?self._getMsgSelected(n):filestack[0]?self._getFileNames()[0]:"",self._setCaption(cap)):self.reset(),self._raise("fileremoved",[id,ind])}))}))})),self.getFrames(" .kv-file-upload").each((function(){var $el=$(this);self._handler($el,"click",(function(){var $frame=$el.closest($h.FRAMES),ind=$frame.attr("data-fileindex");self.$progress.hide(),$frame.hasClass("file-preview-error")&&!self.retryErrorUploads||self._uploadSingle(ind,!1)}))})))},_initPreviewActions:function(){var self=this,$preview=self.$preview,deleteExtraData=self.deleteExtraData||{},btnRemove=$h.FRAMES+" .kv-file-remove",settings=self.fileActionSettings,origClass=settings.removeClass,errClass=settings.removeErrorClass,resetProgress=function(){var hasFiles=self.isAjaxUpload?self.previewCache.count():self.$element.get(0).files.length;$preview.find($h.FRAMES).length||hasFiles||(self._setCaption(""),self.reset(),self.initialCaption="")};self._initZoomButton(),$preview.find(btnRemove).each((function(){var fnBefore,fnSuccess,fnError,$el=$(this),vUrl=$el.data("url")||self.deleteUrl,vKey=$el.data("key");if(!$h.isEmpty(vUrl)&&void 0!==vKey){var settings,params,config,extraData,$frame=$el.closest($h.FRAMES),cache=self.previewCache.data,index=$frame.attr("data-fileindex");index=parseInt(index.replace("init_","")),config=$h.isEmpty(cache.config)&&$h.isEmpty(cache.config[index])?null:cache.config[index],"function"==typeof(extraData=$h.isEmpty(config)||$h.isEmpty(config.extra)?deleteExtraData:config.extra)&&(extraData=extraData()),params={id:$el.attr("id"),key:vKey,extra:extraData},fnBefore=function(jqXHR){self.ajaxAborted=!1,self._raise("filepredelete",[vKey,jqXHR,extraData]),self._abort()?jqXHR.abort():($el.removeClass(errClass),$h.addCss($frame,"file-uploading"),$h.addCss($el,"disabled "+origClass))},fnSuccess=function(data,textStatus,jqXHR){var n,cap;if(!$h.isEmpty(data)&&!$h.isEmpty(data.error))return params.jqXHR=jqXHR,params.response=data,self._showError(data.error,params,"filedeleteerror"),$frame.removeClass("file-uploading"),$el.removeClass("disabled "+origClass).addClass(errClass),void resetProgress();$frame.removeClass("file-uploading").addClass("file-deleted"),$frame.fadeOut("slow",(function(){index=parseInt($frame.attr("data-fileindex").replace("init_","")),self.previewCache.unset(index),n=self.previewCache.count(),cap=n>0?self._getMsgSelected(n):"",self._deleteFileIndex($frame),self._setCaption(cap),self._raise("filedeleted",[vKey,jqXHR,extraData]),$h.cleanZoomCache($preview.find("#zoom-"+$frame.attr("id"))),self._clearObjects($frame),$frame.remove(),resetProgress()}))},fnError=function(jqXHR,textStatus,errorThrown){var op=self.ajaxOperations.deleteThumb,errMsg=self._parseError(op,jqXHR,errorThrown);params.jqXHR=jqXHR,params.response={},self._showError(errMsg,params,"filedeleteerror"),$frame.removeClass("file-uploading"),$el.removeClass("disabled "+origClass).addClass(errClass),resetProgress()},self._mergeAjaxCallback("beforeSend",fnBefore,"delete"),self._mergeAjaxCallback("success",fnSuccess,"delete"),self._mergeAjaxCallback("error",fnError,"delete"),settings=$.extend(!0,{},{url:vUrl,type:"POST",dataType:"json",data:$.extend(!0,{},{key:vKey},extraData)},self.ajaxDeleteSettings),self._handler($el,"click",(function(){if(!self._validateMinCount())return!1;self.ajaxAborted=!1,self._raise("filebeforedelete",[vKey,extraData]),self.ajaxAborted instanceof Promise?self.ajaxAborted.then((function(result){result||$.ajax(settings)})):self.ajaxAborted||$.ajax(settings)}))}}))},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.removeClass("icon-visible")},_showFileIcon:function(){$h.addCss(this.$captionContainer,"icon-visible")},_getSize:function(bytes){var i,sizes,out,size=parseFloat(bytes),func=this.fileSizeGetter;return $.isNumeric(bytes)&&$.isNumeric(size)?("function"==typeof func?out=func(size):0===size?out="0.00 B":(i=Math.floor(Math.log(size)/Math.log(1024)),sizes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],out=1*(size/Math.pow(1024,i)).toFixed(2)+" "+sizes[i]),this._getLayoutTemplate("size").replace("{sizeText}",out)):""},_generatePreviewTemplate:function(cat,data,fname,ftype,previewId,isError,size,frameClass,foot,ind,templ){var getContent,self=this,caption=self.slug(fname),zoomContent="",styleAttribs="",config=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<400?self.previewSettingsSmall[cat]||self.defaults.previewSettingsSmall[cat]:self.previewSettings[cat]||self.defaults.previewSettings[cat],footer=foot||self._renderFileFooter(caption,size,"auto",isError),hasIconSetting=self._getPreviewIcon(fname),typeCss="type-default",forcePrevIcon=hasIconSetting&&self.preferIconicPreview,forceZoomIcon=hasIconSetting&&self.preferIconicZoomPreview;return config&&$.each(config,(function(key,val){styleAttribs+=key+":"+val+";"})),getContent=function(c,d,zoom,frameCss){var id=zoom?"zoom-"+previewId:previewId,tmplt=self._getPreviewTemplate(c),css=(frameClass||"")+" "+frameCss;return self.frameClass&&(css=self.frameClass+" "+css),zoom&&(css=css.replace(" "+$h.SORT_CSS,"")),tmplt=self._parseFilePreviewIcon(tmplt,fname),"text"===c&&(d=$h.htmlEncode(d)),"object"!==cat||ftype||$.each(self.defaults.fileTypeSettings,(function(key,func){"object"!==key&&"other"!==key&&func(fname,ftype)&&(typeCss="type-"+key)})),tmplt.setTokens({previewId:id,caption:caption,frameClass:css,type:ftype,fileindex:ind,typeCss:typeCss,footer:footer,data:d,template:templ||cat,style:styleAttribs?'style="'+styleAttribs+'"':""})},ind=ind||previewId.slice(previewId.lastIndexOf("-")+1),self.fileActionSettings.showZoom&&(zoomContent=getContent(forceZoomIcon?"other":cat,data,!0,"kv-zoom-thumb")),zoomContent="\n"+self._getLayoutTemplate("zoomCache").replace("{zoomContent}",zoomContent),getContent(forcePrevIcon?"other":cat,data,!1,"kv-preview-thumb")+zoomContent},_previewDefault:function(file,previewId,isDisabled){var $preview=this.$preview;if(this.showPreview){var content,fname=file?file.name:"",ftype=file?file.type:"",size=file.size||0,caption=this.slug(fname),isError=!0===isDisabled&&!this.isAjaxUpload,data=$h.objUrl.createObjectURL(file);this._clearDefaultPreview(),content=this._generatePreviewTemplate("other",data,fname,ftype,previewId,isError,size),$preview.append("\n"+content),this._setThumbAttr(previewId,caption,size),!0===isDisabled&&this.isAjaxUpload&&this._setThumbStatus($("#"+previewId),"Error")}},_previewFile:function(i,file,theFile,previewId,data,fileInfo){if(this.showPreview){var content,self=this,fname=file?file.name:"",ftype=fileInfo.type,caption=fileInfo.name,cat=self._parseFileType(ftype,fname),types=self.allowedPreviewTypes,mimes=self.allowedPreviewMimeTypes,$preview=self.$preview,fsize=file.size||0,chkTypes=types&&types.indexOf(cat)>=0,chkMimes=mimes&&-1!==mimes.indexOf(ftype),iData="text"===cat||"html"===cat||"image"===cat?theFile.target.result:data;if("html"===cat&&self.purifyHtml&&window.DOMPurify&&(iData=window.DOMPurify.sanitize(iData)),chkTypes||chkMimes){content=self._generatePreviewTemplate(cat,iData,fname,ftype,previewId,!1,fsize),self._clearDefaultPreview(),$preview.append("\n"+content);var $img=$preview.find("#"+previewId+" img");$img.length&&self.autoOrientImage?$h.validateOrientation(file,(function(value){if(value){var $zoomImg=$preview.find("#zoom-"+previewId+" img"),css="rotate-"+value;value>4&&(css+=$img.width()>$img.height()?" is-portrait-gt4":" is-landscape-gt4"),$h.addCss($img,css),$h.addCss($zoomImg,css),self._raise("fileimageoriented",{$img:$img,file:file}),self._validateImage(previewId,caption,ftype,fsize,iData),$h.adjustOrientedImage($img)}else self._validateImage(previewId,caption,ftype,fsize,iData)})):self._validateImage(previewId,caption,ftype,fsize,iData)}else self._previewDefault(file,previewId);self._setThumbAttr(previewId,caption,fsize),self._initSortable()}},_setThumbAttr:function(id,caption,size){var $frame=$("#"+id);$frame.length&&(size=size&&size>0?this._getSize(size):"",$frame.data({caption:caption,size:size}))},_setInitThumbAttr:function(){var config,caption,size,previewId,data=this.previewCache.data,len=this.previewCache.count();if(0!==len)for(var i=0;i<len;i++)config=data.config[i],previewId=this.previewInitId+"-init_"+i,caption=$h.ifSet("caption",config,$h.ifSet("filename",config)),size=$h.ifSet("size",config),this._setThumbAttr(previewId,caption,size)},_slugDefault:function(text){return $h.isEmpty(text)?"":String(text).replace(/[\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_updateFileDetails:function(numFiles){var $el=this.$element,fileStack=this.getFileStack(),name=$h.isIE(9)&&$h.findFileName($el.val())||$el[0].files[0]&&$el[0].files[0].name||fileStack.length&&fileStack[0].name||"",label=this.slug(name),n=this.isAjaxUpload?fileStack.length:numFiles,nFiles=this.previewCache.count()+n,log=1===n?label:this._getMsgSelected(nFiles);this.isError?(this.$previewContainer.removeClass("file-thumb-loading"),this.$previewStatus.html(""),this.$captionContainer.removeClass("icon-visible")):this._showFileIcon(),this._setCaption(log,this.isError),this.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&this._raise("fileselect",[numFiles,label]),this.previewCache.count()&&this._initPreviewActions()},_setThumbStatus:function($thumb,status){if(this.showPreview){var icon="indicator"+status,msg=icon+"Title",css="file-preview-"+status.toLowerCase(),$indicator=$thumb.find(".file-upload-indicator"),config=this.fileActionSettings;$thumb.removeClass("file-preview-success file-preview-error file-preview-loading"),"Success"===status&&$thumb.find(".file-drag-handle").remove(),$indicator.html(config[icon]),$indicator.attr("title",config[msg]),$thumb.addClass(css),"Error"!==status||this.retryErrorUploads||$thumb.find(".kv-file-upload").attr("disabled",!0)}},_setProgressCancelled:function(){this._setProgress(101,this.$progress,this.msgCancelled)},_setProgress:function(p,$el,error){var out,pct=Math.min(p,100),pctLimit=this.progressUploadThreshold,t=p<=100?this.progressTemplate:this.progressCompleteTemplate,template=pct<100?this.progressTemplate:error?this.progressErrorTemplate:t;$el=$el||this.$progress,$h.isEmpty(template)||(out=pctLimit&&pct>pctLimit&&p<=100?template.setTokens({percent:pctLimit,status:this.msgUploadThreshold}):template.setTokens({percent:pct,status:p>100?this.msgUploadEnd:pct+"%"}),$el.html(out),error&&$el.find('[role="progressbar"]').html(error))},_setFileDropZoneTitle:function(){var strFiles,$zone=this.$container.find(".file-drop-zone"),title=this.dropZoneTitle;this.isClickable&&(strFiles=$h.isEmpty(this.$element.attr("multiple"))?this.fileSingle:this.filePlural,title+=this.dropZoneClickTitle.replace("{files}",strFiles)),$zone.find("."+this.dropZoneTitleClass).remove(),this.isAjaxUpload&&this.showPreview&&0!==$zone.length&&!(this.getFileStack().length>0)&&this.dropZoneEnabled&&(0===$zone.find($h.FRAMES).length&&$h.isEmpty(this.defaultPreviewContent)&&$zone.prepend('<div class="'+this.dropZoneTitleClass+'">'+title+"</div>"),this.$container.removeClass("file-input-new"),$h.addCss(this.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(previewId,pct,total){var sum=0;this._setProgress(pct,$("#"+previewId).find(".file-thumb-progress")),this.uploadStatus[previewId]=pct,$.each(this.uploadStatus,(function(key,value){sum+=value})),this._setProgress(Math.floor(sum/total))},_validateMinCount:function(){var len=this.isAjaxUpload?this.getFileStack().length:this.$element.get(0).files.length;return!(this.validateInitialCount&&this.minFileCount>0&&this._getFileCount(len-1)<this.minFileCount)||(this._noFilesError({}),!1)},_getFileCount:function(fileCount){return this.validateInitialCount&&!this.overwriteInitial&&(fileCount+=this.previewCache.count()),fileCount},_getFileId:function(file){var relativePath,custom=this.generateFileId;return"function"==typeof custom?custom(file,event):file&&(relativePath=String(file.webkitRelativePath||file.fileName||file.name||null))?file.size+"-"+relativePath.replace(/[^0-9a-zA-Z_-]/gim,""):null},_getFileName:function(file){return file&&file.name?this.slug(file.name):void 0},_getFileIds:function(skipNull){return this.fileids.filter((function(n){return skipNull?void 0!==n:null!=n}))},_getFileNames:function(skipNull){return this.filenames.filter((function(n){return skipNull?void 0!==n:null!=n}))},_setPreviewError:function($thumb,i,val,repeat){void 0!==i&&this.updateStack(i,val),this.showPreview&&(!this.removeFromPreviewOnError||repeat?(this._setThumbStatus($thumb,"Error"),this._refreshUploadButton($thumb,repeat)):$thumb.remove())},_refreshUploadButton:function($thumb,repeat){var $btn=$thumb.find(".kv-file-upload"),cfg=this.fileActionSettings,icon=cfg.uploadIcon,title=cfg.uploadTitle;$btn.length&&(repeat&&(icon=cfg.uploadRetryIcon,title=cfg.uploadRetryTitle),$btn.attr("title",title).html(icon))},_checkDimensions:function(i,chk,$img,$thumb,fname,type,params){var msg,dim,$imgEl,limit=this[("Small"===chk?"min":"max")+"Image"+type];!$h.isEmpty(limit)&&$img.length&&($imgEl=$img[0],dim="Width"===type?$imgEl.naturalWidth||$imgEl.width:$imgEl.naturalHeight||$imgEl.height,("Small"===chk?dim>=limit:dim<=limit)||(msg=this["msgImage"+type+chk].setTokens({name:fname,size:limit}),this._showUploadError(msg,params),this._setPreviewError($thumb,i,null)))},_validateImage:function(previewId,fname,ftype,fsize,iData){var params,w1,w2,exifObject,self=this,$preview=self.$preview,$thumb=$preview.find("#"+previewId),i=$thumb.attr("data-fileindex"),$img=$thumb.find("img");fname=fname||"Untitled",$img.one("load",(function(){w1=$thumb.width(),w2=$preview.width(),w1>w2&&$img.css("width","100%"),params={ind:i,id:previewId},self._checkDimensions(i,"Small",$img,$thumb,fname,"Width",params),self._checkDimensions(i,"Small",$img,$thumb,fname,"Height",params),self.resizeImage||(self._checkDimensions(i,"Large",$img,$thumb,fname,"Width",params),self._checkDimensions(i,"Large",$img,$thumb,fname,"Height",params)),self._raise("fileimageloaded",[previewId]);try{exifObject=window.piexif?window.piexif.load(iData):null}catch(err){exifObject=null}self.loadedImages.push({ind:i,img:$img,thumb:$thumb,pid:previewId,typ:ftype,siz:fsize,validated:!1,imgData:iData,exifObj:exifObject}),$thumb.data("exif",exifObject),self._validateAllImages()})).one("error",(function(){self._raise("fileimageloaderror",[previewId])})).each((function(){this.complete?$(this).trigger("load"):this.error&&$(this).trigger("error")}))},_validateAllImages:function(){var i,config,fsize,counter={val:0},numImgs=this.loadedImages.length,minSize=this.resizeIfSizeMoreThan;if(numImgs===this.totalImagesCount&&(this._raise("fileimagesloaded"),this.resizeImage))for(i=0;i<this.loadedImages.length;i++)(config=this.loadedImages[i]).validated||((fsize=config.siz)&&fsize>1e3*minSize&&this._getResizedImage(config,counter,numImgs),this.loadedImages[i].validated=!0)},_getResizedImage:function(config,counter,numImgs){var blob,chkWidth,chkHeight,dataURI,throwError,exifStr,self=this,img=$(config.img)[0],width=img.naturalWidth,height=img.naturalHeight,ratio=1,maxWidth=self.maxImageWidth||width,maxHeight=self.maxImageHeight||height,isValidImage=!(!width||!height),canvas=self.imageCanvas,context=self.imageCanvasContext,type=config.typ,pid=config.pid,ind=config.ind,$thumb=config.thumb,exifObj=config.exifObj;if(throwError=function(msg,params,ev){self.isAjaxUpload?self._showUploadError(msg,params,ev):self._showError(msg,params,ev),self._setPreviewError($thumb,ind)},self.filestack[ind]&&isValidImage&&!(width<=maxWidth&&height<=maxHeight)||(isValidImage&&self.filestack[ind]&&self._raise("fileimageresized",[pid,ind]),counter.val++,counter.val===numImgs&&self._raise("fileimagesresized"),isValidImage)){type=type||self.resizeDefaultImageType,chkWidth=width>maxWidth,chkHeight=height>maxHeight,ratio="width"===self.resizePreference?chkWidth?maxWidth/width:chkHeight?maxHeight/height:1:chkHeight?maxHeight/height:chkWidth?maxWidth/width:1,self._resetCanvas(),width*=ratio,height*=ratio,canvas.width=width,canvas.height=height;try{context.drawImage(img,0,0,width,height),dataURI=canvas.toDataURL(type,self.resizeQuality),exifObj&&(exifStr=window.piexif.dump(exifObj),dataURI=window.piexif.insert(exifStr,dataURI)),blob=$h.dataURI2Blob(dataURI),self.filestack[ind]=blob,self._raise("fileimageresized",[pid,ind]),counter.val++,counter.val===numImgs&&self._raise("fileimagesresized",[void 0,void 0]),blob instanceof Blob||throwError(self.msgImageResizeError,{id:pid,index:ind},"fileimageresizeerror")}catch(err){counter.val++,counter.val===numImgs&&self._raise("fileimagesresized",[void 0,void 0]),throwError(self.msgImageResizeException.replace("{errors}",err.message),{id:pid,index:ind},"fileimageresizeexception")}}else throwError(self.msgImageResizeError,{id:pid,index:ind},"fileimageresizeerror")},_initBrowse:function($container){this.showBrowse?(this.$btnFile=$container.find(".btn-file"),this.$btnFile.append(this.$element)):this.$element.hide()},_initCaption:function(){var cap=this.initialCaption||"";return this.overwriteInitial||$h.isEmpty(cap)?(this.$caption.val(""),!1):(this._setCaption(cap),!0)},_setCaption:function(content,isError){var title,out,icon,n,cap,stack=this.getFileStack();if(this.$caption.length){if(this.$captionContainer.removeClass("icon-visible"),isError)title=$("<div>"+this.msgValidationError+"</div>").text(),cap=(n=stack.length)?1===n&&stack[0]?this._getFileNames()[0]:this._getMsgSelected(n):this._getMsgSelected(this.msgNo),out=$h.isEmpty(content)?cap:content,icon='<span class="'+this.msgValidationErrorClass+'">'+this.msgValidationErrorIcon+"</span>";else{if($h.isEmpty(content))return;out=title=$("<div>"+content+"</div>").text(),icon=this._getLayoutTemplate("fileIcon")}this.$captionContainer.addClass("icon-visible"),this.$caption.attr("title",title).val(out),this.$captionIcon.html(icon)}},_createContainer:function(){var attribs={class:"file-input file-input-new"+(this.rtl?" kv-rtl":"")},$container=$(document.createElement("div")).attr(attribs).html(this._renderMain());return this.$element.before($container),this._initBrowse($container),this.theme&&$container.addClass("theme-"+this.theme),$container},_refreshContainer:function(){var $container=this.$container;$container.before(this.$element),$container.html(this._renderMain()),this._initBrowse($container),this._validateDisabled()},_validateDisabled:function(){this.$caption.attr({readonly:this.isDisabled})},_renderMain:function(){var dropCss=this.isAjaxUpload&&this.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",close=this.showClose?this._getLayoutTemplate("close"):"",preview=this.showPreview?this._getLayoutTemplate("preview").setTokens({class:this.previewClass,dropClass:dropCss}):"",css=this.isDisabled?this.captionClass+" file-caption-disabled":this.captionClass,caption=this.captionTemplate.setTokens({class:css+" kv-fileinput-caption"});return this.mainTemplate.setTokens({class:this.mainClass+(!this.showBrowse&&this.showCaption?" no-browse":""),preview:preview,close:close,caption:caption,upload:this._renderButton("upload"),remove:this._renderButton("remove"),cancel:this._renderButton("cancel"),browse:this._renderButton("browse")})},_renderButton:function(type){var tmplt=this._getLayoutTemplate("btnDefault"),css=this[type+"Class"],title=this[type+"Title"],icon=this[type+"Icon"],label=this[type+"Label"],status=this.isDisabled?" disabled":"",btnType="button";switch(type){case"remove":if(!this.showRemove)return"";break;case"cancel":if(!this.showCancel)return"";css+=" kv-hidden";break;case"upload":if(!this.showUpload)return"";this.isAjaxUpload&&!this.isDisabled?tmplt=this._getLayoutTemplate("btnLink").replace("{href}",this.uploadUrl):btnType="submit";break;case"browse":if(!this.showBrowse)return"";tmplt=this._getLayoutTemplate("btnBrowse");break;default:return""}return css+="browse"===type?" btn-file":" fileinput-"+type+" fileinput-"+type+"-button",$h.isEmpty(label)||(label=' <span class="'+this.buttonLabelClass+'">'+label+"</span>"),tmplt.setTokens({type:btnType,css:css,title:title,status:status,icon:icon,label:label})},_renderThumbProgress:function(){return'<div class="file-thumb-progress kv-hidden">'+this.progressTemplate.setTokens({percent:"0",status:this.msgUploadBegin})+"</div>"},_renderFileFooter:function(caption,size,width,isError){var out,config=this.fileActionSettings,rem=config.showRemove,drg=config.showDrag,upl=config.showUpload,zoom=config.showZoom,template=this._getLayoutTemplate("footer"),tInd=this._getLayoutTemplate("indicator"),ind=isError?config.indicatorError:config.indicatorNew,title=isError?config.indicatorErrorTitle:config.indicatorNewTitle,indicator=tInd.setTokens({indicator:ind,indicatorTitle:title});return size=this._getSize(size),out=this.isAjaxUpload?template.setTokens({actions:this._renderFileActions(upl,!1,rem,zoom,drg,!1,!1,!1),caption:caption,size:size,width:width,progress:this._renderThumbProgress(),indicator:indicator}):template.setTokens({actions:this._renderFileActions(!1,!1,!1,zoom,drg,!1,!1,!1),caption:caption,size:size,width:width,progress:"",indicator:indicator}),out=$h.replaceTags(out,this.previewThumbTags)},_renderFileActions:function(showUpl,showDwn,showDel,showZoom,showDrag,disabled,url,key,isInit,dUrl,dFile){if(!(showUpl||showDwn||showDel||showZoom||showDrag))return"";var css,vUrl=!1===url?"":' data-url="'+url+'"',vKey=!1===key?"":' data-key="'+key+'"',btnDelete="",btnUpload="",btnDownload="",btnZoom="",btnDrag="",template=this._getLayoutTemplate("actions"),config=this.fileActionSettings,otherButtons=this.otherActionButtons.setTokens({dataKey:vKey,key:key}),removeClass=disabled?config.removeClass+" disabled":config.removeClass;return showDel&&(btnDelete=this._getLayoutTemplate("actionDelete").setTokens({removeClass:removeClass,removeIcon:config.removeIcon,removeTitle:config.removeTitle,dataUrl:vUrl,dataKey:vKey,key:key})),showUpl&&(btnUpload=this._getLayoutTemplate("actionUpload").setTokens({uploadClass:config.uploadClass,uploadIcon:config.uploadIcon,uploadTitle:config.uploadTitle})),showDwn&&(btnDownload=(btnDownload=this._getLayoutTemplate("actionDownload").setTokens({downloadClass:config.downloadClass,downloadIcon:config.downloadIcon,downloadTitle:config.downloadTitle,downloadUrl:dUrl||this.initialPreviewDownloadUrl})).setTokens({filename:dFile,key:key})),showZoom&&(btnZoom=this._getLayoutTemplate("actionZoom").setTokens({zoomClass:config.zoomClass,zoomIcon:config.zoomIcon,zoomTitle:config.zoomTitle})),showDrag&&isInit&&(css="drag-handle-init "+config.dragClass,btnDrag=this._getLayoutTemplate("actionDrag").setTokens({dragClass:css,dragTitle:config.dragTitle,dragIcon:config.dragIcon})),template.setTokens({delete:btnDelete,upload:btnUpload,download:btnDownload,zoom:btnZoom,drag:btnDrag,other:otherButtons})},_browse:function(e){this._raise("filebrowse"),e&&e.isDefaultPrevented()||(this.isError&&!this.isAjaxUpload&&this.clear(),this.$captionContainer.focus())},_filterDuplicate:function(file,files,fileIds){var fileId=this._getFileId(file);fileId&&fileIds&&fileIds.indexOf(fileId)>-1||(fileIds||(fileIds=[]),files.push(file),fileIds.push(fileId))},_change:function(e){var self=this,$el=self.$element;if(!self.isAjaxUpload&&$h.isEmpty($el.val())&&self.fileInputCleared)self.fileInputCleared=!1;else{self.fileInputCleared=!1;var msg,total,n,len,mesg,file,previewId,index,p1,p2,tfiles=[],isDragDrop=arguments.length>1,isAjaxUpload=self.isAjaxUpload,files=isDragDrop?e.originalEvent.dataTransfer.files:$el.get(0).files,ctr=self.filestack.length,flagSingle=$h.isEmpty($el.attr("multiple"))&&ctr>0,folders=0,fileIds=self._getFileIds();if(self.reader=null,self._resetUpload(),self._hideFileIcon(),self.isAjaxUpload&&self.$container.find(".file-drop-zone ."+self.dropZoneTitleClass).remove(),isDragDrop?$.each(files,(function(i,f){f&&!f.type&&void 0!==f.size&&f.size%4096==0?folders++:self._filterDuplicate(f,tfiles,fileIds)})):(files=e.target&&void 0===e.target.files?e.target.value?[{name:e.target.value.replace(/^.+\\/,"")}]:[]:e.target.files||{},isAjaxUpload?$.each(files,(function(i,f){self._filterDuplicate(f,tfiles,fileIds)})):tfiles=files),$h.isEmpty(tfiles)||0===tfiles.length)return isAjaxUpload||self.clear(),self._showFolderError(folders),void self._raise("fileselectnone");if(self._resetErrors(),len=tfiles.length,total=self._getFileCount(self.isAjaxUpload?self.getFileStack().length+len:len),self.maxFileCount>0&&total>self.maxFileCount){if(!self.autoReplace||len>self.maxFileCount)return n=self.autoReplace&&len>self.maxFileCount?len:total,msg=self.msgFilesTooMany.replace("{m}",self.maxFileCount).replace("{n}",n),self.isError=(mesg=msg,file=null,previewId=null,index=null,p1=$.extend(!0,{},self._getOutData({},{},files),{id:previewId,index:index}),p2={id:previewId,index:index,file:file,files:files},self.isAjaxUpload?self._showUploadError(mesg,p1):self._showError(mesg,p2)),self.$captionContainer.removeClass("icon-visible"),self._setCaption("",!0),void self.$container.removeClass("file-input-new file-input-ajax-new");total>self.maxFileCount&&self._resetPreviewThumbs(isAjaxUpload)}else!isAjaxUpload||flagSingle?(self._resetPreviewThumbs(!1),flagSingle&&self.clearStack()):!isAjaxUpload||0!==ctr||self.previewCache.count()&&!self.overwriteInitial||self._resetPreviewThumbs(!0);self.isPreviewable?self.readFiles(tfiles):self._updateFileDetails(1),self._showFolderError(folders)}},_abort:function(params){var data;return this.ajaxAborted&&"object"==typeof this.ajaxAborted&&void 0!==this.ajaxAborted.message?((data=$.extend(!0,{},this._getOutData(),params)).abortData=this.ajaxAborted.data||{},data.abortMessage=this.ajaxAborted.message,this._setProgress(101,this.$progress,this.msgCancelled),this._showUploadError(this.ajaxAborted.message,data,"filecustomerror"),this.cancel(),!0):!!this.ajaxAborted},_resetFileStack:function(){var self=this,i=0,newstack=[],newnames=[],newids=[];self._getThumbs().each((function(){var newId,$thumb=$(this),ind=$thumb.attr("data-fileindex"),file=self.filestack[ind],pid=$thumb.attr("id");"-1"!==ind&&-1!==ind&&(void 0!==file?(newstack[i]=file,newnames[i]=self._getFileName(file),newids[i]=self._getFileId(file),$thumb.attr({id:self.previewInitId+"-"+i,"data-fileindex":i}),i++):(newId="uploaded-"+$h.uniqId(),$thumb.attr({id:newId,"data-fileindex":"-1"}),self.$preview.find("#zoom-"+pid).attr("id","zoom-"+newId)))})),self.filestack=newstack,self.filenames=newnames,self.fileids=newids},_isFileSelectionValid:function(cnt){return cnt=cnt||0,this.required&&!this.getFilesCount()?(this.$errorContainer.html(""),this._showUploadError(this.msgFileRequired),!1):!(this.minFileCount>0&&this._getFileCount(cnt)<this.minFileCount)||(this._noFilesError({}),!1)},clearStack:function(){return this.filestack=[],this.filenames=[],this.fileids=[],this.$element},updateStack:function(i,file){return this.filestack[i]=file,this.filenames[i]=this._getFileName(file),this.fileids[i]=file&&this._getFileId(file)||null,this.$element},addToStack:function(file){return this.filestack.push(file),this.filenames.push(this._getFileName(file)),this.fileids.push(this._getFileId(file)),this.$element},getFileStack:function(skipNull){return this.filestack.filter((function(n){return skipNull?void 0!==n:null!=n}))},getFilesCount:function(){var len=this.isAjaxUpload?this.getFileStack().length:this.$element.get(0).files.length;return this._getFileCount(len)},readFiles:function(files){this.reader=new FileReader;var readFile,self=this,$el=self.$element,$preview=self.$preview,reader=self.reader,$container=self.$previewContainer,$status=self.$previewStatus,msgLoading=self.msgLoading,msgProgress=self.msgProgress,previewInitId=self.previewInitId,numFiles=files.length,settings=self.fileTypeSettings,ctr=self.filestack.length,fileTypes=self.allowedFileTypes,typLen=fileTypes?fileTypes.length:0,fileExt=self.allowedFileExtensions,strExt=$h.isEmpty(fileExt)?"":fileExt.join(", "),maxPreviewSize=self.maxFilePreviewSize&&parseFloat(self.maxFilePreviewSize),canPreview=$preview.length&&(!maxPreviewSize||isNaN(maxPreviewSize)),throwError=function(msg,file,previewId,index){var $thumb,p1=$.extend(!0,{},self._getOutData({},{},files),{id:previewId,index:index}),p2={id:previewId,index:index,file:file,files:files};self._previewDefault(file,previewId,!0),self.isAjaxUpload?(self.addToStack(void 0),setTimeout((function(){readFile(index+1)}),100)):numFiles=0,self._initFileActions(),($thumb=$("#"+previewId)).find(".kv-file-upload").hide(),self.removeFromPreviewOnError&&$thumb.remove(),self.isError=self.isAjaxUpload?self._showUploadError(msg,p1):self._showError(msg,p2),self._updateFileDetails(numFiles)};self.loadedImages=[],self.totalImagesCount=0,$.each(files,(function(key,file){var func=self.fileTypeSettings.image;func&&func(file.type)&&self.totalImagesCount++})),(readFile=function(i){if($h.isEmpty($el.attr("multiple"))&&(numFiles=1),i>=numFiles)return self.isAjaxUpload&&self.filestack.length>0?self._raise("filebatchselected",[self.getFileStack()]):self._raise("filebatchselected",[files]),$container.removeClass("file-thumb-loading"),void $status.html("");var fSizeKB,j,msg,typ,chk,typ1,typ2,func,isText,isHtml,isImage,txtFlag,previewId=previewInitId+"-"+(ctr+i),file=files[i],fnText=settings.text,fnImage=settings.image,fnHtml=settings.html,caption=file.name?self.slug(file.name):"",fileSize=(file.size||0)/1024,fileExtExpr="",previewData=$h.objUrl.createObjectURL(file),fileCount=0,strTypes="",knownTypes=0,processFileLoaded=function(){var msg=msgProgress.setTokens({index:i+1,files:numFiles,percent:50,name:caption});setTimeout((function(){$status.html(msg),self._updateFileDetails(numFiles),readFile(i+1)}),100),self._raise("fileloaded",[file,previewId,i,reader])};if(typLen>0)for(j=0;j<typLen;j++)typ1=fileTypes[j],typ2=self.msgFileTypes[typ1]||typ1,strTypes+=0===j?typ2:", "+typ2;if(!1!==caption){if(0===caption.length)return msg=self.msgInvalidFileName.replace("{name}",$h.htmlEncode(file.name)),void throwError(msg,file,previewId,i);if($h.isEmpty(fileExt)||(fileExtExpr=new RegExp("\\.("+fileExt.join("|")+")$","i")),fSizeKB=fileSize.toFixed(2),self.maxFileSize>0&&fileSize>self.maxFileSize)return msg=self.msgSizeTooLarge.setTokens({name:caption,size:fSizeKB,maxSize:self.maxFileSize}),void throwError(msg,file,previewId,i);if(null!==self.minFileSize&&fileSize<=$h.getNum(self.minFileSize))return msg=self.msgSizeTooSmall.setTokens({name:caption,size:fSizeKB,minSize:self.minFileSize}),void throwError(msg,file,previewId,i);if(!$h.isEmpty(fileTypes)&&$h.isArray(fileTypes)){for(j=0;j<fileTypes.length;j+=1)typ=fileTypes[j],fileCount+=(func=settings[typ])&&"function"==typeof func&&func(file.type,file.name)?1:0;if(0===fileCount)return msg=self.msgInvalidFileType.setTokens({name:caption,types:strTypes}),void throwError(msg,file,previewId,i)}if(0===fileCount&&!$h.isEmpty(fileExt)&&$h.isArray(fileExt)&&!$h.isEmpty(fileExtExpr)&&(chk=$h.compare(caption,fileExtExpr),0===(fileCount+=$h.isEmpty(chk)?0:chk.length)))return msg=self.msgInvalidFileExtension.setTokens({name:caption,extensions:strExt}),void throwError(msg,file,previewId,i);if(!self.showPreview)return self.isAjaxUpload&&self.addToStack(file),setTimeout((function(){readFile(i+1),self._updateFileDetails(numFiles)}),100),void self._raise("fileloaded",[file,previewId,i,reader]);if(!canPreview&&fileSize>maxPreviewSize)return self.addToStack(file),$container.addClass("file-thumb-loading"),self._previewDefault(file,previewId),self._initFileActions(),self._updateFileDetails(numFiles),void readFile(i+1);$preview.length&&void 0!==FileReader?(isText=fnText(file.type,caption),isHtml=fnHtml(file.type,caption),isImage=fnImage(file.type,caption),$status.html(msgLoading.replace("{index}",i+1).replace("{files}",numFiles)),$container.addClass("file-thumb-loading"),reader.onerror=function(evt){self._errorHandler(evt,caption)},reader.onload=function(theFile){var hex,fileInfo,uint,byte,contents,mime,textFlag,newReader,bytes=[];if(fileInfo={name:caption,type:file.type},$.each(settings,(function(key,func){"object"!==key&&"other"!==key&&func(file.type,caption)&&knownTypes++})),0===knownTypes){for(uint=new Uint8Array(theFile.target.result),j=0;j<uint.length;j++)byte=uint[j].toString(16),bytes.push(byte);if(hex=bytes.join("").toLowerCase().substring(0,8),mime=$h.getMimeType(hex,"",""),$h.isEmpty(mime)&&(contents=$h.arrayBuffer2String(reader.result),mime=$h.isSvg(contents)?"image/svg+xml":$h.getMimeType(hex,contents,file.type)),fileInfo={name:caption,type:mime},isText=fnText(mime,""),isHtml=fnHtml(mime,""),isImage=fnImage(mime,""),(txtFlag=isText||isHtml)||isImage)return textFlag=txtFlag,(newReader=new FileReader).onerror=function(theFileNew){self._errorHandler(theFileNew,caption)},newReader.onload=function(theFileNew){self._previewFile(i,file,theFileNew,previewId,previewData,fileInfo),self._initFileActions(),processFileLoaded()},void(textFlag?newReader.readAsText(file,self.textEncoding):newReader.readAsDataURL(file))}self._previewFile(i,file,theFile,previewId,previewData,fileInfo),self._initFileActions(),processFileLoaded()},reader.onprogress=function(data){if(data.lengthComputable){var fact=data.loaded/data.total*100,progress=Math.ceil(fact);msg=msgProgress.setTokens({index:i+1,files:numFiles,percent:progress,name:caption}),setTimeout((function(){$status.html(msg)}),100)}},isText||isHtml?reader.readAsText(file,self.textEncoding):isImage?reader.readAsDataURL(file):reader.readAsArrayBuffer(file)):(self._previewDefault(file,previewId),setTimeout((function(){readFile(i+1),self._updateFileDetails(numFiles)}),100),self._raise("fileloaded",[file,previewId,i,reader])),self.addToStack(file)}else readFile(i+1)})(0),self._updateFileDetails(numFiles,!1)},lock:function(){return this._resetErrors(),this.disable(),this.showRemove&&this.$container.find(".fileinput-remove").hide(),this.showCancel&&this.$container.find(".fileinput-cancel").show(),this._raise("filelock",[this.filestack,this._getExtraData()]),this.$element},unlock:function(reset){return void 0===reset&&(reset=!0),this.enable(),this.showCancel&&this.$container.find(".fileinput-cancel").hide(),this.showRemove&&this.$container.find(".fileinput-remove").show(),reset&&this._resetFileStack(),this._raise("fileunlock",[this.filestack,this._getExtraData()]),this.$element},cancel:function(){var i,self=this,xhr=self.ajaxRequests,len=xhr.length;if(len>0)for(i=0;i<len;i+=1)self.cancelling=!0,xhr[i].abort();return self._setProgressCancelled(),self._getThumbs().each((function(){var $thumb=$(this),ind=$thumb.attr("data-fileindex");$thumb.removeClass("file-uploading"),void 0!==self.filestack[ind]&&($thumb.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),$thumb.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),self.unlock()})),self.$element},clear:function(){var cap,self=this;if(self._raise("fileclear"))return self.$btnUpload.removeAttr("disabled"),self._getThumbs().find("video,audio,img").each((function(){$h.cleanMemory($(this))})),self._resetUpload(),self.clearStack(),self._clearFileInput(),self._resetErrors(!0),self._hasInitialPreview()?(self._showFileIcon(),self._resetPreview(),self._initPreviewActions(),self.$container.removeClass("file-input-new")):(self._getThumbs().each((function(){self._clearObjects($(this))})),self.isAjaxUpload&&(self.previewCache.data={}),self.$preview.html(""),cap=!self.overwriteInitial&&self.initialCaption.length>0?self.initialCaption:"",self.$caption.attr("title","").val(cap),$h.addCss(self.$container,"file-input-new"),self._validateDefaultPreview()),0===self.$container.find($h.FRAMES).length&&(self._initCaption()||self.$captionContainer.removeClass("icon-visible")),self._hideFileIcon(),self._raise("filecleared"),self.$captionContainer.focus(),self._setFileDropZoneTitle(),self.$element},reset:function(){if(this._raise("filereset"))return this._resetPreview(),this.$container.find(".fileinput-filename").text(""),$h.addCss(this.$container,"file-input-new"),(this.getFrames().length||this.isAjaxUpload&&this.dropZoneEnabled)&&this.$container.removeClass("file-input-new"),this.clearStack(),this.formdata={},this._setFileDropZoneTitle(),this.$element},disable:function(){return this.isDisabled=!0,this._raise("filedisabled"),this.$element.attr("disabled","disabled"),this.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),$h.addCss(this.$container.find(".btn-file"),"disabled"),this._initDragDrop(),this.$element},enable:function(){return this.isDisabled=!1,this._raise("fileenabled"),this.$element.removeAttr("disabled"),this.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),this.$container.find(".btn-file").removeClass("disabled"),this._initDragDrop(),this.$element},upload:function(){var i,outData,len,totLen=this.getFileStack().length,hasExtraData=!$.isEmptyObject(this._getExtraData());if(this.isAjaxUpload&&!this.isDisabled&&this._isFileSelectionValid(totLen))if(this._resetUpload(),0!==totLen||hasExtraData)if(this.$progress.show(),this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.lock(),this._setProgress(2),0===totLen&&hasExtraData)this._uploadExtraOnly();else{if(len=this.filestack.length,this.hasInitData=!1,!this.uploadAsync)return this._uploadBatch(),this.$element;for(outData=this._getOutData(),this._raise("filebatchpreupload",[outData]),this.fileBatchCompleted=!1,this.uploadCache={content:[],config:[],tags:[],append:!0},this.uploadAsyncCount=this.getFileStack().length,i=0;i<len;i++)this.uploadCache.content[i]=null,this.uploadCache.config[i]=null,this.uploadCache.tags[i]=null;for(this.$preview.find(".file-preview-initial").removeClass($h.SORT_CSS),this._initSortable(),this.cacheInitialPreview=this.getPreview(),i=0;i<len;i++)this.filestack[i]&&this._uploadSingle(i,!0)}else this._showUploadError(this.msgUploadEmpty)},destroy:function(){var $form=this.$form,$cont=this.$container,$el=this.$element,ns=this.namespace;return $(document).off(ns),$(window).off(ns),$form&&$form.length&&$form.off(ns),this.isAjaxUpload&&this._clearFileInput(),this._cleanup(),this._initPreviewCache(),$el.insertBefore($cont).off(ns).removeData(),$cont.off().remove(),$el},refresh:function(options,triggerChange){var $el=this.$element;return options="object"!=typeof options||$h.isEmpty(options)?this.options:$.extend(!0,{},this.options,options),this._init(options,!0),this._listen(),triggerChange&&$el.trigger("change"+this.namespace),$el},zoom:function(frameId){var $frame=this._getFrame(frameId),$modal=this.$modal;$frame&&($h.initModal($modal),$modal.html(this._getModalContent()),this._setZoomContent($frame),$modal.modal("show"),this._initZoomButtons())},getExif:function(frameId){var $frame=this._getFrame(frameId);return $frame&&$frame.data("exif")||null},getFrames:function(cssFilter){return cssFilter=cssFilter||"",this.$preview.find($h.FRAMES+cssFilter)},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}},$.fn.fileinput=function(option){if($h.hasFileAPISupport()||$h.isIE(9)){var args=Array.apply(null,arguments),retvals=[];switch(args.shift(),this.each((function(){var opt,self=$(this),data=self.data("fileinput"),options="object"==typeof option&&option,theme=options.theme||self.data("theme"),l={},t={},lang=options.language||self.data("language")||$.fn.fileinput.defaults.language||"en";data||(theme&&(t=$.fn.fileinputThemes[theme]||{}),"en"===lang||$h.isEmpty($.fn.fileinputLocales[lang])||(l=$.fn.fileinputLocales[lang]||{}),opt=$.extend(!0,{},$.fn.fileinput.defaults,t,$.fn.fileinputLocales.en,l,options,self.data()),data=new FileInput(this,opt),self.data("fileinput",data)),"string"==typeof option&&retvals.push(data[option].apply(data,args))})),retvals.length){case 0:return this;case 1:return retvals[0];default:return retvals}}},$.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:!0,required:!1,rtl:!1,hideThumbnailContent:!1,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,initialPreviewDownloadUrl:"",removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-kv btn-default btn-outline-secondary",fullscreen:"btn btn-kv btn-default btn-outline-secondary",borderless:"btn btn-kv btn-default btn-outline-secondary",close:"btn btn-kv btn-default btn-outline-secondary"},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default btn-secondary",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default btn-secondary",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default btn-secondary",uploadUrl:null,uploadUrlThumb:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar bg-success progress-bar-success",progressErrorClass:"progress-bar bg-danger progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:$h.closeButton("kv-error-close"),slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0,mergeAjaxCallbacks:!1,mergeAjaxDeleteCallbacks:!1,retryErrorUploads:!0},$.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgPlaceholder:"Select {files}...",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgUploadError:"Error",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}},$.fn.fileinput.Constructor=FileInput,$(document).ready((function(){var $input=$("input.file[type=file]");$input.length&&$input.fileinput()}))})),define("pgui.editors/multi_uploader",["pgui.editors/plain","pgui.localizer","bootstrap-file-input"],(function(PlainEditor,localizer){return PlainEditor.extend({setLoading:function(isLoading){var $buttons=$(".fileinput-upload").prop("disabled",isLoading);isLoading?$buttons.addClass("btn-loading"):$buttons.removeClass("btn-loading")},init:function(rootElement,readyCallback){this._super(rootElement,readyCallback);var self=this,uploadUrl=rootElement.closest("form").attr("action");rootElement.fileinput({theme:"explorer-fa",uploadUrl:uploadUrl,initialPreviewAsData:!0,showUpload:!1,showCancel:!1,uploadAsync:!0,fileActionSettings:{showUpload:!1,showDownload:!1,showZoom:!1,removeIcon:'<i class="icon-remove"></i>'},browseIcon:'<i class="icon-folder-open"></i>&nbsp;',browseClass:"btn btn-default",removeIcon:'<i class="icon-remove"></i>',removeLabel:localizer.getString("RemoveAll"),msgValidationErrorIcon:'<i class="icon-exclamation"></i>'}),rootElement.on("filebatchuploadcomplete",(function(event,files,extra){window.location.href=$(".js-close-form").first().attr("href")})),rootElement.on("filepreajax",(function(event,previewId,index){self.setLoading(!0)})),rootElement.on("fileuploaderror",(function(event,previewId,index){self.setLoading(!1)}))}})})),function(factory){"use strict";"function"==typeof define&&define.amd?define("jquery.autocomplete",["jquery"],factory):"object"==typeof exports&&"function"==typeof require?factory(require("jquery")):factory(jQuery)}((function($){"use strict";var utils={escapeRegExChars:function(value){return value.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode:function(containerClass){var div=document.createElement("div");return div.className=containerClass,div.style.position="absolute",div.style.display="none",div}},keys_ESC=27,keys_TAB=9,keys_RETURN=13,keys_UP=38,keys_RIGHT=39,keys_DOWN=40,noop=$.noop;function Autocomplete(el,options){this.element=el,this.el=$(el),this.suggestions=[],this.badQueries=[],this.selectedIndex=-1,this.currentValue=this.element.value,this.timeoutId=null,this.cachedResponse={},this.onChangeTimeout=null,this.onChange=null,this.isLocal=!1,this.suggestionsContainer=null,this.noSuggestionsContainer=null,this.options=$.extend({},Autocomplete.defaults,options),this.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},this.hint=null,this.hintValue="",this.selection=null,this.initialize(),this.setOptions(options)}Autocomplete.utils=utils,$.Autocomplete=Autocomplete,Autocomplete.defaults={ajaxSettings:{},autoSelectFirst:!1,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:function(suggestion,currentValue){if(!currentValue)return suggestion.value;var pattern="("+utils.escapeRegExChars(currentValue)+")";return suggestion.value.replace(new RegExp(pattern,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},formatGroup:function(suggestion,category){return'<div class="autocomplete-group">'+category+"</div>"},delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:noop,onSearchComplete:noop,onSearchError:noop,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(suggestion,originalQuery,queryLowerCase){return-1!==suggestion.value.toLowerCase().indexOf(queryLowerCase)},paramName:"query",transformResult:function(response){return"string"==typeof response?$.parseJSON(response):response},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1},Autocomplete.prototype={initialize:function(){var container,that=this,suggestionSelector="."+that.classes.suggestion,selected=that.classes.selected,options=that.options;that.element.setAttribute("autocomplete","off"),that.noSuggestionsContainer=$('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),that.suggestionsContainer=Autocomplete.utils.createNode(options.containerClass),(container=$(that.suggestionsContainer)).appendTo(options.appendTo||"body"),"auto"!==options.width&&container.css("width",options.width),container.on("mouseover.autocomplete",suggestionSelector,(function(){that.activate($(this).data("index"))})),container.on("mouseout.autocomplete",(function(){that.selectedIndex=-1,container.children("."+selected).removeClass(selected)})),container.on("click.autocomplete",suggestionSelector,(function(){that.select($(this).data("index"))})),container.on("click.autocomplete",(function(){clearTimeout(that.blurTimeoutId)})),that.fixPositionCapture=function(){that.visible&&that.fixPosition()},$(window).on("resize.autocomplete",that.fixPositionCapture),that.el.on("keydown.autocomplete",(function(e){that.onKeyPress(e)})),that.el.on("keyup.autocomplete",(function(e){that.onKeyUp(e)})),that.el.on("blur.autocomplete",(function(){that.onBlur()})),that.el.on("focus.autocomplete",(function(){that.onFocus()})),that.el.on("change.autocomplete",(function(e){that.onKeyUp(e)})),that.el.on("input.autocomplete",(function(e){that.onKeyUp(e)}))},onFocus:function(){this.fixPosition(),this.el.val().length>=this.options.minChars&&this.onValueChange()},onBlur:function(){var that=this;that.blurTimeoutId=setTimeout((function(){that.hide()}),200)},abortAjax:function(){this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null)},setOptions:function(suppliedOptions){var options=$.extend({},this.options,suppliedOptions);this.isLocal=Array.isArray(options.lookup),this.isLocal&&(options.lookup=this.verifySuggestionsFormat(options.lookup)),options.orientation=this.validateOrientation(options.orientation,"bottom"),$(this.suggestionsContainer).css({"max-height":options.maxHeight+"px",width:options.width+"px","z-index":options.zIndex}),this.options=options},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){this.disabled=!0,clearTimeout(this.onChangeTimeout),this.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var $container=$(this.suggestionsContainer),containerParent=$container.parent().get(0);if(containerParent===document.body||this.options.forceFixPosition){var orientation=this.options.orientation,containerHeight=$container.outerHeight(),height=this.el.outerHeight(),offset=this.el.offset(),styles={top:offset.top,left:offset.left};if("auto"===orientation){var viewPortHeight=$(window).height(),scrollTop=$(window).scrollTop(),topOverflow=-scrollTop+offset.top-containerHeight,bottomOverflow=scrollTop+viewPortHeight-(offset.top+height+containerHeight);orientation=Math.max(topOverflow,bottomOverflow)===topOverflow?"top":"bottom"}if(styles.top+="top"===orientation?-containerHeight:height,containerParent!==document.body){var parentOffsetDiff,opacity=$container.css("opacity");this.visible||$container.css("opacity",0).show(),parentOffsetDiff=$container.offsetParent().offset(),styles.top-=parentOffsetDiff.top,styles.top+=containerParent.scrollTop,styles.left-=parentOffsetDiff.left,this.visible||$container.css("opacity",opacity).hide()}"auto"===this.options.width&&(styles.width=this.el.outerWidth()+"px"),$container.css(styles)}},isCursorAtEnd:function(){var range,valLength=this.el.val().length,selectionStart=this.element.selectionStart;return"number"==typeof selectionStart?selectionStart===valLength:!document.selection||((range=document.selection.createRange()).moveStart("character",-valLength),valLength===range.text.length)},onKeyPress:function(e){if(this.disabled||this.visible||e.which!==keys_DOWN||!this.currentValue){if(!this.disabled&&this.visible){switch(e.which){case keys_ESC:this.el.val(this.currentValue),this.hide();break;case keys_RIGHT:if(this.hint&&this.options.onHint&&this.isCursorAtEnd()){this.selectHint();break}return;case keys_TAB:if(this.hint&&this.options.onHint)return void this.selectHint();if(-1===this.selectedIndex)return void this.hide();if(this.select(this.selectedIndex),!1===this.options.tabDisabled)return;break;case keys_RETURN:if(-1===this.selectedIndex)return void this.hide();this.select(this.selectedIndex);break;case keys_UP:this.moveUp();break;case keys_DOWN:this.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}}else this.suggest()},onKeyUp:function(e){var that=this;if(!that.disabled){switch(e.which){case keys_UP:case keys_DOWN:return}clearTimeout(that.onChangeTimeout),that.currentValue!==that.el.val()&&(that.findBestHint(),that.options.deferRequestBy>0?that.onChangeTimeout=setTimeout((function(){that.onValueChange()}),that.options.deferRequestBy):that.onValueChange())}},onValueChange:function(){if(this.ignoreValueChange)this.ignoreValueChange=!1;else{var options=this.options,value=this.el.val(),query=this.getQuery(value);this.selection&&this.currentValue!==query&&(this.selection=null,(options.onInvalidateSelection||$.noop).call(this.element)),clearTimeout(this.onChangeTimeout),this.currentValue=value,this.selectedIndex=-1,options.triggerSelectOnValidInput&&this.isExactMatch(query)?this.select(0):query.length<options.minChars?this.hide():this.getSuggestions(query)}},isExactMatch:function(query){var suggestions=this.suggestions;return 1===suggestions.length&&suggestions[0].value.toLowerCase()===query.toLowerCase()},getQuery:function(value){var parts,delimiter=this.options.delimiter;return delimiter?(parts=value.split(delimiter),$.trim(parts[parts.length-1])):value},getSuggestionsLocal:function(query){var data,options=this.options,queryLowerCase=query.toLowerCase(),filter=options.lookupFilter,limit=parseInt(options.lookupLimit,10);return data={suggestions:$.grep(options.lookup,(function(suggestion){return filter(suggestion,query,queryLowerCase)}))},limit&&data.suggestions.length>limit&&(data.suggestions=data.suggestions.slice(0,limit)),data},getSuggestions:function(q){var response,params,cacheKey,ajaxSettings,that=this,options=that.options,serviceUrl=options.serviceUrl;options.params[options.paramName]=q,!1!==options.onSearchStart.call(that.element,options.params)&&(params=options.ignoreParams?null:options.params,$.isFunction(options.lookup)?options.lookup(q,(function(data){that.suggestions=data.suggestions,that.suggest(),options.onSearchComplete.call(that.element,q,data.suggestions)})):(that.isLocal?response=that.getSuggestionsLocal(q):($.isFunction(serviceUrl)&&(serviceUrl=serviceUrl.call(that.element,q)),cacheKey=serviceUrl+"?"+$.param(params||{}),response=that.cachedResponse[cacheKey]),response&&Array.isArray(response.suggestions)?(that.suggestions=response.suggestions,that.suggest(),options.onSearchComplete.call(that.element,q,response.suggestions)):that.isBadQuery(q)?options.onSearchComplete.call(that.element,q,[]):(that.abortAjax(),ajaxSettings={url:serviceUrl,data:params,type:options.type,dataType:options.dataType},$.extend(ajaxSettings,options.ajaxSettings),that.currentRequest=$.ajax(ajaxSettings).done((function(data){var result;that.currentRequest=null,result=options.transformResult(data,q),that.processResponse(result,q,cacheKey),options.onSearchComplete.call(that.element,q,result.suggestions)})).fail((function(jqXHR,textStatus,errorThrown){options.onSearchError.call(that.element,q,jqXHR,textStatus,errorThrown)})))))},isBadQuery:function(q){if(!this.options.preventBadQueries)return!1;for(var badQueries=this.badQueries,i=badQueries.length;i--;)if(0===q.indexOf(badQueries[i]))return!0;return!1},hide:function(){var container=$(this.suggestionsContainer);$.isFunction(this.options.onHide)&&this.visible&&this.options.onHide.call(this.element,container),this.visible=!1,this.selectedIndex=-1,clearTimeout(this.onChangeTimeout),$(this.suggestionsContainer).hide(),this.signalHint(null)},suggest:function(){if(this.suggestions.length){var category,options=this.options,groupBy=options.groupBy,formatResult=options.formatResult,value=this.getQuery(this.currentValue),className=this.classes.suggestion,classSelected=this.classes.selected,container=$(this.suggestionsContainer),noSuggestionsContainer=$(this.noSuggestionsContainer),beforeRender=options.beforeRender,html="";options.triggerSelectOnValidInput&&this.isExactMatch(value)?this.select(0):($.each(this.suggestions,(function(i,suggestion){groupBy&&(html+=function(suggestion,index){var currentCategory=suggestion.data[groupBy];return category===currentCategory?"":(category=currentCategory,options.formatGroup(suggestion,category))}(suggestion,0)),html+='<div class="'+className+'" data-index="'+i+'">'+formatResult(suggestion,value,i)+"</div>"})),this.adjustContainerWidth(),noSuggestionsContainer.detach(),container.html(html),$.isFunction(beforeRender)&&beforeRender.call(this.element,container,this.suggestions),this.fixPosition(),container.show(),options.autoSelectFirst&&(this.selectedIndex=0,container.scrollTop(0),container.children("."+className).first().addClass(classSelected)),this.visible=!0,this.findBestHint())}else this.options.showNoSuggestionNotice?this.noSuggestions():this.hide()},noSuggestions:function(){var beforeRender=this.options.beforeRender,container=$(this.suggestionsContainer),noSuggestionsContainer=$(this.noSuggestionsContainer);this.adjustContainerWidth(),noSuggestionsContainer.detach(),container.empty(),container.append(noSuggestionsContainer),$.isFunction(beforeRender)&&beforeRender.call(this.element,container,this.suggestions),this.fixPosition(),container.show(),this.visible=!0},adjustContainerWidth:function(){var width,options=this.options,container=$(this.suggestionsContainer);"auto"===options.width?(width=this.el.outerWidth(),container.css("width",width>0?width:300)):"flex"===options.width&&container.css("width","")},findBestHint:function(){var value=this.el.val().toLowerCase(),bestMatch=null;value&&($.each(this.suggestions,(function(i,suggestion){var foundMatch=0===suggestion.value.toLowerCase().indexOf(value);return foundMatch&&(bestMatch=suggestion),!foundMatch})),this.signalHint(bestMatch))},signalHint:function(suggestion){var hintValue="";suggestion&&(hintValue=this.currentValue+suggestion.value.substr(this.currentValue.length)),this.hintValue!==hintValue&&(this.hintValue=hintValue,this.hint=suggestion,(this.options.onHint||$.noop)(hintValue))},verifySuggestionsFormat:function(suggestions){return suggestions.length&&"string"==typeof suggestions[0]?$.map(suggestions,(function(value){return{value:value,data:null}})):suggestions},validateOrientation:function(orientation,fallback){return orientation=$.trim(orientation||"").toLowerCase(),-1===$.inArray(orientation,["auto","bottom","top"])&&(orientation=fallback),orientation},processResponse:function(result,originalQuery,cacheKey){var options=this.options;result.suggestions=this.verifySuggestionsFormat(result.suggestions),options.noCache||(this.cachedResponse[cacheKey]=result,options.preventBadQueries&&!result.suggestions.length&&this.badQueries.push(originalQuery)),originalQuery===this.getQuery(this.currentValue)&&(this.suggestions=result.suggestions,this.suggest())},activate:function(index){var activeItem,selected=this.classes.selected,container=$(this.suggestionsContainer),children=container.find("."+this.classes.suggestion);return container.find("."+selected).removeClass(selected),this.selectedIndex=index,-1!==this.selectedIndex&&children.length>this.selectedIndex?(activeItem=children.get(this.selectedIndex),$(activeItem).addClass(selected),activeItem):null},selectHint:function(){var i=$.inArray(this.hint,this.suggestions);this.select(i)},select:function(i){this.hide(),this.onSelect(i)},moveUp:function(){if(-1!==this.selectedIndex)return 0===this.selectedIndex?($(this.suggestionsContainer).children("."+this.classes.suggestion).first().removeClass(this.classes.selected),this.selectedIndex=-1,this.ignoreValueChange=!1,this.el.val(this.currentValue),void this.findBestHint()):void this.adjustScroll(this.selectedIndex-1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(index){var activeItem=this.activate(index);if(activeItem){var offsetTop,upperBound,lowerBound,heightDelta=$(activeItem).outerHeight();offsetTop=activeItem.offsetTop,lowerBound=(upperBound=$(this.suggestionsContainer).scrollTop())+this.options.maxHeight-heightDelta,offsetTop<upperBound?$(this.suggestionsContainer).scrollTop(offsetTop):offsetTop>lowerBound&&$(this.suggestionsContainer).scrollTop(offsetTop-this.options.maxHeight+heightDelta),this.options.preserveInput||(this.ignoreValueChange=!0,this.el.val(this.getValue(this.suggestions[index].value))),this.signalHint(null)}},onSelect:function(index){var onSelectCallback=this.options.onSelect,suggestion=this.suggestions[index];this.currentValue=this.getValue(suggestion.value),this.currentValue===this.el.val()||this.options.preserveInput||this.el.val(this.currentValue),this.signalHint(null),this.suggestions=[],this.selection=suggestion,$.isFunction(onSelectCallback)&&onSelectCallback.call(this.element,suggestion)},getValue:function(value){var currentValue,parts,delimiter=this.options.delimiter;return delimiter?1===(parts=(currentValue=this.currentValue).split(delimiter)).length?value:currentValue.substr(0,currentValue.length-parts[parts.length-1].length)+value:value},dispose:function(){this.el.off(".autocomplete").removeData("autocomplete"),$(window).off("resize.autocomplete",this.fixPositionCapture),$(this.suggestionsContainer).remove()}},$.fn.devbridgeAutocomplete=function(options,args){return arguments.length?this.each((function(){var inputElement=$(this),instance=inputElement.data("autocomplete");"string"==typeof options?instance&&"function"==typeof instance[options]&&instance[options](args):(instance&&instance.dispose&&instance.dispose(),instance=new Autocomplete(this,options),inputElement.data("autocomplete",instance))})):this.first().data("autocomplete")},$.fn.autocomplete||($.fn.autocomplete=$.fn.devbridgeAutocomplete)})),define("pgui.editors/autocomplete",["pgui.editors/plain","jquery.autocomplete"],(function(PlainEditor){return PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback);var self=this;rootElement.autocomplete({serviceUrl:rootElement.data("url"),minChars:rootElement.data("minimum-input-length"),onSelect:function(suggestion){self.doChanged()}})}})})),
/*!
 * Signature Pad v3.0.0-beta.3 | https://github.com/szimek/signature_pad
 * (c) 2018 Szymon Nowak | Released under the MIT license
 */
function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("signature_pad",factory):global.SignaturePad=factory()}(this,(function(){"use strict";var Point=function(){function Point(x,y,time){this.x=x,this.y=y,this.time=time||Date.now()}return Point.prototype.distanceTo=function(start){return Math.sqrt(Math.pow(this.x-start.x,2)+Math.pow(this.y-start.y,2))},Point.prototype.equals=function(other){return this.x===other.x&&this.y===other.y&&this.time===other.time},Point.prototype.velocityFrom=function(start){return this.time!==start.time?this.distanceTo(start)/(this.time-start.time):0},Point}(),Bezier=function(){function Bezier(startPoint,control2,control1,endPoint,startWidth,endWidth){this.startPoint=startPoint,this.control2=control2,this.control1=control1,this.endPoint=endPoint,this.startWidth=startWidth,this.endWidth=endWidth}return Bezier.fromPoints=function(points,widths){var c2=this.calculateControlPoints(points[0],points[1],points[2]).c2,c3=this.calculateControlPoints(points[1],points[2],points[3]).c1;return new Bezier(points[1],c2,c3,points[2],widths.start,widths.end)},Bezier.calculateControlPoints=function(s1,s2,s3){var dx1=s1.x-s2.x,dy1=s1.y-s2.y,dx2=s2.x-s3.x,dy2=s2.y-s3.y,m1_x=(s1.x+s2.x)/2,m1_y=(s1.y+s2.y)/2,m2_x=(s2.x+s3.x)/2,m2_y=(s2.y+s3.y)/2,l1=Math.sqrt(dx1*dx1+dy1*dy1),l2=Math.sqrt(dx2*dx2+dy2*dy2),k=l2/(l1+l2),cm_x=m2_x+(m1_x-m2_x)*k,cm_y=m2_y+(m1_y-m2_y)*k,tx=s2.x-cm_x,ty=s2.y-cm_y;return{c1:new Point(m1_x+tx,m1_y+ty),c2:new Point(m2_x+tx,m2_y+ty)}},Bezier.prototype.length=function(){for(var px,py,length=0,i=0;i<=10;i+=1){var t=i/10,cx=this.point(t,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),cy=this.point(t,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){var xdiff=cx-px,ydiff=cy-py;length+=Math.sqrt(xdiff*xdiff+ydiff*ydiff)}px=cx,py=cy}return length},Bezier.prototype.point=function(t,start,c1,c2,end){return start*(1-t)*(1-t)*(1-t)+3*c1*(1-t)*(1-t)*t+3*c2*(1-t)*t*t+end*t*t*t},Bezier}();var SignaturePad=function(){function SignaturePad(canvas,options){void 0===options&&(options={});var _this=this;this.canvas=canvas,this.options=options,this._handleMouseDown=function(event){1===event.which&&(_this._mouseButtonDown=!0,_this._strokeBegin(event))},this._handleMouseMove=function(event){_this._mouseButtonDown&&_this._strokeMoveUpdate(event)},this._handleMouseUp=function(event){1===event.which&&_this._mouseButtonDown&&(_this._mouseButtonDown=!1,_this._strokeEnd(event))},this._handleTouchStart=function(event){if(event.preventDefault(),1===event.targetTouches.length){var touch=event.changedTouches[0];_this._strokeBegin(touch)}},this._handleTouchMove=function(event){event.preventDefault();var touch=event.targetTouches[0];_this._strokeMoveUpdate(touch)},this._handleTouchEnd=function(event){if(event.target===_this.canvas){event.preventDefault();var touch=event.changedTouches[0];_this._strokeEnd(touch)}},this.velocityFilterWeight=options.velocityFilterWeight||.7,this.minWidth=options.minWidth||.5,this.maxWidth=options.maxWidth||2.5,this.throttle="throttle"in options?options.throttle:16,this.minDistance="minDistance"in options?options.minDistance:5,this.throttle?this._strokeMoveUpdate=function(fn,wait){void 0===wait&&(wait=250);var result,storedContext,storedArgs,previous=0,timeout=null,later=function(){previous=Date.now(),timeout=null,result=fn.apply(storedContext,storedArgs),timeout||(storedContext=null,storedArgs=[])};return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var now=Date.now(),remaining=wait-(now-previous);return storedContext=this,storedArgs=args,remaining<=0||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=fn.apply(storedContext,storedArgs),timeout||(storedContext=null,storedArgs=[])):timeout||(timeout=window.setTimeout(later,remaining)),result}}(SignaturePad.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=SignaturePad.prototype._strokeUpdate,this.dotSize=options.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=options.penColor||"black",this.backgroundColor=options.backgroundColor||"rgba(0,0,0,0)",this.onBegin=options.onBegin,this.onEnd=options.onEnd,this._ctx=canvas.getContext("2d"),this.clear(),this.on()}return SignaturePad.prototype.clear=function(){var ctx=this._ctx,canvas=this.canvas;ctx.fillStyle=this.backgroundColor,ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillRect(0,0,canvas.width,canvas.height),this._data=[],this._reset(),this._isEmpty=!0},SignaturePad.prototype.fromDataURL=function(dataUrl,options,callback){var _this=this;void 0===options&&(options={});var image=new Image,width=(options.ratio||window.devicePixelRatio,this.canvas.width),height=this.canvas.height;this._reset(),image.onload=function(){_this._ctx.drawImage(image,0,0,width,height),callback&&callback()},image.onerror=function(error){callback&&callback(error)},image.src=dataUrl,this._isEmpty=!1},SignaturePad.prototype.toDataURL=function(type,encoderOptions){return void 0===type&&(type="image/png"),"image/svg+xml"===type?this._toSVG():this.canvas.toDataURL(type,encoderOptions)},SignaturePad.prototype.on=function(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",window.PointerEvent?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())},SignaturePad.prototype.off=function(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.removeEventListener("pointerdown",this._handleMouseDown),this.canvas.removeEventListener("pointermove",this._handleMouseMove),document.removeEventListener("pointerup",this._handleMouseUp),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)},SignaturePad.prototype.isEmpty=function(){return this._isEmpty},SignaturePad.prototype.fromData=function(pointGroups){var _this=this;this.clear(),this._fromData(pointGroups,(function(_a){var color=_a.color,curve=_a.curve;return _this._drawCurve({color:color,curve:curve})}),(function(_a){var color=_a.color,point=_a.point;return _this._drawDot({color:color,point:point})})),this._data=pointGroups},SignaturePad.prototype.toData=function(){return this._data},SignaturePad.prototype._strokeBegin=function(event){var newPointGroup={color:this.penColor,points:[]};"function"==typeof this.onBegin&&this.onBegin(event),this._data.push(newPointGroup),this._reset(),this._strokeUpdate(event)},SignaturePad.prototype._strokeUpdate=function(event){var x=event.clientX,y=event.clientY,point=this._createPoint(x,y),lastPointGroup=this._data[this._data.length-1],lastPoints=lastPointGroup.points,lastPoint=lastPoints.length>0&&lastPoints[lastPoints.length-1],isLastPointTooClose=!!lastPoint&&point.distanceTo(lastPoint)<=this.minDistance,color=lastPointGroup.color;if(!lastPoint||!lastPoint||!isLastPointTooClose){var curve=this._addPoint(point);lastPoint?curve&&this._drawCurve({color:color,curve:curve}):this._drawDot({color:color,point:point}),lastPoints.push({time:point.time,x:point.x,y:point.y})}},SignaturePad.prototype._strokeEnd=function(event){this._strokeUpdate(event),"function"==typeof this.onEnd&&this.onEnd(event)},SignaturePad.prototype._handlePointerEvents=function(){this._mouseButtonDown=!1,this.canvas.addEventListener("pointerdown",this._handleMouseDown),this.canvas.addEventListener("pointermove",this._handleMouseMove),document.addEventListener("pointerup",this._handleMouseUp)},SignaturePad.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},SignaturePad.prototype._handleTouchEvents=function(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)},SignaturePad.prototype._reset=function(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},SignaturePad.prototype._createPoint=function(x,y){var rect=this.canvas.getBoundingClientRect();return new Point(x-rect.left,y-rect.top,(new Date).getTime())},SignaturePad.prototype._addPoint=function(point){var _lastPoints=this._lastPoints;if(_lastPoints.push(point),_lastPoints.length>2){3===_lastPoints.length&&_lastPoints.unshift(_lastPoints[0]);var widths=this._calculateCurveWidths(_lastPoints[1],_lastPoints[2]),curve=Bezier.fromPoints(_lastPoints,widths);return _lastPoints.shift(),curve}return null},SignaturePad.prototype._calculateCurveWidths=function(startPoint,endPoint){var velocity=this.velocityFilterWeight*endPoint.velocityFrom(startPoint)+(1-this.velocityFilterWeight)*this._lastVelocity,newWidth=this._strokeWidth(velocity),widths={end:newWidth,start:this._lastWidth};return this._lastVelocity=velocity,this._lastWidth=newWidth,widths},SignaturePad.prototype._strokeWidth=function(velocity){return Math.max(this.maxWidth/(velocity+1),this.minWidth)},SignaturePad.prototype._drawCurveSegment=function(x,y,width){var ctx=this._ctx;ctx.moveTo(x,y),ctx.arc(x,y,width,0,2*Math.PI,!1),this._isEmpty=!1},SignaturePad.prototype._drawCurve=function(_a){var color=_a.color,curve=_a.curve,ctx=this._ctx,widthDelta=curve.endWidth-curve.startWidth,drawSteps=2*Math.floor(curve.length());ctx.beginPath(),ctx.fillStyle=color;for(var i=0;i<drawSteps;i+=1){var t=i/drawSteps,tt=t*t,ttt=tt*t,u=1-t,uu=u*u,uuu=uu*u,x=uuu*curve.startPoint.x;x+=3*uu*t*curve.control1.x,x+=3*u*tt*curve.control2.x,x+=ttt*curve.endPoint.x;var y=uuu*curve.startPoint.y;y+=3*uu*t*curve.control1.y,y+=3*u*tt*curve.control2.y,y+=ttt*curve.endPoint.y;var width=curve.startWidth+ttt*widthDelta;this._drawCurveSegment(x,y,width)}ctx.closePath(),ctx.fill()},SignaturePad.prototype._drawDot=function(_a){var color=_a.color,point=_a.point,ctx=this._ctx,width="function"==typeof this.dotSize?this.dotSize():this.dotSize;ctx.beginPath(),this._drawCurveSegment(point.x,point.y,width),ctx.closePath(),ctx.fillStyle=color,ctx.fill()},SignaturePad.prototype._fromData=function(pointGroups,drawCurve,drawDot){for(var _i=0,pointGroups_1=pointGroups;_i<pointGroups_1.length;_i++){var group=pointGroups_1[_i],color=group.color,points=group.points;if(points.length>1)for(var j=0;j<points.length;j+=1){var basicPoint=points[j],point=new Point(basicPoint.x,basicPoint.y,basicPoint.time);this.penColor=color,0===j&&this._reset();var curve=this._addPoint(point);curve&&drawCurve({color:color,curve:curve})}else this._reset(),drawDot({color:color,point:points[0]})}},SignaturePad.prototype._toSVG=function(){var _this=this,pointGroups=this._data,ratio=Math.max(window.devicePixelRatio||1,1),maxX=this.canvas.width/ratio,maxY=this.canvas.height/ratio,svg=document.createElementNS("http://www.w3.org/2000/svg","svg");if(svg.setAttribute("width",this.canvas.width.toString()),svg.setAttribute("height",this.canvas.height.toString()),"transparent"!=this.backgroundColor){var rect=document.createElement("rect");rect.setAttribute("width","100%"),rect.setAttribute("height","100%"),rect.setAttribute("fill",this.backgroundColor),svg.appendChild(rect)}this._fromData(pointGroups,(function(_a){var color=_a.color,curve=_a.curve,path=document.createElement("path");if(!(isNaN(curve.control1.x)||isNaN(curve.control1.y)||isNaN(curve.control2.x)||isNaN(curve.control2.y))){var attr="M "+curve.startPoint.x.toFixed(3)+","+curve.startPoint.y.toFixed(3)+" C "+curve.control1.x.toFixed(3)+","+curve.control1.y.toFixed(3)+" "+curve.control2.x.toFixed(3)+","+curve.control2.y.toFixed(3)+" "+curve.endPoint.x.toFixed(3)+","+curve.endPoint.y.toFixed(3);path.setAttribute("d",attr),path.setAttribute("stroke-width",(2.25*curve.endWidth).toFixed(3)),path.setAttribute("stroke",color),path.setAttribute("fill","none"),path.setAttribute("stroke-linecap","round"),svg.appendChild(path)}}),(function(_a){var color=_a.color,point=_a.point,circle=document.createElement("circle"),dotSize="function"==typeof _this.dotSize?_this.dotSize():_this.dotSize;circle.setAttribute("r",dotSize.toString()),circle.setAttribute("cx",point.x.toString()),circle.setAttribute("cy",point.y.toString()),circle.setAttribute("fill",color),svg.appendChild(circle)}));var header='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+maxX+" "+maxY+'" width="'+maxX+'" height="'+maxY+'">',body=svg.innerHTML;if(void 0===body){var dummy=document.createElement("dummy"),nodes=svg.childNodes;dummy.innerHTML="";for(var i=0;i<nodes.length;i+=1)dummy.appendChild(nodes[i].cloneNode(!0));body=dummy.innerHTML}return"data:image/svg+xml;base64,"+btoa(header+body+"</svg>")},SignaturePad}();return SignaturePad})),define("pgui.editors/signature",["pgui.editors/plain","signature_pad"],(function(PlainEditor,Signature){return PlainEditor.extend({init:function(rootElement,readyCallback){this._super(rootElement,readyCallback);var self=this;this._history=[];var initialValue="",$signatureContainer=rootElement.closest("div"),canvas=$signatureContainer.find("canvas").first().get(0);this.formatForSaving=rootElement.data("format-for-saving"),this.$clearBtn=$signatureContainer.find("[data-action=clear]"),this.$undoBtn=$signatureContainer.find("[data-action=undo]");var penColor=rootElement.data("pen-color")?rootElement.data("pen-color"):"black",backgroundColor=rootElement.data("background-color")?rootElement.data("background-color"):"transparent";this.signaturePad=new Signature(canvas,{penColor:penColor,backgroundColor:backgroundColor,onEnd:function(){self.rootElement.val(self.toDataURL()),self._history.push(self.getValue()),self.$undoBtn.prop("disabled",!1)}}),this.getValue()&&(this.signaturePad.fromDataURL(this.getValue()),initialValue=this.getValue()),this._enableControls(this.getEnabled()&&!this.getReadonly()),this.$clearBtn.click((function(){return self.signaturePad.clear(),self.rootElement.val(""),self._history=[],initialValue="",self.$undoBtn.prop("disabled",!0),!1})),this.$undoBtn.click((function(){return self._history.pop(),0==self._history.length?(self.setValue(initialValue),$(this).prop("disabled",!0)):self.setValue(self._history[self._history.length-1]),!1}))},setValue:function(value){return this.rootElement.val(value),this.signaturePad.clear(),this.signaturePad.fromDataURL(value),this},toDataURL:function(){return"svg"==this.formatForSaving?this.signaturePad.toDataURL("image/svg+xml"):"jpg"==this.formatForSaving?this.signaturePad.toDataURL("image/jpeg"):this.signaturePad.toDataURL()},setEnabled:function(value){return this._super(value),this._enableControls(value&&!this.getReadonly()),this},setReadonly:function(value){return this._super(value),this._enableControls(!value&&this.getEnabled()),this},_enableControls:function(value){value?(this.signaturePad.on(),this.$clearBtn.prop("disabled",!1),this._history.length>0&&this.$undoBtn.prop("disabled",!1)):(this.signaturePad.off(),this.$clearBtn.prop("disabled",!0),this.$undoBtn.prop("disabled",!0))}})})),define("pgui.editors",["class","microevent","underscore","pgui.editors/dynamic_combobox","pgui.editors/checkbox","pgui.editors/checkboxgroup","pgui.editors/combobox","pgui.editors/custom","pgui.editors/datetime","pgui.editors/html","pgui.editors/image_uploader","pgui.editors/multivalue_select","pgui.editors/remote_multivalue_select","pgui.editors/plain","pgui.editors/radio","pgui.editors/text","pgui.editors/mask","pgui.editors/cascading_combobox","pgui.editors/dynamic_cascading_combobox","pgui.editors/static_editor","pgui.editors/multi_uploader","pgui.editors/autocomplete","pgui.editors/signature"],(function(Class,events,_,DynamicCombobox,Checkbox,CheckboxGroup,Combobox,Custom,DateTime,Html,ImageUploader,MultiValueSelect,RemoteMultiValueSelect,Plain,Radio,Text,Mask,CascadingCombobox,DynamicCascadingCombobox,StaticEditor,MultiUploader,Autocomplete,Signature){var editorNames={dynamic_combobox:DynamicCombobox,checkbox:Checkbox,checkboxgroup:CheckboxGroup,color:Plain,combobox:Combobox,datetime:DateTime,html_wysiwyg:Html,imageuploader:ImageUploader,masked:Mask,multivalue_select:MultiValueSelect,remote_multivalue_select:RemoteMultiValueSelect,radio:Radio,range:Plain,spin:Plain,text:Text,textarea:Text,time:DateTime,cascading_combobox:CascadingCombobox,dynamic_cascading_combobox:DynamicCascadingCombobox,static_editor:StaticEditor,multiuploader:MultiUploader,autocomplete:Autocomplete,signature:Signature,toggle:Checkbox},EditorsController=events.mixin(Class.extend({init:function(context){this.context=context,this.editors={},this.calculateControlValuesIntervalId=-1},captureEditors:function(readyCallback){var $editors=this.context.find("[data-editor]"),pendingEditorsCount=$editors.length;$editors.each(_.bind((function(index,item){var $item=$(item),editorName=$item.data("editor");editorName=editorName.replace(/\.\.\/custom_templates\/editors\//,""),new editorNames[editorName]($item,_.bind((function(editor){pendingEditorsCount--,this.editors[editor.getFieldName()]=editor,$item.data("editor",editor),pendingEditorsCount<=0&&(this.trigger("oninitdEvent",this.editors),this.trigger("onCalculateControlValuesEvent",this.editors),_.isFunction(readyCallback)&&readyCallback(this))}),this)).onChange(_.bind((function(sender){this.trigger("onEditorValueChangeEvent",sender,this.editors)}),this))}),this))},oninitd:function(callback){this.bind("oninitdEvent",callback)},onEditorValueChange:function(callback){this.bind("onEditorValueChangeEvent",callback)},onCalculateControlValues:function(callback){this.bind("onCalculateControlValuesEvent",callback)},destroy:function(){clearInterval(this.calculateControlValuesIntervalId),_.each(this.editors,(function(editor){editor.destroy()}))}}));return{init:function($container,readyCallback){var formId=$container.is("form")?$container.attr("id"):$container.find("form").first().attr("id"),editorValuesChangedCallback=window[formId+"_EditorValuesChanged"],initFormCallback=window[formId+"_initd"],calculateControlValuesCallback=window[formId+"_CalculateControlValues"],editorsController=new EditorsController($container);return editorsController.oninitd((function(editors){if(_.isFunction(initFormCallback))try{initFormCallback(editors)}catch(err){console.error(err)}})),editorsController.onEditorValueChange((function(sender,editors){if(_.isFunction(editorValuesChangedCallback))try{editorValuesChangedCallback(sender,editors)}catch(err){console.error(err)}})),editorsController.onCalculateControlValues((function(editors){if(_.isFunction(calculateControlValuesCallback))try{calculateControlValuesCallback(editors),editorsController.calculateControlValuesIntervalId=setInterval((function(){calculateControlValuesCallback(editors)}),1e3)}catch(err){console.error(err)}})),editorsController.captureEditors(readyCallback),editorsController},getEditorByName:function(name){var editorName=name.replace(/\.\.\/custom_templates\/editors\//,"");return editorNames[editorName]}}})),define("pgui.filter_builder",["class","underscore","pgui.filter_common","pgui.events","pgui.editors","pgui.localizer","pgui.shortcuts"],(function(Class,_,Filter,pgevents,editors,localizer,shortcuts){var Builder=Class.extend({init:function($modal){this.$modal=$modal,this.$container=$modal.find(".js-filter-builder-container"),this.$disableFilterCheckbox=$modal.find(".js-filter-builder-disable").first(),this.columns=[],this.filterComponent=new Group;var self=this;this.$modal.on("shown.bs.modal",(function(){shortcuts.push(["filter_builder"])})).on("click",".js-filter-builder-commit",(function(e){e.preventDefault(),self.filterComponent=self.currentFilterComponent,self.submit()})).on("hidden.bs.modal",(function(e){self.hide(),shortcuts.pop()})),this.$modal.on("submit",(function(e){e.preventDefault()})).on("click",".js-group-add-component",(function(e){var type=$(e.currentTarget).data("type"),$group=getComponentElement(e.currentTarget),condition=new Condition(self._getDefaultColumn()),component="condition"===type?condition:new Group(null,[condition]);return $group.data("component").addChild(component),self._addComponentToDOM($group.find(".js-group-content").first(),component,!0),!1})).on("click",".js-component-remove",(function(e){var $component=getComponentElement(e.currentTarget),component=$component.data("component");if(self.currentFilterComponent===component){self.currentFilterComponent=new Group,self.$disableFilterCheckbox.prop("checked",!1);var $componentDOM=self.currentFilterComponent.getDOM();$component.replaceWith($componentDOM,self.columns),$componentDOM.find("td").first().removeAttr("colspan")}else self.currentFilterComponent.removeChild(component),$component.remove();return!1})).on("click",".js-group-operator-select",(function(e){var $link=$(e.currentTarget),$component=getComponentElement(e.currentTarget),data=$link.data();return $component.find(".js-group-operator-text").first().text(data.translate),$component.data("component").setOperator(data.operator),$link.blur().closest(".dropdown").find(".dropdown-toggle").dropdown("toggle"),!1})).on("change",".js-condition-field-select",(function(e){var $option=$(e.currentTarget),$component=getComponentElement(e.currentTarget),component=$component.data("component");component.setColumn(self._getColumnByName($option.val())),$component.replaceWith(component.getDOM(self.columns))})).on("change",".js-condition-operator-select",(function(e){var $option=$(e.currentTarget),$component=getComponentElement(e.currentTarget),component=$component.data("component");component.setOperator($option.val()),component.createEditorsDOM($component.find(".js-value").first())})).on("click",".js-component-toggle",(function(e){var $link=$(e.currentTarget),$icon=$link.find("span"),$component=getComponentElement($link),component=$component.data("component"),nextIsEnabled=!component.isEnabled();component.setEnabled(nextIsEnabled),nextIsEnabled?($link.attr("title",localizer.getString("DisableFilter")),$icon.addClass("icon-disable").removeClass("icon-enable"),component.isCondition()?$component.find("select,input").prop("disabled",!1):$component.removeClass("filter-builder-group-disabled")):($link.attr("title",localizer.getString("EnableFilter")),$icon.addClass("icon-enable").removeClass("icon-disable"),component.isCondition()?$component.find("select,input").prop("disabled",!0):$component.addClass("filter-builder-group-disabled")),self.currentFilterComponent===component&&self.$disableFilterCheckbox.prop("checked",!component.isEnabled()),e.preventDefault()})).on("change",".js-filter-builder-disable",function(e){$modal.find(".js-component .js-component-toggle").first().click()}.bind(this))},show:function(){return this.$modal.modal("show"),this.currentFilterComponent=new Group,this.currentFilterComponent.deserialize(this.columns,this.filterComponent.serialize()),this.currentFilterComponent.isEmpty()&&this.currentFilterComponent.addChild(new Condition(this._getDefaultColumn())),this.$container.html(""),this.$disableFilterCheckbox.prop("checked",!this.currentFilterComponent.isEnabled()),this._addComponentToDOM(this.$container,this.currentFilterComponent),this},hide:function(){return this.$modal.modal("hide"),this},addColumn:function(column){return this.columns.push(column),this},getColumns:function(){return this.columns},setFilterComponent:function(filterComponent){return this.filterComponent=filterComponent,this},setEnabled:function(isEnabled){return this.filterComponent.setEnabled(isEnabled),this},reset:function(){return this.filterComponent=new Group,this},submit:function(){this.$modal.find("[data-editor]").trigger("change");var jsonData=JSON.stringify(this.filterComponent.serialize());return $("<form>").attr("method","POST").append($('<input type="hidden" name="filter_builder">').val(jsonData)).hide().appendTo($("body")).submit(),this},_addComponentToDOM:function($container,component,isFocused){var $componentDOM=component.getDOM(this.columns);return $container.append($componentDOM),isFocused&&$componentDOM.find(".js-condition-field-select").first().focus(),component===this.currentFilterComponent&&$componentDOM.find("td").first().removeAttr("colspan"),$componentDOM},_getDefaultColumn:function(){return _.first(this.columns)},_getColumnByName:function(columnName){return _.find(this.columns,(function(column){return column.getName()===columnName}))}}),Group=Filter.Group.extend({createCondition:function(){return new Condition},getDOM:function(columns){var $el=$(createTemplate("group")({isEnabled:this.enabled,operator:localizer.getString("Operator"+this.operator[0]+this.operator.toLowerCase().slice(1))})).data("component",this),$container=$el.find(".js-group-content").first();return _.each(this.children,(function(child){$container.append(child.getDOM(columns))})),$el}}),Condition=Filter.Condition.extend({setOperator:function(operator){var valuesCount=function(column,operator){switch(operator){case Filter.ConditionOperator.IN:case Filter.ConditionOperator.NOT_IN:return 1/0;default:return getEditorsCount(column,operator)}}(this.column,operator);return this.editors&&this.editors[0]&&!this.editors[0].isMultivalue()&&this.setValues(this.values.slice(0,valuesCount)).setDisplayValues(this.displayValues.slice(0,valuesCount)),this._super(operator)},getDOM:function(columns){var $el=$(createTemplate("condition")({isEnabled:this.enabled,columnName:this.column.getName(),operator:this.operator,columns:columns,operators:_.reduce(this.column.getOperators(),(function(acc,operator){return acc[operator]=localizer.getString("FilterOperator"+operator),acc}),{})})).data("component",this);return this.createEditorsDOM($el.find(".js-value").first()),$el},createEditorsDOM:function($container){$container.html("");var operator,column,editorsCount=getEditorsCount(this.column,this.operator);editorsCount>1?$container.addClass("filter-builder-condition-value-multiple"):$container.removeClass("filter-builder-condition-value-multiple"),this.editors=[];for(var i=0;i<editorsCount;i++){var $editorTemplate=(operator=this.operator,column=this.column,$($("#filter_builder_editor_"+operator+"_"+column.getName().replace(/ /g,"_")).html()));if(0!==$editorTemplate.length){var $editorWrapper=$("<div>").append($editorTemplate);$container.append($editorWrapper);var editorIndex=i,$editorElement=$editorWrapper.find("[data-editor]").first(),editor=new(editors.getEditorByName($editorElement.data("editor")))($editorElement);this.editors[i]=editor,editor.setEnabled(this.isEnabled()),exchangeValues(editor,this,editorIndex),editor.onChange(_.partial(setConditionValues,editor,this,editorIndex)),editorsCount>1&&i!==editorsCount-1&&$container.append($("<div>").addClass("filter-builder-condition-value-divider").text(localizer.getString("And")))}}return this}});function exchangeValues(editor,condition,index){if(editor.isMultivalue()){var values=condition.getValues();values?editor.setValueEx(values):setConditionValues(editor,condition,index)}else{var value=condition.getValueAt(index);null!==value?editor.setValueEx(value):setConditionValues(editor,condition,index)}}function setConditionValues(editor,condition,index){editor.isMultivalue()?condition.setValues(editor.getValueEx()).setDisplayValues(editor.getDisplayValue()):condition.setValueAt(index,editor.getValueEx()).setDisplayValueAt(index,editor.getDisplayValue())}var templateSelectors={condition:"#filterBuilderConditionTemplate",group:"#filterBuilderGroupTemplate"},templates={};function createTemplate(name){if(templates[name])return templates[name];var template=_.template($(templateSelectors[name]).html());return templates[name]=template,template}function getComponentElement(element){return $(element).closest(".js-component")}function getEditorsCount(column,operator){switch(operator){case Filter.ConditionOperator.IS_BETWEEN:case Filter.ConditionOperator.IS_NOT_BETWEEN:return 2;case Filter.ConditionOperator.IS_BLANK:case Filter.ConditionOperator.IS_NOT_BLANK:case Filter.ConditionOperator.TODAY:return 0;default:return 1}}return{Group:Group,Condition:Condition,create:function(id,$modal){return new Builder(id,$modal)}}})),jQuery.fn.highlight=function(pat,opt,options){options=$.extend({hint:""},options);function innerHighlight(node,pat,opt,options){var skip=0;if(3==node.nodeType){var pos=-1;pos="END"==opt?node.data.toLowerCase().lastIndexOf(pat):node.data.toLowerCase().indexOf(pat);var dataLength=node.data.toLowerCase().length;if(pos>=0&&"ALL"==opt||0==pos&&"START"==opt||pos>=0&&pos>=dataLength-pat.length&&"END"==opt){var spannode=document.createElement("span");spannode.title=options.hint,spannode.className="highlight";var middlebit=node.splitText(pos),middleclone=(middlebit.splitText(pat.length),middlebit.cloneNode(!0));spannode.appendChild(middleclone),middlebit.parentNode.replaceChild(spannode,middlebit),skip=1}}else if(1==node.nodeType&&node.childNodes&&!/(script|style)/i.test(node.tagName))for(var i=0;i<node.childNodes.length;++i)i+=innerHighlight(node.childNodes[i],pat,opt,options);return skip}return this.each((function(){""!=pat&&innerHighlight(this,pat.toLowerCase(),opt,options)}))},jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each((function(){with(this.parentNode.firstChild.nodeName,this.parentNode)replaceChild(this.firstChild,this),normalize()})).end()},define("jquery.highlight",(function(){})),function(window,document,undefined){"use strict";var factory;factory=function($){var pluginName="webuiPopover",pluginClass="webui-popover",pluginType="webui.popover",defaults={placement:"auto",container:null,width:"auto",height:"auto",trigger:"click",style:"",delay:{show:null,hide:null},async:{type:"GET",before:null,success:null,error:null},cache:!0,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,url:"",type:"html",animation:null,template:'<div class="webui-popover"><div class="webui-arrow"></div><div class="webui-popover-inner"><a href="#" class="close"></a><h3 class="webui-popover-title"></h3><div class="webui-popover-content"><i class="icon-refresh"></i> <p>&nbsp;</p></div></div></div>',backdrop:!1,dismissible:!0,onShow:null,onHide:null,abortXHR:!0,autoHide:!1,offsetTop:0,offsetLeft:0,iframeOptions:{frameborder:"0",allowtransparency:"true",id:"",name:"",scrolling:"",onload:"",height:"",width:""}},_srcElements=[],backdrop=$('<div class="webui-popover-backdrop"></div>'),_globalIdSeed=0,_isBodyEventHandled=!1,$document=$(document),toNumber=function(numeric,fallback){return isNaN(numeric)?fallback||0:Number(numeric)},getPopFromElement=function($element){return $element.data("plugin_"+pluginName)},hideAllPop=function(){for(var pop=null,i=0;i<_srcElements.length;i++)(pop=getPopFromElement(_srcElements[i]))&&pop.hide(!0);$document.trigger("hiddenAll."+pluginType)},pointerEventToXY=function(e){var out={x:0,y:0};if("touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type||"touchcancel"===e.type){var touch=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];out.x=touch.pageX,out.y=touch.pageY}else"mousedown"!==e.type&&"mouseup"!==e.type&&"click"!==e.type||(out.x=e.pageX,out.y=e.pageY);return out};function WebuiPopover(element,options){this.$element=$(element),options&&("string"!==$.type(options.delay)&&"number"!==$.type(options.delay)||(options.delay={show:options.delay,hide:options.delay})),this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this._targetclick=!1,this.init(),_srcElements.push(this.$element)}WebuiPopover.prototype={init:function(){"click"===this.getTrigger()?this.$element.off("click touchend").on("click touchend",$.proxy(this.toggle,this)):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave click").on("mouseenter",$.proxy(this.mouseenterHandler,this)).on("mouseleave",$.proxy(this.mouseleaveHandler,this)),this._poped=!1,this._inited=!0,this._opened=!1,this._idSeed=_globalIdSeed,this.options.container=$(this.options.container||document.body).first(),this.options.backdrop&&backdrop.appendTo(this.options.container).hide(),_globalIdSeed++,"sticky"===this.getTrigger()&&this.show()},destroy:function(){for(var index=-1,i=0;i<_srcElements.length;i++)if(_srcElements[i]===this.$element){index=i;break}_srcElements.splice(index,1),this.hide(),this.$element.data("plugin_"+pluginName,null),"click"===this.getTrigger()?this.$element.off("click"):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave"),this.$target&&this.$target.remove()},hide:function(force,event){if((force||"sticky"!==this.getTrigger())&&this._opened){event&&(event.preventDefault(),event.stopPropagation()),this.xhr&&!0===this.options.abortXHR&&(this.xhr.abort(),this.xhr=null);var e=$.Event("hide."+pluginType);if(this.$element.trigger(e,[this.$target]),this.$target){this.$target.removeClass("in").addClass(this.getHideAnimation());var that=this;setTimeout((function(){that.$target.hide()}),300)}this.options.backdrop&&backdrop.hide(),this._opened=!1,this.$element.trigger("hidden."+pluginType,[this.$target]),this.options.onHide&&this.options.onHide(this.$target)}},resetAutoHide:function(){var that=this,autoHide=that.getAutoHide();autoHide&&(that.autoHideHandler&&clearTimeout(that.autoHideHandler),that.autoHideHandler=setTimeout((function(){that.hide()}),autoHide))},toggle:function(e){e&&(e.preventDefault(),e.stopPropagation()),this[this.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){hideAllPop()},show:function(){var $target=this.getTarget().removeClass().addClass(pluginClass).addClass(this._customTargetClass);this.options.multi||this.hideAll(),this._opened||(this.getCache()&&this._poped&&""!==this.content||(this.content="",this.setTitle(this.getTitle()),this.options.closeable||$target.find(".close").off("click").remove(),this.isAsync()?this.setContentASync(this.options.content):this.setContent(this.getContent()),$target.show()),this.displayContent(),this.options.onShow&&this.options.onShow($target),this.bindBodyEvents(),this.options.backdrop&&backdrop.show(),this._opened=!0,this.resetAutoHide())},displayContent:function(){var placement,elementPos=this.getElementPosition(),$target=this.getTarget().removeClass().addClass(pluginClass).addClass(this._customTargetClass),$targetContent=this.getContentElement(),targetWidth=$target[0].offsetWidth,targetHeight=$target[0].offsetHeight,e=$.Event("show."+pluginType);this.$element.trigger(e,[$target]);var optWidth=this.$element.data("width")||this.options.width;""===optWidth&&(optWidth=this._defaults.width),"auto"!==optWidth&&$target.width(optWidth);var optHeight=this.$element.data("height")||this.options.height;""===optHeight&&(optHeight=this._defaults.height),"auto"!==optHeight&&$targetContent.height(optHeight),this.options.style&&this.$target.addClass(pluginClass+"-"+this.options.style),this.options.arrow||$target.find(".webui-arrow").remove(),$target.detach().css({top:-2e3,left:-2e3,display:"block"}),this.getAnimation()&&$target.addClass(this.getAnimation()),$target.appendTo(this.options.container),placement=this.getPlacement(elementPos),this.$element.trigger("added."+pluginType),this.initTargetEvents(),this.options.padding||("auto"!==this.options.height&&$targetContent.css("height",$targetContent.outerHeight()),this.$target.addClass("webui-no-padding")),targetWidth=$target[0].offsetWidth,targetHeight=$target[0].offsetHeight;var postionInfo=this.getTargetPositin(elementPos,placement,targetWidth,targetHeight);if(this.$target.css(postionInfo.position).addClass(placement).addClass("in"),"iframe"===this.options.type){var $iframe=$target.find("iframe"),iframeWidth=$target.width(),iframeHeight=$iframe.parent().height();""!==this.options.iframeOptions.width&&"auto"!==this.options.iframeOptions.width&&(iframeWidth=this.options.iframeOptions.width),""!==this.options.iframeOptions.height&&"auto"!==this.options.iframeOptions.height&&(iframeHeight=this.options.iframeOptions.height),$iframe.width(iframeWidth).height(iframeHeight)}if(this.options.arrow||this.$target.css({margin:0}),this.options.arrow){var $arrow=this.$target.find(".webui-arrow");$arrow.removeAttr("style"),"left"===placement||"right"===placement?$arrow.css({top:this.$target.height()/2}):"top"!==placement&&"bottom"!==placement||$arrow.css({left:this.$target.width()/2}),postionInfo.arrowOffset&&(-1===postionInfo.arrowOffset.left||-1===postionInfo.arrowOffset.top?$arrow.hide():$arrow.css(postionInfo.arrowOffset))}this._poped=!0,this.$element.trigger("shown."+pluginType,[this.$target])},isTargetLoaded:function(){return 0===this.getTarget().find("i.glyphicon-refresh").length},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var id=pluginName+this._idSeed;this.$target=$(this.options.template).attr("id",id).data("trigger-element",this.getTriggerElement()),this._customTargetClass=this.$target.attr("class")!==pluginClass?this.$target.attr("class"):null,this.getTriggerElement().attr("data-target",id)}return this.$target},getTitleElement:function(){return this.getTarget().find(".webui-popover-title")},getContentElement:function(){return this.$contentElement||(this.$contentElement=this.getTarget().find(".webui-popover-content")),this.$contentElement},getTitle:function(){return this.$element.attr("data-title")||this.options.title},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getAutoHide:function(){return this.$element.attr("data-auto-hide")||this.options.autoHide},getOffsetTop:function(){return toNumber(this.$element.attr("data-offset-top"))||this.options.offsetTop},getOffsetLeft:function(){return toNumber(this.$element.attr("data-offset-left"))||this.options.offsetLeft},getCache:function(){var dataAttr=this.$element.attr("data-cache");if(void 0!==dataAttr)switch(dataAttr.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":return!1}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var dataAttr=this.$element.attr("data-delay-show");return void 0!==dataAttr?dataAttr:0===this.options.delay.show?0:this.options.delay.show||100},getHideDelay:function(){var dataAttr=this.$element.attr("data-delay-hide");return void 0!==dataAttr?dataAttr:0===this.options.delay.hide?0:this.options.delay.hide||100},getAnimation:function(){return this.$element.attr("data-animation")||this.options.animation},getHideAnimation:function(){var ani=this.getAnimation();return ani?ani+"-out":"out"},setTitle:function(title){var $titleEl=this.getTitleElement();title?$titleEl.html(title):$titleEl.remove()},hasContent:function(){return this.getContent()},getIframe:function(){var $iframe=$("<iframe></iframe>").attr("src",this.getUrl()),self=this;return $.each(this._defaults.iframeOptions,(function(opt){void 0!==self.options.iframeOptions[opt]&&$iframe.attr(opt,self.options.iframeOptions[opt])})),$iframe},getContent:function(){if(this.getUrl())switch(this.options.type){case"iframe":this.content=this.getIframe();break;case"html":try{this.content=$(this.getUrl()),this.content.is(":visible")||this.content.show()}catch(error){throw new Error("Unable to get popover content. Invalid selector specified.")}}else if(!this.content){var content="";if(content=$.isFunction(this.options.content)?this.options.content.apply(this.$element[0],[this]):this.options.content,this.content=this.$element.attr("data-content")||content,!this.content){var $next=this.$element.next();$next&&$next.hasClass(pluginClass+"-content")&&(this.content=$next)}}return this.content},setContent:function(content){var $target=this.getTarget(),$ct=this.getContentElement();"string"==typeof content?$ct.html(content):content instanceof jQuery&&($ct.html(""),this.options.cache?content.removeClass(pluginClass+"-content").appendTo($ct):content.clone(!0,!0).removeClass(pluginClass+"-content").appendTo($ct)),this.$target=$target},isAsync:function(){return"async"===this.options.type},setContentASync:function(content){var that=this;this.xhr||(this.xhr=$.ajax({url:this.getUrl(),type:this.options.async.type,cache:this.getCache(),beforeSend:function(xhr){that.options.async.before&&that.options.async.before(that,xhr)},success:function(data){that.bindBodyEvents(),content&&$.isFunction(content)?that.content=content.apply(that.$element[0],[data]):that.content=data,that.setContent(that.content),that.getContentElement().removeAttr("style"),that.displayContent(),that.options.async.success&&that.options.async.success(that,data)},complete:function(){that.xhr=null},error:function(xhr,data){that.options.async.error&&that.options.async.error(that,xhr,data)}}))},bindBodyEvents:function(){_isBodyEventHandled||(this.options.dismissible&&"click"===this.getTrigger()?($document.off("keyup.webui-popover").on("keyup.webui-popover",$.proxy(this.escapeHandler,this)),$document.off("click.webui-popover touchend.webui-popover").on("click.webui-popover touchend.webui-popover",$.proxy(this.bodyClickHandler,this))):"hover"===this.getTrigger()&&$document.off("touchend.webui-popover").on("touchend.webui-popover",$.proxy(this.bodyClickHandler,this)))},mouseenterHandler:function(){var self=this;self._timeout&&clearTimeout(self._timeout),self._enterTimeout=setTimeout((function(){self.getTarget().is(":visible")||self.show()}),this.getDelayShow())},mouseleaveHandler:function(){var self=this;clearTimeout(self._enterTimeout),self._timeout=setTimeout((function(){self.hide()}),this.getHideDelay())},escapeHandler:function(e){27===e.keyCode&&this.hideAll()},bodyClickHandler:function(e){_isBodyEventHandled=!0;for(var canHide=!0,i=0;i<_srcElements.length;i++){var pop=getPopFromElement(_srcElements[i]);if(pop&&pop._opened){var popX1=pop.getTarget().offset().left,popY1=pop.getTarget().offset().top,popX2=pop.getTarget().offset().left+pop.getTarget().width(),popY2=pop.getTarget().offset().top+pop.getTarget().height(),pt=pointerEventToXY(e);if(pt.x>=popX1&&pt.x<=popX2&&pt.y>=popY1&&pt.y<=popY2){canHide=!1;break}}}canHide&&hideAllPop()},initTargetEvents:function(){"hover"===this.getTrigger()&&this.$target.off("mouseenter mouseleave").on("mouseenter",$.proxy(this.mouseenterHandler,this)).on("mouseleave",$.proxy(this.mouseleaveHandler,this)),this.$target.find(".close").off("click").on("click",$.proxy(this.hide,this,!0))},getPlacement:function(pos){var placement,container=this.options.container,clientWidth=container.innerWidth(),clientHeight=container.innerHeight(),scrollTop=container.scrollTop(),scrollLeft=container.scrollLeft(),pageX=Math.max(0,pos.left-scrollLeft),pageY=Math.max(0,pos.top-scrollTop),isH="horizontal"===(placement="function"==typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.$element[0]):this.$element.data("placement")||this.options.placement),isV="vertical"===placement;return"auto"===placement||isH||isV?placement=pageX<clientWidth/3?pageY<clientHeight/3?isH?"right-bottom":"bottom-right":pageY<2*clientHeight/3?isV?pageY<=clientHeight/2?"bottom-right":"top-right":"right":isH?"right-top":"top-right":pageX<2*clientWidth/3?pageY<clientHeight/3?isH?pageX<=clientWidth/2?"right-bottom":"left-bottom":"bottom":pageY<2*clientHeight/3?isH?pageX<=clientWidth/2?"right":"left":pageY<=clientHeight/2?"bottom":"top":isH?pageX<=clientWidth/2?"right-top":"left-top":"top":pageY<clientHeight/3?isH?"left-bottom":"bottom-left":pageY<2*clientHeight/3?isV?pageY<=clientHeight/2?"bottom-left":"top-left":"left":isH?"left-top":"top-left":"auto-top"===placement?placement=pageX<clientWidth/3?"top-right":pageX<2*clientWidth/3?"top":"top-left":"auto-bottom"===placement?placement=pageX<clientWidth/3?"bottom-right":pageX<2*clientWidth/3?"bottom":"bottom-left":"auto-left"===placement?placement=pageY<clientHeight/3?"left-top":pageY<2*clientHeight/3?"left":"left-bottom":"auto-right"===placement&&(placement=pageY<clientHeight/3?"right-top":pageY<2*clientHeight/3?"right":"right-bottom"),placement},getElementPosition:function(){return $.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTargetPositin:function(elementPos,placement,targetWidth,targetHeight){var pos=elementPos,container=this.options.container,clientWidth=container.innerWidth(),clientHeight=container.innerHeight(),elementW=this.$element.outerWidth(),elementH=this.$element.outerHeight(),scrollTop=container.scrollTop(),scrollLeft=container.scrollLeft(),position={},arrowOffset=null,arrowSize=this.options.arrow?20:0,fixedW=elementW<arrowSize+10?arrowSize:0,fixedH=elementH<arrowSize+10?arrowSize:0,refix=0,pageH=clientHeight+scrollTop,pageW=clientWidth+scrollLeft,validLeft=pos.left+pos.width/2-fixedW>0,validRight=pos.left+pos.width/2+fixedW<pageW,validTop=pos.top+pos.height/2-fixedH>0,validBottom=pos.top+pos.height/2+fixedH<pageH;switch(placement){case"bottom":position={top:pos.top+pos.height,left:pos.left+pos.width/2-targetWidth/2};break;case"top":position={top:pos.top-targetHeight,left:pos.left+pos.width/2-targetWidth/2};break;case"left":position={top:pos.top+pos.height/2-targetHeight/2,left:pos.left-targetWidth};break;case"right":position={top:pos.top+pos.height/2-targetHeight/2,left:pos.left+pos.width};break;case"top-right":position={top:pos.top-targetHeight,left:validLeft?pos.left-fixedW:10},arrowOffset={left:validLeft?Math.min(elementW,targetWidth)/2+fixedW:-2e3};break;case"top-left":refix=validRight?fixedW:-10,position={top:pos.top-targetHeight,left:pos.left-targetWidth+pos.width+refix},arrowOffset={left:validRight?targetWidth-Math.min(elementW,targetWidth)/2-fixedW:-2e3};break;case"bottom-right":position={top:pos.top+pos.height,left:validLeft?pos.left-fixedW:10},arrowOffset={left:validLeft?Math.min(elementW,targetWidth)/2+fixedW:-2e3};break;case"bottom-left":refix=validRight?fixedW:-10,position={top:pos.top+pos.height,left:pos.left-targetWidth+pos.width+refix},arrowOffset={left:validRight?targetWidth-Math.min(elementW,targetWidth)/2-fixedW:-2e3};break;case"right-top":refix=validBottom?fixedH:-10,position={top:pos.top-targetHeight+pos.height+refix,left:pos.left+pos.width},arrowOffset={top:validBottom?targetHeight-Math.min(elementH,targetHeight)/2-fixedH:-2e3};break;case"right-bottom":position={top:validTop?pos.top-fixedH:10,left:pos.left+pos.width},arrowOffset={top:validTop?Math.min(elementH,targetHeight)/2+fixedH:-2e3};break;case"left-top":refix=validBottom?fixedH:-10,position={top:pos.top-targetHeight+pos.height+refix,left:pos.left-targetWidth},arrowOffset={top:validBottom?targetHeight-Math.min(elementH,targetHeight)/2-fixedH:-2e3};break;case"left-bottom":position={top:validTop?pos.top-fixedH:10,left:pos.left-targetWidth},arrowOffset={top:validTop?Math.min(elementH,targetHeight)/2+fixedH:-2e3}}return position.top+=this.getOffsetTop(),position.left+=this.getOffsetLeft(),{position:position,arrowOffset:arrowOffset}}},$.fn[pluginName]=function(options,noInit){var results=[],$result=this.each((function(){var webuiPopover=$.data(this,"plugin_"+pluginName);webuiPopover?"destroy"===options?webuiPopover.destroy():"string"==typeof options&&results.push(webuiPopover[options]()):(options?"string"==typeof options?"destroy"!==options&&(noInit||(webuiPopover=new WebuiPopover(this,null),results.push(webuiPopover[options]()))):"object"==typeof options&&(webuiPopover=new WebuiPopover(this,options)):webuiPopover=new WebuiPopover(this,null),$.data(this,"plugin_"+pluginName,webuiPopover))}));return results.length?results:$result}},"function"==typeof define&&define.amd?define("jquery.popover",["jquery"],factory):"object"==typeof exports?module.exports=factory(require("jquery")):factory(window.jQuery)}(window,document),define("pgui.column_filter",["class","underscore","pgui.filter_common","jquery.highlight","jquery.popover"],(function(Class,_,Filter){var ColumnFilter=Class.extend({init:function($container){this.$container=$container,this.columns=[],this.filterComponent=new Group,this.excludedComponents=[],this.defaultsEnabled=[],this.selectedDateTimeValues=[]},addColumn:function(column){return this.columns.push(column),this},getColumns:function(){return this.columns},setFilterComponent:function(filterComponent){return this.filterComponent=filterComponent,this},attach:function(){_.each(this.filterComponent.getChildren(),_.bind((function(child,columnName){this._attachPopover(columnName,this.$container.find('[data-name="'+columnName+'"] .js-filter-trigger').first(),child,this.excludedComponents[columnName]||[])}),this))},_getChildByColumnName:function(columnName){return _.find(this.filterComponent.getChildren(),(function(child,childColumnName){return childColumnName==columnName}))},_attachPopover:function(columnName,$trigger,group,excludedComponents){var self=this,loadedGroup=new Group;group.setEnabled(!0);var $content=$(createTemplate("content")()),popover=$trigger.webuiPopover({content:$content,backdrop:!0,placement:"auto-bottom",trigger:"manual"}).data("plugin_webuiPopover");return $content.on("click",".js-apply",_.bind((function(e){self._typeIsDateTime(columnName)&&self._isDefaultsEnabledFor(columnName)&&(group=loadedGroup,self.filterComponent.addChild(group,columnName)),self._createConditions(columnName,group,popover.$contentElement),this.submit()}),this)).on("change",".js-toggle-component",(function(e){updateSelectAll($content)})).on("change",".js-select-all",_.bind((function(e){var checked=$(e.currentTarget).prop("checked");$content.find("input:not(.js-select-all):not(.js-ignore-select-all)").filter(":visible").prop("checked",checked).trigger("change")}),this)).on("click",".js-reset",_.bind((function(e){e.preventDefault(),group.setChildren({}),this.submit()}),this)).on("click",".close",(function(){popover.hide()})),$trigger.on("click",(function(e){e.preventDefault(),e.stopPropagation(),popover.show(),$(".webui-popover-backdrop").one("click",(function(){popover.hide()}))})).one("click",(function(e){setTimeout((function(){$content.css("width",$content.width())}),0)})).on("show.webui.popover",(function(){self._typeIsDateTime(columnName)&&self._isDefaultsEnabledFor(columnName)?($content.find(".js-search").hide(),$content.find(".js-content").hide(),$content.find(".js-search-empty").hide(),$content.find(".js-searching .js-searching-title").hide(),$content.find(".js-searching").show(),$.ajax({url:window.location.href,dataType:"json",data:{column_filter_hname:columnName},success:function(data){$content.find(".js-searching").hide(),$content.find(".js-content").show(),loadedGroup.deserialize(self.getColumns(),data),loadedGroup.setEnabled(!0),popover.$contentElement.find(".js-content").first().html("").append(self._getColumnGroupDOM(loadedGroup,excludedComponents)),updateSelectAll(popover.$contentElement)}})):(popover.$contentElement.find(".js-content").first().html("").append(self._getColumnGroupDOM(group,excludedComponents)),self._handleSearch(columnName,group,popover.$contentElement))})).on("shown.webui.popover",(function(){updateSelectAll(popover.$contentElement)})),$content},_typeIsDateTime:function(columnName){return _.find(this.columns,(function(column){return column.name==columnName&&1==column.typeIsDateTime}))},_createConditions:function(columnName,group,$content){var columns=this.columns,column=_.find(columns,(function(column){return column.getName()===columnName}));if($content.find(".js-content .js-dynamic input:checked").each((function(){var condition=group.createCondition();condition.setColumn(column),condition.setEnabled(!0).setOperator("Equals").setValues([$(this).closest("div").data("condition-value")]).setDisplayValues([$(this).closest("div").data("condition-display-value")]),group.addChild(condition," "+$(this).closest("div").data("condition-display-value"))})),this._typeIsDateTime(columnName)){var resultFullYears=[],resultFullMonths=[],resultDays=[];if($content.find(".js-content > .js-date-tree").each((function(){var $yearCheckBox=$(this).find("input:checkbox").first(),yearValue=$yearCheckBox.closest("label").attr("title");$yearCheckBox.prop("checked")?resultFullYears.push(yearValue):$yearCheckBox.prop("indeterminate")&&$(this).find(".js-children > .js-group").each((function(){var $monthCheckBox=$(this).find("input:checkbox").first(),monthValue=$monthCheckBox.closest("label").attr("title");$monthCheckBox.prop("checked")?resultFullMonths.push({year:yearValue,month:monthValue}):$(this).find(".js-children > .js-component").each((function(){var $dayCheckBox=$(this).find("input:checkbox").first(),dayValue=$dayCheckBox.closest("label").attr("title");$dayCheckBox.prop("checked")&&resultDays.push({year:yearValue,month:monthValue,day:dayValue})}))}))})),resultFullYears.length>0||resultFullMonths.length>0||resultDays.length>0){var result=[];result.fullYears=resultFullYears,result.fullMonths=resultFullMonths,result.days=resultDays,this.selectedDateTimeValues[columnName]=result}}},setDefaultsEnabled:function(columnNames){return this.defaultsEnabled=columnNames,this},_isDefaultsEnabledFor:function(columnName){return-1!==this.defaultsEnabled.indexOf(columnName)},_handleSearch:function(columnName,group,$content){$content.find(".js-searching .js-data-loading-title").hide();var $searchEmpty=$content.find(".js-search-empty").hide(),$searchClear=$content.find(".js-search-clear").hide(),$searching=$content.find(".js-searching").hide();if(!this._typeIsDateTime(columnName)&&this._isDefaultsEnabledFor(columnName)){var $searchInput=$content.find(".js-search-input");group.getTitles();$searchClear.on("click",(function(){return $searchInput.val("").trigger("change"),!1})),$content.find(".js-component:not(.js-dynamic)").length>0&&$content.find(".js-content").first().append($('<hr class="column-filter-separator">')),$searchInput.off("keyup change").on("keyup change",_.debounce((function(){doDynamicSearch(!1)}),500)),doDynamicSearch(!0)}else $content.find(".js-search").hide();function doDynamicSearch(initial){var result,term=$searchInput.val(),lastTerm=$searchInput.data("last-term");!0!==initial&&term===lastTerm||($searching.show(),$searchEmpty.hide(),$content.find(".js-content .js-dynamic").remove(),$.ajax({url:window.location.href,dataType:"json",data:{column_filter_hname:columnName,term:term,excludedValues:(result=[],$content.find(".js-content input:checked").each((function(){result.push($(this).closest("label").attr("title"))})),result)},success:function(data){$searching.hide(),_.isEmpty(data)?$searchEmpty.show():$content.find(".js-content").first().append(function(data){return _.map(data,(function(item){return value=item.id,displayValue=item.value,$(createTemplate("condition")({ignoreSelectAll:!1,hasDivider:!1,label:$("<div/>").html(displayValue).text(),checked:!1})).addClass("js-dynamic").data("condition-value",value).data("condition-display-value",displayValue);var value,displayValue}))}(data)),$searchInput.data("last-term",term),$content.find(".js-content .js-dynamic").highlight(term,"ALL"),afterSearch()}}))}function afterSearch(){$searchClear.toggle($searchInput.val().length>0),updateSelectAll($content)}},_getColumnGroupDOM:function(group,excludedComponents){return _.toArray(_.mapObject(group.getChildren(),(function(child,label){if(!isExcluded(excludedComponents,label))return child.getDOM(label,excludedComponents)})))},submit:function(){var jsonData=JSON.stringify(this.filterComponent.serializeEnabledRootComponents(this.selectedDateTimeValues));return $("<form>").attr("method","POST").append($('<input type="hidden" name="column_filter">').val(jsonData)).hide().appendTo($("body")).submit(),this},setEnabled:function(isEnabled){return this.filterComponent.setEnabled(isEnabled),this},reset:function(){return this.filterComponent=new Group,this}}),Group=Filter.Group.extend({init:function(operator,children){this._super(operator,children),this.isDateTreePart=!1},getDOM:function(label,excludedComponents){var groupExcludedComponents=excludedComponents[label]||[],$el=$(createTemplate("group")({label:$("<div/>").html(label).text(),checked:this.isEnabled(),isDateTreePart:this.isDateTreePart})),$checkbox=$el.find(".js-toggle-component").first(),$children=$el.find(".js-children").first(),children=_.filter(_.toArray(_.mapObject(this.getChildren(),(function(child,label){if(!isExcluded(groupExcludedComponents,label))return child.getDOM(label,groupExcludedComponents)}))),(function(item){return Boolean(item)}));if(0!==children.length)return $children.append(children),this._updateEnabledOnDOM($checkbox,$children),$el.data("component",this).on("click",".js-caret:first",(function(e){$(e.currentTarget).toggleClass("collapsed"),$children.toggle(),e.preventDefault()})).on("change",".js-toggle-component",_.bind((function(e){var element;if((element=$(e.currentTarget),$(element).closest(".js-component")).data("component")===this){$checkbox.prop("indeterminate",!1);var checked=$(e.currentTarget).prop("checked");this.setEnabled(checked),$children.find(".js-toggle-component").prop("checked",checked),$children.find(".js-component").each((function(i,child){$(child).data("component").setEnabled(checked)}))}else this._updateEnabledOnDOM($checkbox,$children)}),this))},_updateEnabledOnDOM:function($checkbox,$children,excludedComponents){var checkedChildrenCount=$children.find(".js-toggle-component:checked").length,allChildrenChecked=checkedChildrenCount===$children.find(".js-toggle-component").length;$checkbox.prop("indeterminate",checkedChildrenCount>0&&!allChildrenChecked),$checkbox.prop("checked",allChildrenChecked),this.setEnabled(checkedChildrenCount>0)},createCondition:function(){return new Condition},serializeEnabledRootComponents:function(selectedDateTimeValues){var self=this;return{type:"group",isEnabled:this.isEnabled(),operator:this.getOperator(),children:_.mapObject(this.children,(function(child,columnName){if(child.isEnabled()){var result=child.serializeEnabledComponents();return void 0!==selectedDateTimeValues[columnName]&&(result.selectedDateTimeValues=self.serializeSelectedDateTimeValues(selectedDateTimeValues[columnName])),result}}))}},serializeSelectedDateTimeValues:function(selectedDateTimeValues){return{fullYears:selectedDateTimeValues.fullYears,fullMonths:selectedDateTimeValues.fullMonths,days:selectedDateTimeValues.days}},serializeEnabledComponents:function(){return{type:"group",isEnabled:this.isEnabled(),operator:this.getOperator(),children:_.mapObject(this.children,(function(child){if(child.isEnabled()&&!child.isDateTreePart)return child.serializeEnabledComponents()}))}},setEnabledDeep:function(isEnabled){return this.setEnabled(isEnabled),_.each(this.children,(function(child){child.setEnabledDeep(isEnabled)})),this},getTitles:function(){return _.reduce(this.children,(function(acc,child,key){return acc.push({title:$("<div/>").html(key).text(),component:child}),acc.push(child.getTitles()),_.flatten(acc)}),[])},serialize:function(){var result=this._super();return result.isDateTreePart=this.isDateTreePart,result},deserialize:function(columns,data){return this.isDateTreePart=data.isDateTreePart||!1,this._super(columns,data)}}),Condition=Filter.Condition.extend({init:function(column,operator,values){this._super(column,operator,values),this.hasDivider=!1,this.ignoreSelectAll=null,this.isDateTreePart=!1},getDOM:function(label){return $(createTemplate("condition")({ignoreSelectAll:this.ignoreSelectAll,hasDivider:this.hasDivider,label:$("<div/>").html(label).text(),checked:this.isEnabled()})).data("component",this).on("change",".js-toggle-component",_.bind((function(e){this.setEnabled($(e.currentTarget).prop("checked"))}),this))},serializeEnabledComponents:function(){return{type:"condition",isEnabled:this.isEnabled(),column:this.column.getName(),operator:this.getOperator(),values:this.getValues(),displayValues:this.getDisplayValues()}},setEnabledDeep:function(isEnabled){return this.setEnabled(isEnabled),this},getTitles:function(){return[]},serialize:function(){var result=this._super();return result.hasDivider=this.hasDivider,result.ignoreSelectAll=this.ignoreSelectAll,result},deserialize:function(columns,data){return this.hasDivider=data.hasDivider||!1,this.ignoreSelectAll=data.ignoreSelectAll||!1,this._super(columns,data)}}),Column=Filter.Column.extend({init:function(name,caption,typeIsDateTime,operators){this._super(name,caption,operators),this.typeIsDateTime=typeIsDateTime},setTypeIsDateTime:function(value){return this.typeIsDateTime=value,this},getTypeIsDateTime:function(){return this.typeIsDateTime}}),templateSelectors={content:"#columnFilterContentTemplate",group:"#columnFilterGroupTemplate",condition:"#columnFilterConditionTemplate"},templates={};function createTemplate(name){if(templates[name])return templates[name];var template=_.template($(templateSelectors[name]).html());return templates[name]=template,template}function isExcluded(excluded,key){return _.isObject(excluded[key])&&0===_.keys(excluded[key]).length}function updateSelectAll($content){var checked=$content.find(".js-toggle-component:visible:not(.js-ignore-select-all)").length===$content.find(".js-toggle-component:visible:checked:not(.js-ignore-select-all)").length;$content.find(".js-select-all").prop("checked",checked)}return{Column:Column,Group:Group,Condition:Condition,create:function($header){return new ColumnFilter($header)}}})),define("pgui.text_highlight",["jquery.highlight"],(function(){return{HighlightTextInGrid:function(gridSelector,fieldName,text,opt,hint){$(gridSelector+" [data-column-name='"+fieldName+"']").highlight(text,opt,{hint:hint||""})},HighlightTextInAllGrid:function($grid,text,opt){$grid.highlight(""+text,opt)}}})),define("pgui.quick_filter",["class","pgui.text_highlight","pgui.editors/multivalue_select"],(function(Class,highlight,multivalue_select){return Class.extend({init:function($container){this.container=$container,this._initializeEditors(),this._initializeEvents()},_initializeEditors:function(){this.$input=this.container.find(".js-input"),this.$filterConditionEditor=this.container.find("#quick-filter-operator");var $columnsEditor=this.container.find("#quick-filter-fields");this.$selectedColumnsEditor=new multivalue_select($columnsEditor),$columnsEditor.off("change")},_initializeEvents:function(){var self=this;this.container.on("click",".js-submit",(function(){self._submit()})).on("click",".js-reset",(function(){self._reset()._submit()})).on("keyup",".js-input",(function(e){13===e.keyCode&&self._submit()})).on("click",".js-cancel",(function(e){var $dropdownToggleButton=self.container.find(".dropdown-toggle");$dropdownToggleButton.length&&$dropdownToggleButton.trigger("click")}))},setColumnNames:function(columnNames){return this.columnNames=columnNames,this},highlight:function($container){return highlight.HighlightTextInAllGrid($container.find($.map(this._getColumnsToHighlight(),(function(name){return'td[data-column-name="'+name+'"]'})).join(",")),this._getValue(),"ALL"),this},_getColumnsToHighlight:function(){var result=[],selectedColumnNames=this.$selectedColumnsEditor.getValue();if(_.isArray(selectedColumnNames))for(var i=0;i<this.columnNames.length;i++)selectedColumnNames.indexOf(this.columnNames[i])>-1&&result.push(this.columnNames[i]);return result.length>0?result:this.columnNames},_getValue:function(){return this.$input.val()},_getFilterCondition:function(){return this.$filterConditionEditor.val()},_getSelectedColumns:function(){return this.$selectedColumnsEditor.getValue()},_reset:function(){return this.$input.val(""),this},_submit:function(){var query=jQuery.query;query=(query=(query=query.set("quick_filter",this._getValue())).set("quick_filter_operator",this._getFilterCondition())).set("quick_filter_fields",this._getSelectedColumns()),window.location=query}})})),function(t,r){"use strict";function i(i,e,o){var s=this,n=i.get(0);s.duration=e.duration,s.opacity=e.opacity,s.isShown=!1,s.jqTargetOrg=i,t.isWindow(n)||9===n.nodeType?s.jqTarget=t("body"):"iframe"===n.nodeName.toLowerCase()||"frame"===n.nodeName.toLowerCase()?(s.jqWin=t(n.contentWindow),s.elmDoc=n.contentWindow.document,s.jqTarget=t("body",s.elmDoc),s.isFrame=!0):s.jqTarget=i,s.jqWin=s.jqWin||t(window),s.elmDoc=s.elmDoc||document,s.isBody="body"===s.jqTarget.get(0).nodeName.toLowerCase(),o&&(o.jqProgress&&(o.timer&&clearTimeout(o.timer),o.jqProgress.remove(),delete o.jqProgress),o.reset(!0),o.jqOverlay.stop()),s.jqOverlay=(o&&o.jqOverlay||t('<div class="'+d+'" />').css({position:s.isBody?"fixed":"absolute",left:0,top:0,display:"none",cursor:"wait"}).appendTo(s.jqTarget).on("touchmove",(function(){return!1}))).css({backgroundColor:e.fillColor,zIndex:e.zIndex}),(s.jqProgress=!1===e.progress?r:"function"==typeof e.progress?e.progress.call(s.jqTarget,e):h(s))&&s.jqProgress.css({position:s.isBody?"fixed":"absolute",display:"none",zIndex:e.zIndex+1,cursor:"wait"}).appendTo(s.jqTarget).on("touchmove",(function(){return!1})),s.callAdjust=function(t){return t.adjustProgress?function(){t.adjustProgress(),t.adjust()}:function(){t.adjust()}}(s),s.avoidFocus=function(r){return function(i){return t(r.elmDoc.activeElement).blur(),i.preventDefault(),!1}}(s),s.avoidScroll=function(t){return function(r){return function(r){r.scrollLeft(t.scrLeft).scrollTop(t.scrTop)}(t.isBody?t.jqWin:t.jqTarget),r.preventDefault(),!1}}(s),o&&(o.timer&&clearTimeout(o.timer),o=r)}function e(r,e){var o=t.extend({duration:200,opacity:.6,zIndex:9e3},e);return o.fillColor=o.fillColor||o.color||"#888",r.each((function(){var r=t(this);r.data(a,new i(r,o,r.data(a))),"function"==typeof o.show&&r.off(g,o.show).on(g,o.show),"function"==typeof o.hide&&r.off(c,o.hide).on(c,o.hide)}))}function o(r,i){return r.each((function(){var r,o=t(this);(i||!(r=o.data(a)))&&(r=e(o,i).data(a)),r.show()}))}function s(r){return r.each((function(){var r=t(this).data(a);r&&r.hide()}))}function n(t,i,o){var s,n=t.length?t.eq(0):r;if(n&&(s=n.data(a)||e(n).data(a)).hasOwnProperty(i))return null!=o&&(s[i]=o),s[i]}var a="plainOverlay",d=a.toLowerCase(),g=d+"show",c=d+"hide",h=function(){function i(i,e,o,s){return s=s===r?";":s,t.map(i,(function(r){return t.map(e,(function(t){return(o||"")+t+r})).join(s)})).join(s)}var e,o="jQuery-"+a,s=["-webkit-","-moz-","-ms-","-o-",""],n=o+"-progress",d="."+n+"{"+i(["box-sizing:border-box"],["-webkit-","-moz-",""])+";width:100%;height:100%;border-top:3px solid #17f29b;"+i(["border-radius:50%"],s)+";-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);box-shadow:0 0 1px rgba(0,0,0,0);"+i(["animation-name:"+o+"-spin","animation-duration:1s","animation-timing-function:linear","animation-iteration-count:infinite"],s)+"}"+i(["keyframes "+o+"-spin{from{"+i(["transform:rotate(0deg)"],s)+"}to{"+i(["transform:rotate(360deg)"],s)+"}}"],s,"@","")+"."+n+"-legacy{width:100%;height:50%;padding-top:25%;text-align:center;white-space:nowrap;*zoom:1}."+n+"-legacy:after,."+n+'-legacy:before{content:" ";display:table}.'+n+"-legacy:after{clear:both}."+n+"-legacy div{width:18%;height:100%;margin:0 1%;background-color:#17f29b;float:left;visibility:hidden}."+n+"-1 div."+n+"-1,."+n+"-2 div."+n+"-1,."+n+"-2 div."+n+"-2,."+n+"-3 div."+n+"-1,."+n+"-3 div."+n+"-2,."+n+"-3 div."+n+"-3{visibility:visible}",g=function(){var t=Math.min(300,.9*(this.isBody?Math.min(this.jqWin.width(),this.jqWin.height()):Math.min(this.jqTarget.innerWidth(),this.jqTarget.innerHeight())));this.jqProgress.width(t).height(t),this.showProgress||this.jqProgress.children("."+n).css("borderTopWidth",Math.max(3,t/30))},c=function(t){var r=this;r.timer&&clearTimeout(r.timer),r.progressCnt&&r.jqProgress.removeClass(n+"-"+r.progressCnt),r.isShown&&(r.progressCnt=!t&&r.progressCnt<3?r.progressCnt+1:0,r.progressCnt&&r.jqProgress.addClass(n+"-"+r.progressCnt),r.timer=setTimeout((function(){r.showProgress()}),500))};return function(i){var s,a;return"boolean"!=typeof e&&(e=function(){function t(t,r){return!!~(""+t).indexOf(r)}function i(i){var e;for(e in i)if(!t(i[e],"-")&&a[i[e]]!==r)return!0;return!1}function e(t){var r=t.charAt(0).toUpperCase()+t.slice(1);return i((t+" "+g.join(r+" ")+r).split(" "))}var o,s,n=document.createElement("modernizr"),a=n.style,g="Webkit Moz O ms".split(" "),c={},h={}.hasOwnProperty,l=h!==r&&h.call!==r?function(t,r){return h.call(t,r)}:function(t,i){return i in t&&t.constructor.prototype[i]===r};for(s in c.borderradius=function(){return e("borderRadius")},c.cssanimations=function(){return e("animationName")},c.csstransforms=function(){return!!e("transform")},o=!1,c)if(l(c,s)&&!c[s]()){o=!0;break}return a.cssText="",n=null,o}()),i.elmDoc.getElementById(o)||(i.elmDoc.createStyleSheet?((a=i.elmDoc.createStyleSheet()).owningElement.id=o,a.cssText=d):((a=(i.elmDoc.getElementsByTagName("head")[0]||i.elmDoc.documentElement).appendChild(i.elmDoc.createElement("style"))).type="text/css",a.id=o,a.textContent=d)),e?(s=t('<div><div class="'+n+'-legacy"><div class="'+n+'-3" /><div class="'+n+'-2" /><div class="'+n+'-1" /><div class="'+n+'-2" /><div class="'+n+'-3" /></div></div>'),i.showProgress=c):s=t('<div><div class="'+n+'" /></div>'),i.adjustProgress=g,s}}();i.prototype.show=function(){var i,e,o,s,n,a=this;a.reset(!0),i=a.jqTarget.get(0).style,a.orgPosition=i.position,"relative"!==(e=a.jqTarget.css("position"))&&"absolute"!==e&&"fixed"!==e&&a.jqTarget.css("position","relative"),a.orgOverflow=i.overflow,o=a.jqTarget.prop("clientWidth"),s=a.jqTarget.prop("clientHeight"),a.jqTarget.css("overflow","hidden"),o-=a.jqTarget.prop("clientWidth"),s-=a.jqTarget.prop("clientHeight"),a.addMarginR=a.addMarginB=0,0>o&&(a.addMarginR=-o),0>s&&(a.addMarginB=-s),a.isBody?(a.addMarginR&&(a.orgMarginR=i.marginRight,a.jqTarget.css("marginRight","+="+a.addMarginR)),a.addMarginB&&(a.orgMarginB=i.marginBottom,a.jqTarget.css("marginBottom","+="+a.addMarginB))):(a.addMarginR&&(a.orgMarginR=i.paddingRight,a.orgWidth=i.width),a.addMarginB&&(a.orgMarginB=i.paddingBottom,a.orgHeight=i.height)),a.jqActive=r,n=t(a.elmDoc.activeElement),a.isBody&&!a.isFrame?a.jqActive=n.blur():a.jqTarget.has(n.get(0)).length&&n.blur(),a.jqTarget.focusin(a.avoidFocus),function(t){a.scrLeft=t.scrollLeft(),a.scrTop=t.scrollTop(),t.scroll(a.avoidScroll)}(a.isBody?a.jqWin:a.jqTarget),a.jqWin.resize(a.callAdjust),a.callAdjust(),a.isShown=!0,a.jqOverlay.stop().fadeTo(a.duration,a.opacity,(function(){a.jqTargetOrg.trigger(g)})),a.jqProgress&&(a.showProgress&&a.showProgress(!0),a.jqProgress.fadeIn(a.duration))},i.prototype.hide=function(){var t=this;t.isShown&&(t.jqOverlay.stop().fadeOut(t.duration,(function(){t.reset(),t.jqTargetOrg.trigger(c)})),t.jqProgress&&t.jqProgress.fadeOut(t.duration))},i.prototype.adjust=function(){var t,r;this.isBody?(t=this.jqWin.width(),r=this.jqWin.height(),this.jqOverlay.width(t).height(r),this.jqProgress&&this.jqProgress.css({left:(t-this.jqProgress.outerWidth())/2,top:(r-this.jqProgress.outerHeight())/2})):(this.addMarginR&&(t=this.jqTarget.css({paddingRight:this.orgMarginR,width:this.orgWidth}).width(),this.jqTarget.css("paddingRight","+="+this.addMarginR).width(t-this.addMarginR)),this.addMarginB&&(r=this.jqTarget.css({paddingBottom:this.orgMarginB,height:this.orgHeight}).height(),this.jqTarget.css("paddingBottom","+="+this.addMarginB).height(r-this.addMarginB)),t=Math.max(this.jqTarget.prop("scrollWidth"),this.jqTarget.innerWidth()),r=Math.max(this.jqTarget.prop("scrollHeight"),this.jqTarget.innerHeight()),this.jqOverlay.width(t).height(r),this.jqProgress&&(t=this.jqTarget.innerWidth(),r=this.jqTarget.innerHeight(),this.jqProgress.css({left:(t-this.jqProgress.outerWidth())/2+this.scrLeft,top:(r-this.jqProgress.outerHeight())/2+this.scrTop})))},i.prototype.reset=function(t){var r=this;t&&(r.jqOverlay.css("display","none"),r.jqProgress&&r.jqProgress.css("display","none")),r.isShown&&(r.jqTarget.css({position:r.orgPosition,overflow:r.orgOverflow}),r.isBody?(r.addMarginR&&r.jqTarget.css("marginRight",r.orgMarginR),r.addMarginB&&r.jqTarget.css("marginBottom",r.orgMarginB)):(r.addMarginR&&r.jqTarget.css({paddingRight:r.orgMarginR,width:r.orgWidth}),r.addMarginB&&r.jqTarget.css({paddingBottom:r.orgMarginB,height:r.orgHeight})),r.jqTarget.off("focusin",r.avoidFocus),r.jqActive&&r.jqActive.length&&r.jqActive.focus(),function(t){t.off("scroll",r.avoidScroll).scrollLeft(r.scrLeft).scrollTop(r.scrTop)}(r.isBody?r.jqWin:r.jqTarget),r.jqWin.off("resize",r.callAdjust),r.isShown=!1)},t.fn[a]=function(t,r,i){return"show"===t?o(this,r):"hide"===t?s(this):"option"===t?n(this,r,i):e(this,t)}}(jQuery),define("jquery.plainoverlay",(function(){})),define("pgui.overlay",["jquery.plainoverlay"],(function(){return window.overlay={showOverlay:function(image,text){$("body").plainOverlay("show",{progress:function(){return $('<div class="pgui-overlay"><div class="comment">'+text+"</div></div>")}})},hideOverlay:function(){$("body").plainOverlay("hide")}},window.overlay})),define("multiple_sorting",["class","pgui.localizer"],(function(Class,localizer){return Class.extend({init:function(sorter,$sortDialog){var self=this;this.sorter=sorter,this.$sortDialog=$sortDialog,this.$table=$sortDialog.find(".multiple-sorting-table"),this.$addLevelButton=$sortDialog.find(".add-sorting-level"),this.$deleteLevelButton=$sortDialog.find(".delete-sorting-level"),this.$initialLevels=this.$table.find("tr.sorting-level").clone(),this.$sortDialog.on("click",".sort-button",(function(e){e.preventDefault();var $levels=self.$table.find("tr.sorting-level");self.sorter.clear(),$levels.each((function(){var columnName=$(this).find(".multi-sort-name").val();self.sorter.deleteColumn(columnName),self.sorter.addColumn(columnName,$(this).find(".multi-sort-order").val())})),self.sorter.applySort()})),this.$sortDialog.on("hidden.bs.modal",(function(){self.$table.find("tr.sorting-level").remove(),self.$table.find("tbody").append(self.$initialLevels),self._updateButtons()})),this.$addLevelButton.on("click",(function(){self._addLevel()})),this.$deleteLevelButton.on("click",(function(){self._deleteLevel()})),this._updateButtons()},_addLevel:function(){var sortingLevelName=localizer.getString("SortBy");this.$table.find("tr.sorting-level").length>0&&(sortingLevelName=localizer.getString("ThenBy"));var $columns=$("<select>").addClass("multi-sort-name form-control");$.each(this.sorter.getSortableColumns(),(function(i,column){$columns.append($("<option>").val(column.name).text(column.caption))}));var $sortOrderSelect=$("<select>").addClass("multi-sort-order form-control").append($("<option>").val("a").text(localizer.getString("Ascending"))).append($("<option>").val("d").text(localizer.getString("Descending")));$("<tr>").addClass("sorting-level").append($("<td>").text(sortingLevelName)).append($("<td>").append($columns)).append($("<td>").append($sortOrderSelect)).appendTo(this.$table.find("tbody")),this._updateButtons()},_deleteLevel:function(){var $levels=this.$table.find("tr.sorting-level");$levels.length>0&&$levels.last().remove(),this._updateButtons()},_updateButtons:function(){var sortingLevelsCount=this.$table.find("tr.sorting-level").length,sortableColumnsCount=this.sorter.getSortableColumns().length;this.$addLevelButton.prop("disabled",sortableColumnsCount==sortingLevelsCount),this.$deleteLevelButton.prop("disabled",0==sortingLevelsCount)}})})),define("sorter",["class"],(function(Class){return Class.extend({init:function(sortableColumns){var self=this;this.sortingColumns=[],this.sortableColumns=[],$.each(sortableColumns,(function(name,item){var $col=$('.sortable[data-field-name="'+item.name+'"]');self.sortableColumns.push(item),$col.on("click",(function(e){e.preventDefault();var fieldName=$(this).data("field-name");self._onClickSortableCellHandler(fieldName,e)}));var sortIndex=$col.data("sort-index")||item.index;null!=sortIndex&&(self.sortingColumns[sortIndex]=("desc"==$col.data("sort-order")?"d":"a")+$col.data("field-name"))}))},_onClickSortableCellHandler:function(fieldName,event){event.shiftKey?this.addColumn(fieldName):event.ctrlKey||event.metaKey?this.deleteColumn(fieldName):this.sortByColumn(fieldName),this.applySort()},getSortableColumns:function(){return this.sortableColumns},applySort:function(){var self=this;require(["jquery.query"],(function(){self.sortingColumns.length>0?window.location=jQuery.query.set("order",self.sortingColumns):window.location=jQuery.query.remove("order").set("operation","resetorder")}))},_getColumnIndexByName:function(fieldName){for(var i=0;i<this.sortingColumns.length;i++)if(this.sortingColumns[i]&&this.sortingColumns[i].slice(1)==fieldName)return i},addColumn:function(fieldName,order){var index=this._getColumnIndexByName(fieldName);null!=index?"a"==this.sortingColumns[index].charAt(0)?this.sortingColumns[index]="d"+fieldName:this.sortingColumns[index]="a"+fieldName:this.sortingColumns.push((order||"a")+fieldName)},deleteColumn:function(fieldName){var index=this._getColumnIndexByName(fieldName);void 0!==index&&this.sortingColumns.splice(index,1)},sortByColumn:function(fieldName){var index=this._getColumnIndexByName(fieldName),orderType="d";null!=index&&"d"!=this.sortingColumns[index].charAt(0)||(orderType="a"),this.sortingColumns=[orderType+fieldName]},clear:function(){this.sortingColumns=[]}})})),define("pgui.autohide-message",[],(function(){return function($el,messageDisplayTime,slideTime){slideTime=slideTime||1e3,(messageDisplayTime=parseInt(messageDisplayTime||$el.data("display-time")||0))>0&&setTimeout((function(){$el.slideUp(slideTime)}),1e3*parseInt(messageDisplayTime))}})),function(t,e){"use strict";t.bootbox=e(t.jQuery),"function"==typeof define&&define.amd?define("libs/bootbox.min",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.bootbox=e(t.jQuery)}(this,(function e(p,u){"use strict";var r,n,i,l;Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,n=!{toString:null}.propertyIsEnumerable("toString"),l=(i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){if("function"!=typeof t&&("object"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");var e,o,a=[];for(e in t)r.call(t,e)&&a.push(e);if(n)for(o=0;o<l;o++)r.call(t,i[o])&&a.push(i[o]);return a}));var d={VERSION:"5.5.2"},b={en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"}},f={dialog:'<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',header:'<div class="modal-header"><h5 class="modal-title"></h5></div>',footer:'<div class="modal-footer"></div>',closeButton:'<button type="button" class="bootbox-close-button close" aria-hidden="true">&times;</button>',form:'<form class="bootbox-form"></form>',button:'<button type="button" class="btn"></button>',option:"<option></option>",promptMessage:'<div class="bootbox-prompt-message"></div>',inputs:{text:'<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',textarea:'<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',email:'<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',select:'<select class="bootbox-input bootbox-input-select form-control"></select>',checkbox:'<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',radio:'<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',date:'<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',time:'<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',number:'<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',password:'<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',range:'<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'}},m={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body",value:"",inputType:"text",swapButtonOrder:!1,centerVertical:!1,multiple:!1,scrollable:!1,reusable:!1};function h(t,e,o,a){var r;a&&a[0]&&(r=a[0].locale||m.locale,(a[0].swapButtonOrder||m.swapButtonOrder)&&(e=e.reverse()));var n,i,l,s={className:"bootbox-"+t,buttons:function(t,e){for(var o={},a=0,r=t.length;a<r;a++){var n=t[a],i=n.toLowerCase(),l=n.toUpperCase();o[i]={label:(s=l,c=e,p=b[c],p?p[s]:b.en[s])}}var s,c,p;return o}(e,r)};return n=function(t,e,o){return p.extend(!0,{},t,function(t,e){var o=t.length,a={};if(o<1||2<o)throw new Error("Invalid argument length");return 2===o||"string"==typeof t[0]?(a[e[0]]=t[0],a[e[1]]=t[1]):a=t[0],a}(e,o))}(s,a,o),l={},g(i=e,(function(t,e){l[e]=!0})),g(n.buttons,(function(t){if(l[t]===u)throw new Error('button key "'+t+'" is not allowed (options are '+i.join(" ")+")")})),n}function w(t){return Object.keys(t).length}function g(t,o){var a=0;p.each(t,(function(t,e){o(t,e,a++)}))}function v(t){t.data.dialog.find(".bootbox-accept").first().trigger("focus")}function y(t){t.target===t.data.dialog[0]&&t.data.dialog.remove()}function x(t){t.target===t.data.dialog[0]&&(t.data.dialog.off("escape.close.bb"),t.data.dialog.off("click"))}function k(t,e,o){t.stopPropagation(),t.preventDefault(),p.isFunction(o)&&!1===o.call(e,t)||e.modal("hide")}function E(t){return/([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(t)}function O(t){return/(\d{4})-(\d{2})-(\d{2})/.test(t)}return d.locales=function(t){return t?b[t]:b},d.addLocale=function(t,o){return p.each(["OK","CANCEL","CONFIRM"],(function(t,e){if(!o[e])throw new Error('Please supply a translation for "'+e+'"')})),b[t]={OK:o.OK,CANCEL:o.CANCEL,CONFIRM:o.CONFIRM},d},d.removeLocale=function(t){if("en"===t)throw new Error('"en" is used as the default and fallback locale and cannot be removed.');return delete b[t],d},d.setLocale=function(t){return d.setDefaults("locale",t)},d.setDefaults=function(){var t={};return 2===arguments.length?t[arguments[0]]=arguments[1]:t=arguments[0],p.extend(m,t),d},d.hideAll=function(){return p(".bootbox").modal("hide"),d},d.init=function(t){return e(t||p)},d.dialog=function(t){if(p.fn.modal===u)throw new Error('"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/4.4/getting-started/javascript/ for more details.');if(t=function(r){var n,i;if("object"!=typeof r)throw new Error("Please supply an object of options");if(!r.message)throw new Error('"message" option must not be null or an empty string.');return(r=p.extend({},m,r)).backdrop?r.backdrop="string"!=typeof r.backdrop||"static"!==r.backdrop.toLowerCase()||"static":r.backdrop=!1!==r.backdrop&&0!==r.backdrop&&"static",r.buttons||(r.buttons={}),n=r.buttons,i=w(n),g(n,(function(t,e,o){if(p.isFunction(e)&&(e=n[t]={callback:e}),"object"!==p.type(e))throw new Error('button with key "'+t+'" must be an object');if(e.label||(e.label=t),!e.className){var a;a=r.swapButtonOrder?0===o:o===i-1,e.className=i<=2&&a?"btn-primary":"btn-secondary btn-default"}})),r}(t),p.fn.modal.Constructor.VERSION){t.fullBootstrapVersion=p.fn.modal.Constructor.VERSION;var e=t.fullBootstrapVersion.indexOf(".");t.bootstrap=t.fullBootstrapVersion.substring(0,e)}else t.bootstrap="2",t.fullBootstrapVersion="2.3.2",console.warn("Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible.");var o=p(f.dialog),a=o.find(".modal-dialog"),r=o.find(".modal-body"),n=p(f.header),i=p(f.footer),l=t.buttons,s={onEscape:t.onEscape};if(r.find(".bootbox-body").html(t.message),0<w(t.buttons)&&(g(l,(function(t,e){var o=p(f.button);switch(o.data("bb-handler",t),o.addClass(e.className),t){case"ok":case"confirm":o.addClass("bootbox-accept");break;case"cancel":o.addClass("bootbox-cancel")}o.html(e.label),i.append(o),s[t]=e.callback})),r.after(i)),!0===t.animate&&o.addClass("fade"),t.className&&o.addClass(t.className),t.size)switch(t.fullBootstrapVersion.substring(0,3)<"3.1"&&console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option."),t.size){case"small":case"sm":a.addClass("modal-sm");break;case"large":case"lg":a.addClass("modal-lg");break;case"extra-large":case"xl":a.addClass("modal-xl"),t.fullBootstrapVersion.substring(0,3)<"4.2"&&console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")}if(t.scrollable&&(a.addClass("modal-dialog-scrollable"),t.fullBootstrapVersion.substring(0,3)<"4.3"&&console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")),t.title&&(r.before(n),o.find(".modal-title").html(t.title)),t.closeButton){var c=p(f.closeButton);t.title?3<t.bootstrap?o.find(".modal-header").append(c):o.find(".modal-header").prepend(c):c.prependTo(r)}if(t.centerVertical&&(a.addClass("modal-dialog-centered"),t.fullBootstrapVersion<"4.0.0"&&console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")),t.reusable||o.one("hide.bs.modal",{dialog:o},x),t.onHide){if(!p.isFunction(t.onHide))throw new Error('Argument supplied to "onHide" must be a function');o.on("hide.bs.modal",t.onHide)}if(t.reusable||o.one("hidden.bs.modal",{dialog:o},y),t.onHidden){if(!p.isFunction(t.onHidden))throw new Error('Argument supplied to "onHidden" must be a function');o.on("hidden.bs.modal",t.onHidden)}if(t.onShow){if(!p.isFunction(t.onShow))throw new Error('Argument supplied to "onShow" must be a function');o.on("show.bs.modal",t.onShow)}if(o.one("shown.bs.modal",{dialog:o},v),t.onShown){if(!p.isFunction(t.onShown))throw new Error('Argument supplied to "onShown" must be a function');o.on("shown.bs.modal",t.onShown)}return!0===t.backdrop&&o.on("click.dismiss.bs.modal",(function(t){o.children(".modal-backdrop").length&&(t.currentTarget=o.children(".modal-backdrop").get(0)),t.target===t.currentTarget&&o.trigger("escape.close.bb")})),o.on("escape.close.bb",(function(t){s.onEscape&&k(t,o,s.onEscape)})),o.on("click",".modal-footer button:not(.disabled)",(function(t){var e=p(this).data("bb-handler");e!==u&&k(t,o,s[e])})),o.on("click",".bootbox-close-button",(function(t){k(t,o,s.onEscape)})),o.on("keyup",(function(t){27===t.which&&o.trigger("escape.close.bb")})),p(t.container).append(o),o.modal({backdrop:t.backdrop,keyboard:!1,show:!1}),t.show&&o.modal("show"),o},d.alert=function(){var t;if((t=h("alert",["ok"],["message","callback"],arguments)).callback&&!p.isFunction(t.callback))throw new Error('alert requires the "callback" property to be a function when provided');return t.buttons.ok.callback=t.onEscape=function(){return!p.isFunction(t.callback)||t.callback.call(this)},d.dialog(t)},d.confirm=function(){var t;if(t=h("confirm",["cancel","confirm"],["message","callback"],arguments),!p.isFunction(t.callback))throw new Error("confirm requires a callback");return t.buttons.cancel.callback=t.onEscape=function(){return t.callback.call(this,!1)},t.buttons.confirm.callback=function(){return t.callback.call(this,!0)},d.dialog(t)},d.prompt=function(){var r,e,t,n,o,a;if(t=p(f.form),(r=h("prompt",["cancel","confirm"],["title","callback"],arguments)).value||(r.value=m.value),r.inputType||(r.inputType=m.inputType),o=r.show===u?m.show:r.show,r.show=!1,r.buttons.cancel.callback=r.onEscape=function(){return r.callback.call(this,null)},r.buttons.confirm.callback=function(){var t;if("checkbox"===r.inputType)t=n.find("input:checked").map((function(){return p(this).val()})).get();else if("radio"===r.inputType)t=n.find("input:checked").val();else{if(n[0].checkValidity&&!n[0].checkValidity())return!1;t="select"===r.inputType&&!0===r.multiple?n.find("option:selected").map((function(){return p(this).val()})).get():n.val()}return r.callback.call(this,t)},!r.title)throw new Error("prompt requires a title");if(!p.isFunction(r.callback))throw new Error("prompt requires a callback");if(!f.inputs[r.inputType])throw new Error("Invalid prompt type");switch(n=p(f.inputs[r.inputType]),r.inputType){case"text":case"textarea":case"email":case"password":n.val(r.value),r.placeholder&&n.attr("placeholder",r.placeholder),r.pattern&&n.attr("pattern",r.pattern),r.maxlength&&n.attr("maxlength",r.maxlength),r.required&&n.prop({required:!0}),r.rows&&!isNaN(parseInt(r.rows))&&"textarea"===r.inputType&&n.attr({rows:r.rows});break;case"date":case"time":case"number":case"range":if(n.val(r.value),r.placeholder&&n.attr("placeholder",r.placeholder),r.pattern&&n.attr("pattern",r.pattern),r.required&&n.prop({required:!0}),"date"!==r.inputType&&r.step){if(!("any"===r.step||!isNaN(r.step)&&0<parseFloat(r.step)))throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');n.attr("step",r.step)}!function(t,e,o){var a=!1,r=!0,n=!0;if("date"===t)e===u||(r=O(e))?o===u||(n=O(o))||console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.'):console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');else if("time"===t){if(e!==u&&!(r=E(e)))throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');if(o!==u&&!(n=E(o)))throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.')}else{if(e!==u&&isNaN(e))throw r=!1,new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');if(o!==u&&isNaN(o))throw n=!1,new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.')}if(r&&n){if(o<=e)throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');a=!0}return a}(r.inputType,r.min,r.max)||(r.min!==u&&n.attr("min",r.min),r.max!==u&&n.attr("max",r.max));break;case"select":var i={};if(a=r.inputOptions||[],!p.isArray(a))throw new Error("Please pass an array of input options");if(!a.length)throw new Error('prompt with "inputType" set to "select" requires at least one option');r.placeholder&&n.attr("placeholder",r.placeholder),r.required&&n.prop({required:!0}),r.multiple&&n.prop({multiple:!0}),g(a,(function(t,e){var o=n;if(e.value===u||e.text===u)throw new Error('each option needs a "value" property and a "text" property');e.group&&(i[e.group]||(i[e.group]=p("<optgroup />").attr("label",e.group)),o=i[e.group]);var a=p(f.option);a.attr("value",e.value).text(e.text),o.append(a)})),g(i,(function(t,e){n.append(e)})),n.val(r.value);break;case"checkbox":var l=p.isArray(r.value)?r.value:[r.value];if(!(a=r.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');n=p('<div class="bootbox-checkbox-list"></div>'),g(a,(function(t,o){if(o.value===u||o.text===u)throw new Error('each option needs a "value" property and a "text" property');var a=p(f.inputs[r.inputType]);a.find("input").attr("value",o.value),a.find("label").append("\n"+o.text),g(l,(function(t,e){e===o.value&&a.find("input").prop("checked",!0)})),n.append(a)}));break;case"radio":if(r.value!==u&&p.isArray(r.value))throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');if(!(a=r.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "radio" requires at least one option');n=p('<div class="bootbox-radiobutton-list"></div>');var s=!0;g(a,(function(t,e){if(e.value===u||e.text===u)throw new Error('each option needs a "value" property and a "text" property');var o=p(f.inputs[r.inputType]);o.find("input").attr("value",e.value),o.find("label").append("\n"+e.text),r.value!==u&&e.value===r.value&&(o.find("input").prop("checked",!0),s=!1),n.append(o)})),s&&n.find('input[type="radio"]').first().prop("checked",!0)}if(t.append(n),t.on("submit",(function(t){t.preventDefault(),t.stopPropagation(),e.find(".bootbox-accept").trigger("click")})),""!==p.trim(r.message)){var c=p(f.promptMessage).html(r.message);t.prepend(c),r.message=t}else r.message=t;return(e=d.dialog(r)).off("shown.bs.modal",v),e.on("shown.bs.modal",(function(){n.focus()})),!0===o&&e.modal("show"),e},d})),require(["pgui.localizer","libs/bootbox.min","jquery"],(function(localizer){localizer.load().done((function(){bootbox.addLocale("php_gen",{OK:localizer.getString("Ok"),CANCEL:localizer.getString("Cancel"),CONFIRM:localizer.getString("Ok")}),bootbox.setLocale("php_gen")}))})),define("bootbox",(function(){})),define("pgui.utils",["pgui.autohide-message","bootbox"],(function(autoHideMessage){function _buildMessage(message,alertType){return $("<div>").addClass("alert").addClass("alert-"+alertType).css("margin-bottom",0).html("<p>"+message+"</p>")}function _showBootBoxAlert(messageToDisplay){bootbox.alert({closeButton:!1,message:messageToDisplay})}return{showInfoMessage:function(message){_showBootBoxAlert(_buildMessage(message,"info"))},showSuccessMessage:function(message){_showBootBoxAlert(_buildMessage(message,"success"))},showWarningMessage:function(message){_showBootBoxAlert(_buildMessage(message,"warning"))},showErrorMessage:function(message){_showBootBoxAlert(_buildMessage(message,"danger"))},showMessage:function(message){_showBootBoxAlert(message)},updatePopupHints:function($container){$container.find(".js-more-hint").each((function(){var $hintLink=$(this),$hintMessage=$hintLink.closest("td[data-column-name]").find(".js-more-box").html();$hintLink.off("click").on("click",(function(){return $(this).popover("hide"),_showBootBoxAlert($hintMessage),!1}));var popover=$hintLink.data("bs.popover");popover?popover.options.content=$hintMessage:$hintLink.popover({title:"",placement:function(){return $hintLink.offset().top-$(window).scrollTop()<$(window).height()/2?"bottom":"top"},html:!0,trigger:"hover",content:$hintMessage})}))},buildDismissableMessage:function(className,message,messageDisplayTime){if(!message)return null;var $message=$('<div class="alert alert-'+className+' alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-label="Close">&times;</button>'+message+"</div>");return autoHideMessage($message,messageDisplayTime),$message},createLoadingModalDialog:function(operationName){var loadingContent='<div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-body" style="text-align: center"><img src="components/assets/img/loading.gif" />'+(void 0!==operationName?"&nbsp&nbsp<span>"+operationName+"</span>":"")+"</div></div>";return $("<div/>",{class:"modal fade",tabIndex:"-1","data-backdrop":"static"}).append(loadingContent).appendTo($("body"))},replaceRow:function($oldRow,$newRow){var $oldRowDetails=$oldRow.find(".details").first(),$newRowDetails=$newRow.find(".details").first();$oldRowDetails.length>0&&$newRowDetails.length>0&&$newRowDetails.replaceWith($oldRowDetails),$oldRow.replaceWith($newRow)}}})),define("pgui.field-embedded-video",["underscore","pgui.localizer","bootbox","jquery.query"],(function(_,localizer){var template=_.template('<img class="pgui-field-embedded-video-thumb pgui-field-embedded-video-fade" src="<%=thumbnail_url %>" /><span class="pgui-field-embedded-video-icon pgui-field-embedded-video-fade icon-play"></span>');function closeCallback(){return!0}function getIframe(response,autoplay){var src,params,$iframe=$(response.html);return $iframe.removeClass().addClass("pgui-field-embedded-video-iframe").removeAttr("width").removeAttr("height"),autoplay&&$iframe.attr("src",(src=$iframe.attr("src"),(params=((src=src.split("?"))[1]||"").split("&")).push("autoplay=1"),src[0]+"?"+params.join("&"))),$iframe}function openModal($el){if($el.data("api")){var api=$el.data("api");bootbox.dialog({message:getIframe(api,$el.data("autoplay")),title:api.title||null,closeButton:!0,backdrop:!0,onEscape:closeCallback,buttons:{cancel:{label:localizer.getString("Close"),callback:closeCallback}}})}else $el.append('<img class="pgui-field-embedded-video-preloader" src="components/assets/img/loading.gif">'),getApi($el,(function(){$el.find(".pgui-field-embedded-video-preloader").remove(),openModal($el)}))}function getApi($el,cb){var url=$el.data("url");$.getJSON("https://noembed.com/embed",{url:url}).done((function(response){if($el.data("api",response),"video"!==response.type)return $el.html(url),void $el.find(".pgui-field-embedded-video-preloader").remove();cb(response)})).fail((function(){$el.html(url),$el.find(".pgui-field-embedded-video-preloader").remove()}))}return function(container,autoplay,allWithoutModal){autoplay=autoplay||!0,container.find(".pgui-field-embedded-video").each((function(i,el){var $el=$(el);if($el.data("url")){$el.data("autoplay",autoplay);var $wrapper=$el.closest(".pgui-embedded-video-wrapper");allWithoutModal||$wrapper.data("without-modal")?getApi($el,(function(response){$el.html(getIframe(response)),$el.find(".pgui-field-embedded-video-preloader").remove()})):($el.on("click",(function(){return openModal($el),!1})),$el.find(".pgui-field-embedded-video-thumb").length||getApi($el,(function(response){(void 0===$el.data("thumb")||$el.data("thumb"))&&$el.prepend($(template(response))),setTimeout((function(){$el.find(".pgui-field-embedded-video-fade").removeClass("pgui-field-embedded-video-fade"),$el.find(".pgui-field-embedded-video-preloader").addClass("pgui-field-embedded-video-fade")}),10)})))}}))}})),function(root,factory){"function"==typeof define&&define.amd?define("libs/store",[],factory):"object"==typeof exports?module.exports=factory():root.store=factory()}(this,(function(){var storage,store={},win="undefined"!=typeof window?window:global,doc=win.document;if(store.disabled=!1,store.version="1.3.20",store.set=function(key,value){},store.get=function(key,defaultVal){},store.has=function(key){return void 0!==store.get(key)},store.remove=function(key){},store.clear=function(){},store.transact=function(key,defaultVal,transactionFn){null==transactionFn&&(transactionFn=defaultVal,defaultVal=null),null==defaultVal&&(defaultVal={});var val=store.get(key,defaultVal);transactionFn(val),store.set(key,val)},store.getAll=function(){},store.forEach=function(){},store.serialize=function(value){return JSON.stringify(value)},store.deserialize=function(value){if("string"==typeof value)try{return JSON.parse(value)}catch(e){return value||void 0}},function(){try{return"localStorage"in win&&win.localStorage}catch(err){return!1}}())storage=win.localStorage,store.set=function(key,val){return void 0===val?store.remove(key):(storage.setItem(key,store.serialize(val)),val)},store.get=function(key,defaultVal){var val=store.deserialize(storage.getItem(key));return void 0===val?defaultVal:val},store.remove=function(key){storage.removeItem(key)},store.clear=function(){storage.clear()},store.getAll=function(){var ret={};return store.forEach((function(key,val){ret[key]=val})),ret},store.forEach=function(callback){for(var i=0;i<storage.length;i++){var key=storage.key(i);callback(key,store.get(key))}};else if(doc&&doc.documentElement.addBehavior){var storageOwner,storageContainer;try{(storageContainer=new ActiveXObject("htmlfile")).open(),storageContainer.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),storageContainer.close(),storageOwner=storageContainer.w.frames[0].document,storage=storageOwner.createElement("div")}catch(e){storage=doc.createElement("div"),storageOwner=doc.body}var withIEStorage=function(storeFunction){return function(){var args=Array.prototype.slice.call(arguments,0);args.unshift(storage),storageOwner.appendChild(storage),storage.addBehavior("#default#userData"),storage.load("localStorage");var result=storeFunction.apply(store,args);return storageOwner.removeChild(storage),result}},forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),ieKeyFix=function(key){return key.replace(/^d/,"___$&").replace(forbiddenCharsRegex,"___")};store.set=withIEStorage((function(storage,key,val){return key=ieKeyFix(key),void 0===val?store.remove(key):(storage.setAttribute(key,store.serialize(val)),storage.save("localStorage"),val)})),store.get=withIEStorage((function(storage,key,defaultVal){key=ieKeyFix(key);var val=store.deserialize(storage.getAttribute(key));return void 0===val?defaultVal:val})),store.remove=withIEStorage((function(storage,key){key=ieKeyFix(key),storage.removeAttribute(key),storage.save("localStorage")})),store.clear=withIEStorage((function(storage){var attributes=storage.XMLDocument.documentElement.attributes;storage.load("localStorage");for(var i=attributes.length-1;i>=0;i--)storage.removeAttribute(attributes[i].name);storage.save("localStorage")})),store.getAll=function(storage){var ret={};return store.forEach((function(key,val){ret[key]=val})),ret},store.forEach=withIEStorage((function(storage,callback){for(var attr,attributes=storage.XMLDocument.documentElement.attributes,i=0;attr=attributes[i];++i)callback(attr.name,store.deserialize(storage.getAttribute(attr.name)))}))}try{var testKey="__storejs__";store.set(testKey,testKey),store.get(testKey)!=testKey&&(store.disabled=!0),store.remove(testKey)}catch(e){store.disabled=!0}return store.enabled=!store.disabled,store})),define("pgui.selection",["class","libs/store","microevent"],(function(Class,store,events){function removeFromData(data,value){return _.filter(data,(function(v){return v.join("_")!==value.join("_")}))}return events.mixin(Class.extend({init:function(prefix){this.prefix=prefix+"_selection"},getData:function(){return store.get(this.prefix)||[]},add:function(value){var data=removeFromData(this.getData(),value);return data.push(value),store.set(this.prefix,data),this.trigger("change",data),this},remove:function(value){var nextData=removeFromData(this.getData(),value);return store.set(this.prefix,nextData),this.trigger("change",nextData),this},toggle:function(value,isEnabled){return isEnabled?this.add(value):this.remove(value),this},clear:function(){store.remove(this.prefix),this.trigger("change",[])}}))})),
/*!
 * jQuery Validation Plugin v1.19.5
 *
 * https://jqueryvalidation.org/
 *
 * Copyright (c) 2022 JÃ¶rn Zaefferer
 * Released under the MIT license
 */
function(factory){"function"==typeof define&&define.amd?define("jquery.validate",["jquery"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("jquery")):factory(jQuery)}((function($){$.extend($.fn,{validate:function(options){if(this.length){var validator=$.data(this[0],"validator");return validator||(this.attr("novalidate","novalidate"),validator=new $.validator(options,this[0]),$.data(this[0],"validator",validator),validator.settings.onsubmit&&(this.on("click.validate",":submit",(function(event){validator.submitButton=event.currentTarget,$(this).hasClass("cancel")&&(validator.cancelSubmit=!0),void 0!==$(this).attr("formnovalidate")&&(validator.cancelSubmit=!0)})),this.on("submit.validate",(function(event){function handle(){var hidden,result;return validator.submitButton&&(validator.settings.submitHandler||validator.formSubmitted)&&(hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val($(validator.submitButton).val()).appendTo(validator.currentForm)),!(validator.settings.submitHandler&&!validator.settings.debug)||(result=validator.settings.submitHandler.call(validator,validator.currentForm,event),hidden&&hidden.remove(),void 0!==result&&result)}return validator.settings.debug&&event.preventDefault(),validator.cancelSubmit?(validator.cancelSubmit=!1,handle()):validator.form()?validator.pendingRequest?(validator.formSubmitted=!0,!1):handle():(validator.focusInvalid(),!1)}))),validator)}options&&options.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){var valid,validator,errorList;return $(this[0]).is("form")?valid=this.validate().form():(errorList=[],valid=!0,validator=$(this[0].form).validate(),this.each((function(){(valid=validator.element(this)&&valid)||(errorList=errorList.concat(validator.errorList))})),validator.errorList=errorList),valid},rules:function(command,argument){var settings,staticRules,existingRules,data,param,filtered,element=this[0],isContentEditable=void 0!==this.attr("contenteditable")&&"false"!==this.attr("contenteditable");if(null!=element&&(!element.form&&isContentEditable&&(element.form=this.closest("form")[0],element.name=this.attr("name")),null!=element.form)){if(command)switch(staticRules=(settings=$.data(element.form,"validator").settings).rules,existingRules=$.validator.staticRules(element),command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument)),delete existingRules.messages,staticRules[element.name]=existingRules,argument.messages&&(settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages));break;case"remove":return argument?(filtered={},$.each(argument.split(/\s/),(function(index,method){filtered[method]=existingRules[method],delete existingRules[method]})),filtered):(delete staticRules[element.name],existingRules)}return(data=$.validator.normalizeRules($.extend({},$.validator.classRules(element),$.validator.attributeRules(element),$.validator.dataRules(element),$.validator.staticRules(element)),element)).required&&(param=data.required,delete data.required,data=$.extend({required:param},data)),data.remote&&(param=data.remote,delete data.remote,data=$.extend(data,{remote:param})),data}}});var called,trim=function(str){return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};$.extend($.expr.pseudos||$.expr[":"],{blank:function(a){return!trim(""+$(a).val())},filled:function(a){var val=$(a).val();return null!==val&&!!trim(""+val)},unchecked:function(a){return!$(a).prop("checked")}}),$.validator=function(options,form){this.settings=$.extend(!0,{},$.validator.defaults,options),this.currentForm=form,this.init()},$.validator.format=function(source,params){return 1===arguments.length?function(){var args=$.makeArray(arguments);return args.unshift(source),$.validator.format.apply(this,args)}:(void 0===params||(arguments.length>2&&params.constructor!==Array&&(params=$.makeArray(arguments).slice(1)),params.constructor!==Array&&(params=[params]),$.each(params,(function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),(function(){return n}))}))),source)},$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(element){this.lastActive=element,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(element)))},onfocusout:function(element){this.checkable(element)||!(element.name in this.submitted)&&this.optional(element)||this.element(element)},onkeyup:function(element,event){9===event.which&&""===this.elementValue(element)||-1!==$.inArray(event.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])||(element.name in this.submitted||element.name in this.invalid)&&this.element(element)},onclick:function(element){element.name in this.submitted?this.element(element):element.parentNode.name in this.submitted&&this.element(element.parentNode)},highlight:function(element,errorClass,validClass){"radio"===element.type?this.findByName(element.name).addClass(errorClass).removeClass(validClass):$(element).addClass(errorClass).removeClass(validClass)},unhighlight:function(element,errorClass,validClass){"radio"===element.type?this.findByName(element.name).removeClass(errorClass).addClass(validClass):$(element).removeClass(errorClass).addClass(validClass)}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm),this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var rules,currentForm=this.currentForm,groups=this.groups={};function delegate(event){var isContentEditable=void 0!==$(this).attr("contenteditable")&&"false"!==$(this).attr("contenteditable");if(!this.form&&isContentEditable&&(this.form=$(this).closest("form")[0],this.name=$(this).attr("name")),currentForm===this.form){var validator=$.data(this.form,"validator"),eventType="on"+event.type.replace(/^validate/,""),settings=validator.settings;settings[eventType]&&!$(this).is(settings.ignore)&&settings[eventType].call(validator,this,event)}}$.each(this.settings.groups,(function(key,value){"string"==typeof value&&(value=value.split(/\s/)),$.each(value,(function(index,name){groups[name]=key}))})),rules=this.settings.rules,$.each(rules,(function(key,value){rules[key]=$.validator.normalizeRule(value)})),$(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",delegate).on("click.validate","select, option, [type='radio'], [type='checkbox']",delegate),this.settings.invalidHandler&&$(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),$.extend(this.submitted,this.errorMap),this.invalid=$.extend({},this.errorMap),this.valid()||$(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++)this.check(elements[i]);return this.valid()},element:function(element){var rs,group,cleanElement=this.clean(element),checkElement=this.validationTargetFor(cleanElement),v=this,result=!0;return void 0===checkElement?delete this.invalid[cleanElement.name]:(this.prepareElement(checkElement),this.currentElements=$(checkElement),(group=this.groups[checkElement.name])&&$.each(this.groups,(function(name,testgroup){testgroup===group&&name!==checkElement.name&&(cleanElement=v.validationTargetFor(v.clean(v.findByName(name))))&&cleanElement.name in v.invalid&&(v.currentElements.push(cleanElement),result=v.check(cleanElement)&&result)})),rs=!1!==this.check(checkElement),result=result&&rs,this.invalid[checkElement.name]=!rs,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),$(element).attr("aria-invalid",!rs)),result},showErrors:function(errors){if(errors){var validator=this;$.extend(this.errorMap,errors),this.errorList=$.map(this.errorMap,(function(message,name){return{message:message,element:validator.findByName(name)[0]}})),this.successList=$.grep(this.successList,(function(element){return!(element.name in errors)}))}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){$.fn.resetForm&&$(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var elements=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(elements)},resetElements:function(elements){var i;if(this.settings.unhighlight)for(i=0;elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,""),this.findByName(elements[i].name).removeClass(this.settings.validClass);else elements.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var i,count=0;for(i in obj)void 0!==obj[i]&&null!==obj[i]&&!1!==obj[i]&&count++;return count},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(errors){errors.not(this.containers).text(""),this.addWrapper(errors).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").trigger("focus").trigger("focusin")}catch(e){}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&1===$.grep(this.errorList,(function(n){return n.element.name===lastActive.name})).length&&lastActive},elements:function(){var validator=this,rulesCache={};return $(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter((function(){var name=this.name||$(this).attr("name"),isContentEditable=void 0!==$(this).attr("contenteditable")&&"false"!==$(this).attr("contenteditable");return!name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this),isContentEditable&&(this.form=$(this).closest("form")[0],this.name=name),this.form===validator.currentForm&&(!(name in rulesCache||!validator.objectLength($(this).rules()))&&(rulesCache[name]=!0,!0))}))},clean:function(selector){return $(selector)[0]},errors:function(){var errorClass=this.settings.errorClass.split(" ").join(".");return $(this.settings.errorElement+"."+errorClass,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=$([]),this.toHide=$([])},reset:function(){this.resetInternals(),this.currentElements=$([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset(),this.toHide=this.errorsFor(element)},elementValue:function(element){var val,idx,$element=$(element),type=element.type,isContentEditable=void 0!==$element.attr("contenteditable")&&"false"!==$element.attr("contenteditable");return"radio"===type||"checkbox"===type?this.findByName(element.name).filter(":checked").val():"number"===type&&void 0!==element.validity?element.validity.badInput?"NaN":$element.val():(val=isContentEditable?$element.text():$element.val(),"file"===type?"C:\\fakepath\\"===val.substr(0,12)?val.substr(12):(idx=val.lastIndexOf("/"))>=0||(idx=val.lastIndexOf("\\"))>=0?val.substr(idx+1):val:"string"==typeof val?val.replace(/\r/g,""):val)},check:function(element){element=this.validationTargetFor(this.clean(element));var result,method,rule,normalizer,rules=$(element).rules(),rulesCount=$.map(rules,(function(n,i){return i})).length,dependencyMismatch=!1,val=this.elementValue(element);for(method in"function"==typeof rules.normalizer?normalizer=rules.normalizer:"function"==typeof this.settings.normalizer&&(normalizer=this.settings.normalizer),normalizer&&(val=normalizer.call(element,val),delete rules.normalizer),rules){rule={method:method,parameters:rules[method]};try{if("dependency-mismatch"===(result=$.validator.methods[method].call(this,val,element,rule.parameters))&&1===rulesCount){dependencyMismatch=!0;continue}if(dependencyMismatch=!1,"pending"===result)return void(this.toHide=this.toHide.not(this.errorsFor(element)));if(!result)return this.formatAndAdd(element,rule),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+element.id+", check the '"+rule.method+"' method.",e),e instanceof TypeError&&(e.message+=".  Exception occurred when checking element "+element.id+", check the '"+rule.method+"' method."),e}}if(!dependencyMismatch)return this.objectLength(rules)&&this.successList.push(element),!0},customDataMessage:function(element,method){return $(element).data("msg"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase())||$(element).data("msg")},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor===String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++)if(void 0!==arguments[i])return arguments[i]},defaultMessage:function(element,rule){"string"==typeof rule&&(rule={method:rule});var message=this.findDefined(this.customMessage(element.name,rule.method),this.customDataMessage(element,rule.method),!this.settings.ignoreTitle&&element.title||void 0,$.validator.messages[rule.method],"<strong>Warning: No message defined for "+element.name+"</strong>"),theregex=/\$?\{(\d+)\}/g;return"function"==typeof message?message=message.call(this,rule.parameters,element):theregex.test(message)&&(message=$.validator.format(message.replace(theregex,"{$1}"),rule.parameters)),message},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule);this.errorList.push({message:message,element:element,method:rule.method}),this.errorMap[element.name]=message,this.submitted[element.name]=message},addWrapper:function(toToggle){return this.settings.wrapper&&(toToggle=toToggle.add(toToggle.parent(this.settings.wrapper))),toToggle},defaultShowErrors:function(){var i,elements,error;for(i=0;this.errorList[i];i++)error=this.errorList[i],this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass),this.showLabel(error.element,error.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(i=0;this.successList[i];i++)this.showLabel(this.successList[i]);if(this.settings.unhighlight)for(i=0,elements=this.validElements();elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map((function(){return this.element}))},showLabel:function(element,message){var place,group,errorID,v,error=this.errorsFor(element),elementID=this.idOrName(element),describedBy=$(element).attr("aria-describedby");error.length?(error.removeClass(this.settings.validClass).addClass(this.settings.errorClass),error.html(message)):(place=error=$("<"+this.settings.errorElement+">").attr("id",elementID+"-error").addClass(this.settings.errorClass).html(message||""),this.settings.wrapper&&(place=error.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(place):this.settings.errorPlacement?this.settings.errorPlacement.call(this,place,$(element)):place.insertAfter(element),error.is("label")?error.attr("for",elementID):0===error.parents("label[for='"+this.escapeCssMeta(elementID)+"']").length&&(errorID=error.attr("id"),describedBy?describedBy.match(new RegExp("\\b"+this.escapeCssMeta(errorID)+"\\b"))||(describedBy+=" "+errorID):describedBy=errorID,$(element).attr("aria-describedby",describedBy),(group=this.groups[element.name])&&(v=this,$.each(v.groups,(function(name,testgroup){testgroup===group&&$("[name='"+v.escapeCssMeta(name)+"']",v.currentForm).attr("aria-describedby",error.attr("id"))}))))),!message&&this.settings.success&&(error.text(""),"string"==typeof this.settings.success?error.addClass(this.settings.success):this.settings.success(error,element)),this.toShow=this.toShow.add(error)},errorsFor:function(element){var name=this.escapeCssMeta(this.idOrName(element)),describer=$(element).attr("aria-describedby"),selector="label[for='"+name+"'], label[for='"+name+"'] *";return describer&&(selector=selector+", #"+this.escapeCssMeta(describer).replace(/\s+/g,", #")),this.errors().filter(selector)},escapeCssMeta:function(string){return void 0===string?"":string.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name)},validationTargetFor:function(element){return this.checkable(element)&&(element=this.findByName(element.name)),$(element).not(this.settings.ignore)[0]},checkable:function(element){return/radio|checkbox/i.test(element.type)},findByName:function(name){return $(this.currentForm).find("[name='"+this.escapeCssMeta(name)+"']")},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case"select":return $("option:selected",element).length;case"input":if(this.checkable(element))return this.findByName(element.name).filter(":checked").length}return value.length},depend:function(param,element){return!this.dependTypes[typeof param]||this.dependTypes[typeof param](param,element)},dependTypes:{boolean:function(param){return param},string:function(param,element){return!!$(param,element.form).length},function:function(param,element){return param(element)}},optional:function(element){var val=this.elementValue(element);return!$.validator.methods.required.call(this,val,element)&&"dependency-mismatch"},startRequest:function(element){this.pending[element.name]||(this.pendingRequest++,$(element).addClass(this.settings.pendingClass),this.pending[element.name]=!0)},stopRequest:function(element,valid){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[element.name],$(element).removeClass(this.settings.pendingClass),valid&&0===this.pendingRequest&&this.formSubmitted&&this.form()&&0===this.pendingRequest?($(this.currentForm).trigger("submit"),this.submitButton&&$("input:hidden[name='"+this.submitButton.name+"']",this.currentForm).remove(),this.formSubmitted=!1):!valid&&0===this.pendingRequest&&this.formSubmitted&&($(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(element,method){return method="string"==typeof method&&method||"remote",$.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:!0,message:this.defaultMessage(element,{method:method})})},destroy:function(){this.resetForm(),$(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur").find(".validate-lessThan-blur").off(".validate-lessThan").removeClass("validate-lessThan-blur").find(".validate-lessThanEqual-blur").off(".validate-lessThanEqual").removeClass("validate-lessThanEqual-blur").find(".validate-greaterThanEqual-blur").off(".validate-greaterThanEqual").removeClass("validate-greaterThanEqual-blur").find(".validate-greaterThan-blur").off(".validate-greaterThan").removeClass("validate-greaterThan-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(className,rules){className.constructor===String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className)},classRules:function(element){var rules={},classes=$(element).attr("class");return classes&&$.each(classes.split(" "),(function(){this in $.validator.classRuleSettings&&$.extend(rules,$.validator.classRuleSettings[this])})),rules},normalizeAttributeRule:function(rules,type,method,value){/min|max|step/.test(method)&&(null===type||/number|range|text/.test(type))&&(value=Number(value),isNaN(value)&&(value=void 0)),value||0===value?rules[method]=value:type===method&&"range"!==type&&(rules["date"===type?"dateISO":method]=!0)},attributeRules:function(element){var method,value,rules={},$element=$(element),type=element.getAttribute("type");for(method in $.validator.methods)"required"===method?(""===(value=element.getAttribute(method))&&(value=!0),value=!!value):value=$element.attr(method),this.normalizeAttributeRule(rules,type,method,value);return rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)&&delete rules.maxlength,rules},dataRules:function(element){var method,value,rules={},$element=$(element),type=element.getAttribute("type");for(method in $.validator.methods)""===(value=$element.data("rule"+method.charAt(0).toUpperCase()+method.substring(1).toLowerCase()))&&(value=!0),this.normalizeAttributeRule(rules,type,method,value);return rules},staticRules:function(element){var rules={},validator=$.data(element.form,"validator");return validator.settings.rules&&(rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{}),rules},normalizeRules:function(rules,element){return $.each(rules,(function(prop,val){if(!1!==val){if(val.param||val.depends){var keepRule=!0;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element)}keepRule?rules[prop]=void 0===val.param||val.param:($.data(element.form,"validator").resetElements($(element)),delete rules[prop])}}else delete rules[prop]})),$.each(rules,(function(rule,parameter){rules[rule]="function"==typeof parameter&&"normalizer"!==rule?parameter(element):parameter})),$.each(["minlength","maxlength"],(function(){rules[this]&&(rules[this]=Number(rules[this]))})),$.each(["rangelength","range"],(function(){var parts;rules[this]&&(Array.isArray(rules[this])?rules[this]=[Number(rules[this][0]),Number(rules[this][1])]:"string"==typeof rules[this]&&(parts=rules[this].replace(/[\[\]]/g,"").split(/[\s,]+/),rules[this]=[Number(parts[0]),Number(parts[1])]))})),$.validator.autoCreateRanges&&(null!=rules.min&&null!=rules.max&&(rules.range=[rules.min,rules.max],delete rules.min,delete rules.max),null!=rules.minlength&&null!=rules.maxlength&&(rules.rangelength=[rules.minlength,rules.maxlength],delete rules.minlength,delete rules.maxlength)),rules},normalizeRule:function(data){if("string"==typeof data){var transformed={};$.each(data.split(/\s/),(function(){transformed[this]=!0})),data=transformed}return data},addMethod:function(name,method,message){$.validator.methods[name]=method,$.validator.messages[name]=void 0!==message?message:$.validator.messages[name],method.length<3&&$.validator.addClassRules(name,$.validator.normalizeRule(name))},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";if("select"===element.nodeName.toLowerCase()){var val=$(element).val();return val&&val.length>0}return this.checkable(element)?this.getLength(value,element)>0:null!=value&&value.length>0},email:function(value,element){return this.optional(element)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(value)},url:function(value,element){return this.optional(element)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:(?:[^\]\[?\/<~#`!@$^&*()+=}|:";',>{ ]|%[0-9A-Fa-f]{2})+(?::(?:[^\]\[?\/<~#`!@$^&*()+=}|:";',>{ ]|%[0-9A-Fa-f]{2})*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(value)},date:(called=!1,function(value,element){return called||(called=!0,this.settings.debug&&window.console&&console.warn("The `date` method is deprecated and will be removed in version '2.0.0'.\nPlease don't use it, since it relies on the Date constructor, which\nbehaves very differently across browsers and locales. Use `dateISO`\ninstead or one of the locale specific methods in `localizations/`\nand `additional-methods.js`.")),this.optional(element)||!/Invalid|NaN/.test(new Date(value).toString())}),dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(value)},number:function(value,element){return this.optional(element)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value)},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9 \-]+/.test(value))return!1;for(var nCheck=0,nDigit=0,bEven=!1,n=(value=value.replace(/\D/g,"")).length-1;n>=0;n--){var cDigit=value.charAt(n);nDigit=parseInt(cDigit,10),bEven&&(nDigit*=2)>9&&(nDigit-=9),nCheck+=nDigit,bEven=!bEven}return nCheck%10==0},minlength:function(value,element,param){var length=Array.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param},maxlength:function(value,element,param){var length=Array.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length<=param},rangelength:function(value,element,param){var length=Array.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||value<=param},range:function(value,element,param){return this.optional(element)||value>=param[0]&&value<=param[1]},equalTo:function(value,element,param){var target=$(param);return this.settings.onfocusout&&target.not(".validate-equalTo-blur").length&&target.addClass("validate-equalTo-blur").on("blur.validate-equalTo",(function(){$(element).valid()})),value===target.val()},remote:function(value,element,param,method){if(this.optional(element))return"dependency-mismatch";method="string"==typeof method&&method||"remote";var validator,data,optionDataString,previous=this.previousValue(element,method);return this.settings.messages[element.name]||(this.settings.messages[element.name]={}),previous.originalMessage=previous.originalMessage||this.settings.messages[element.name][method],this.settings.messages[element.name][method]=previous.message,param="string"==typeof param&&{url:param}||param,optionDataString=$.param($.extend({data:value},param.data)),previous.old===optionDataString?previous.valid:(previous.old=optionDataString,validator=this,this.startRequest(element),(data={})[element.name]=value,$.ajax($.extend(!0,{mode:"abort",port:"validate"+element.name,dataType:"json",data:data,context:validator.currentForm,success:function(response){var errors,message,submitted,valid=!0===response||"true"===response;validator.settings.messages[element.name][method]=previous.originalMessage,valid?(submitted=validator.formSubmitted,validator.resetInternals(),validator.toHide=validator.errorsFor(element),validator.formSubmitted=submitted,validator.successList.push(element),validator.invalid[element.name]=!1,validator.showErrors()):(errors={},message=response||validator.defaultMessage(element,{method:method,parameters:value}),errors[element.name]=previous.message=message,validator.invalid[element.name]=!0,validator.showErrors(errors)),previous.valid=valid,validator.stopRequest(element,valid)}},param)),"pending")}}});var ajax,pendingRequests={};return $.ajaxPrefilter?$.ajaxPrefilter((function(settings,_,xhr){var port=settings.port;"abort"===settings.mode&&(pendingRequests[port]&&pendingRequests[port].abort(),pendingRequests[port]=xhr)})):(ajax=$.ajax,$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;return"abort"===mode?(pendingRequests[port]&&pendingRequests[port].abort(),pendingRequests[port]=ajax.apply(this,arguments),pendingRequests[port]):ajax.apply(this,arguments)}),$})),define("pgui.validation",["underscore","jquery.validate"],(function(_){function validateTabs(element){var $formTabsContainer=$(element).closest("form").find(".form-tabs-container");if($formTabsContainer.length>0){$formTabsContainer.find("a span.required").remove();var $tabContent=$(element).closest(".tab-content");$tabContent.length>0&&$tabContent.find(".tab-pane:has(.form-group.has-error)").each((function(){var id=$(this).attr("id");$formTabsContainer.find('a[href^="#'+id+'"]').append(' <span class="required">***</span>')}))}}var methods={init:function(options){var settings={validate_errorClass:"help-block",validate_errorPlacement:function(helpBlock,element){var target=element.closest(".col-input,.form-group");0===target.length&&(target=element.parent()),helpBlock.appendTo(target)},validate_success:function(element){$(element).closest(".form-group").removeClass("has-error").prev(".form-group-label").removeClass("has-error"),validateTabs(element),$(element).remove()},highlight:function(element){$(element).closest(".form-group").addClass("has-error").prev(".form-group-label").addClass("has-error"),validateTabs(element)},unhighlight:void 0};options&&$.extend(settings,options),this&&this.length>0&&($.validator.addMethod("regexp",(function(value,element,param){var pattern=new RegExp(param);return value.match(pattern)}),"Default regexp message"),$.validator.addMethod("required_custom",(function(value,element,param){return"file"===$(element).attr("type")&&$(element).data("has-file")||value}),"Default required message"),this.each((function(index,form){var validationRules={},errorMessageMap={};$(form).find('input,select,textarea,div[data-editor="radio"]').each((function(inputIndex,input){if(null!=$(input).attr("data-validation")){var rules=$(input).attr("data-validation").split(" "),validationRule={},errorMessages={};function appendErrorMessage(validatorName,attrName){attrName=attrName||validatorName;var data=$(input).data();data[attrName+"ErrorMessage"]&&(errorMessages[validatorName]=data[attrName+"ErrorMessage"])}for(var i=0;i<rules.length;i++)"email"==rules[i]?(validationRule.email=!0,appendErrorMessage(rules[i])):"url"==rules[i]?(validationRule.url=!0,appendErrorMessage(rules[i])):"required"==rules[i]?(validationRule.required_custom=!0,appendErrorMessage("required_custom","required")):"range"==rules[i]?(validationRule.range=[$(input).attr("range-min-value"),$(input).attr("range-max-value")],appendErrorMessage(rules[i])):"max-value"==rules[i]?(validationRule.max=Number($(input).attr("max-value")),appendErrorMessage("max","maxValue")):"min-value"==rules[i]?(validationRule.min=Number($(input).attr("min-value")),appendErrorMessage("min","minValue")):"max-length"==rules[i]?(validationRule.maxlength=$(input).attr("max-length"),appendErrorMessage("maxlength","maxLength")):"min-length"==rules[i]?(validationRule.minlength=$(input).attr("min-length"),appendErrorMessage("minlength","minLength")):"rangelength"==rules[i]?(validationRule.rangelength=[$(input).attr("range-min-length"),$(input).attr("range-max-length")],appendErrorMessage(rules[i])):"number"==rules[i]?(validationRule.number=!0,appendErrorMessage(rules[i])):"digits"==rules[i]?(validationRule.digits=!0,appendErrorMessage(rules[i])):"creditcard"==rules[i]?(validationRule.creditcard=!0,appendErrorMessage(rules[i])):"regexp"==rules[i]&&(validationRule.regexp=$(input).attr("regexp"),appendErrorMessage(rules[i]));var inputName="radio"===$(input).data("editor")?$(input).data("editor-name"):$(input).attr("name");errorMessageMap[inputName]=errorMessages,validationRules[inputName]=validationRule}})),$(form).validate({errorClass:settings.validate_errorClass,errorPlacement:settings.validate_errorPlacement,errorElement:"span",ignore:"",success:settings.validate_success,rules:validationRules,messages:errorMessageMap,highlight:settings.highlight,unhighlight:settings.unhighlight})})))}};function ErrorInfo(message){var _message=message;this.GetMessage=function(){return _message},this.SetMessage=function(value){_message=value}}return $.fn.pgui_validate_form=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.pgui_effects"):methods.init.apply(this,arguments)},{validateForm:function($form){if(!$form.valid())return{success:!1,message:null};var values={},errorInfo=new ErrorInfo;$form.find("*[data-pgui-legacy-validate]").each((function(index,element){var $el=$(element);$el.data("editor")&&$el.data("editor").getValue&&(values[$el.data("legacy-field-name")]=$el.data("editor").getValue())}));var validationCallback=window[$form.attr("id")+"Validation"];return{success:!_.isFunction(validationCallback)||validationCallback(values,errorInfo),message:errorInfo.GetMessage()}}}})),define("pgui.modal_operation_link",["pgui.shortcuts","pgui.utils"],(function(shortcuts,utils){function internalProcessQuery(FormCollection,$link,doneCallback){var url=$link.data("content-link"),$modal=utils.createLoadingModalDialog().modal();$.get(url,{is_modal:!0},(function(content){$modal.html(content);var formCollection=new FormCollection($modal,$modal.find(".js-form-collection"),url,{done:function(hasErrors,responses,params){return doneCallback($modal,hasErrors,responses,params)}});shortcuts.push("form"),$modal.one("hidden.bs.modal",(function(){formCollection.destroy(),$modal.remove(),shortcuts.pop()}))}))}function createModalLink(FormCollection,$link,$grid,doneCallback){$link.click((function(e){e.preventDefault(),internalProcessQuery(FormCollection,$link,doneCallback)}))}function done($modal,hasErrors,responses,params,$rows,$grid,callback){if("function"==typeof callback&&callback(hasErrors,responses,params),$.each(responses,(function(i,response){response.success&&$grid&&$grid.showMessage(response.message,response.messageDisplayTime)})),hasErrors)return!0;if($modal.modal("hide"),1===responses.length&&1===$rows.length)switch(params.action){case"edit":$rows[0].find("[data-column-name=edit]").find("a").get(0).click();break;case"details":location.href=responses[0].details[params.index]}return"insert"===params.action&&$grid&&$grid.container.find(".pgui-add:first").get(0).click(),void 0===params.action&&$grid&&$grid.getReloadPageAfterAjaxOperation()&&location.reload(),!1}return{processQuery:function(FormCollection,$link,doneCallback){return internalProcessQuery(FormCollection,$link,doneCallback)},createInsertLink:function(FormCollection,$link,$grid,callback){return createModalLink(FormCollection,$link,0,(function($modal,hasErrors,responses,params){return $rows=$.map(responses.filter((function(r){return r.success})),(function(response){return!$grid||$grid.insertRowAtBegin($(response.row))})),done($modal,hasErrors,responses,params,$rows,$grid,callback)}))},createEditLink:function(FormCollection,$link,$grid,callback){return createModalLink(FormCollection,$link,0,(function($modal,hasErrors,responses,params){var $row=$();return hasErrors||($row=$(responses[0].row),utils.replaceRow($link.closest(".pg-row"),$row),$grid&&($grid.integrateRows($row),$grid.updateEmptyGridMessage())),done($modal,hasErrors,responses,params,[$row],$grid,callback)}))}}})),
/*!
 * jQuery Form Plugin
 * version: 3.51.0-2014.06.20
 * Requires jQuery v1.5 or later
 * Copyright (c) 2014 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
function(factory){"use strict";"function"==typeof define&&define.amd?define("jquery.form",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}((function($){"use strict";var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout((function(){form.clk=form.clk_x=form.clk_y=null}),100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),(url=(url="string"==typeof(action=options.url||this.attr2("action"))?$.trim(action):"")||window.location.href||"")&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&!1===options.beforeSerialize(this,options))return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&!1===options.beforeSubmit(a,this,options))return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push((function(){$form.resetForm()})),options.clearForm&&callbacks.push((function(){$form.clearForm(options.includeHidden)})),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push((function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)}))}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var hasFileInputs=$("input[type=file]:enabled",this).filter((function(){return""!==$(this).val()})).length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;!1!==options.iframe&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,(function(){jqxhr=fileUploadIframe(a)})):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?function(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=function(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;i<len;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",(function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)}),!1),xhr});s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){options.formData?o.data=options.formData:o.data=formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this;function fileUploadIframe(a){var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if((s=$.extend(!0,{},$.ajaxSettings,options)).context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?(n=($io=$(s.iframeTarget)).attr2("name"))?id=n:$io.attr2("name",id):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />')).css({position:"absolute",top:"-1000px",left:"-1000px"}),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},(g=s.global)&&0==$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&!1===s.beforeSend.call(s.context,xhr,s))return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;(sub=form.clk)&&(n=sub.name)&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2;function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}var csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");function doSubmit(){var t=$form.attr2("target"),a=$form.attr2("action"),et=$form.attr("enctype")||$form.attr("encoding")||"multipart/form-data";form.setAttribute("target",id),method&&!/post/i.test(method)||form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout((function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)}),s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]):extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]));s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout((function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}),15);try{form.submit()}catch(err){document.createElement("form").submit.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50;function cb(e){if(!xhr.aborted&&!callbackProcessed){if((doc=getDoc(io))||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){return{"content-type":s.dataType}[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&! --$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout((function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null}),100)}}}var toXml=$.parseXML||function(s,doc){return window.ActiveXObject?((doc=new ActiveXObject("Microsoft.XMLDOM")).async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}},$.fn.ajaxForm=function(options){if((options=options||{}).delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$((function(){$(o.s,o.c).ajaxForm(options)})),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,i,j,n,v,el,max,jmax,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get()).length&&(els=(els||[]).concat(els2)),!els||!els.length)return a;for(i=0,max=els.length;i<max;i++)if((n=(el=els[i]).name)&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if((v=$.fieldValue(el,!0))&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!=v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];(n=input.name)&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each((function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else null!=v&&a.push({name:this.name,value:v})}})),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i],v=$.fieldValue(el,successful);null==v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&-1==el.selectedIndex))return null;if("select"==tag){var index=el.selectedIndex;if(index<0)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each((function(){$("input,select,textarea",this).clearFields(includeHidden)}))},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each((function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(!0===includeHidden&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")}))},$.fn.resetForm=function(){return this.each((function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()}))},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each((function(){this.disabled=!b}))},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each((function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}}))},$.fn.ajaxSubmit.debug=!1})),define("pgui.form_collection",["class","pgui.editors","pgui.validation","pgui.modal_operation_link","pgui.autohide-message","jquery.form"],(function(Class,editors,validation,modalLink,autoHideMessage){var FormCollection=Class.extend({init:function($formsContainer,$collectionContainer,newFormUrl,callbacks){var self=this;this.forms=[],this.editorControllers=[],this.$formsContainer=$formsContainer,this.$collectionContainer=$collectionContainer,this.callbacks=$.extend({init:function(){},done:function(){},copy:function($sourceForm,content){self.copy($sourceForm,$(content))}},callbacks),$.each($formsContainer.find("form").toArray().reverse(),function(i,form){this.add($(form))}.bind(this)),this.$formsContainer.on("click",".js-save",this.submit.bind(this));var formCollection=this;this.$formsContainer.on("click",".js-form-add",(function(e){e.preventDefault(),$.get(newFormUrl,(function(response){formCollection.add($(response))}))})).on("click",".js-form-copy",(function(e){var $sourceForm=$(e.target).closest("form");$.get(newFormUrl,function(content){self.callbacks.copy($sourceForm,content)}.bind(this))}))},submit:function(e){e.preventDefault();var submitParams=$(e.target).data();this.setLoading(!0);var promises=$.map(this.forms,(function(form){return $form=$(form),$errorContainer=$form.find(".form-error-container").html(""),deferred=$.Deferred(),$form.ajaxSubmit({dataType:"JSON",beforeSubmit:function(){var result=validation.validateForm($form,$errorContainer,!1);return result.success||(appendError($errorContainer,result.message),deferred.reject($.extend({$form:$form},result))),result.success},success:function(response){if(!response.success)return appendError($errorContainer,response.message),void deferred.reject($.extend({$form:$form},response));deferred.resolve($.extend({$form:$form},response))},error:function(xhr){appendError($errorContainer,xhr.responseText),deferred.reject({$form:$form})}}),deferred.promise();var $form,$errorContainer,deferred}));$.when.apply($,$.map(promises,(function(promise){return promise.then(null,(function(){return $.Deferred().resolveWith(this,arguments)}))}))).done(function(responses){var hasErrors=(responses=Array.prototype.slice.call(arguments)).reduce((function(hasErrors,response){return!response.success||hasErrors}),!1);$.each(responses,function(i,response){hasErrors&&response.success&&this.remove(response.$form)}.bind(this)),hasErrors&&this.$formsContainer.find(".has-error").find("input,textarea,select").first().focus(),this.callbacks.done(hasErrors,responses,submitParams)&&this.setLoading(!1)}.bind(this))},add:function($form,initCallback){var self=this;0===this.$collectionContainer.has($form).length&&this.$collectionContainer.append("<hr/>").append($form),$form.pgui_validate_form(),$form.on("submit",(function(e){e.preventDefault()})),this.forms.push($form);var editorsController=editors.init($form,(function(controller){self.callbacks.init(self),_.each(controller.editors,(function(editor){!function(editor){var $insertButtons,editorName=editor.rootElement.attr("data-editor");$insertButtons=editorName.indexOf("cascading")>-1?editor.rootElement.find(".js-nested-insert"):editor.rootElement.closest(".input-group").find(".js-nested-insert").first();$insertButtons.each((function(index,item){var $insertButton=$(this);if(!$insertButton.data("insert-link")){var dataLink=modalLink.createInsertLink(FormCollection,$insertButton,null,(function(hasErrors,responses){hasErrors||editor.trigger("submit.pgui.nested-insert",$insertButton,responses[0].primaryKeys[0],responses[0].record)}));$insertButton.data("insert-link",dataLink)}}))}(editor)})),"function"==typeof initCallback&&initCallback()}));return this.editorControllers.push(editorsController),this.forms.length>1&&(this.$formsContainer.find(".js-multiple-insert-hide").hide(),this.$formsContainer.find(".js-form-remove").show()),$form.on("click",".js-form-remove",function(){this.remove($form)}.bind(this)),$form.find("input,select,textarea").filter((function(i,item){return $(item).is(":visible")&&0===$(item).closest("#form-group-fields-to-be-updated").length})).first().focus(),$form.on("change","#fields-to-be-updated",(function(e){var fieldsToBeUpdated=$(e.target).val();_.each(editorsController.editors,(function(editor,key){"undefined"!==key&&editor.setEnabled(null!==fieldsToBeUpdated&&fieldsToBeUpdated.indexOf(key)>-1)}))})).on("click","#clear-fields-to-be-updated",(function(e){$("#fields-to-be-updated").select2("val",[]).trigger("change")})),$.each($form.find(".alert"),(function(i,alert){autoHideMessage($(alert))})),$form.find(".js-hint").each((function(){$(this).popover({placement:"top",trigger:"hover",container:"body",html:!0,content:$(this).attr("data-hint")})})),$form},copy:function($sourceForm,$targetForm){return this.add($targetForm,_.bind((function(){this.copyEditorsValues($sourceForm,$targetForm)}),this))},copyEditorsValues:function($sourceForm,$targetForm){$sourceForm.find("[data-editor]").each((function(i,el){var $el=$(el),targetEditor=$targetForm.find('[data-field-name="'+$el.data("field-name")+'"]').data("editor");targetEditor&&$el.data("editor")&&targetEditor.setData($el.data("editor").getData())}))},remove:function($form){var index=$.map(this.forms,(function($f){return $f.attr("id")})).indexOf($form.attr("id"));return this.forms.splice(index,1),this.editorControllers[index].destroy(),this.editorControllers.splice(index,1),$form.prev("hr").remove(),$form.remove(),this.$collectionContainer.find("hr:first-child").remove(),1===this.forms.length&&(this.$formsContainer.find(".js-form-remove").hide(),this.$formsContainer.find(".js-multiple-insert-hide").show()),this.forms},get:function(index){return this.forms[index]},setLoading:function(isLoading){var $buttons=this.$formsContainer.find(".btn-toolbar button.btn-primary,.js-save,.js-cancel,.js-recaptcha").prop("disabled",isLoading);isLoading?$buttons.addClass("btn-loading"):$buttons.removeClass("btn-loading")},focus:function(){this.forms[0].find("input,select,textarea").first().focus()},destroy:function(){_.each(this.editorControllers,(function(editorController){editorController.destroy()})),this.forms=[],this.editorControllers=[]}});function appendError($errorContainer,message){message&&$('<div class="alert alert-danger"><button data-dismiss="alert" class="close" type="button">&times;</button>'+message+"</div>").appendTo($errorContainer)}return FormCollection})),define("pgui.selection-handler",["class","pgui.localizer","pgui.utils","libs/sprintf","pgui.form_collection","pgui.modal_operation_link","underscore","jquery.query","bootbox","jquery.popover"],(function(Class,localizer,utils,sprintf,FormCollection,modalLink){return Class.extend({init:function(selection,$container,$selectionHeader,$checkboxes,hideContainer,grid){if(this.hideContainer=hideContainer,this.$container=$container||$(".js-selection-actions-container").first(),this.$actions=$container.find(".js-action"),this.$count=$container.find(".js-count"),this.selection=selection,this.grid=grid,void 0!==$selectionHeader)var $allCheckbox=$selectionHeader.find("input[type=checkbox]");this.setCheckboxes($allCheckbox||$(),$checkboxes||$()),this.$actions.on("click",this._handleAction.bind(this)),this.selection.bind("change",this._handleChange.bind(this)),this._handleChange(this.selection.getData()),this._initSelectionFilters($selectionHeader)},setCheckboxes:function($allCheckbox,$checkboxes){this.$allCheckbox=$allCheckbox||$(),this.$checkboxes=$checkboxes||$(),this.checkboxesData=_.map(this.$checkboxes,(function(v,k){return $(v).data("value")})),this.$checkboxes.off("change").on("change",this._checkboxChangeHandler.bind(this)),this.$allCheckbox.off("change").on("change",this._allCheckboxChangeHandler.bind(this))},_checkboxChangeHandler:function(e){var $el=$(e.currentTarget);this.selection.toggle($el.data("value"),$el.prop("checked"))},_allCheckboxChangeHandler:function(e){var checked=$(e.currentTarget).prop("checked");this.$checkboxes.prop("checked",checked),_.each(this.checkboxesData,function(value){checked?this.selection.add(value):this.selection.remove(value)}.bind(this))},_handleChange:function(selectionData){var count=selectionData.length;this.hideContainer&&(this.$container.toggle(count>0),_.defer(this.$container.toggleClass.bind(this.$container),"in",count>0)),this.$count.text(count),this.$checkboxes.prop("checked",!1),_.each(selectionData,function(keys){this.$checkboxes.filter("[data-value='"+JSON.stringify(keys)+"']").prop("checked",!0)}.bind(this));var checkedCount=this.$checkboxes.filter(":checked").length;this.$allCheckbox.prop("checked",checkedCount===this.$checkboxes.length&&this.$checkboxes.length>0).prop("indeterminate",checkedCount>0&&checkedCount<this.$checkboxes.length)},_handleAction:function(e){var $el=$(e.currentTarget),type=$el.data("type"),openInNewTab="_blank"==$el.attr("target");switch(e.preventDefault(),type){case"compare":return this._compare($el.data("url"));case"compare-remove":return this._compareRemove($el.attr("href"),$el.data("value"));case"print":return this._print($el.data("url"),openInNewTab);case"export":return this._export($el.data("url"),$el.data("export-type"),openInNewTab);case"update":return this._update($el);case"delete":return this._delete($el.data("url"));case"clear":return this.selection.clear();case"select":return this._processSelection($el)}},_delete:function(url){var self=this;bootbox.confirm(localizer.getString("DeleteSelectedRecordsQuestion"),(function(confirmed){if(confirmed){utils.createLoadingModalDialog(localizer.getString("Deleting")).modal();var selectionData=self.selection.getData(),formData={operation:"delsel",recordCount:selectionData.length};_.each(selectionData,(function(keys,i){formData["rec"+i]=null,_.each(keys,(function(value,pk){formData["rec"+i+"_pk"+pk]=value})),self.selection.remove(keys)})),function(url,data){var $form=$("<form>").hide().attr("method","POST").attr("action",url);return _.each(data,(function(value,name){$form.append($('<input name="'+name+'" value="'+value+'">'))})),$form.appendTo($("body"))}(url,formData).submit()}}))},_compare:function(url){this._processSelectedRecords(url,"compare")},_compareRemove:function(url,value){this.selection.remove(value),location.href=url},_print:function(url,openInNewTab){this._processSelectedRecords(url,"print_selected",openInNewTab)},_export:function(url,exportType,openInNewTab){this._processSelectedRecords(url,sprintf.sprintf("e%s_selected",exportType),openInNewTab)},_update:function($el){var self=this;if("multiple-edit"===$el.data("modal-operation")){var handlerName=$el.data("multiple-edit-handler-name"),url=jQuery.query.load($el.data("url")).set("hname",handlerName).set("keys",this.selection.getData()).toString();$el.data("content-link",url),modalLink.processQuery(FormCollection,$el,(function($modal,hasErrors,responses,params){var $grid=$el.closest(".js-grid"),$row=$();return hasErrors||($.each(responses[0].row,(function(i,row){$row=$(row),$grid.find(".row-selection input").each((function(){if($(this).attr("data-value")===responses[0].primaryKeys[i])return $(this).closest(".pg-row").replaceWith($row),self.grid.integrateRows($row),!1}))})),$modal.modal("hide"),self.selection.clear(),self.grid.getReloadPageAfterAjaxOperation()&&location.reload()),hasErrors}))}else this._processSelectedRecords($el.data("url"),"multi_edit")},_processSelection:function($el){var condition=$el.data("condition");location.href="all"==condition?jQuery.query.load($el.data("url")).remove("keys").set("selection_filter","").toString():jQuery.query.load($el.data("url")).set("selection_filter",condition).set("keys",this.selection.getData()).toString()},_initSelectionFilters:function($selectionHeader){if(void 0!==$selectionHeader){var self=this,contentHtml=$("#selection-filters-content").html(),$selectionFiltersLink=$selectionHeader.find("a.selection-filters");if(0!=$selectionFiltersLink.length){var popover=$selectionFiltersLink.webuiPopover({trigger:"manual",backdrop:!0,placement:"auto-bottom",padding:!1,content:$(contentHtml)}).data("plugin_webuiPopover");$selectionFiltersLink.on("click",(function(e){e.preventDefault(),popover.show(),$(".webui-popover-backdrop").one("click",(function(){popover.hide()}))})),$selectionFiltersLink.on("show.webui.popover",(function(){popover.$contentElement.find("ul.dropdown-menu").show(),popover.$contentElement.find(".js-action").one("click",(function(){self._selectRecords($(this)),popover.hide()}))}))}}},_selectRecords:function($el){var self=this,url=jQuery.query.load($el.data("url")).set("hname",$el.data("handler-name")).set("filterName",$el.data("filter-name")).toString();$.getJSON(url,(function(data){self.selection.clear();for(var i=0;i<data.length;i++)self.selection.add(data[i])}))},_processSelectedRecords:function(url,operation,openInNewTab){var resultUrl=jQuery.query.load(url).set("operation",operation).set("keys",this.selection.getData()).toString();openInNewTab?window.open(resultUrl,"_blank"):location.href=resultUrl}})})),define("custom/pgui.selection-handler.ops",["../pgui.selection-handler","../pgui.localizer","underscore","jquery.query","bootbox"],(function(SelectionHandler,localizer){return SelectionHandler.extend({init:function(selection,$container,$selectionHeader,$checkboxes,hideContainer,grid){this._super(selection,$container,$selectionHeader,$checkboxes,!1,grid),this.hideContainerToggle=hideContainer,this.$containerToggle=$container.not(".js-actions-container-always-visible")},_handleChange:function(selectionData){this._super(selectionData);var count=selectionData.length;this.hideContainerToggle&&(this.$containerToggle.toggle(count>0),_.defer(this.$containerToggle.toggleClass.bind(this.$containerToggle),"in",count>0))},_handleAction:function(e){var $el=$(e.currentTarget),type=$el.data("type");if(e.preventDefault(),null==this._super(e)){var nRows=this.selection.getData().length,url=$el.data("url");switch(type){case"set-ehrenamtlich-selected":return this._op_text("setehrenamtlichsel","Ehrenamtlich | ","&quot;Ehrenamtlich&quot; (0) fÃ¼r das aktuelle Jahr bei "+nRows+' EintrÃ¤gen setzen?<small><br><br>Bitte Beschreibung und Quelle eingeben:<br>Format: Beschreibung | Quelle | URL<br>Beschreibung leer = "Ehrenamtlich"<br>Quelle oder URL leer = nichts<br>Alles leer = Abbruch</small>',url);case"set-bezahlt-selected":return this._op_text("setbezahltsel","Bezahlt | ","&quot;Bezahlt&quot; (1) fÃ¼r das aktuelle Jahr bei "+nRows+' EintrÃ¤gen setzen?<small><br><br>Bitte Beschreibung und Quelle eingeben:<br>Format: Beschreibung | Quelle | URL<br>Beschreibung leer = "Bezahlt"<br>Quelle oder URL leer = nichts<br>Alles leer = Abbruch</small>',url);case"set-zahlend-selected":return this._op_text("setzahlendsel","Bezahlendes Mitglied | ","&quot;Bezahlendes Mitglied&quot; (0) fÃ¼r das aktuelle Jahr bei "+nRows+' EintrÃ¤gen setzen?<small><br><br>Bitte Beschreibung und Quelle eingeben:<br>Format: Beschreibung | Quelle | URL<br>Beschreibung leer = "Bezahlendes Mitglied"<br>Quelle oder URL leer = nichts<br>Alles leer = Abbruch</small>',url);case"set-imratbis-selected":return this._op_date("setimratbissel","&quot;Im Rat bis&quot; bei "+nRows+" Parlamentarieren setzen?<small><br><br>Der Zugang der GÃ¤ste erlischt. Das Bis-Datum der Zutrittsberechtigten wird ebenfalls gesetzt.<br><br>Bitte &quot;Im Rat bis&quot; (TT.MM.JJJJ) eingeben (leer = heute):</small>",url);case"clear-imratbis-selected":return this._op_confirm("clearimratbissel","&quot;Im Rat bis&quot; bei "+nRows+" EintrÃ¤gen entfernen?<small><br><br>Das Bis-Datum der Zutrittsberechtigten wird ebenfalls entfernt, sofern das Datum gleich wie beim Parlamentarier ist.</small>",url);case"input-finished-selected":return this._op_confirm("finsel",nRows+" markierte EintrÃ¤ge abschliessen?",url);case"de-input-finished-selected":return this._op_confirm("definsel",'"Eingabe abgeschlossen" bei '+nRows+" EintrÃ¤gen entfernen?",url);case"controlled-selected":return this._op_confirm("consel",nRows+" markierte EintrÃ¤ge kontrolliert?",url);case"de-controlled-selected":return this._op_confirm("deconsel",'"Kontrolliert" bei '+nRows+" EintrÃ¤gen entfernen?",url);case"authorization-sent-selected":return this._op_date("sndsel","Bei "+nRows+" markierten EintrÃ¤gen eine Autorisierungsanfrage verschickt?<small><br><br>Bitte Sendedatum (TT.MM.JJJJ) eingeben (leer = heute):</small>",url);case"de-authorization-sent-selected":return this._op_confirm("desndsel",'"Autorisierungsanfrage verschickt" bei '+nRows+" EintrÃ¤gen entfernen?",url);case"authorization-reminder-sent-selected":return this._op_date("sndremindersel","Bei "+nRows+" markierten EintrÃ¤gen eine Autorisierungsreminder verschickt?<small><br><br>Bitte Sendedatum (TT.MM.JJJJ) eingeben (leer = heute):</small>",url);case"de-authorization-reminder-sent-selected":return this._op_confirm("desndremindersel",'"Autorisierungsreminder verschickt" bei '+nRows+" EintrÃ¤gen entfernen?",url);case"create-verguetungstransparenzliste":return this._op_date("create-verguetungstransparenzliste","VergÃ¼tungstransparenzliste erstellen?<small><br><br>Bitte Stichdatum (TT.MM.JJJJ) eingeben (leer = heute):</small>",url);case"copy-interessenbindungsverguetungen":return this._op_confirm("copy-interessenbindungsverguetungen","Kopiere die InteressenbindungsvergÃ¼tungen des letzten Jahres aufs aktuelle Jahr?<br>Falls fÃ¼rs aktuelle Jahr bereits InteressenbindungsvergÃ¼tungen erfasst wurden, werden diese EintrÃ¤ge beim Kopieren ignoriert. Falls fÃ¼rs letzte Jahr EintrÃ¤ge nacherfasst wurden, kann das Kopieren nochmals ausgefÃ¼hrt werden und diese EintrÃ¤ge werden fÃ¼r aktuelle Jahr Ã¼bernommen.",url);case"authorize-selected":return this._op_date("autsel",nRows+" markierte EintrÃ¤ge autorisieren?<small><br><br>Bitte Autorisierungsdatum (TT.MM.JJJJ) eingeben (leer = heute):</small>",url);case"de-authorize-selected":return this._op_confirm("deautsel","Autorisierung bei "+nRows+" EintrÃ¤gen entfernen?",url);case"release-selected":return this._op_date("relsel",nRows+" markierte EintrÃ¤ge freigeben?<small><br><br>Bitte Freigabedatum (TT.MM.JJJJ) eingeben (leer = heute):</small>",url);case"de-release-selected":return this._op_confirm("derelsel","Freigabe bei "+nRows+" EintrÃ¤gen entfernen?",url)}}},_op_date:function(op,text,url){var self=this,selectionData=self.selection.getData();bootbox.prompt(text,(function(date){null!==date&&(""===date||self.isDateValid(date)?self.operateSelectRows(op,selectionData,url,date,void 0,void 0,void 0):bootbox.alert("Bitte Datum als TT.MM.JJJJ eingeben"))}))},_op_text:function(op,val,text,url){var self=this,selectionData=self.selection.getData();bootbox.prompt({title:text,value:val,callback:function(input){if(input){var text=input.split("|"),text1=text[0].trim(),text2=text.length>1?text[1].trim():"",text3=text.length>2?text[2].trim():"";if(text3&&!/^https?:\/\//i.test(text3))return void bootbox.alert("URL nicht gÃ¼ltig: "+text3+"<br>Der URL muss mit http:// oder https:// starten.");self.operateSelectRows(op,selectionData,url,void 0,text1,text2,text3)}}})},_op_confirm:function(op,text,url){var self=this,selectionData=self.selection.getData();bootbox.confirm(text,(function(confirmed){confirmed&&self.operateSelectRows(op,selectionData,url,void 0,void 0,void 0,void 0)}))},operateSelectRows:function(operation,selectionData,url,date,text1,text2,text3){var self=this,formData={operation:operation,recordCount:selectionData.length,date:date,text1:text1,text2:text2,text3:text3};_.each(selectionData,(function(keys,i){formData["rec"+i]=null,_.each(keys,(function(value,pk){formData["rec"+i+"_pk"+pk]=value})),self.selection.remove(keys)})),this.buildForm(url,formData).submit()},buildForm:function(url,data){var $form=$("<form>").hide().attr("method","POST").attr("action",url);return _.each(data,(function(value,name){$form.append($('<input name="'+name+'" value="'+value+'">'))})),$form.appendTo($("body"))},isDateValid:function(date){return null!==date.match(/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(20)\d\d$/)}})})),define("pgui.cell-edit",["pgui.form_collection","pgui.shortcuts","jquery.popover"],(function(FormCollection,shortcuts){function getPlugin($el){return $el.data("plugin_webuiPopover")}function destroyPlugin(plugin,$el,options){plugin.hide(!0),plugin.destroy(),$el.webuiPopover(options)}return function($cell,successCallback){var url=$cell.data("edit-url");if(url){var options={cache:!1,type:"async",url:url,placement:"vertical",style:"cell-edit",backdrop:!0,trigger:"manual"},$button=$('<span class="icon-edit pgui-cell-edit-button"></span>'),escapeHanler=function(e){27===e.keyCode&&destroyPlugin(getPlugin($cell),$cell,options)};$button.on("click",(function(){getPlugin($cell).show()})),$cell.webuiPopover(options),$cell.on("shown.webui.popover",(function(){var plugin=getPlugin($cell),$container=plugin.$target.find(".webui-popover-content");if(0!==$container.find("form").length){new FormCollection($container,$container,null,{init:function(){!function($el){var plugin=$el.data("plugin_webuiPopover"),elPos=plugin.getElementPosition(),info=plugin.getTargetPositin(elPos,plugin.getPlacement(elPos),plugin.$target[0].offsetWidth,plugin.$target[0].offsetHeight);plugin.$target.css(info.position),info.arrowOffset||(info.arrowOffset={left:"50%"}),plugin.$target.find(".webui-arrow").css(info.arrowOffset)}($cell)},done:function(hasErrors,responses){return hasErrors||(destroyPlugin(plugin,$cell,options),"function"==typeof successCallback&&successCallback(responses[0])),!0}});$container.data("forms-ready",!0),$([$(".webui-popover-backdrop").get(0),$container.find(".js-cancel").get(0)]).one("click",(function(){destroyPlugin(plugin,$cell,options)})),$(document).on("keyup",escapeHanler),plugin.$target.find("input,select,textarea").on("keyup",escapeHanler),shortcuts.push(["quick_edit"])}})).on("hidden.webui.popover",(function(){var plugin=getPlugin($cell);plugin&&plugin.hide&&destroyPlugin(plugin,$cell,options),$(document).off("keyup",escapeHanler),shortcuts.pop()})).on("mouseenter",(function(){$cell.append($button)})).on("mouseleave",(function(){$button.detach()}))}}})),define("pgui.modal_delete_link",["pgui.localizer","pgui.utils","bootbox"],(function(localizer,utils){return function($container,grid){$container.off("click","a[data-modal-operation=delete]").on("click","a[data-modal-operation=delete]",(function(e){e.preventDefault();var $button=$(this);bootbox.confirm(localizer.getString("DeleteRecordQuestion"),(function(confirmed){if(confirmed){var $modal=utils.createLoadingModalDialog(localizer.getString("Deleting")).modal();$modal.one("hidden.bs.modal",(function(){$modal.remove()}));var url=$button.data("content-link");$.ajax({url:url,dataType:"json",success:function(response){response.success?(grid.removeRow($button.closest(".pg-row")),grid.showMessage(response.message,response.messageDisplayTime),grid.getReloadPageAfterAjaxOperation()&&location.reload()):utils.showErrorMessage(response.message)},complete:function(){$modal.modal("hide")}})}}))}))}})),function($){var mfp,_prevStatus,_body,_document,_prevContentType,_wrapClasses,_currPopupType,MagnificPopup=function(){},_isJQ=!!window.jQuery,_window=$(window),_mfpOn=function(name,f){mfp.ev.on("mfp"+name+".mfp",f)},_getEl=function(className,appendTo,html,raw){var el=document.createElement("div");return el.className="mfp-"+className,html&&(el.innerHTML=html),raw?appendTo&&appendTo.appendChild(el):(el=$(el),appendTo&&el.appendTo(appendTo)),el},_mfpTrigger=function(e,data){mfp.ev.triggerHandler("mfp"+e,data),mfp.st.callbacks&&(e=e.charAt(0).toLowerCase()+e.slice(1),mfp.st.callbacks[e]&&mfp.st.callbacks[e].apply(mfp,$.isArray(data)?data:[data]))},_getCloseBtn=function(type){return type===_currPopupType&&mfp.currTemplate.closeBtn||(mfp.currTemplate.closeBtn=$(mfp.st.closeMarkup.replace("%title%",mfp.st.tClose)),_currPopupType=type),mfp.currTemplate.closeBtn},_checkInstance=function(){$.magnificPopup.instance||((mfp=new MagnificPopup).init(),$.magnificPopup.instance=mfp)};MagnificPopup.prototype={constructor:MagnificPopup,init:function(){var appVersion=navigator.appVersion;mfp.isIE7=-1!==appVersion.indexOf("MSIE 7."),mfp.isIE8=-1!==appVersion.indexOf("MSIE 8."),mfp.isLowIE=mfp.isIE7||mfp.isIE8,mfp.isAndroid=/android/gi.test(appVersion),mfp.isIOS=/iphone|ipad|ipod/gi.test(appVersion),mfp.supportsTransition=function(){var s=document.createElement("p").style,v=["ms","O","Moz","Webkit"];if(void 0!==s.transition)return!0;for(;v.length;)if(v.pop()+"Transition"in s)return!0;return!1}(),mfp.probablyMobile=mfp.isAndroid||mfp.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),_body=$(document.body),_document=$(document),mfp.popupsCache={}},open:function(data){var i;if(!1===data.isObj){mfp.items=data.items.toArray(),mfp.index=0;var item,items=data.items;for(i=0;i<items.length;i++)if((item=items[i]).parsed&&(item=item.el[0]),item===data.el[0]){mfp.index=i;break}}else mfp.items=$.isArray(data.items)?data.items:[data.items],mfp.index=data.index||0;if(!mfp.isOpen){mfp.types=[],_wrapClasses="",data.mainEl&&data.mainEl.length?mfp.ev=data.mainEl.eq(0):mfp.ev=_document,data.key?(mfp.popupsCache[data.key]||(mfp.popupsCache[data.key]={}),mfp.currTemplate=mfp.popupsCache[data.key]):mfp.currTemplate={},mfp.st=$.extend(!0,{},$.magnificPopup.defaults,data),mfp.fixedContentPos="auto"===mfp.st.fixedContentPos?!mfp.probablyMobile:mfp.st.fixedContentPos,mfp.st.modal&&(mfp.st.closeOnContentClick=!1,mfp.st.closeOnBgClick=!1,mfp.st.showCloseBtn=!1,mfp.st.enableEscapeKey=!1),mfp.bgOverlay||(mfp.bgOverlay=_getEl("bg").on("click.mfp",(function(){mfp.close()})),mfp.wrap=_getEl("wrap").attr("tabindex",-1).on("click.mfp",(function(e){mfp._checkIfClose(e.target)&&mfp.close()})),mfp.container=_getEl("container",mfp.wrap)),mfp.contentContainer=_getEl("content"),mfp.st.preloader&&(mfp.preloader=_getEl("preloader",mfp.container,mfp.st.tLoading));var modules=$.magnificPopup.modules;for(i=0;i<modules.length;i++){var n=modules[i];n=n.charAt(0).toUpperCase()+n.slice(1),mfp["init"+n].call(mfp)}_mfpTrigger("BeforeOpen"),mfp.st.showCloseBtn&&(mfp.st.closeBtnInside?(_mfpOn("MarkupParse",(function(e,template,values,item){values.close_replaceWith=_getCloseBtn(item.type)})),_wrapClasses+=" mfp-close-btn-in"):mfp.wrap.append(_getCloseBtn())),mfp.st.alignTop&&(_wrapClasses+=" mfp-align-top"),mfp.fixedContentPos?mfp.wrap.css({overflow:mfp.st.overflowY,overflowX:"hidden",overflowY:mfp.st.overflowY}):mfp.wrap.css({top:_window.scrollTop(),position:"absolute"}),(!1===mfp.st.fixedBgPos||"auto"===mfp.st.fixedBgPos&&!mfp.fixedContentPos)&&mfp.bgOverlay.css({height:_document.height(),position:"absolute"}),mfp.st.enableEscapeKey&&_document.on("keyup.mfp",(function(e){27===e.keyCode&&mfp.close()})),_window.on("resize.mfp",(function(){mfp.updateSize()})),mfp.st.closeOnContentClick||(_wrapClasses+=" mfp-auto-cursor"),_wrapClasses&&mfp.wrap.addClass(_wrapClasses);var windowHeight=mfp.wH=_window.height(),windowStyles={};if(mfp.fixedContentPos&&mfp._hasScrollBar(windowHeight)){var s=mfp._getScrollbarSize();s&&(windowStyles.marginRight=s)}mfp.fixedContentPos&&(mfp.isIE7?$("body, html").css("overflow","hidden"):windowStyles.overflow="hidden");var classesToadd=mfp.st.mainClass;return mfp.isIE7&&(classesToadd+=" mfp-ie7"),classesToadd&&mfp._addClassToMFP(classesToadd),mfp.updateItemHTML(),_mfpTrigger("BuildControls"),$("html").css(windowStyles),mfp.bgOverlay.add(mfp.wrap).prependTo(document.body),mfp._lastFocusedEl=document.activeElement,setTimeout((function(){mfp.content?(mfp._addClassToMFP("mfp-ready"),mfp._setFocus()):mfp.bgOverlay.addClass("mfp-ready"),_document.on("focusin.mfp",mfp._onFocusIn)}),16),mfp.isOpen=!0,mfp.updateSize(windowHeight),_mfpTrigger("Open"),data}mfp.updateItemHTML()},close:function(){mfp.isOpen&&(_mfpTrigger("BeforeClose"),mfp.isOpen=!1,mfp.st.removalDelay&&!mfp.isLowIE&&mfp.supportsTransition?(mfp._addClassToMFP("mfp-removing"),setTimeout((function(){mfp._close()}),mfp.st.removalDelay)):mfp._close())},_close:function(){_mfpTrigger("Close");var classesToRemove="mfp-removing mfp-ready ";if(mfp.bgOverlay.detach(),mfp.wrap.detach(),mfp.container.empty(),mfp.st.mainClass&&(classesToRemove+=mfp.st.mainClass+" "),mfp._removeClassFromMFP(classesToRemove),mfp.fixedContentPos){var windowStyles={marginRight:""};mfp.isIE7?$("body, html").css("overflow",""):windowStyles.overflow="",$("html").css(windowStyles)}_document.off("keyup.mfp focusin.mfp"),mfp.ev.off(".mfp"),mfp.wrap.attr("class","mfp-wrap").removeAttr("style"),mfp.bgOverlay.attr("class","mfp-bg"),mfp.container.attr("class","mfp-container"),!mfp.st.showCloseBtn||mfp.st.closeBtnInside&&!0!==mfp.currTemplate[mfp.currItem.type]||mfp.currTemplate.closeBtn&&mfp.currTemplate.closeBtn.detach(),mfp._lastFocusedEl&&$(mfp._lastFocusedEl).focus(),mfp.currItem=null,mfp.content=null,mfp.currTemplate=null,mfp.prevHeight=0,_mfpTrigger("AfterClose")},updateSize:function(winHeight){if(mfp.isIOS){var zoomLevel=document.documentElement.clientWidth/window.innerWidth,height=window.innerHeight*zoomLevel;mfp.wrap.css("height",height),mfp.wH=height}else mfp.wH=winHeight||_window.height();mfp.fixedContentPos||mfp.wrap.css("height",mfp.wH),_mfpTrigger("Resize")},updateItemHTML:function(){var item=mfp.items[mfp.index];mfp.contentContainer.detach(),mfp.content&&mfp.content.detach(),item.parsed||(item=mfp.parseEl(mfp.index));var type=item.type;if(_mfpTrigger("BeforeChange",[mfp.currItem?mfp.currItem.type:"",type]),mfp.currItem=item,!mfp.currTemplate[type]){var markup=!!mfp.st[type]&&mfp.st[type].markup;_mfpTrigger("FirstMarkupParse",markup),mfp.currTemplate[type]=!markup||$(markup)}_prevContentType&&_prevContentType!==item.type&&mfp.container.removeClass("mfp-"+_prevContentType+"-holder");var newContent=mfp["get"+type.charAt(0).toUpperCase()+type.slice(1)](item,mfp.currTemplate[type]);mfp.appendContent(newContent,type),item.preloaded=!0,_mfpTrigger("Change",item),_prevContentType=item.type,mfp.container.prepend(mfp.contentContainer),_mfpTrigger("AfterChange")},appendContent:function(newContent,type){mfp.content=newContent,newContent?mfp.st.showCloseBtn&&mfp.st.closeBtnInside&&!0===mfp.currTemplate[type]?mfp.content.find(".mfp-close").length||mfp.content.append(_getCloseBtn()):mfp.content=newContent:mfp.content="",_mfpTrigger("BeforeAppend"),mfp.container.addClass("mfp-"+type+"-holder"),mfp.contentContainer.append(mfp.content)},parseEl:function(index){var item=mfp.items[index],type=item.type;if((item=item.tagName?{el:$(item)}:{data:item,src:item.src}).el){for(var types=mfp.types,i=0;i<types.length;i++)if(item.el.hasClass("mfp-"+types[i])){type=types[i];break}item.src=item.el.attr("data-mfp-src"),item.src||(item.src=item.el.attr("href"))}return item.type=type||mfp.st.type||"inline",item.index=index,item.parsed=!0,mfp.items[index]=item,_mfpTrigger("ElementParse",item),mfp.items[index]},addGroup:function(el,options){var eHandler=function(e){e.mfpEl=this,mfp._openClick(e,el,options)};options||(options={});var eName="click.magnificPopup";options.mainEl=el,options.items?(options.isObj=!0,el.off(eName).on(eName,eHandler)):(options.isObj=!1,options.delegate?el.off(eName).on(eName,options.delegate,eHandler):(options.items=el,el.off(eName).on(eName,eHandler)))},_openClick:function(e,el,options){if((void 0!==options.midClick?options.midClick:$.magnificPopup.defaults.midClick)||2!==e.which&&!e.ctrlKey&&!e.metaKey){var disableOn=void 0!==options.disableOn?options.disableOn:$.magnificPopup.defaults.disableOn;if(disableOn)if($.isFunction(disableOn)){if(!disableOn.call(mfp))return!0}else if(_window.width()<disableOn)return!0;e.type&&(e.preventDefault(),mfp.isOpen&&e.stopPropagation()),options.el=$(e.mfpEl),options.delegate&&(options.items=el.find(options.delegate)),mfp.open(options)}},updateStatus:function(status,text){if(mfp.preloader){_prevStatus!==status&&mfp.container.removeClass("mfp-s-"+_prevStatus),text||"loading"!==status||(text=mfp.st.tLoading);var data={status:status,text:text};_mfpTrigger("UpdateStatus",data),status=data.status,text=data.text,mfp.preloader.html(text),mfp.preloader.find("a").on("click",(function(e){e.stopImmediatePropagation()})),mfp.container.addClass("mfp-s-"+status),_prevStatus=status}},_checkIfClose:function(target){if(!$(target).hasClass("mfp-prevent-close")){var closeOnContent=mfp.st.closeOnContentClick,closeOnBg=mfp.st.closeOnBgClick;if(closeOnContent&&closeOnBg)return!0;if(!mfp.content||$(target).hasClass("mfp-close")||mfp.preloader&&target===mfp.preloader[0])return!0;if(target===mfp.content[0]||$.contains(mfp.content[0],target)){if(closeOnContent)return!0}else if(closeOnBg&&$.contains(document,target))return!0;return!1}},_addClassToMFP:function(cName){mfp.bgOverlay.addClass(cName),mfp.wrap.addClass(cName)},_removeClassFromMFP:function(cName){this.bgOverlay.removeClass(cName),mfp.wrap.removeClass(cName)},_hasScrollBar:function(winHeight){return(mfp.isIE7?_document.height():document.body.scrollHeight)>(winHeight||_window.height())},_setFocus:function(){(mfp.st.focus?mfp.content.find(mfp.st.focus).eq(0):mfp.wrap).focus()},_onFocusIn:function(e){if(e.target!==mfp.wrap[0]&&!$.contains(mfp.wrap[0],e.target))return mfp._setFocus(),!1},_parseMarkup:function(template,values,item){var arr;item.data&&(values=$.extend(item.data,values)),_mfpTrigger("MarkupParse",[template,values,item]),$.each(values,(function(key,value){if(void 0===value||!1===value)return!0;if((arr=key.split("_")).length>1){var el=template.find(".mfp-"+arr[0]);if(el.length>0){var attr=arr[1];"replaceWith"===attr?el[0]!==value[0]&&el.replaceWith(value):"img"===attr?el.is("img")?el.attr("src",value):el.replaceWith('<img src="'+value+'" class="'+el.attr("class")+'" />'):el.attr(arr[1],value)}}else template.find(".mfp-"+key).html(value)}))},_getScrollbarSize:function(){if(void 0===mfp.scrollbarSize){var scrollDiv=document.createElement("div");scrollDiv.id="mfp-sbm",scrollDiv.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(scrollDiv),mfp.scrollbarSize=scrollDiv.offsetWidth-scrollDiv.clientWidth,document.body.removeChild(scrollDiv)}return mfp.scrollbarSize}},$.magnificPopup={instance:null,proto:MagnificPopup.prototype,modules:[],open:function(options,index){return _checkInstance(),(options=options?$.extend(!0,{},options):{}).isObj=!0,options.index=index||0,this.instance.open(options)},close:function(){return $.magnificPopup.instance&&$.magnificPopup.instance.close()},registerModule:function(name,module){module.options&&($.magnificPopup.defaults[name]=module.options),$.extend(this.proto,module.proto),this.modules.push(name)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&times;</button>',tClose:"Close (Esc)",tLoading:"Loading..."}},$.fn.magnificPopup=function(options){_checkInstance();var jqEl=$(this);if("string"==typeof options)if("open"===options){var items,itemOpts=_isJQ?jqEl.data("magnificPopup"):jqEl[0].magnificPopup,index=parseInt(arguments[1],10)||0;itemOpts.items?items=itemOpts.items[index]:(items=jqEl,itemOpts.delegate&&(items=items.find(itemOpts.delegate)),items=items.eq(index)),mfp._openClick({mfpEl:items},jqEl,itemOpts)}else mfp.isOpen&&mfp[options].apply(mfp,Array.prototype.slice.call(arguments,1));else options=$.extend(!0,{},options),_isJQ?jqEl.data("magnificPopup",options):jqEl[0].magnificPopup=options,mfp.addGroup(jqEl,options);return jqEl};var _hiddenClass,_inlinePlaceholder,_lastInlineElement,_putInlineElementsBack=function(){_lastInlineElement&&(_inlinePlaceholder.after(_lastInlineElement.addClass(_hiddenClass)).detach(),_lastInlineElement=null)};$.magnificPopup.registerModule("inline",{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){mfp.types.push("inline"),_mfpOn("Close.inline",(function(){_putInlineElementsBack()}))},getInline:function(item,template){if(_putInlineElementsBack(),item.src){var inlineSt=mfp.st.inline,el=$(item.src);if(el.length){var parent=el[0].parentNode;parent&&parent.tagName&&(_inlinePlaceholder||(_hiddenClass=inlineSt.hiddenClass,_inlinePlaceholder=_getEl(_hiddenClass),_hiddenClass="mfp-"+_hiddenClass),_lastInlineElement=el.after(_inlinePlaceholder).detach().removeClass(_hiddenClass)),mfp.updateStatus("ready")}else mfp.updateStatus("error",inlineSt.tNotFound),el=$("<div>");return item.inlineElement=el,el}return mfp.updateStatus("ready"),mfp._parseMarkup(template,{},item),template}}});var _ajaxCur,_removeAjaxCursor=function(){_ajaxCur&&_body.removeClass(_ajaxCur)},_destroyAjaxRequest=function(){_removeAjaxCursor(),mfp.req&&mfp.req.abort()};$.magnificPopup.registerModule("ajax",{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){mfp.types.push("ajax"),_ajaxCur=mfp.st.ajax.cursor,_mfpOn("Close.ajax",_destroyAjaxRequest),_mfpOn("BeforeChange.ajax",_destroyAjaxRequest)},getAjax:function(item){_ajaxCur&&_body.addClass(_ajaxCur),mfp.updateStatus("loading");var opts=$.extend({url:item.src,success:function(data,textStatus,jqXHR){var temp={data:data,xhr:jqXHR};_mfpTrigger("ParseAjax",temp),mfp.appendContent($(temp.data),"ajax"),item.finished=!0,_removeAjaxCursor(),mfp._setFocus(),setTimeout((function(){mfp.wrap.addClass("mfp-ready")}),16),mfp.updateStatus("ready"),_mfpTrigger("AjaxContentAdded")},error:function(){_removeAjaxCursor(),item.finished=item.loadError=!0,mfp.updateStatus("error",mfp.st.ajax.tError.replace("%url%",item.src))}},mfp.st.ajax.settings);return mfp.req=$.ajax(opts),""}}});var _imgInterval,_getTitle=function(item){if(item.data&&void 0!==item.data.title)return item.data.title;var src=mfp.st.image.titleSrc;if(src){if($.isFunction(src))return src.call(mfp,item);if(item.el)return item.el.attr(src)||""}return""};$.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var imgSt=mfp.st.image,ns=".image";mfp.types.push("image"),_mfpOn("Open"+ns,(function(){"image"===mfp.currItem.type&&imgSt.cursor&&_body.addClass(imgSt.cursor)})),_mfpOn("Close"+ns,(function(){imgSt.cursor&&_body.removeClass(imgSt.cursor),_window.off("resize.mfp")})),_mfpOn("Resize"+ns,mfp.resizeImage),mfp.isLowIE&&_mfpOn("AfterChange",mfp.resizeImage)},resizeImage:function(){var item=mfp.currItem;if(item&&item.img&&mfp.st.image.verticalFit){var decr=0;mfp.isLowIE&&(decr=parseInt(item.img.css("padding-top"),10)+parseInt(item.img.css("padding-bottom"),10)),item.img.css("max-height",mfp.wH-decr)}},_onImageHasSize:function(item){item.img&&(item.hasSize=!0,_imgInterval&&clearInterval(_imgInterval),item.isCheckingImgSize=!1,_mfpTrigger("ImageHasSize",item),item.imgHidden&&(mfp.content&&mfp.content.removeClass("mfp-loading"),item.imgHidden=!1))},findImageSize:function(item){var counter=0,img=item.img[0],mfpSetInterval=function(delay){_imgInterval&&clearInterval(_imgInterval),_imgInterval=setInterval((function(){img.naturalWidth>0?mfp._onImageHasSize(item):(counter>200&&clearInterval(_imgInterval),3===++counter?mfpSetInterval(10):40===counter?mfpSetInterval(50):100===counter&&mfpSetInterval(500))}),delay)};mfpSetInterval(1)},getImage:function(item,template){var guard=0,onLoadComplete=function(){item&&(item.img[0].complete?(item.img.off(".mfploader"),item===mfp.currItem&&(mfp._onImageHasSize(item),mfp.updateStatus("ready")),item.hasSize=!0,item.loaded=!0,_mfpTrigger("ImageLoadComplete")):++guard<200?setTimeout(onLoadComplete,100):onLoadError())},onLoadError=function(){item&&(item.img.off(".mfploader"),item===mfp.currItem&&(mfp._onImageHasSize(item),mfp.updateStatus("error",imgSt.tError.replace("%url%",item.src))),item.hasSize=!0,item.loaded=!0,item.loadError=!0)},imgSt=mfp.st.image,el=template.find(".mfp-img");if(el.length){var img=document.createElement("img");img.className="mfp-img",item.img=$(img).on("load.mfploader",onLoadComplete).on("error.mfploader",onLoadError),img.src=item.src,el.is("img")&&(item.img=item.img.clone()),item.img[0].naturalWidth>0&&(item.hasSize=!0)}return mfp._parseMarkup(template,{title:_getTitle(item),img_replaceWith:item.img},item),mfp.resizeImage(),item.hasSize?(_imgInterval&&clearInterval(_imgInterval),item.loadError?(template.addClass("mfp-loading"),mfp.updateStatus("error",imgSt.tError.replace("%url%",item.src))):(template.removeClass("mfp-loading"),mfp.updateStatus("ready")),template):(mfp.updateStatus("loading"),item.loading=!0,item.hasSize||(item.imgHidden=!0,template.addClass("mfp-loading"),mfp.findImageSize(item)),template)}}});var hasMozTransform;$.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(element){return element.is("img")?element:element.find("img")}},proto:{initZoom:function(){var image,zoomSt=mfp.st.zoom,ns=".zoom";if(zoomSt.enabled&&mfp.supportsTransition){var openTimeout,animatedImg,duration=zoomSt.duration,getElToAnimate=function(image){var newImg=image.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),transition="all "+zoomSt.duration/1e3+"s "+zoomSt.easing,cssObj={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},t="transition";return cssObj["-webkit-"+t]=cssObj["-moz-"+t]=cssObj["-o-"+t]=cssObj[t]=transition,newImg.css(cssObj),newImg},showMainContent=function(){mfp.content.css("visibility","visible")};_mfpOn("BuildControls"+ns,(function(){if(mfp._allowZoom()){if(clearTimeout(openTimeout),mfp.content.css("visibility","hidden"),!(image=mfp._getItemToZoom()))return void showMainContent();(animatedImg=getElToAnimate(image)).css(mfp._getOffset()),mfp.wrap.append(animatedImg),openTimeout=setTimeout((function(){animatedImg.css(mfp._getOffset(!0)),openTimeout=setTimeout((function(){showMainContent(),setTimeout((function(){animatedImg.remove(),image=animatedImg=null,_mfpTrigger("ZoomAnimationEnded")}),16)}),duration)}),16)}})),_mfpOn("BeforeClose"+ns,(function(){if(mfp._allowZoom()){if(clearTimeout(openTimeout),mfp.st.removalDelay=duration,!image){if(!(image=mfp._getItemToZoom()))return;animatedImg=getElToAnimate(image)}animatedImg.css(mfp._getOffset(!0)),mfp.wrap.append(animatedImg),mfp.content.css("visibility","hidden"),setTimeout((function(){animatedImg.css(mfp._getOffset())}),16)}})),_mfpOn("Close"+ns,(function(){mfp._allowZoom()&&(showMainContent(),animatedImg&&animatedImg.remove(),image=null)}))}},_allowZoom:function(){return"image"===mfp.currItem.type},_getItemToZoom:function(){return!!mfp.currItem.hasSize&&mfp.currItem.img},_getOffset:function(isLarge){var el,offset=(el=isLarge?mfp.currItem.img:mfp.st.zoom.opener(mfp.currItem.el||mfp.currItem)).offset(),paddingTop=parseInt(el.css("padding-top"),10),paddingBottom=parseInt(el.css("padding-bottom"),10);offset.top-=$(window).scrollTop()-paddingTop;var obj={width:el.width(),height:(_isJQ?el.innerHeight():el[0].offsetHeight)-paddingBottom-paddingTop};return void 0===hasMozTransform&&(hasMozTransform=void 0!==document.createElement("p").style.MozTransform),hasMozTransform?obj["-moz-transform"]=obj.transform="translate("+offset.left+"px,"+offset.top+"px)":(obj.left=offset.left,obj.top=offset.top),obj}}});var _fixIframeBugs=function(isShowing){if(mfp.currTemplate.iframe){var el=mfp.currTemplate.iframe.find("iframe");el.length&&(isShowing||(el[0].src="//about:blank"),mfp.isIE8&&el.css("display",isShowing?"block":"none"))}};$.magnificPopup.registerModule("iframe",{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){mfp.types.push("iframe"),_mfpOn("BeforeChange",(function(e,prevType,newType){prevType!==newType&&("iframe"===prevType?_fixIframeBugs():"iframe"===newType&&_fixIframeBugs(!0))})),_mfpOn("Close.iframe",(function(){_fixIframeBugs()}))},getIframe:function(item,template){var embedSrc=item.src,iframeSt=mfp.st.iframe;$.each(iframeSt.patterns,(function(){if(embedSrc.indexOf(this.index)>-1)return this.id&&(embedSrc="string"==typeof this.id?embedSrc.substr(embedSrc.lastIndexOf(this.id)+this.id.length,embedSrc.length):this.id.call(this,embedSrc)),embedSrc=this.src.replace("%id%",embedSrc),!1}));var dataObj={};return iframeSt.srcAction&&(dataObj[iframeSt.srcAction]=embedSrc),mfp._parseMarkup(template,dataObj,item),mfp.updateStatus("ready"),template}}});var _getLoopedId=function(index){var numSlides=mfp.items.length;return index>numSlides-1?index-numSlides:index<0?numSlides+index:index},_replaceCurrTotal=function(text,curr,total){return text.replace(/%curr%/gi,curr+1).replace(/%total%/gi,total)};$.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var gSt=mfp.st.gallery,ns=".mfp-gallery",supportsFastClick=Boolean($.fn.mfpFastClick);if(mfp.direction=!0,!gSt||!gSt.enabled)return!1;_wrapClasses+=" mfp-gallery",_mfpOn("Open"+ns,(function(){gSt.navigateByImgClick&&mfp.wrap.on("click"+ns,".mfp-img",(function(){if(mfp.items.length>1)return mfp.next(),!1})),_document.on("keydown"+ns,(function(e){37===e.keyCode?mfp.prev():39===e.keyCode&&mfp.next()}))})),_mfpOn("UpdateStatus"+ns,(function(e,data){data.text&&(data.text=_replaceCurrTotal(data.text,mfp.currItem.index,mfp.items.length))})),_mfpOn("MarkupParse"+ns,(function(e,element,values,item){var l=mfp.items.length;values.counter=l>1?_replaceCurrTotal(gSt.tCounter,item.index,l):""})),_mfpOn("BuildControls"+ns,(function(){if(mfp.items.length>1&&gSt.arrows&&!mfp.arrowLeft){var markup=gSt.arrowMarkup,arrowLeft=mfp.arrowLeft=$(markup.replace(/%title%/gi,gSt.tPrev).replace(/%dir%/gi,"left")).addClass("mfp-prevent-close"),arrowRight=mfp.arrowRight=$(markup.replace(/%title%/gi,gSt.tNext).replace(/%dir%/gi,"right")).addClass("mfp-prevent-close"),eName=supportsFastClick?"mfpFastClick":"click";arrowLeft[eName]((function(){mfp.prev()})),arrowRight[eName]((function(){mfp.next()})),mfp.isIE7&&(_getEl("b",arrowLeft[0],!1,!0),_getEl("a",arrowLeft[0],!1,!0),_getEl("b",arrowRight[0],!1,!0),_getEl("a",arrowRight[0],!1,!0)),mfp.container.append(arrowLeft.add(arrowRight))}})),_mfpOn("Change"+ns,(function(){mfp._preloadTimeout&&clearTimeout(mfp._preloadTimeout),mfp._preloadTimeout=setTimeout((function(){mfp.preloadNearbyImages(),mfp._preloadTimeout=null}),16)})),_mfpOn("Close"+ns,(function(){_document.off(ns),mfp.wrap.off("click"+ns),mfp.arrowLeft&&supportsFastClick&&mfp.arrowLeft.add(mfp.arrowRight).destroyMfpFastClick(),mfp.arrowRight=mfp.arrowLeft=null}))},next:function(){mfp.direction=!0,mfp.index=_getLoopedId(mfp.index+1),mfp.updateItemHTML()},prev:function(){mfp.direction=!1,mfp.index=_getLoopedId(mfp.index-1),mfp.updateItemHTML()},goTo:function(newIndex){mfp.direction=newIndex>=mfp.index,mfp.index=newIndex,mfp.updateItemHTML()},preloadNearbyImages:function(){var i,p=mfp.st.gallery.preload,preloadBefore=Math.min(p[0],mfp.items.length),preloadAfter=Math.min(p[1],mfp.items.length);for(i=1;i<=(mfp.direction?preloadAfter:preloadBefore);i++)mfp._preloadItem(mfp.index+i);for(i=1;i<=(mfp.direction?preloadBefore:preloadAfter);i++)mfp._preloadItem(mfp.index-i)},_preloadItem:function(index){if(index=_getLoopedId(index),!mfp.items[index].preloaded){var item=mfp.items[index];item.parsed||(item=mfp.parseEl(index)),_mfpTrigger("LazyLoad",item),"image"===item.type&&(item.img=$('<img class="mfp-img" />').on("load.mfploader",(function(){item.hasSize=!0})).on("error.mfploader",(function(){item.hasSize=!0,item.loadError=!0,_mfpTrigger("LazyLoadError",item)})).attr("src",item.src)),item.preloaded=!0}}}});var supportsTouch,unbindTouchMove,ns;$.magnificPopup.registerModule("retina",{options:{replaceSrc:function(item){return item.src.replace(/\.\w+$/,(function(m){return"@2x"+m}))},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var st=mfp.st.retina,ratio=st.ratio;(ratio=isNaN(ratio)?ratio():ratio)>1&&(_mfpOn("ImageHasSize.retina",(function(e,item){item.img.css({"max-width":item.img[0].naturalWidth/ratio,width:"100%"})})),_mfpOn("ElementParse.retina",(function(e,item){item.src=st.replaceSrc(item,ratio)})))}}}}),supportsTouch="ontouchstart"in window,unbindTouchMove=function(){_window.off("touchmove"+ns+" touchend"+ns)},ns=".mfpFastClick",$.fn.mfpFastClick=function(callback){return $(this).each((function(){var lock,timeout,startX,startY,pointerMoved,point,numPointers,elem=$(this);supportsTouch&&elem.on("touchstart"+ns,(function(e){pointerMoved=!1,numPointers=1,point=e.originalEvent?e.originalEvent.touches[0]:e.touches[0],startX=point.clientX,startY=point.clientY,_window.on("touchmove"+ns,(function(e){point=e.originalEvent?e.originalEvent.touches:e.touches,numPointers=point.length,point=point[0],(Math.abs(point.clientX-startX)>10||Math.abs(point.clientY-startY)>10)&&(pointerMoved=!0,unbindTouchMove())})).on("touchend"+ns,(function(e){unbindTouchMove(),pointerMoved||numPointers>1||(lock=!0,e.preventDefault(),clearTimeout(timeout),timeout=setTimeout((function(){lock=!1}),1e3),callback())}))})),elem.on("click"+ns,(function(){lock||callback()}))}))},$.fn.destroyMfpFastClick=function(){$(this).off("touchstart"+ns+" click"+ns),supportsTouch&&_window.off("touchmove"+ns+" touchend"+ns)},_checkInstance()}(window.jQuery||window.Zepto),define("jquery.magnific-popup",(function(){})),define("pgui.image_popup",["underscore","jquery.magnific-popup"],(function(_){return function($container){_.chain($container.find("a.gallery-item")).reduce((function(acc,el){var columnName=$(el).data("name");return-1===acc.indexOf(columnName)&&acc.push(columnName),acc}),[]).each((function(columnName){$container.find('a.gallery-item[data-name="'+columnName+'"]').magnificPopup({type:"image",gallery:{enabled:!0,preload:[0,1]},image:{titleSrc:function(item){return item.el.attr("title")}}})})),function($container){$container.find(".linked-images-retriever").on("click",(function(e){e.preventDefault();var $currentLink=$(this),$currentLinkParent=$currentLink.parent();if($currentLink.hasClass("retrieved"))$currentLinkParent.find("a.gallery-item").first().click();else{var url=$currentLink.data("url");$.get(url,(function(content){$currentLinkParent.append(content),$currentLinkParent.find("a.gallery-item").magnificPopup({type:"image",gallery:{enabled:!0,preload:[0,1]},image:{titleSrc:function(item){return item.el.attr("title")}}}),$currentLink.addClass("retrieved"),$currentLinkParent.find("a.gallery-item").first().click()}))}}))}($container)}})),define("pgui.toggle",["pgui.utils","bootstrap.toggle"],(function(utils){return function($container,$grid){$container.find(".pgui-toggle-checkbox").each((function(i,el){var $el=$(el),toggleOptions={on:$el.data("toggle-on-caption"),off:$el.data("toggle-off-caption"),size:$el.data("toggle-size"),onstyle:$el.data("toggle-on-style"),offstyle:$el.data("toggle-off-style")};$el.data("toggle-width")&&(toggleOptions.width=$el.data("toggle-width")),$el.data("toggle-height")&&(toggleOptions.height=$el.data("toggle-height")),$el.bootstrapToggle(toggleOptions),$el.data("toggle-disabled")&&$el.bootstrapToggle("disable");var changeFailed=!1;$el.change((function(){if(changeFailed)changeFailed=!1;else{var currentElement=$(this),data=currentElement.data("pk-values")?currentElement.data("pk-values"):{};data.column=currentElement.closest("td").data("column-name");var fieldName=currentElement.data("editor-name");currentElement.is(":checked")&&(data[fieldName]=1),$.ajax({method:"POST",url:currentElement.data("editing-link"),data:data,dataType:"json",success:function(response){if(!response.success)return changeFailed=!0,$el.bootstrapToggle("toggle"),void utils.showErrorMessage(response.message);if(void 0!==$grid){$grid.showMessage(response.message,response.messageDisplayTime);var $row=$(response.row);utils.replaceRow(currentElement.closest(".pg-row"),$row),$grid.integrateRows($row),$grid.getReloadPageAfterAjaxOperation()&&location.reload()}}})}}))}))}})),define("pgui.modal_view",["pgui.field-embedded-video","pgui.cell-edit","pgui.utils","pgui.image_popup","pgui.toggle"],(function(showFieldEmbeddedVideo,initCellEdit,utils,initImagePopup,initToggle){var $body=$("body");return function init(item){if(!item.data("modal-view")){var $modalContainer=$('<div class="modal fade"></div>'),contentUrl=item.data("content-link");item.click((function(e){e.preventDefault(),$.get(contentUrl,(function(content){$body.append($modalContainer),$modalContainer.html(content).one("hidden.bs.modal",(function(){this.remove()})).modal(),showFieldEmbeddedVideo($modalContainer,!1,!1),initImagePopup($modalContainer),initToggle($modalContainer),$modalContainer.find("[data-edit-url]").each((function(i,el){var $el=$(el),columnName=$el.data("column-name");initCellEdit($el,(function(response){$el.html(response.columns[columnName]),$modalContainer.find(".js-message-container").append(utils.buildDismissableMessage("success",response.message,response.messageDisplayTime))}))})),$modalContainer.find("[data-modal-operation=view]").each((function(i,el){init($(el))}))}))})),item.data("modal-view",!0)}}})),define("pgui.inline-edit",["pgui.form_collection","pgui.utils","pgui.field-embedded-video","pgui.image_popup","pgui.toggle","jquery.query"],(function(FormCollection,utils,showFieldEmbeddedVideo,initImagePopup,initToggle){function createContainer(grid,cancelCallback){return grid.getRowTemplate().on("click",".js-cancel",(function(e){"function"==typeof cancelCallback&&cancelCallback(),$(e.delegateTarget).remove()}))}function getUrl($link){return $.query.load($link.data("content-link")).set("is_inline","true").toString()}function putContent($container,content){$container.find(".js-inline-edit-container").first().removeClass("pg-inline-edit-container-loading").html(content)}function showMessage(grid,responses){responses[0].success&&grid&&grid.showMessage(responses[0].message,responses[0].messageDisplayTime)}function createInsertForm($container,grid,content,newFormUrl,options){return putContent($container,content),new FormCollection($container,$container,newFormUrl,$.extend({done:function(hasErrors,responses,params){if(showMessage(grid,responses),!hasErrors){var $newRow=$(responses[0].row);$container.after($newRow),grid.integrateRows($newRow),$container.remove(),grid.updateEmptyGridMessage(),params&&"edit"==params.action&&$newRow.find("[data-inline-operation=edit]").first().click(),void 0===params.action&&grid.getReloadPageAfterAjaxOperation()&&location.reload()}return!0},copy:function($sourceForm,copyContent){$copiedContainer=createContainer(grid),$container.after($copiedContainer),createInsertForm($copiedContainer,grid,copyContent,newFormUrl,{init:function(formCollection){formCollection.copyEditorsValues($sourceForm,formCollection.get(0))}})}},options))}return{createInsertLink:function($link,grid,count){count=count||1;var url=getUrl($link);$link.on("click",(function(e){e.preventDefault();for(var containers=[],i=0;i<count;i++){var $container=createContainer(grid);grid.container.find(".pg-row-list:first").prepend($container),containers.push($container)}$.get(url,(function(content){$.each(containers,(function(i,$container){createInsertForm($container,grid,content,url,{})}))}))}))},createEditLink:function($link,grid){var $row=$link.closest(".pg-row");$link.data("form-container",null),$link.on("click",(function(e){e.preventDefault();var $viewInlineLink=$row.find("[data-inline-operation=view]");if($viewInlineLink.length&&$viewInlineLink.data("form-container")&&($viewInlineLink.data("form-container").remove(),$viewInlineLink.data("form-container",null)),$link.data("form-container"))return $link.data("form-container").remove(),void $link.data("form-container",null);var $container=createContainer(grid,(function(){$link.data("form-container",null),$row.show()}));$link.data("form-container",$container),grid.isCard()&&$row.hide(),$row.after($container),$.get(getUrl($link),(function(content){putContent($container,content),new FormCollection($container,$container,null,{done:function(hasErrors,responses,params){if(showMessage(grid,responses),!hasErrors){var $newRow=$(responses[0].row);utils.replaceRow($row,$newRow),$row.show(),grid.integrateRows($newRow),$link.data("form-container",null),$container.remove(),grid.updateEmptyGridMessage(),params&&"edit"==params.action&&$newRow.find("[data-column-name=edit] > a").first().click(),void 0===params.action&&grid.getReloadPageAfterAjaxOperation()&&location.reload()}return!0}})}))}))},createViewLink:function($link,grid){var url=getUrl($link),$row=$link.closest(".pg-row");$link.data("form-container",null),$link.on("click",(function(e){e.preventDefault();var $editInlineLink=$row.find("[data-inline-operation=edit]");if($editInlineLink.length&&$editInlineLink.data("form-container")&&($editInlineLink.data("form-container").remove(),$editInlineLink.data("form-container",null)),$link.data("form-container"))return $link.data("form-container").remove(),void $link.data("form-container",null);var $container=createContainer(grid,(function(){$link.data("form-container",null),$row.show()}));$link.data("form-container",$container),grid.isCard()&&$row.hide(),$row.after($container),$.get(url,(function(content){putContent($container,content),showFieldEmbeddedVideo($container,!1,!1),initImagePopup($container),initToggle($container)}))}))}}})),define("pgui.column_group",["libs/match-media"],(function(){function match(maxWidth){return window.matchMedia("(max-width: "+maxWidth+"px)").matches}return function($container){var $columnGroups=$container.find(".js-column-group");function updateGroups(){window.outerWidth;var visibility=4;match(767)?visibility=1:match(991)?visibility=2:match(1200)&&(visibility=3),$columnGroups.each((function(i,el){var $el=$(el);$el.attr("colspan",$el.data("visibility")[visibility])}))}$(window).on("resize",updateGroups),updateGroups()}})),define("pgui.charts",["moment"],(function(moment){var charts=[];function getTable(chart){var table=new google.visualization.DataTable;return $.each(chart.data.columns,(function(i,column){"data"===column.role?table.addColumn({type:transformType(column.type),label:column.label}):table.addColumn({role:column.role,type:"string",p:{html:!0}})})),$.each(chart.data.rows,(function(i,rowData){var row=[];$.each(chart.data.columns,(function(j,col){var value=rowData[j];"date"!==col.type&&"datetime"!==col.type||null===value||(value=moment(value).toDate()),row.push(value)})),table.addRow(row)})),function(columns,table){var formatterClasses={number:google.visualization.NumberFormat,date:google.visualization.DateFormat,datetime:google.visualization.DateFormat};$.each(columns,(function(i,column){var Formatter=formatterClasses[transformType(column.type)];column.format&&Formatter&&new Formatter({pattern:column.format}).format(table,i)}))}(chart.data.columns,table),table}function transformType(type){switch((type=type||"string").toLowerCase()){case"string":return"string";case"date":return"date";case"datetime":return"datetime";default:return"number"}}function googleObjectAvailable(){return"undefined"!=typeof google&&google}function drawCharts(){googleObjectAvailable()&&$.each(charts,(function(i,chartConfig){chartConfig.table=chartConfig.table||getTable(chartConfig);var $container=$("[data-id="+chartConfig.id+"]");chartConfig.options=function($container,chartType,options){var textColor=$container.css("color"),gridlinesColor=$container.css("border-color"),result=$.extend(!0,{backgroundColor:"none",titleTextStyle:{color:textColor},vAxis:{gridlines:{color:gridlinesColor}},hAxis:{gridlines:{color:gridlinesColor}}},options);if("Geo"!=chartType&&(result=$.extend(!0,{legend:{textStyle:{color:textColor}}},result)),"Pie"==chartType)return result;var axisStyles={titleTextStyle:{color:textColor},textStyle:{color:textColor}};return $.extend(!0,{},{hAxis:axisStyles,vAxis:axisStyles},result)}($container,chartConfig.type,chartConfig.options),"TreeMap"==chartConfig.type&&"generateTooltip"in chartConfig&&(window["chartData_"+chartConfig.id].dataTable=chartConfig.table,chartConfig.options.generateTooltip=chartConfig.generateTooltip);var chartClass=chartConfig.type;["Histogram","Gantt","Timeline","TreeMap"].includes(chartClass)||(chartClass+="Chart"),new google.visualization[chartClass]($container.get(0)).draw(chartConfig.table,chartConfig.options)}))}return{init:function($container){$container.find(".pgui-chart").each((function(i,el){var chartConfig,$chart=$(el);$chart.data("ready")||(chartConfig=window["chartData_"+$chart.data("id")],charts.push(chartConfig),$chart.data("ready",!0))})),googleObjectAvailable()&&google.charts.setOnLoadCallback(drawCharts),$(window).off("resize",drawCharts).on("resize",drawCharts)},draw:drawCharts}})),define("pgui.grid-details",["class","pgui.charts","underscore"],(function(Class,charts,_){var RowDetails=Class.extend({init:function(grid,$row,$button,$expandAll,details){this.$row=$row,this.$button=$button,this.$expandAll=$expandAll,this.grid=grid,this.details=details,this.$container=grid.isCard()?function(grid,$row){var $container=$('<div class="grid-card-item col-xs-12"><div class="well grid-details grid-details-card js-content"></div></div>'),$rows=grid.getRows();function attachContainer(){var listWidth=grid.container.find(".pg-row-list").width(),cardWidth=$row.width(),cardsInARow=Math.floor(listWidth/cardWidth),index=$rows.index($row),beforeDetailsIndex=Math.min($rows.length-1,index+cardsInARow-index%cardsInARow-1);$container.detach(),$($rows.get(beforeDetailsIndex)).after($container)}return $(window).on("resize",attachContainer),attachContainer(),$container}(grid,$row):function(grid,$row){var $container=$('<tr class="grid-details grid-details-table detail"><td class="js-content" colspan="'+grid.getColumnCount()+'"></td></tr>');return $row.after($container),$container}(grid,$row),this.$container.find(".js-content").append($('<button class="close js-close" type="button">&times;</button>')).append($('<div class="grid-details-loading js-loading"><img src="components/assets/img/loading.gif"></div>')),this.isLoaded=!1,this.isLoading=!1},open:function(){this._load(),this.$container.show(),this.$container.find(".js-close").first().on("click",_.bind(this.close,this)),window.scroll(window.scrollX,this.$container.offset().top-$("#navbar").height()-32),charts.draw(),this.toggleButtons(!0)},close:function(){this.$container.hide(),this.toggleButtons(!1)},toggle:function(isOpen){isOpen?this.open():this.close()},toggleButtons:function(isOpen){var $rows=this.grid.getRows();this.grid.isCard()&&(isOpen&&$rows.find(".js-expand-details.expanded").click(),this.$row.toggleClass("grid-card-item-details-expanded",isOpen)),this.$button.toggleClass("collapsed",!isOpen).toggleClass("expanded",isOpen);var isAllOpened=$rows.length===$rows.find(".js-expand-details.expanded").length;this.$expandAll.toggleClass("collapsed",!isAllOpened).toggleClass("expanded",isAllOpened)},_load:function(){this.isLoaded||this.isLoading||(this.isLoading=!0,$.when.apply($,_.map(this.details,(function(detail){return $.get(detail.gridLink,{inline:!0}).then((function(html){return{caption:detail.caption,id:detail.detailId,$el:$(html)}}))}))).done(_.bind((function(){var details,$tabs,$panes;this.isLoaded=!0,this.isLoading=!1,this.$container.find(".js-loading").hide(),this.$container.find(".js-content").append((details=[].slice.call(arguments),$tabs=$('<ul class="nav nav-tabs grid-details-tabs">'),$panes=$('<div class="tab-content">'),_.each(details,(function(detail,i){var id=detail.id+Math.ceil(1e8*Math.random());$tabs.append($("<li>").toggleClass("active",0===i).append($('<a href="#'+id+'" data-toggle="tab">'+detail.caption+"</a>"))),$panes.append($('<div class="tab-pane" id="'+id+'">').toggleClass("active",0===i).append(detail.$el))})),$tabs.find('[data-toggle="tab"]').on("shown.bs.tab",(function(){charts.draw()})),$("<div>").append($tabs).append($panes))),this._initGrids()}),this)))},_initGrids:function(){this.$container.find(".js-grid").each(_.bind((function(i,el){new this.grid.constructor($(el))}),this)),charts.init(this.$container)},remove:function(){this.$container.remove()}});return function(grid,$expandAll,$rows){$expandAll.off("click").on("click",(function(e){var isOpened=$expandAll.hasClass("expanded");$rows.find(".js-expand-details").filter(isOpened?".expanded":".collapsed").click(),$expandAll.toggleClass("collapsed",isOpened).toggleClass("expanded",!isOpened),e.preventDefault()})),$rows.each((function(i,row){var $row=$(row),$button=$row.find(".js-expand-details").first();$button.data("details")||$button.off("click").on("click",(function(e){var nextIsOpened=!$button.hasClass("expanded"),details=$button.data("details");details||(details=new RowDetails(grid,$row,$button,$expandAll,$button.data("info")),$button.data("details",details),$row.data("details",details)),details.toggle(nextIsOpened),e.preventDefault()}))}))}})),define("pgui.grid",["class","pgui.filter_builder","pgui.column_filter","pgui.quick_filter","pgui.localizer","microevent","pgui.overlay","underscore","multiple_sorting","sorter","pgui.shortcuts","pgui.utils","pgui.field-embedded-video","pgui.autohide-message","pgui.selection","custom/pgui.selection-handler.ops","pgui.cell-edit","pgui.modal_operation_link","pgui.modal_delete_link","pgui.modal_view","pgui.inline-edit","pgui.column_group","pgui.grid-details","pgui.form_collection","pgui.image_popup","pgui.toggle"],(function(Class,FilterBuilder,ColumnFilter,QuickFilter,localizer,events,overlay,_,MultipleSorting,Sorter,shortcuts,utils,showFieldEmbeddedVideo,autoHideMessage,Selection,SelectionHandler,initCellEdit,modalLink,initModalDelete,initModalView,inlineLink,initColumnGroup,initDetails,FormCollection,initImagePopup,initToggle){return Class.extend({init:function(container,options){if(this.container=container,this.container.data("grid-class",this),this.filters={},this.options=options||{},this.reloadPageAfterAjaxOperation=this.container.data("reload-page-after-ajax-operation"),this.$header=this.container.find("thead").first(),this.selectionActions=new SelectionHandler(new Selection(this.getSelectionId()),this.container.find(".js-selection-actions-container"),this.$header.find("th.row-selection"),this.container.find(".pg-row .row-selection input[type=checkbox]"),!0,this),this._initActions(),this.integrateRows(this.container.find(".pg-row")),this._recalculateRowNumbers(),this._createFilters(),this._bindHandlers(),this._processHiddenValues(),this.$header.length&&this.$header.data("has-groups")&&initColumnGroup(this.$header),!this.container.data("is-master")){var sortableColumns=this.container.data("sortable-columns"),sorter=new Sorter(sortableColumns),$sortDialog=$("#multiple-sorting-"+this.getId());new MultipleSorting(sorter,$sortDialog)}$.each(this.container.find(".alert"),(function(i,alert){autoHideMessage($(alert))}))},getId:function(){return this.container.attr("id")},isCard:function(){return this.container.hasClass("grid-card")},getSelectionId:function(){return this.container.data("selection-id")},getRowTemplate:function(){var $rowTemplate=$(_.template($("#"+this.getId()+"_row_template").html())(this));return $rowTemplate.find("td.pg-inline-edit-container").attr("colspan",this.getColumnCount()),$rowTemplate},getColumnCount:function(){return this.container.data("column-count")},getQuickFilter:function(){return this.filters.quickFilter},getFilterBuilder:function(){return this.filters.filterBuilder},getColumnFilter:function(){return this.filters.columnFilter},getReloadPageAfterAjaxOperation:function(){return this.reloadPageAfterAjaxOperation},getRows:function(){return this.container.find(".pg-row-list:first > .pg-row")},removeRow:function($row){$row.data("details")&&$row.data("details").remove();var $checkbox=$row.find(".row-selection input[type=checkbox]").first();$checkbox.length&&$checkbox.prop("checked")&&$checkbox.click();var $editLink=$row.find("[data-inline-operation=edit]");$editLink.length&&$editLink.data("form-container")&&$editLink.data("form-container").remove(),$row.remove(),this.updateEmptyGridMessage()},updateEmptyGridMessage:function(){this.container.find(".pg-row-list:first .empty-grid").toggle(0==this.container.find(".pg-row").length)},insertRowAtBegin:function($row){var row=this.container.find(".pg-row-list:first > .pg-row").first(),emptyGrid=this.container.find(".pg-row-list:first .empty-grid").closest("tr");return 0==row.length&&(row=emptyGrid),row.before($row),this.integrateRows($row),this.updateEmptyGridMessage(),$row},addHiddenValue:function(name,value){this.hiddenValues[name]=value},showMessage:function(message,displayTime,isError){message&&this.container.find(".js-grid-message-container").first().append(utils.buildDismissableMessage(isError?"danger":"success",message,displayTime))},integrateRows:function($rows){var self=this;this.selectionActions.setCheckboxes(this.$header.find(".row-selection input[type=checkbox]"),this.container.find(".pg-row .row-selection input[type=checkbox]")),showFieldEmbeddedVideo($rows),initImagePopup($rows),initToggle($rows,self),$rows.find("[data-edit-url]").each((function(i,el){var $el=$(el);initCellEdit($(el),(function(response){self.showMessage(response.message,response.messageDisplayTime,!response.success);var $row=$(response.row);utils.replaceRow($el.closest(".pg-row"),$row),self.integrateRows($row),self.getReloadPageAfterAjaxOperation()&&location.reload()}))})),$rows.find("[data-modal-operation=edit]").each((function(index,item){var $item=$(item);$item.data("modal-edit")||$item.data("modal-edit",modalLink.createEditLink(FormCollection,$item,self))})),$rows.find("[data-modal-operation=copy]").each((function(index,item){var $item=$(item);$item.data("modal-copy")||$item.data("modal-copy",modalLink.createInsertLink(FormCollection,$item,self))})),$rows.find("[data-modal-operation=view]").each((function(index,item){initModalView($(item))})),$rows.find("[data-modal-operation=delete]").length>0&&initModalDelete($rows,self),$rows.find("[data-inline-operation=edit]").each((function(index,item){var $item=$(item);$item.data("inline-edit")||$item.data("inline-edit",inlineLink.createEditLink($item,self))})),$rows.find("[data-inline-operation=copy]").each((function(index,item){var $item=$(item);$item.data("inline-copy")||$item.data("inline-copy",inlineLink.createInsertLink($item,self))})),$rows.find("[data-inline-operation=view]").each((function(index,item){var $item=$(item);$item.data("inline-view")||$item.data("inline-view",inlineLink.createViewLink($item,self))})),initDetails(this,this.container.find(".js-expand-all-details").first(),this.getRows()),utils.updatePopupHints($rows)},_createFilters:function(){this.filters={filterBuilder:FilterBuilder.create(this.container.find(".js-filter-builder-modal")),columnFilter:ColumnFilter.create(this.container.find(".js-column-filter-container").first()),quickFilter:new QuickFilter(this.container.find(".js-quick-filter").first())},this.container.find(".js-filter-builder-open").on("click",_.bind((function(e){this.filters.filterBuilder.show(),e.preventDefault()}),this))},_bindFilterStatusHandlers:function($container){var self=this;function getFilterByEvent(event){return self.filters[$(event.currentTarget).data("id")]}$container.on("click",".js-edit-filter",(function(e){getFilterByEvent(e).show(),e.preventDefault()})).on("click",".js-toggle-filter",(function(e){getFilterByEvent(e).setEnabled($(e.currentTarget).data("value")).submit(),e.preventDefault()})).on("click",".js-reset-filter",(function(e){getFilterByEvent(e).reset().submit(),e.preventDefault()})).on("click",".js-reset-selection-filter",(function(e){location.href=$.query.remove("keys").set("selection_filter",""),e.preventDefault()}))},_processHiddenValues:function(){var self=this;this.hiddenValues={},_.each(this.container.data("grid-hidden-values"),(function(value,name){self.addHiddenValue(name,value)}))},_recalculateRowNumbers:function(){var padCount,startNumber=parseInt(this.container.data("start-line-number")),lineNumberCells=this.container.find("tbody > tr > td.line-number"),maxNumber=startNumber+lineNumberCells.length;padCount=maxNumber.toString().length,lineNumberCells.each((function(index){$(this).html(function(number,length){for(var str=""+number;str.length<length;)str="0"+str;return str}(index+startNumber,padCount))}))},_initActions:function(){var self=this,$actions=this.container.find(".js-actions").first();$actions.find("[data-modal-insert=true]").each((function(i,el){var $el=$(el);$el.data("modal-insert-object")||$el.data("modal-insert-object",modalLink.createInsertLink(FormCollection,$el,self))})),$actions.find("[data-inline-insert=true]").each((function(i,el){var $el=$(el);$el.data("inline-insert-object")||$el.data("inline-insert-object",inlineLink.createInsertLink($el,self,$el.data("count")||1))}))},_bindHandlers:function(){this.$header.find("th[data-comment]").each((function(){$(this).popover({placement:"top",container:"body",trigger:"hover",html:!0,title:$(this).attr("data-field-caption"),content:$(this).attr("data-comment")})})),this._bindFilterStatusHandlers(this.container.find(".js-filter-status").first())}})})),function($,window,undefined){"use strict";var name="stickyTableHeaders",id=0,defaults={fixedOffset:0,leftOffset:0,marginTop:0,scrollableArea:window,selector:"thead:first"};function Plugin(el,options){var base=this;base.$el=$(el),base.el=el,base.id=id++,base.$window=$(window),base.$document=$(document),base.$el.bind("destroyed",$.proxy(base.teardown,base)),base.$clonedHeader=null,base.$originalHeader=null,base.isSticky=!1,base.hasBeenSticky=!1,base.leftOffset=null,base.topOffset=null,base.init=function(){base.setOptions(options),base.$el.each((function(){var $this=$(this);$this.css("padding",0),base.$originalHeader=$(base.options.selector,this),base.$clonedHeader=base.$originalHeader.clone(),$this.trigger("clonedHeader."+name,[base.$clonedHeader]),base.$clonedHeader.addClass("tableFloatingHeader"),base.$clonedHeader.css("display","none"),base.$originalHeader.addClass("tableFloatingHeaderOriginal"),base.$originalHeader.after(base.$clonedHeader),base.$printStyle=$('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),$("head").append(base.$printStyle)})),base.updateWidth(),base.toggleHeaders(),base.bind()},base.destroy=function(){base.$el.unbind("destroyed",base.teardown),base.teardown()},base.teardown=function(){base.isSticky&&base.$originalHeader.css("position","static"),$.removeData(base.el,"plugin_"+name),base.unbind(),base.$clonedHeader.remove(),base.$originalHeader.removeClass("tableFloatingHeaderOriginal"),base.$originalHeader.css("visibility","visible"),base.$printStyle.remove(),base.el=null,base.$el=null},base.bind=function(){base.$scrollableArea.on("scroll."+name,base.toggleHeaders),base.isWindowScrolling||(base.$window.on("scroll."+name+base.id,base.setPositionValues),base.$window.on("resize."+name+base.id,base.toggleHeaders)),base.$scrollableArea.on("resize."+name,base.toggleHeaders),base.$scrollableArea.on("resize."+name,base.updateWidth)},base.unbind=function(){base.$scrollableArea.off("."+name,base.toggleHeaders),base.isWindowScrolling||(base.$window.off("."+name+base.id,base.setPositionValues),base.$window.off("."+name+base.id,base.toggleHeaders)),base.$scrollableArea.off("."+name,base.updateWidth)},base.toggleHeaders=function(){base.$el&&base.$el.each((function(){var newLeft,$this=$(this),newTopOffset=base.isWindowScrolling?isNaN(base.options.fixedOffset)?base.options.fixedOffset.outerHeight():base.options.fixedOffset:base.$scrollableArea.offset().top+(isNaN(base.options.fixedOffset)?0:base.options.fixedOffset),offset=$this.offset(),scrollTop=base.$scrollableArea.scrollTop()+newTopOffset,scrollLeft=base.$scrollableArea.scrollLeft(),scrolledPastTop=base.isWindowScrolling?scrollTop>offset.top:newTopOffset>offset.top,notScrolledPastBottom=(base.isWindowScrolling?scrollTop:0)<offset.top+$this.height()-base.$clonedHeader.height()-(base.isWindowScrolling?0:newTopOffset);scrolledPastTop&&notScrolledPastBottom?(newLeft=offset.left-scrollLeft+base.options.leftOffset,base.$originalHeader.css({position:"fixed","margin-top":base.options.marginTop,left:newLeft,"z-index":3}),base.leftOffset=newLeft,base.topOffset=newTopOffset,base.$clonedHeader.css("display",""),base.isSticky||(base.isSticky=!0,base.updateWidth()),base.setPositionValues()):base.isSticky&&(base.$originalHeader.css("position","static"),base.$clonedHeader.css("display","none"),base.isSticky=!1,base.resetWidth($("td,th",base.$clonedHeader),$("td,th",base.$originalHeader)))}))},base.setPositionValues=function(){var winScrollTop=base.$window.scrollTop(),winScrollLeft=base.$window.scrollLeft();!base.isSticky||winScrollTop<0||winScrollTop+base.$window.height()>base.$document.height()||winScrollLeft<0||winScrollLeft+base.$window.width()>base.$document.width()||base.$originalHeader.css({top:base.topOffset-(base.isWindowScrolling?0:winScrollTop),left:base.leftOffset-(base.isWindowScrolling?0:winScrollLeft)})},base.updateWidth=function(){if(base.isSticky){base.$originalHeaderCells||(base.$originalHeaderCells=$("th,td",base.$originalHeader)),base.$clonedHeaderCells||(base.$clonedHeaderCells=$("th,td",base.$clonedHeader));var cellWidths=base.getWidth(base.$clonedHeaderCells);base.setWidth(cellWidths,base.$clonedHeaderCells,base.$originalHeaderCells),base.$originalHeader.css("width",base.$clonedHeader.width())}},base.getWidth=function($clonedHeaders){var widths=[];return $clonedHeaders.each((function(index){var width,$this=$(this);if("border-box"===$this.css("box-sizing"))width=$this[0].getBoundingClientRect().width;else if("collapse"===$("th",base.$originalHeader).css("border-collapse"))if(window.getComputedStyle)width=parseFloat(window.getComputedStyle(this,null).width);else{var leftPadding=parseFloat($this.css("padding-left")),rightPadding=parseFloat($this.css("padding-right")),border=parseFloat($this.css("border-width"));width=$this.outerWidth()-leftPadding-rightPadding-border}else width=$this.width();widths[index]=width})),widths},base.setWidth=function(widths,$clonedHeaders,$origHeaders){$clonedHeaders.each((function(index){var width=widths[index];$origHeaders.eq(index).css({"min-width":width,"max-width":width})}))},base.resetWidth=function($clonedHeaders,$origHeaders){$clonedHeaders.each((function(index){var $this=$(this);$origHeaders.eq(index).css({"min-width":$this.css("min-width"),"max-width":$this.css("max-width")})}))},base.setOptions=function(options){base.options=$.extend({},defaults,options),base.$scrollableArea=$(base.options.scrollableArea),base.isWindowScrolling=base.$scrollableArea[0]===window},base.updateOptions=function(options){base.setOptions(options),base.unbind(),base.bind(),base.updateWidth(),base.toggleHeaders()},base.init()}$.fn[name]=function(options){return this.each((function(){var instance=$.data(this,"plugin_"+name);instance?"string"==typeof options?instance[options].apply(instance):instance.updateOptions(options):"destroy"!==options&&$.data(this,"plugin_"+name,new Plugin(this,options))}))}}(jQuery,window),define("jquery.stickytableheaders",["jquery"],(function(){})),define("pgui.list-page-main",["underscore","pgui.page_settings","pgui.shortcuts","pgui.grid","pgui.filter_common","pgui.filter_builder","pgui.column_filter","pgui.charts","pgui.utils","jquery.stickytableheaders"],(function(_,pageSettings,shortcuts,Grid,Filter,FilterBuilder,ColumnFilter,charts,utils){return function(){var $body=$("body");pageSettings($body);var $tableToFixHeader=$("table.table.fixed-header");if($tableToFixHeader.length>0){var $navbar=$(".navbar"),marginTop=0;$navbar.hasClass("navbar-fixed-top")&&(marginTop+=$navbar.outerHeight()),$tableToFixHeader.stickyTableHeaders({selector:"thead:first",marginTop:marginTop})}shortcuts.push(["grid"]),$body.find(".js-grid").each((function(i,el){var $grid=$(el),grid=new Grid($grid),id=grid.getId(),gridData=window["gridData_"+id],filterBuilder=grid.getFilterBuilder();_.each(gridData.filterBuilder.columns,(function(columnData){filterBuilder.addColumn(new Filter.Column(columnData.fieldName,columnData.caption,columnData.operators))}));var filterBuilderGroup=new FilterBuilder.Group;filterBuilderGroup.deserialize(filterBuilder.getColumns(),gridData.filterBuilder.data),filterBuilder.setFilterComponent(filterBuilderGroup);var columnFilter=grid.getColumnFilter();_.each(gridData.columnFilter.columns,(function(columnData){columnFilter.addColumn(new ColumnFilter.Column(columnData.fieldName,columnData.caption,columnData.typeIsDateTime))}));var columnFilterGroup=new ColumnFilter.Group;columnFilterGroup.deserialize(columnFilter.getColumns(),gridData.columnFilter.data),columnFilter.setFilterComponent(columnFilterGroup),columnFilter.setDefaultsEnabled(gridData.columnFilter.isDefaultsEnabled),columnFilter.attach();var quickFilter=grid.getQuickFilter();quickFilter.setColumnNames(gridData.quickFilter.columns),quickFilter.highlight($grid),utils.updatePopupHints($grid.find(".pg-row"))})),charts.init($body)}})),define("pgui.view-page-main",["pgui.utils","pgui.field-embedded-video","pgui.cell-edit","pgui.selection","pgui.selection-handler","pgui.image_popup","pgui.modal_view","pgui.toggle"],(function(utils,showFieldEmbeddedVideo,initCellEdit,Selection,SelectionHandler,initImagePopup,initModalView,initToggle){return function(){var $body=$("body");utils.updatePopupHints($body),showFieldEmbeddedVideo($body),initImagePopup($body),initToggle($body),$body.find("[data-edit-url]").each((function(i,el){var $el=$(el),columnName=$el.data("column-name");initCellEdit($el,(function(response){$el.html(response.columns[columnName]),$body.find(".js-message-container").append(utils.buildDismissableMessage("success",response.message,response.messageDisplayTime))}))})),$body.find("[data-modal-operation=view]").each((function(i,el){initModalView($(el))}));var $selectionActions=$body.find(".js-selection-actions-container");if($selectionActions.length)new SelectionHandler(new Selection($selectionActions.data("selection-id")),$selectionActions)}})),define("pgui.compare-page-main",["pgui.view-page-main"],(function(initViewPage){return function(){function updateMode(){var $this=$(this);$this.prop("checked")&&$("[data-diff=false]").toggle("all"===$this.data("mode"))}initViewPage(),$(".js-compare-mode").on("change",updateMode).each(updateMode)}})),define("pgui.form-page-main",["pgui.form_collection","pgui.shortcuts"],(function(FormCollection,shortcuts){return function(){var $formContainer=$(".js-form-container").first();new FormCollection($formContainer,$(".js-form-collection"),$formContainer.data("form-url"),{done:function(hasErrors,responses,params){if(hasErrors)return!0;switch(params.action){case"open":location.href=params.url;break;case"edit":location.href=responses[0].editUrl;break;case"details":location.href=responses[0].details[params.index]}return!1}});shortcuts.push(["form"])}})),define("pgui.user_management_api",[],(function(){return{_invokeApiFunction:function(functionShortName,data){var result=new $.Deferred;return $.get("user_management_api.php",$.extend({},{hname:functionShortName},data)).done((function(data){"error"==data.status?result.reject(data.result):data.result?result.resolve(data.result):result.resolve()})).fail((function(xhr,status,errorMessage){result.reject(status+": "+errorMessage)})),result.promise()},addUser:function(name,password){return this._invokeApiFunction("au",{username:name,password:password})},addUserEx:function(name,password,email){return this._invokeApiFunction("aue",{username:name,password:password,email:email})},updateUser:function(id,name,email,status){return this._invokeApiFunction("uu",{user_id:id,username:name,email:email,status:status})},removeUser:function(id){return this._invokeApiFunction("ru",{user_id:id})},changeUserName:function(id,name){return this._invokeApiFunction("cun",{user_id:id,username:name})},changeUserPassword:function(id,password){return this._invokeApiFunction("cup",{user_id:id,password:password})},getUserGrants:function(userId){return this._invokeApiFunction("gug",{user_id:userId})},addUserGrant:function(userId,pageName,grantName){return this._invokeApiFunction("aug",{user_id:userId,page_name:pageName,grant:grantName})},removeUserGrant:function(userId,pageName,grantName){return this._invokeApiFunction("rug",{user_id:userId,page_name:pageName,grant:grantName})},selfChangePassword:function(currentPassword,newPassword){return this._invokeApiFunction("self_change_password",{current_password:currentPassword,new_password:newPassword})}}})),function(jQuery,undefined){var appendToTmplItems,oldManip=jQuery.fn.domManip,tmplItmAtt="_tmplitem",htmlExpr=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,newTmplItems={},wrappedItems={},topTmplItem={key:0,data:{}},itemKey=0,cloneIndex=0,stack=[];function newTmplItem(options,parentItem,fn,data){var newItem={data:data||(parentItem?parentItem.data:{}),_wrap:parentItem?parentItem._wrap:null,tmpl:null,parent:parentItem||null,nodes:[],calls:tiCalls,nest:tiNest,wrap:tiWrap,html:tiHtml,update:tiUpdate};return options&&jQuery.extend(newItem,options,{nodes:[],parent:parentItem}),fn&&(newItem.tmpl=fn,newItem._ctnt=newItem._ctnt||newItem.tmpl(jQuery,newItem),newItem.key=++itemKey,(stack.length?wrappedItems:newTmplItems)[itemKey]=newItem),newItem}function build(tmplItem,nested,content){var frag,ret=content?jQuery.map(content,(function(item){return"string"==typeof item?tmplItem.key?item.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+tmplItmAtt+'="'+tmplItem.key+'" $2'):item:build(item,tmplItem,item._ctnt)})):tmplItem;return nested?ret:((ret=ret.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,(function(all,before,middle,after){storeTmplItems(frag=jQuery(middle).get()),before&&(frag=unencode(before).concat(frag)),after&&(frag=frag.concat(unencode(after)))})),frag||unencode(ret))}function unencode(text){var el=document.createElement("div");return el.innerHTML=text,jQuery.makeArray(el.childNodes)}function buildTmplFn(markup){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+jQuery.trim(markup).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,(function(all,slash,type,fnargs,target,parens,args){var def,expr,exprAutoFnDetect,tag=jQuery.tmpl.tag[type];if(!tag)throw"Template command not found: "+type;return def=tag._default||[],parens&&!/\w$/.test(target)&&(target+=parens,parens=""),target?(target=unescape(target),args=args?","+unescape(args)+")":parens?")":"",expr=parens?target.indexOf(".")>-1?target+parens:"("+target+").call($item"+args:target,exprAutoFnDetect=parens?expr:"(typeof("+target+")==='function'?("+target+").call($item):("+target+"))"):exprAutoFnDetect=expr=def.$1||"null",fnargs=unescape(fnargs),"');"+tag[slash?"close":"open"].split("$notnull_1").join(target?"typeof("+target+")!=='undefined' && ("+target+")!=null":"true").split("$1a").join(exprAutoFnDetect).split("$1").join(expr).split("$2").join(fnargs?fnargs.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,(function(all,name,parens,params){return(params=params?","+params+")":parens?")":"")?"("+name+").call($item"+params:all})):def.$2||"")+"_.push('"}))+"');}return _;")}function updateWrapped(options,wrapped){options._wrap=build(options,!0,jQuery.isArray(wrapped)?wrapped:[htmlExpr.test(wrapped)?wrapped:jQuery(wrapped).html()]).join("")}function unescape(args){return args?args.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function storeTmplItems(content){var elem,elems,i,l,m,keySuffix="_"+cloneIndex,newClonedItems={};for(i=0,l=content.length;i<l;i++)if(1===(elem=content[i]).nodeType){for(m=(elems=elem.getElementsByTagName("*")).length-1;m>=0;m--)processItemKey(elems[m]);processItemKey(elem)}function processItemKey(el){var pntKey,pntItem,tmplItem,key,pntNode=el;if(key=el.getAttribute(tmplItmAtt)){for(;pntNode.parentNode&&1===(pntNode=pntNode.parentNode).nodeType&&!(pntKey=pntNode.getAttribute(tmplItmAtt)););pntKey!==key&&(pntNode=pntNode.parentNode?11===pntNode.nodeType?0:pntNode.getAttribute(tmplItmAtt)||0:0,(tmplItem=newTmplItems[key])||((tmplItem=newTmplItem(tmplItem=wrappedItems[key],newTmplItems[pntNode]||wrappedItems[pntNode],null,!0)).key=++itemKey,newTmplItems[itemKey]=tmplItem),cloneIndex&&cloneTmplItem(key)),el.removeAttribute(tmplItmAtt)}else cloneIndex&&(tmplItem=jQuery.data(el,"tmplItem"))&&(cloneTmplItem(tmplItem.key),newTmplItems[tmplItem.key]=tmplItem,pntNode=(pntNode=jQuery.data(el.parentNode,"tmplItem"))?pntNode.key:0);if(tmplItem){for(pntItem=tmplItem;pntItem&&pntItem.key!=pntNode;)pntItem.nodes.push(el),pntItem=pntItem.parent;delete tmplItem._ctnt,delete tmplItem._wrap,jQuery.data(el,"tmplItem",tmplItem)}function cloneTmplItem(key){tmplItem=newClonedItems[key+=keySuffix]=newClonedItems[key]||newTmplItem(tmplItem,newTmplItems[tmplItem.parent.key+keySuffix]||tmplItem.parent,null,!0)}}}function tiCalls(content,tmpl,data,options){if(!content)return stack.pop();stack.push({_:content,tmpl:tmpl,item:this,data:data,options:options})}function tiNest(tmpl,data,options){return jQuery.tmpl(jQuery.template(tmpl),data,options,this)}function tiWrap(call,wrapped){var options=call.options||{};return options.wrapped=wrapped,jQuery.tmpl(jQuery.template(call.tmpl),call.data,options,call.item)}function tiHtml(filter,textOnly){var wrapped=this._wrap;return jQuery.map(jQuery(jQuery.isArray(wrapped)?wrapped.join(""):wrapped).filter(filter||"*"),(function(e){return textOnly?e.innerText||e.textContent:e.outerHTML||(elem=e,(div=document.createElement("div")).appendChild(elem.cloneNode(!0)),div.innerHTML);var elem,div}))}function tiUpdate(){var coll=this.nodes;jQuery.tmpl(null,null,null,this).insertBefore(coll[0]),jQuery(coll).remove()}jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(name,original){jQuery.fn[name]=function(selector){var elems,i,l,tmplItems,ret=[],insert=jQuery(selector),parent=1===this.length&&this[0].parentNode;if(appendToTmplItems=newTmplItems||{},parent&&11===parent.nodeType&&1===parent.childNodes.length&&1===insert.length)insert[original](this[0]),ret=this;else{for(i=0,l=insert.length;i<l;i++)cloneIndex=i,elems=(i>0?this.clone(!0):this).get(),jQuery.fn[original].apply(jQuery(insert[i]),elems),ret=ret.concat(elems);cloneIndex=0,ret=this.pushStack(ret,name,insert.selector)}return tmplItems=appendToTmplItems,appendToTmplItems=null,jQuery.tmpl.complete(tmplItems),ret}})),jQuery.fn.extend({tmpl:function(data,options,parentItem){return jQuery.tmpl(this[0],data,options,parentItem)},tmplItem:function(){return jQuery.tmplItem(this[0])},template:function(name){return jQuery.template(name,this[0])},domManip:function(args,table,callback,options){if(args[0]&&args[0].nodeType){for(var tmplItem,dmArgs=jQuery.makeArray(arguments),argsLength=args.length,i=0;i<argsLength&&!(tmplItem=jQuery.data(args[i++],"tmplItem")););argsLength>1&&(dmArgs[0]=[jQuery.makeArray(args)]),tmplItem&&cloneIndex&&(dmArgs[2]=function(fragClone){jQuery.tmpl.afterManip(this,fragClone,callback)}),oldManip.apply(this,dmArgs)}else oldManip.apply(this,arguments);return cloneIndex=0,appendToTmplItems||jQuery.tmpl.complete(newTmplItems),this}}),jQuery.extend({tmpl:function(tmpl,data,options,parentItem){var ret,topLevel=!parentItem;if(topLevel)parentItem=topTmplItem,tmpl=jQuery.template[tmpl]||jQuery.template(null,tmpl),wrappedItems={};else if(!tmpl)return tmpl=parentItem.tmpl,newTmplItems[parentItem.key]=parentItem,parentItem.nodes=[],parentItem.wrapped&&updateWrapped(parentItem,parentItem.wrapped),jQuery(build(parentItem,null,parentItem.tmpl(jQuery,parentItem)));return tmpl?("function"==typeof data&&(data=data.call(parentItem||{})),options&&options.wrapped&&updateWrapped(options,options.wrapped),ret=jQuery.isArray(data)?jQuery.map(data,(function(dataItem){return dataItem?newTmplItem(options,parentItem,tmpl,dataItem):null})):[newTmplItem(options,parentItem,tmpl,data)],topLevel?jQuery(build(parentItem,null,ret)):ret):[]},tmplItem:function(elem){var tmplItem;for(elem instanceof jQuery&&(elem=elem[0]);elem&&1===elem.nodeType&&!(tmplItem=jQuery.data(elem,"tmplItem"))&&(elem=elem.parentNode););return tmplItem||topTmplItem},template:function(name,tmpl){return tmpl?("string"==typeof tmpl?tmpl=buildTmplFn(tmpl):tmpl instanceof jQuery&&(tmpl=tmpl[0]||{}),tmpl.nodeType&&(tmpl=jQuery.data(tmpl,"tmpl")||jQuery.data(tmpl,"tmpl",buildTmplFn(tmpl.innerHTML))),"string"==typeof name?jQuery.template[name]=tmpl:tmpl):name?"string"!=typeof name?jQuery.template(null,name):jQuery.template[name]||jQuery.template(null,htmlExpr.test(name)?name:jQuery(name)):null},encode:function(text){return(""+text).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),jQuery.extend(jQuery.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(items){newTmplItems={}},afterManip:function(elem,fragClone,callback){var content=11===fragClone.nodeType?jQuery.makeArray(fragClone.childNodes):1===fragClone.nodeType?[fragClone]:[];callback.call(elem,fragClone),storeTmplItems(content),cloneIndex++}})}(jQuery),define("jquery.tmpl",(function(){})),function(n){var A=this||(0,eval)("this"),w=A.document,R=A.navigator,v=A.jQuery,H=A.JSON;v||"undefined"==typeof jQuery||(v=jQuery),function(n){"function"==typeof define&&define.amd?define("knockout",["exports","require"],n):"object"==typeof exports&&"object"==typeof module?n(module.exports||exports):n(A.ko={})}((function(S,T){function K(a,c){return(null===a||typeof a in W)&&a===c}function X(b,c){var d;return function(){d||(d=a.a.setTimeout((function(){d=n,b()}),c))}}function Y(b,c){var d;return function(){clearTimeout(d),d=a.a.setTimeout(b,c)}}function Z(a,c){c&&"change"!==c?"beforeChange"===c?this.pc(a):this.gb(a,c):this.qc(a)}function aa(a,c){null!==c&&c.s&&c.s()}function ba(a,c){var d=this.qd,e=d[r];e.ra||(this.Qb&&this.mb[c]?(d.uc(c,a,this.mb[c]),this.mb[c]=null,--this.Qb):e.I[c]||d.uc(c,a,e.J?{da:a}:d.$c(a)),a.Ja&&a.gd())}var b,c,d,e,f,g,a=void 0!==S?S:{};a.b=function(b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)e=e[d[f]];e[d[d.length-1]]=c},a.L=function(a,c,d){a[c]=d},a.version="3.5.1",a.b("version",a.version),a.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},a.a=function(){function b(a,b){for(var c in a)f.call(a,c)&&b(c,a[c])}function c(a,b){if(b)for(var c in b)f.call(b,c)&&(a[c]=b[c]);return a}function d(a,b){return a.__proto__=b,a}function e(b,c,d,e){var l=b[c].match(q)||[];a.a.D(d.match(q),(function(b){a.a.Na(l,b,e)})),b[c]=l.join(" ")}var f=Object.prototype.hasOwnProperty,g={__proto__:[]}instanceof Array,h="function"==typeof Symbol,m={},k={};m[R&&/Firefox\/2/i.test(R.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],m.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),b(m,(function(a,b){if(b.length)for(var c=0,d=b.length;c<d;c++)k[b[c]]=a}));var t,l={propertychange:!0},p=w&&function(){for(var a=3,b=w.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return 4<a?a:n}(),q=/\S+/g;return{Jc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],D:function(a,b,c){for(var d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a)},A:"function"==typeof Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b)}:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},Lb:function(a,b,c){for(var d=0,e=a.length;d<e;d++)if(b.call(c,a[d],d,a))return a[d];return n},Pa:function(b,c){var d=a.a.A(b,c);0<d?b.splice(d,1):0===d&&b.shift()},wc:function(b){var c=[];return b&&a.a.D(b,(function(b){0>a.a.A(c,b)&&c.push(b)})),c},Mb:function(a,b,c){var d=[];if(a)for(var e=0,l=a.length;e<l;e++)d.push(b.call(c,a[e],e));return d},jb:function(a,b,c){var d=[];if(a)for(var e=0,l=a.length;e<l;e++)b.call(c,a[e],e)&&d.push(a[e]);return d},Nb:function(a,b){if(b instanceof Array)a.push.apply(a,b);else for(var c=0,d=b.length;c<d;c++)a.push(b[c]);return a},Na:function(b,c,d){var e=a.a.A(a.a.bc(b),c);0>e?d&&b.push(c):d||b.splice(e,1)},Ba:g,extend:c,setPrototypeOf:d,Ab:g?d:c,P:b,Ga:function(a,b,c){if(!a)return a;var e,d={};for(e in a)f.call(a,e)&&(d[e]=b.call(c,a[e],e,a));return d},Tb:function(b){for(;b.firstChild;)a.removeNode(b.firstChild)},Yb:function(b){for(var c=((b=a.a.la(b))[0]&&b[0].ownerDocument||w).createElement("div"),d=0,e=b.length;d<e;d++)c.appendChild(a.oa(b[d]));return c},Ca:function(b,c){for(var d=0,e=b.length,l=[];d<e;d++){var k=b[d].cloneNode(!0);l.push(c?a.oa(k):k)}return l},va:function(b,c){if(a.a.Tb(b),c)for(var d=0,e=c.length;d<e;d++)b.appendChild(c[d])},Xc:function(b,c){var d=b.nodeType?[b]:b;if(0<d.length){for(var e=d[0],l=e.parentNode,k=0,f=c.length;k<f;k++)l.insertBefore(c[k],e);for(k=0,f=d.length;k<f;k++)a.removeNode(d[k])}},Ua:function(a,b){if(a.length){for(b=8===b.nodeType&&b.parentNode||b;a.length&&a[0].parentNode!==b;)a.splice(0,1);for(;1<a.length&&a[a.length-1].parentNode!==b;)a.length--;if(1<a.length){var c=a[0],d=a[a.length-1];for(a.length=0;c!==d;)a.push(c),c=c.nextSibling;a.push(d)}}return a},Zc:function(a,b){7>p?a.setAttribute("selected",b):a.selected=b},Db:function(a){return null===a||a===n?"":a.trim?a.trim():a.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Ud:function(a,b){return a=a||"",!(b.length>a.length)&&a.substring(0,b.length)===b},vd:function(a,b){if(a===b)return!0;if(11===a.nodeType)return!1;if(b.contains)return b.contains(1!==a.nodeType?a.parentNode:a);if(b.compareDocumentPosition)return!(16&~b.compareDocumentPosition(a));for(;a&&a!=b;)a=a.parentNode;return!!a},Sb:function(b){return a.a.vd(b,b.ownerDocument.documentElement)},kd:function(b){return!!a.a.Lb(b,a.a.Sb)},R:function(a){return a&&a.tagName&&a.tagName.toLowerCase()},Ac:function(b){return a.onError?function(){try{return b.apply(this,arguments)}catch(c){throw a.onError&&a.onError(c),c}}:b},setTimeout:function(b,c){return setTimeout(a.a.Ac(b),c)},Gc:function(b){setTimeout((function(){throw a.onError&&a.onError(b),b}),0)},B:function(b,c,d){var e=a.a.Ac(d);if(d=l[c],a.options.useOnlyNativeEvents||d||!v)if(d||"function"!=typeof b.addEventListener){if(void 0===b.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var k=function(a){e.call(b,a)},f="on"+c;b.attachEvent(f,k),a.a.K.za(b,(function(){b.detachEvent(f,k)}))}else b.addEventListener(c,e,!1);else t||(t="function"==typeof v(b).on?"on":"bind"),v(b)[t](c,e)},Fb:function(b,c){if(!b||!b.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var d;if(d=!("input"!==a.a.R(b)||!b.type||"click"!=c.toLowerCase())&&("checkbox"==(d=b.type)||"radio"==d),a.options.useOnlyNativeEvents||!v||d)if("function"==typeof w.createEvent){if("function"!=typeof b.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(d=w.createEvent(k[c]||"HTMLEvents")).initEvent(c,!0,!0,A,0,0,0,0,0,!1,!1,!1,!1,0,b),b.dispatchEvent(d)}else if(d&&b.click)b.click();else{if(void 0===b.fireEvent)throw Error("Browser doesn't support triggering events");b.fireEvent("on"+c)}else v(b).trigger(c)},f:function(b){return a.O(b)?b():b},bc:function(b){return a.O(b)?b.v():b},Eb:function(b,c,d){var l;c&&("object"==typeof b.classList?(l=b.classList[d?"add":"remove"],a.a.D(c.match(q),(function(a){l.call(b.classList,a)}))):"string"==typeof b.className.baseVal?e(b.className,"baseVal",c,d):e(b,"className",c,d))},Bb:function(b,c){var d=a.a.f(c);null!==d&&d!==n||(d="");var e=a.h.firstChild(b);!e||3!=e.nodeType||a.h.nextSibling(e)?a.h.va(b,[b.ownerDocument.createTextNode(d)]):e.data=d,a.a.Ad(b)},Yc:function(a,b){if(a.name=b,7>=p)try{var c=a.name.replace(/[&<>'"]/g,(function(a){return"&#"+a.charCodeAt(0)+";"}));a.mergeAttributes(w.createElement("<input name='"+c+"'/>"),!1)}catch(d){}},Ad:function(a){9<=p&&(a=1==a.nodeType?a:a.parentNode).style&&(a.style.zoom=a.style.zoom)},wd:function(a){if(p){var b=a.style.width;a.style.width=0,a.style.width=b}},Pd:function(b,c){b=a.a.f(b),c=a.a.f(c);for(var d=[],e=b;e<=c;e++)d.push(e);return d},la:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b},Da:function(a){return h?Symbol(a):a},Zd:6===p,$d:7===p,W:p,Lc:function(b,c){for(var d=a.a.la(b.getElementsByTagName("input")).concat(a.a.la(b.getElementsByTagName("textarea"))),e="string"==typeof c?function(a){return a.name===c}:function(a){return c.test(a.name)},l=[],k=d.length-1;0<=k;k--)e(d[k])&&l.push(d[k]);return l},Nd:function(b){return"string"==typeof b&&(b=a.a.Db(b))?H&&H.parse?H.parse(b):new Function("return "+b)():null},hc:function(b,c,d){if(!H||!H.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return H.stringify(a.a.f(b),c,d)},Od:function(c,d,e){var l=(e=e||{}).params||{},k=e.includeFields||this.Jc,f=c;if("object"==typeof c&&"form"===a.a.R(c)){f=c.action;for(var h=k.length-1;0<=h;h--)for(var g=a.a.Lc(c,k[h]),m=g.length-1;0<=m;m--)l[g[m].name]=g[m].value}d=a.a.f(d);var p=w.createElement("form");for(var q in p.style.display="none",p.action=f,p.method="post",d)(c=w.createElement("input")).type="hidden",c.name=q,c.value=a.a.hc(a.a.f(d[q])),p.appendChild(c);b(l,(function(a,b){var c=w.createElement("input");c.type="hidden",c.name=a,c.value=b,p.appendChild(c)})),w.body.appendChild(p),e.submitter?e.submitter(p):p.submit(),setTimeout((function(){p.parentNode.removeChild(p)}),0)}}}(),a.b("utils",a.a),a.b("utils.arrayForEach",a.a.D),a.b("utils.arrayFirst",a.a.Lb),a.b("utils.arrayFilter",a.a.jb),a.b("utils.arrayGetDistinctValues",a.a.wc),a.b("utils.arrayIndexOf",a.a.A),a.b("utils.arrayMap",a.a.Mb),a.b("utils.arrayPushAll",a.a.Nb),a.b("utils.arrayRemoveItem",a.a.Pa),a.b("utils.cloneNodes",a.a.Ca),a.b("utils.createSymbolOrString",a.a.Da),a.b("utils.extend",a.a.extend),a.b("utils.fieldsIncludedWithJsonPost",a.a.Jc),a.b("utils.getFormFields",a.a.Lc),a.b("utils.objectMap",a.a.Ga),a.b("utils.peekObservable",a.a.bc),a.b("utils.postJson",a.a.Od),a.b("utils.parseJson",a.a.Nd),a.b("utils.registerEventHandler",a.a.B),a.b("utils.stringifyJson",a.a.hc),a.b("utils.range",a.a.Pd),a.b("utils.toggleDomNodeCssClass",a.a.Eb),a.b("utils.triggerEvent",a.a.Fb),a.b("utils.unwrapObservable",a.a.f),a.b("utils.objectForEach",a.a.P),a.b("utils.addOrRemoveItem",a.a.Na),a.b("utils.setTextContent",a.a.Bb),a.b("unwrap",a.a.f),Function.prototype.bind||(Function.prototype.bind=function(a){var c=this;if(1===arguments.length)return function(){return c.apply(a,arguments)};var d=Array.prototype.slice.call(arguments,1);return function(){var e=d.slice(0);return e.push.apply(e,arguments),c.apply(a,e)}}),a.a.g=new function(){var e,f,b=0,c="__ko__"+(new Date).getTime(),d={};return a.a.W?(e=function(a,e){var f=a[c];if(!f||"null"===f||!d[f]){if(!e)return n;f=a[c]="ko"+b++,d[f]={}}return d[f]},f=function(a){var b=a[c];return!!b&&(delete d[b],a[c]=null,!0)}):(e=function(a,b){var d=a[c];return!d&&b&&(d=a[c]={}),d},f=function(a){return!!a[c]&&(delete a[c],!0)}),{get:function(a,b){var c=e(a,!1);return c&&c[b]},set:function(a,b,c){(a=e(a,c!==n))&&(a[b]=c)},Ub:function(a,b,c){return(a=e(a,!0))[b]||(a[b]=c)},clear:f,Z:function(){return b+++c}}},a.b("utils.domData",a.a.g),a.b("utils.domData.clear",a.a.g.clear),a.a.K=new function(){function b(b,c){var d=a.a.g.get(b,e);return d===n&&c&&(d=[],a.a.g.set(b,e,d)),d}function c(c){if(e=b(c,!1))for(var e=e.slice(0),k=0;k<e.length;k++)e[k](c);a.a.g.clear(c),a.a.K.cleanExternalData(c),g[c.nodeType]&&d(c.childNodes,!0)}function d(b,d){for(var l,e=[],f=0;f<b.length;f++)if((!d||8===b[f].nodeType)&&(c(e[e.length]=l=b[f]),b[f]!==l))for(;f--&&-1==a.a.A(e,b[f]););}var e=a.a.g.Z(),f={1:!0,8:!0,9:!0},g={1:!0,9:!0};return{za:function(a,c){if("function"!=typeof c)throw Error("Callback must be a function");b(a,!0).push(c)},yb:function(c,d){var f=b(c,!1);f&&(a.a.Pa(f,d),0==f.length&&a.a.g.set(c,e,n))},oa:function(b){return a.u.G((function(){f[b.nodeType]&&(c(b),g[b.nodeType]&&d(b.getElementsByTagName("*")))})),b},removeNode:function(b){a.oa(b),b.parentNode&&b.parentNode.removeChild(b)},cleanExternalData:function(a){v&&"function"==typeof v.cleanData&&v.cleanData([a])}}},a.oa=a.a.K.oa,a.removeNode=a.a.K.removeNode,a.b("cleanNode",a.oa),a.b("removeNode",a.removeNode),a.b("utils.domNodeDisposal",a.a.K),a.b("utils.domNodeDisposal.addDisposeCallback",a.a.K.za),a.b("utils.domNodeDisposal.removeDisposeCallback",a.a.K.yb),b=[0,"",""],f={thead:c=[1,"<table>","</table>"],tbody:c,tfoot:c,tr:[2,"<table><tbody>","</tbody></table>"],td:d=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:d,option:e=[1,"<select multiple='multiple'>","</select>"],optgroup:e},g=8>=a.a.W,a.a.ua=function(c,d){var e;if(v){if(v.parseHTML)e=v.parseHTML(c,d)||[];else if((e=v.clean([c],d))&&e[0]){for(var l=e[0];l.parentNode&&11!==l.parentNode.nodeType;)l=l.parentNode;l.parentNode&&l.parentNode.removeChild(l)}}else{(e=d)||(e=w),l=e.parentWindow||e.defaultView||A;var t,p=a.a.Db(c).toLowerCase(),q=e.createElement("div");for(t=(p=p.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&f[p[1]]||b,p=t[0],t="ignored<div>"+t[1]+c+t[2]+"</div>","function"==typeof l.innerShiv?q.appendChild(l.innerShiv(t)):(g&&e.body.appendChild(q),q.innerHTML=t,g&&q.parentNode.removeChild(q));p--;)q=q.lastChild;e=a.a.la(q.lastChild.childNodes)}return e},a.a.Md=function(b,c){var d=a.a.ua(b,c);return d.length&&d[0].parentElement||a.a.Yb(d)},a.a.fc=function(b,c){if(a.a.Tb(b),null!==(c=a.a.f(c))&&c!==n)if("string"!=typeof c&&(c=c.toString()),v)v(b).html(c);else for(var d=a.a.ua(c,b.ownerDocument),e=0;e<d.length;e++)b.appendChild(d[e])},a.b("utils.parseHtmlFragment",a.a.ua),a.b("utils.setHtml",a.a.fc),a.aa=function(){function b(c,e){if(c)if(8==c.nodeType)null!=(f=a.aa.Uc(c.nodeValue))&&e.push({ud:c,Kd:f});else if(1==c.nodeType)for(var f=0,g=c.childNodes,h=g.length;f<h;f++)b(g[f],e)}var c={};return{Xb:function(a){if("function"!=typeof a)throw Error("You can only pass a function to ko.memoization.memoize()");var b=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return c[b]=a,"\x3c!--[ko_memo:"+b+"]--\x3e"},bd:function(a,b){var f=c[a];if(f===n)throw Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized.");try{return f.apply(null,b||[]),!0}finally{delete c[a]}},cd:function(c,e){var f=[];b(c,f);for(var g=0,h=f.length;g<h;g++){var m=f[g].ud,k=[m];e&&a.a.Nb(k,e),a.aa.bd(f[g].Kd,k),m.nodeValue="",m.parentNode&&m.parentNode.removeChild(m)}},Uc:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:null}}}(),a.b("memoization",a.aa),a.b("memoization.memoize",a.aa.Xb),a.b("memoization.unmemoize",a.aa.bd),a.b("memoization.parseMemoText",a.aa.Uc),a.b("memoization.unmemoizeDomNodeAndDescendants",a.aa.cd),a.na=function(){function b(){if(f)for(var d,b=f,c=0;h<f;)if(d=e[h++]){if(h>b){if(5e3<=++c){h=f,a.a.Gc(Error("'Too much recursion' after processing "+c+" task groups."));break}b=f}try{d()}catch(p){a.a.Gc(p)}}}function c(){b(),h=f=e.length=0}var d,e=[],f=0,g=1,h=0;return d=A.MutationObserver?function(a){var b=w.createElement("div");return new MutationObserver(a).observe(b,{attributes:!0}),function(){b.classList.toggle("foo")}}(c):w&&"onreadystatechange"in w.createElement("script")?function(a){var b=w.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=null,w.documentElement.removeChild(b),b=null,a()},w.documentElement.appendChild(b)}:function(a){setTimeout(a,0)},{scheduler:d,zb:function(b){return f||a.na.scheduler(c),e[f++]=b,g++},cancel:function(a){(a-=g-f)>=h&&a<f&&(e[a]=null)},resetForTesting:function(){var a=f-h;return h=f=e.length=0,a},Sd:b}}(),a.b("tasks",a.na),a.b("tasks.schedule",a.na.zb),a.b("tasks.runEarly",a.na.Sd),a.Ta={throttle:function(b,c){b.throttleEvaluation=c;var d=null;return a.$({read:b,write:function(e){clearTimeout(d),d=a.a.setTimeout((function(){b(e)}),c)}})},rateLimit:function(a,c){var d,e,f;"number"==typeof c?d=c:(d=c.timeout,e=c.method),a.Hb=!1,f="function"==typeof e?e:"notifyWhenChangesStop"==e?Y:X,a.ub((function(a){return f(a,d,c)}))},deferred:function(b,c){if(!0!==c)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");b.Hb||(b.Hb=!0,b.ub((function(c){var e,f=!1;return function(){if(!f){a.na.cancel(e),e=a.na.zb(c);try{f=!0,b.notifySubscribers(n,"dirty")}finally{f=!1}}}})))},notify:function(a,c){a.equalityComparer="always"==c?null:K}};var W={undefined:1,boolean:1,number:1,string:1};a.b("extenders",a.Ta),a.ic=function(b,c,d){this.da=b,this.lc=c,this.mc=d,this.Ib=!1,this.fb=this.Jb=null,a.L(this,"dispose",this.s),a.L(this,"disposeWhenNodeIsRemoved",this.l)},a.ic.prototype.s=function(){this.Ib||(this.fb&&a.a.K.yb(this.Jb,this.fb),this.Ib=!0,this.mc(),this.da=this.lc=this.mc=this.Jb=this.fb=null)},a.ic.prototype.l=function(b){this.Jb=b,a.a.K.za(b,this.fb=this.s.bind(this))},a.T=function(){a.a.Ab(this,D),D.qb(this)};var D={qb:function(a){a.U={change:[]},a.sc=1},subscribe:function(b,c,d){var e=this;d=d||"change";var f=new a.ic(e,c?b.bind(c):b,(function(){a.a.Pa(e.U[d],f),e.hb&&e.hb(d)}));return e.Qa&&e.Qa(d),e.U[d]||(e.U[d]=[]),e.U[d].push(f),f},notifySubscribers:function(b,c){if("change"===(c=c||"change")&&this.Gb(),this.Wa(c)){var d="change"===c&&this.ed||this.U[c].slice(0);try{a.u.xc();for(var f,e=0;f=d[e];++e)f.Ib||f.lc(b)}finally{a.u.end()}}},ob:function(){return this.sc},Dd:function(a){return this.ob()!==a},Gb:function(){++this.sc},ub:function(b){var e,f,g,h,m,c=this,d=a.O(c);c.gb||(c.gb=c.notifySubscribers,c.notifySubscribers=Z);var k=b((function(){c.Ja=!1,d&&h===c&&(h=c.nc?c.nc():c());var a=f||m&&c.sb(g,h);m=f=e=!1,a&&c.gb(g=h)}));c.qc=function(a,b){b&&c.Ja||(m=!b),c.ed=c.U.change.slice(0),c.Ja=e=!0,h=a,k()},c.pc=function(a){e||(g=a,c.gb(a,"beforeChange"))},c.rc=function(){m=!0},c.gd=function(){c.sb(g,c.v(!0))&&(f=!0)}},Wa:function(a){return this.U[a]&&this.U[a].length},Bd:function(b){if(b)return this.U[b]&&this.U[b].length||0;var c=0;return a.a.P(this.U,(function(a,b){"dirty"!==a&&(c+=b.length)})),c},sb:function(a,c){return!this.equalityComparer||!this.equalityComparer(a,c)},toString:function(){return"[object Object]"},extend:function(b){var c=this;return b&&a.a.P(b,(function(b,e){var f=a.Ta[b];"function"==typeof f&&(c=f(c,e)||c)})),c}};a.L(D,"init",D.qb),a.L(D,"subscribe",D.subscribe),a.L(D,"extend",D.extend),a.L(D,"getSubscriptionsCount",D.Bd),a.a.Ba&&a.a.setPrototypeOf(D,Function.prototype),a.T.fn=D,a.Qc=function(a){return null!=a&&"function"==typeof a.subscribe&&"function"==typeof a.notifySubscribers},a.b("subscribable",a.T),a.b("isSubscribable",a.Qc),a.S=a.u=function(){function b(a){d.push(e),e=a}function c(){e=d.pop()}var e,d=[],f=0;return{xc:b,end:c,cc:function(b){if(e){if(!a.Qc(b))throw Error("Only subscribable things can act as dependencies");e.od.call(e.pd,b,b.fd||(b.fd=++f))}},G:function(a,d,e){try{return b(),a.apply(d,e||[])}finally{c()}},qa:function(){if(e)return e.o.qa()},Va:function(){if(e)return e.o.Va()},Ya:function(){if(e)return e.Ya},o:function(){if(e)return e.o}}}(),a.b("computedContext",a.S),a.b("computedContext.getDependenciesCount",a.S.qa),a.b("computedContext.getDependencies",a.S.Va),a.b("computedContext.isInitial",a.S.Ya),a.b("computedContext.registerDependency",a.S.cc),a.b("ignoreDependencies",a.Yd=a.u.G);var I=a.a.Da("_latestValue");a.ta=function(b){function c(){return 0<arguments.length?(c.sb(c[I],arguments[0])&&(c.ya(),c[I]=arguments[0],c.xa()),this):(a.u.cc(c),c[I])}return c[I]=b,a.a.Ba||a.a.extend(c,a.T.fn),a.T.fn.qb(c),a.a.Ab(c,F),a.options.deferUpdates&&a.Ta.deferred(c,!0),c};var F={equalityComparer:K,v:function(){return this[I]},xa:function(){this.notifySubscribers(this[I],"spectate"),this.notifySubscribers(this[I])},ya:function(){this.notifySubscribers(this[I],"beforeChange")}};a.a.Ba&&a.a.setPrototypeOf(F,a.T.fn);var G=a.ta.Ma="__ko_proto__";F[G]=a.ta,a.O=function(b){if((b="function"==typeof b&&b[G])&&b!==F[G]&&b!==a.o.fn[G])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!b},a.Za=function(b){return"function"==typeof b&&(b[G]===F[G]||b[G]===a.o.fn[G]&&b.Nc)},a.b("observable",a.ta),a.b("isObservable",a.O),a.b("isWriteableObservable",a.Za),a.b("isWritableObservable",a.Za),a.b("observable.fn",F),a.L(F,"peek",F.v),a.L(F,"valueHasMutated",F.xa),a.L(F,"valueWillMutate",F.ya),a.Ha=function(b){if("object"!=typeof(b=b||[])||!("length"in b))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return b=a.ta(b),a.a.Ab(b,a.Ha.fn),b.extend({trackArrayChanges:!0})},a.Ha.fn={remove:function(b){for(var c=this.v(),d=[],e="function"!=typeof b||a.O(b)?function(a){return a===b}:b,f=0;f<c.length;f++){var g=c[f];if(e(g)){if(0===d.length&&this.ya(),c[f]!==g)throw Error("Array modified during remove; cannot remove item");d.push(g),c.splice(f,1),f--}}return d.length&&this.xa(),d},removeAll:function(b){if(b===n){var c=this.v(),d=c.slice(0);return this.ya(),c.splice(0,c.length),this.xa(),d}return b?this.remove((function(c){return 0<=a.a.A(b,c)})):[]},destroy:function(b){var c=this.v(),d="function"!=typeof b||a.O(b)?function(a){return a===b}:b;this.ya();for(var e=c.length-1;0<=e;e--){var f=c[e];d(f)&&(f._destroy=!0)}this.xa()},destroyAll:function(b){return b===n?this.destroy((function(){return!0})):b?this.destroy((function(c){return 0<=a.a.A(b,c)})):[]},indexOf:function(b){var c=this();return a.a.A(c,b)},replace:function(a,c){var d=this.indexOf(a);0<=d&&(this.ya(),this.v()[d]=c,this.xa())},sorted:function(a){var c=this().slice(0);return a?c.sort(a):c.sort()},reversed:function(){return this().slice(0).reverse()}},a.a.Ba&&a.a.setPrototypeOf(a.Ha.fn,a.ta.fn),a.a.D("pop push reverse shift sort splice unshift".split(" "),(function(b){a.Ha.fn[b]=function(){var a=this.v();this.ya(),this.zc(a,b,arguments);var d=a[b].apply(a,arguments);return this.xa(),d===a?this:d}})),a.a.D(["slice"],(function(b){a.Ha.fn[b]=function(){var a=this();return a[b].apply(a,arguments)}})),a.Pc=function(b){return a.O(b)&&"function"==typeof b.remove&&"function"==typeof b.push},a.b("observableArray",a.Ha),a.b("isObservableArray",a.Pc),a.Ta.trackArrayChanges=function(b,c){function d(){function c(){if(m){var e,d=[].concat(b.v()||[]);b.Wa("arrayChange")&&((!f||1<m)&&(f=a.a.Pb(k,d,b.Ob)),e=f),k=d,f=null,m=0,e&&e.length&&b.notifySubscribers(e,"arrayChange")}}e?c():(e=!0,h=b.subscribe((function(){++m}),null,"spectate"),k=[].concat(b.v()||[]),f=null,g=b.subscribe(c))}if(b.Ob={},c&&"object"==typeof c&&a.a.extend(b.Ob,c),b.Ob.sparse=!0,!b.zc){var g,h,k,e=!1,f=null,m=0,l=b.Qa,p=b.hb;b.Qa=function(a){l&&l.call(b,a),"arrayChange"===a&&d()},b.hb=function(a){p&&p.call(b,a),"arrayChange"!==a||b.Wa("arrayChange")||(g&&g.s(),h&&h.s(),h=g=null,e=!1,k=n)},b.zc=function(b,c,d){function l(a,b,c){return k[k.length]={status:a,value:b,index:c}}if(e&&!m){var k=[],p=b.length,g=d.length,h=0;switch(c){case"push":h=p;case"unshift":for(c=0;c<g;c++)l("added",d[c],h+c);break;case"pop":h=p-1;case"shift":p&&l("deleted",b[h],h);break;case"splice":c=Math.min(Math.max(0,0>d[0]?p+d[0]:d[0]),p),p=1===g?p:Math.min(c+(d[1]||0),p),g=c+g-2,h=Math.max(p,g);for(var U=[],L=[],n=2;c<h;++c,++n)c<p&&L.push(l("deleted",b[c],c)),c<g&&U.push(l("added",d[n],c));a.a.Kc(L,U);break;default:return}f=k}}}};var r=a.a.Da("_state");a.o=a.$=function(b,c,d){function e(){if(0<arguments.length){if("function"!=typeof f)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return f.apply(g.nb,arguments),this}return g.ra||a.u.cc(e),(g.ka||g.J&&e.Xa())&&e.ha(),g.X}if("object"==typeof b?d=b:(d=d||{},b&&(d.read=b)),"function"!=typeof d.read)throw Error("Pass a function that returns the value of the ko.computed");var f=d.write,g={X:n,sa:!0,ka:!0,rb:!1,jc:!1,ra:!1,wb:!1,J:!1,Wc:d.read,nb:c||d.owner,l:d.disposeWhenNodeIsRemoved||d.l||null,Sa:d.disposeWhen||d.Sa,Rb:null,I:{},V:0,Ic:null};return e[r]=g,e.Nc="function"==typeof f,a.a.Ba||a.a.extend(e,a.T.fn),a.T.fn.qb(e),a.a.Ab(e,C),d.pure?(g.wb=!0,g.J=!0,a.a.extend(e,da)):d.deferEvaluation&&a.a.extend(e,ea),a.options.deferUpdates&&a.Ta.deferred(e,!0),g.l&&(g.jc=!0,g.l.nodeType||(g.l=null)),g.J||d.deferEvaluation||e.ha(),g.l&&e.ja()&&a.a.K.za(g.l,g.Rb=function(){e.s()}),e};var C={equalityComparer:K,qa:function(){return this[r].V},Va:function(){var b=[];return a.a.P(this[r].I,(function(a,d){b[d.Ka]=d.da})),b},Vb:function(b){if(!this[r].V)return!1;var c=this.Va();return-1!==a.a.A(c,b)||!!a.a.Lb(c,(function(a){return a.Vb&&a.Vb(b)}))},uc:function(a,c,d){if(this[r].wb&&c===this)throw Error("A 'pure' computed must not be called recursively");this[r].I[a]=d,d.Ka=this[r].V++,d.La=c.ob()},Xa:function(){var a,c,d=this[r].I;for(a in d)if(Object.prototype.hasOwnProperty.call(d,a)&&(c=d[a],this.Ia&&c.da.Ja||c.da.Dd(c.La)))return!0},Jd:function(){this.Ia&&!this[r].rb&&this.Ia(!1)},ja:function(){var a=this[r];return a.ka||0<a.V},Rd:function(){this.Ja?this[r].ka&&(this[r].sa=!0):this.Hc()},$c:function(a){if(a.Hb){var c=a.subscribe(this.Jd,this,"dirty"),d=a.subscribe(this.Rd,this);return{da:a,s:function(){c.s(),d.s()}}}return a.subscribe(this.Hc,this)},Hc:function(){var b=this,c=b.throttleEvaluation;c&&0<=c?(clearTimeout(this[r].Ic),this[r].Ic=a.a.setTimeout((function(){b.ha(!0)}),c)):b.Ia?b.Ia(!0):b.ha(!0)},ha:function(b){var c=this[r],d=c.Sa,e=!1;if(!c.rb&&!c.ra){if(c.l&&!a.a.Sb(c.l)||d&&d()){if(!c.jc)return void this.s()}else c.jc=!1;c.rb=!0;try{e=this.zd(b)}finally{c.rb=!1}return e}},zd:function(b){var c=this[r],d=!1,e=c.wb?n:!c.V;d={qd:this,mb:c.I,Qb:c.V},a.u.xc({pd:d,od:ba,o:this,Ya:e}),c.I={},c.V=0;var f=this.yd(c,d);return c.V?d=this.sb(c.X,f):(this.s(),d=!0),d&&(c.J?this.Gb():this.notifySubscribers(c.X,"beforeChange"),c.X=f,this.notifySubscribers(c.X,"spectate"),!c.J&&b&&this.notifySubscribers(c.X),this.rc&&this.rc()),e&&this.notifySubscribers(c.X,"awake"),d},yd:function(b,c){try{var d=b.Wc;return b.nb?d.call(b.nb):d()}finally{a.u.end(),c.Qb&&!b.J&&a.a.P(c.mb,aa),b.sa=b.ka=!1}},v:function(a){var c=this[r];return(c.ka&&(a||!c.V)||c.J&&this.Xa())&&this.ha(),c.X},ub:function(b){a.T.fn.ub.call(this,b),this.nc=function(){return this[r].J||(this[r].sa?this.ha():this[r].ka=!1),this[r].X},this.Ia=function(a){this.pc(this[r].X),this[r].ka=!0,a&&(this[r].sa=!0),this.qc(this,!a)}},s:function(){var b=this[r];!b.J&&b.I&&a.a.P(b.I,(function(a,b){b.s&&b.s()})),b.l&&b.Rb&&a.a.K.yb(b.l,b.Rb),b.I=n,b.V=0,b.ra=!0,b.sa=!1,b.ka=!1,b.J=!1,b.l=n,b.Sa=n,b.Wc=n,this.Nc||(b.nb=n)}},da={Qa:function(b){var c=this,d=c[r];if(!d.ra&&d.J&&"change"==b){if(d.J=!1,d.sa||c.Xa())d.I=null,d.V=0,c.ha()&&c.Gb();else{var e=[];a.a.P(d.I,(function(a,b){e[b.Ka]=a})),a.a.D(e,(function(a,b){var e=d.I[a],m=c.$c(e.da);m.Ka=b,m.La=e.La,d.I[a]=m})),c.Xa()&&c.ha()&&c.Gb()}d.ra||c.notifySubscribers(d.X,"awake")}},hb:function(b){var c=this[r];c.ra||"change"!=b||this.Wa("change")||(a.a.P(c.I,(function(a,b){b.s&&(c.I[a]={da:b.da,Ka:b.Ka,La:b.La},b.s())})),c.J=!0,this.notifySubscribers(n,"asleep"))},ob:function(){var b=this[r];return b.J&&(b.sa||this.Xa())&&this.ha(),a.T.fn.ob.call(this)}},ea={Qa:function(a){"change"!=a&&"beforeChange"!=a||this.v()}};a.a.Ba&&a.a.setPrototypeOf(C,a.T.fn);var N=a.ta.Ma;C[N]=a.o,a.Oc=function(a){return"function"==typeof a&&a[N]===C[N]},a.Fd=function(b){return a.Oc(b)&&b[r]&&b[r].wb},a.b("computed",a.o),a.b("dependentObservable",a.o),a.b("isComputed",a.Oc),a.b("isPureComputed",a.Fd),a.b("computed.fn",C),a.L(C,"peek",C.v),a.L(C,"dispose",C.s),a.L(C,"isActive",C.ja),a.L(C,"getDependenciesCount",C.qa),a.L(C,"getDependencies",C.Va),a.xb=function(b,c){return"function"==typeof b?a.o(b,c,{pure:!0}):((b=a.a.extend({},b)).pure=!0,a.o(b,c))},a.b("pureComputed",a.xb),function(){function b(a,f,g){if(g=g||new d,"object"!=typeof(a=f(a))||null===a||a===n||a instanceof RegExp||a instanceof Date||a instanceof String||a instanceof Number||a instanceof Boolean)return a;var h=a instanceof Array?[]:{};return g.save(a,h),function(a,b){if(a instanceof Array){for(var c=0;c<a.length;c++)b(c);"function"==typeof a.toJSON&&b("toJSON")}else for(c in a)b(c)}(a,(function(c){var d=f(a[c]);switch(typeof d){case"boolean":case"number":case"string":case"function":h[c]=d;break;case"object":case"undefined":var l=g.get(d);h[c]=l!==n?l:b(d,f,g)}})),h}function d(){this.keys=[],this.values=[]}a.ad=function(c){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return b(c,(function(b){for(var c=0;a.O(b)&&10>c;c++)b=b();return b}))},a.toJSON=function(b,c,d){return b=a.ad(b),a.a.hc(b,c,d)},d.prototype={constructor:d,save:function(b,c){var d=a.a.A(this.keys,b);0<=d?this.values[d]=c:(this.keys.push(b),this.values.push(c))},get:function(b){return 0<=(b=a.a.A(this.keys,b))?this.values[b]:n}}}(),a.b("toJS",a.ad),a.b("toJSON",a.toJSON),a.Wd=function(b,c,d){function e(c){var e=a.xb(b,d).extend({ma:"always"}),h=e.subscribe((function(a){a&&(h.s(),c(a))}));return e.notifySubscribers(e.v()),h}return"function"!=typeof Promise||c?e(c.bind(d)):new Promise(e)},a.b("when",a.Wd),a.w={M:function(b){switch(a.a.R(b)){case"option":return!0===b.__ko__hasDomDataOptionValue__?a.a.g.get(b,a.c.options.$b):7>=a.a.W?b.getAttributeNode("value")&&b.getAttributeNode("value").specified?b.value:b.text:b.value;case"select":return 0<=b.selectedIndex?a.w.M(b.options[b.selectedIndex]):n;default:return b.value}},cb:function(b,c,d){switch(a.a.R(b)){case"option":"string"==typeof c?(a.a.g.set(b,a.c.options.$b,n),"__ko__hasDomDataOptionValue__"in b&&delete b.__ko__hasDomDataOptionValue__,b.value=c):(a.a.g.set(b,a.c.options.$b,c),b.__ko__hasDomDataOptionValue__=!0,b.value="number"==typeof c?c:"");break;case"select":""!==c&&null!==c||(c=n);for(var h,e=-1,f=0,g=b.options.length;f<g;++f)if((h=a.w.M(b.options[f]))==c||""===h&&c===n){e=f;break}(d||0<=e||c===n&&1<b.size)&&(b.selectedIndex=e,6===a.a.W&&a.a.setTimeout((function(){b.selectedIndex=e}),0));break;default:null!==c&&c!==n||(c=""),b.value=c}}},a.b("selectExtensions",a.w),a.b("selectExtensions.readValue",a.w.M),a.b("selectExtensions.writeValue",a.w.cb),a.m=function(){function b(b){123===(b=a.a.Db(b)).charCodeAt(0)&&(b=b.slice(1,-1));var p,c=[],d=(b+="\n,").match(e),q=[],h=0;if(1<d.length){for(var B,x=0;B=d[x];++x){var u=B.charCodeAt(0);if(44===u){if(0>=h){c.push(p&&q.length?{key:p,value:q.join("")}:{unknown:p||q.join("")}),p=h=0,q=[];continue}}else if(58===u){if(!h&&!p&&1===q.length){p=q.pop();continue}}else{if(47===u&&1<B.length&&(47===B.charCodeAt(1)||42===B.charCodeAt(1)))continue;47===u&&x&&1<B.length?(u=d[x-1].match(f))&&!g[u[0]]&&(d=(b=b.substr(b.indexOf(B)+1)).match(e),x=-1,B="/"):40===u||123===u||91===u?++h:41===u||125===u||93===u?--h:p||q.length||34!==u&&39!==u||(B=B.slice(1,-1))}q.push(B)}if(0<h)throw Error("Unbalanced parentheses, braces, or brackets")}return c}var c=["true","false","null","undefined"],d=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,e=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),f=/[\])"'A-Za-z0-9_$]+$/,g={in:1,return:1,typeof:1},h={};return{Ra:[],wa:h,ac:b,vb:function(e,f){function l(b,e){var f;if(!x){var k=a.getBindingHandler(b);if(k&&k.preprocess&&!(e=k.preprocess(e,b,l)))return;(k=h[b])&&(f=e,0<=a.a.A(c,f)?f=!1:(k=f.match(d),f=null!==k&&(k[1]?"Object("+k[1]+")"+k[2]:f)),k=f),k&&q.push("'"+("string"==typeof h[b]?h[b]:b)+"':function(_z){"+f+"=_z}")}g&&(e="function(){return "+e+" }"),p.push("'"+b+"':"+e)}var p=[],q=[],g=(f=f||{}).valueAccessors,x=f.bindingParams,B="string"==typeof e?b(e):e;return a.a.D(B,(function(a){l(a.key||a.unknown,a.value)})),q.length&&l("_ko_property_writers","{"+q.join(",")+" }"),p.join(",")},Id:function(a,b){for(var c=0;c<a.length;c++)if(a[c].key==b)return!0;return!1},eb:function(b,c,d,e,f){b&&a.O(b)?!a.Za(b)||f&&b.v()===e||b(e):(b=c.get("_ko_property_writers"))&&b[d]&&b[d](e)}}}(),a.b("expressionRewriting",a.m),a.b("expressionRewriting.bindingRewriteValidators",a.m.Ra),a.b("expressionRewriting.parseObjectLiteral",a.m.ac),a.b("expressionRewriting.preProcessBindings",a.m.vb),a.b("expressionRewriting._twoWayBindings",a.m.wa),a.b("jsonExpressionRewriting",a.m),a.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",a.m.vb),function(){function b(a){return 8==a.nodeType&&g.test(f?a.text:a.nodeValue)}function c(a){return 8==a.nodeType&&h.test(f?a.text:a.nodeValue)}function d(d,e){for(var f=d,h=1,g=[];f=f.nextSibling;){if(c(f)&&(a.a.g.set(f,k,!0),0==--h))return g;g.push(f),b(f)&&h++}if(!e)throw Error("Cannot find closing comment tag to match: "+d.nodeValue);return null}function e(a,b){var c=d(a,b);return c?0<c.length?c[c.length-1].nextSibling:a.nextSibling:null}var f=w&&"\x3c!--test--\x3e"===w.createComment("test").text,g=f?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,h=f?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,m={ul:!0,ol:!0},k="__ko_matchedEndComment__";a.h={ea:{},childNodes:function(a){return b(a)?d(a):a.childNodes},Ea:function(c){if(b(c))for(var d=0,e=(c=a.h.childNodes(c)).length;d<e;d++)a.removeNode(c[d]);else a.a.Tb(c)},va:function(c,d){if(b(c)){a.h.Ea(c);for(var e=c.nextSibling,f=0,k=d.length;f<k;f++)e.parentNode.insertBefore(d[f],e)}else a.a.va(c,d)},Vc:function(a,c){var d;b(a)?(d=a.nextSibling,a=a.parentNode):d=a.firstChild,d?c!==d&&a.insertBefore(c,d):a.appendChild(c)},Wb:function(c,d,e){e?(e=e.nextSibling,b(c)&&(c=c.parentNode),e?d!==e&&c.insertBefore(d,e):c.appendChild(d)):a.h.Vc(c,d)},firstChild:function(a){if(b(a))return!a.nextSibling||c(a.nextSibling)?null:a.nextSibling;if(a.firstChild&&c(a.firstChild))throw Error("Found invalid end comment, as the first child of "+a);return a.firstChild},nextSibling:function(d){if(b(d)&&(d=e(d)),d.nextSibling&&c(d.nextSibling)){var f=d.nextSibling;if(c(f)&&!a.a.g.get(f,k))throw Error("Found end comment without a matching opening comment, as child of "+d);return null}return d.nextSibling},Cd:b,Vd:function(a){return(a=(f?a.text:a.nodeValue).match(g))?a[1]:null},Sc:function(d){if(m[a.a.R(d)]){var f=d.firstChild;if(f)do{if(1===f.nodeType){var k,h=null;if(k=f.firstChild)do{if(h)h.push(k);else if(b(k)){var g=e(k,!0);g?k=g:h=[k]}else c(k)&&(h=[k])}while(k=k.nextSibling);if(k=h)for(h=f.nextSibling,g=0;g<k.length;g++)h?d.insertBefore(k[g],h):d.appendChild(k[g])}}while(f=f.nextSibling)}}}}(),a.b("virtualElements",a.h),a.b("virtualElements.allowedBindings",a.h.ea),a.b("virtualElements.emptyNode",a.h.Ea),a.b("virtualElements.insertAfter",a.h.Wb),a.b("virtualElements.prepend",a.h.Vc),a.b("virtualElements.setDomNodeChildren",a.h.va),a.ga=function(){this.nd={}},a.a.extend(a.ga.prototype,{nodeHasBindings:function(b){switch(b.nodeType){case 1:return null!=b.getAttribute("data-bind")||a.j.getComponentNameForNode(b);case 8:return a.h.Cd(b);default:return!1}},getBindings:function(b,c){var d=(d=this.getBindingsString(b,c))?this.parseBindingsString(d,c,b):null;return a.j.tc(d,b,c,!1)},getBindingAccessors:function(b,c){var d=(d=this.getBindingsString(b,c))?this.parseBindingsString(d,c,b,{valueAccessors:!0}):null;return a.j.tc(d,b,c,!0)},getBindingsString:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind");case 8:return a.h.Vd(b);default:return null}},parseBindingsString:function(b,c,d,e){try{var h,f=this.nd,g=b+(e&&e.valueAccessors||"");if(!(h=f[g])){var m,k="with($context){with($data||{}){return{"+a.m.vb(b,e)+"}}}";m=new Function("$context","$element",k),h=f[g]=m}return h(c,d)}catch(l){throw l.message="Unable to parse bindings.\nBindings value: "+b+"\nMessage: "+l.message,l}}}),a.ga.instance=new a.ga,a.b("bindingProvider",a.ga),function(){function b(b){var c=(b=a.a.g.get(b,z))&&b.N;c&&(b.N=null,c.Tc())}function c(c,d,e){this.node=c,this.yc=d,this.kb=[],this.H=!1,d.N||a.a.K.za(c,b),e&&e.N&&(e.N.kb.push(c),this.Kb=e)}function d(a){return function(){return a}}function e(a){return a()}function f(b){return a.a.Ga(a.u.G(b),(function(a,c){return function(){return b()[c]}}))}function g(b,c,e){return"function"==typeof b?f(b.bind(null,c,e)):a.a.Ga(b,d)}function h(a,b){return f(this.getBindings.bind(this,a,b))}function m(b,c){var d=a.h.firstChild(c);if(d){var e,f=a.ga.instance,l=f.preprocessNode;if(l){for(;e=d;)d=a.h.nextSibling(e),l.call(f,e);d=a.h.firstChild(c)}for(;e=d;)d=a.h.nextSibling(e),k(b,e)}a.i.ma(c,a.i.H)}function k(b,c){var d=b,e=1===c.nodeType;e&&a.h.Sc(c),(e||a.ga.instance.nodeHasBindings(c))&&(d=p(c,null,b).bindingContextForDescendants),d&&!u[a.a.R(c)]&&m(d,c)}function p(b,c,d){var g,f=a.a.g.Ub(b,z,{}),k=f.hd;if(!c){if(k)throw Error("You cannot apply bindings multiple times to the same element.");f.hd=!0}if(k||(f.context=d),f.Zb||(f.Zb={}),c&&"function"!=typeof c)g=c;else{var p=a.ga.instance,q=p.getBindingAccessors||h,m=a.$((function(){return(g=c?c(d,b):q.call(p,b,d))&&(d[t]&&d[t](),d[B]&&d[B]()),g}),null,{l:b});g&&m.ja()||(m=null)}var u,x=d;if(g){var J=function(){return a.a.Ga(m?m():g,e)},r=m?function(a){return function(){return e(m()[a])}}:function(a){return g[a]};J.get=function(a){return g[a]&&e(r(a))},J.has=function(a){return a in g},a.i.H in g&&a.i.subscribe(b,a.i.H,(function(){var c=(0,g[a.i.H])();if(c){var d=a.h.childNodes(b);d.length&&c(d,a.Ec(d[0]))}})),a.i.pa in g&&(x=a.i.Cb(b,d),a.i.subscribe(b,a.i.pa,(function(){var c=(0,g[a.i.pa])();c&&a.h.firstChild(b)&&c(b)}))),f=function(b){var c=[],d={},e=[];return a.a.P(b,(function ca(f){if(!d[f]){var k=a.getBindingHandler(f);k&&(k.after&&(e.push(f),a.a.D(k.after,(function(c){if(b[c]){if(-1!==a.a.A(e,c))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+e.join(", "));ca(c)}})),e.length--),c.push({key:f,Mc:k})),d[f]=!0}})),c}(g),a.a.D(f,(function(c){var d=c.Mc.init,e=c.Mc.update,f=c.key;if(8===b.nodeType&&!a.h.ea[f])throw Error("The binding '"+f+"' cannot be used with virtual elements");try{"function"==typeof d&&a.u.G((function(){var a=d(b,r(f),J,x.$data,x);if(a&&a.controlsDescendantBindings){if(u!==n)throw Error("Multiple bindings ("+u+" and "+f+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");u=f}})),"function"==typeof e&&a.$((function(){e(b,r(f),J,x.$data,x)}),null,{l:b})}catch(k){throw k.message='Unable to process binding "'+f+": "+g[f]+'"\nMessage: '+k.message,k}}))}return{shouldBindDescendants:f=u===n,bindingContextForDescendants:f&&x}}function q(b,c){return b&&b instanceof a.fa?b:new a.fa(b,n,n,c)}var t=a.a.Da("_subscribable"),x=a.a.Da("_ancestorBindingInfo"),B=a.a.Da("_dataDependency");a.c={};var u={script:!0,textarea:!0,template:!0};a.getBindingHandler=function(b){return a.c[b]};var J={};a.fa=function(b,c,d,e,f){function k(){var b=p?h():h,f=a.a.f(b);return c?(a.a.extend(l,c),x in c&&(l[x]=c[x])):(l.$parents=[],l.$root=f,l.ko=a),l[t]=q,g?f=l.$data:(l.$rawData=b,l.$data=f),d&&(l[d]=f),e&&e(l,c,f),c&&c[t]&&!a.S.o().Vb(c[t])&&c[t](),m&&(l[B]=m),l.$data}var q,l=this,g=b===J,h=g?n:b,p="function"==typeof h&&!a.O(h),m=f&&f.dataDependency;f&&f.exportDependencies?k():((q=a.xb(k)).v(),q.ja()?q.equalityComparer=null:l[t]=n)},a.fa.prototype.createChildContext=function(b,c,d,e){if(!e&&c&&"object"==typeof c&&(c=(e=c).as,d=e.extend),c&&e&&e.noChildContext){var f="function"==typeof b&&!a.O(b);return new a.fa(J,this,null,(function(a){d&&d(a),a[c]=f?b():b}),e)}return new a.fa(b,this,c,(function(a,b){a.$parentContext=b,a.$parent=b.$data,a.$parents=(b.$parents||[]).slice(0),a.$parents.unshift(a.$parent),d&&d(a)}),e)},a.fa.prototype.extend=function(b,c){return new a.fa(J,this,null,(function(c){a.a.extend(c,"function"==typeof b?b(c):b)}),c)};var z=a.a.g.Z();c.prototype.Tc=function(){this.Kb&&this.Kb.N&&this.Kb.N.sd(this.node)},c.prototype.sd=function(b){a.a.Pa(this.kb,b),!this.kb.length&&this.H&&this.Cc()},c.prototype.Cc=function(){this.H=!0,this.yc.N&&!this.kb.length&&(this.yc.N=null,a.a.K.yb(this.node,b),a.i.ma(this.node,a.i.pa),this.Tc())},a.i={H:"childrenComplete",pa:"descendantsComplete",subscribe:function(b,c,d,e,f){var k=a.a.g.Ub(b,z,{});return k.Fa||(k.Fa=new a.T),f&&f.notifyImmediately&&k.Zb[c]&&a.u.G(d,e,[b]),k.Fa.subscribe(d,e,c)},ma:function(b,c){var d=a.a.g.get(b,z);if(d&&(d.Zb[c]=!0,d.Fa&&d.Fa.notifySubscribers(b,c),c==a.i.H))if(d.N)d.N.Cc();else if(d.N===n&&d.Fa&&d.Fa.Wa(a.i.pa))throw Error("descendantsComplete event not supported for bindings on this node")},Cb:function(b,d){var e=a.a.g.Ub(b,z,{});return e.N||(e.N=new c(b,e,d[x])),d[x]==e?d:d.extend((function(a){a[x]=e}))}},a.Td=function(b){return(b=a.a.g.get(b,z))&&b.context},a.ib=function(b,c,d){return 1===b.nodeType&&a.h.Sc(b),p(b,c,q(d))},a.ld=function(b,c,d){return d=q(d),a.ib(b,g(c,d,b),d)},a.Oa=function(a,b){1!==b.nodeType&&8!==b.nodeType||m(q(a),b)},a.vc=function(a,b,c){if(!v&&A.jQuery&&(v=A.jQuery),2>arguments.length){if(!(b=w.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!b||1!==b.nodeType&&8!==b.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");k(q(a,c),b)},a.Dc=function(b){return!b||1!==b.nodeType&&8!==b.nodeType?n:a.Td(b)},a.Ec=function(b){return(b=a.Dc(b))?b.$data:n},a.b("bindingHandlers",a.c),a.b("bindingEvent",a.i),a.b("bindingEvent.subscribe",a.i.subscribe),a.b("bindingEvent.startPossiblyAsyncContentBinding",a.i.Cb),a.b("applyBindings",a.vc),a.b("applyBindingsToDescendants",a.Oa),a.b("applyBindingAccessorsToNode",a.ib),a.b("applyBindingsToNode",a.ld),a.b("contextFor",a.Dc),a.b("dataFor",a.Ec)}(),function(b){function c(c,e){var l,k=Object.prototype.hasOwnProperty.call(f,c)?f[c]:b;k?k.subscribe(e):((k=f[c]=new a.T).subscribe(e),d(c,(function(b,d){var e=!(!d||!d.synchronous);g[c]={definition:b,Gd:e},delete f[c],l||e?k.notifySubscribers(b):a.na.zb((function(){k.notifySubscribers(b)}))})),l=!0)}function d(a,b){e("getConfig",[a],(function(c){c?e("loadComponent",[a,c],(function(a){b(a,c)})):b(null,null)}))}function e(c,d,f,l){l||(l=a.j.loaders.slice(0));var g=l.shift();if(g){var q=g[c];if(q){var t=!1;if(q.apply(g,d.concat((function(a){t?f(null):null!==a?f(a):e(c,d,f,l)})))!==b&&(t=!0,!g.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else e(c,d,f,l)}else f(null)}var f={},g={};a.j={get:function(d,e){var f=Object.prototype.hasOwnProperty.call(g,d)?g[d]:b;f?f.Gd?a.u.G((function(){e(f.definition)})):a.na.zb((function(){e(f.definition)})):c(d,e)},Bc:function(a){delete g[a]},oc:e},a.j.loaders=[],a.b("components",a.j),a.b("components.get",a.j.get),a.b("components.clearCachedDefinition",a.j.Bc)}(),function(){function b(b,c,d,e){function g(){0==--B&&e(h)}var h={},B=2,u=d.template;d=d.viewModel,u?f(c,u,(function(c){a.j.oc("loadTemplate",[b,c],(function(a){h.template=a,g()}))})):g(),d?f(c,d,(function(c){a.j.oc("loadViewModel",[b,c],(function(a){h[m]=a,g()}))})):g()}function c(a,b,d){if("function"==typeof b)d((function(a){return new b(a)}));else if("function"==typeof b[m])d(b[m]);else if("instance"in b){var e=b.instance;d((function(){return e}))}else"viewModel"in b?c(a,b.viewModel,d):a("Unknown viewModel value: "+b)}function d(b){switch(a.a.R(b)){case"script":return a.a.ua(b.text);case"textarea":return a.a.ua(b.value);case"template":if(e(b.content))return a.a.Ca(b.content.childNodes)}return a.a.Ca(b.childNodes)}function e(a){return A.DocumentFragment?a instanceof DocumentFragment:a&&11===a.nodeType}function f(a,b,c){"string"==typeof b.require?T||A.require?(T||A.require)([b.require],(function(a){a&&"object"==typeof a&&a.Xd&&a.default&&(a=a.default),c(a)})):a("Uses require, but no AMD loader is present"):c(b)}function g(a){return function(b){throw Error("Component '"+a+"': "+b)}}var h={};a.j.register=function(b,c){if(!c)throw Error("Invalid configuration for "+b);if(a.j.tb(b))throw Error("Component "+b+" is already registered");h[b]=c},a.j.tb=function(a){return Object.prototype.hasOwnProperty.call(h,a)},a.j.unregister=function(b){delete h[b],a.j.Bc(b)},a.j.Fc={getConfig:function(b,c){c(a.j.tb(b)?h[b]:null)},loadComponent:function(a,c,d){var e=g(a);f(e,c,(function(c){b(a,e,c,d)}))},loadTemplate:function(b,c,f){if(b=g(b),"string"==typeof c)f(a.a.ua(c));else if(c instanceof Array)f(c);else if(e(c))f(a.a.la(c.childNodes));else if(c.element)if(c=c.element,A.HTMLElement?c instanceof HTMLElement:c&&c.tagName&&1===c.nodeType)f(d(c));else if("string"==typeof c){var h=w.getElementById(c);h?f(d(h)):b("Cannot find element with ID "+c)}else b("Unknown element type: "+c);else b("Unknown template value: "+c)},loadViewModel:function(a,b,d){c(g(a),b,d)}};var m="createViewModel";a.b("components.register",a.j.register),a.b("components.isRegistered",a.j.tb),a.b("components.unregister",a.j.unregister),a.b("components.defaultLoader",a.j.Fc),a.j.loaders.push(a.j.Fc),a.j.dd=h}(),function(){function b(b,e){if(f=b.getAttribute("params")){var f=c.parseBindingsString(f,e,b,{valueAccessors:!0,bindingParams:!0}),g=(f=a.a.Ga(f,(function(c){return a.o(c,null,{l:b})})),a.a.Ga(f,(function(c){var e=c.v();return c.ja()?a.o({read:function(){return a.a.f(c())},write:a.Za(e)&&function(a){c()(a)},l:b}):e})));return Object.prototype.hasOwnProperty.call(g,"$raw")||(g.$raw=f),g}return{$raw:{}}}a.j.getComponentNameForNode=function(b){var c=a.a.R(b);if(a.j.tb(c)&&(-1!=c.indexOf("-")||"[object HTMLUnknownElement]"==""+b||8>=a.a.W&&b.tagName===c))return c},a.j.tc=function(c,e,f,g){if(1===e.nodeType){var h=a.j.getComponentNameForNode(e);if(h){if((c=c||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var m={name:h,params:b(e,f)};c.component=g?function(){return m}:m}}return c};var c=new a.ga;9>a.a.W&&(a.j.register=function(a){return function(b){return a.apply(this,arguments)}}(a.j.register),w.createDocumentFragment=function(b){return function(){var g,c=b(),f=a.j.dd;for(g in f);return c}}(w.createDocumentFragment))}(),function(){var d=0;a.c.component={init:function(e,f,g,h,m){function k(){var a=l&&l.dispose;"function"==typeof a&&a.call(l),q&&q.s(),p=l=q=null}var l,p,q,t=a.a.la(a.h.childNodes(e));return a.h.Ea(e),a.a.K.za(e,k),a.o((function(){var h,u,g=a.a.f(f());if("string"==typeof g?h=g:(h=a.a.f(g.name),u=a.a.f(g.params)),!h)throw Error("No component name specified");var n=a.i.Cb(e,m),z=p=++d;a.j.get(h,(function(d){if(p===z){if(k(),!d)throw Error("Unknown component '"+h+"'");!function(b,c,d){if(!(c=c.template))throw Error("Component '"+b+"' has no template");b=a.a.Ca(c),a.h.va(d,b)}(h,d,e);var f=function(a,b,c){var d=a.createViewModel;return d?d.call(a,b,c):b}(d,u,{element:e,templateNodes:t});d=n.createChildContext(f,{extend:function(a){a.$component=f,a.$componentTemplateNodes=t}}),f&&f.koDescendantsComplete&&(q=a.i.subscribe(e,a.i.pa,f.koDescendantsComplete,f)),l=f,a.Oa(d,e)}}))}),null,{l:e}),{controlsDescendantBindings:!0}}},a.h.ea.component=!0}();var V={class:"className",for:"htmlFor"};a.c.attr={update:function(b,c){var d=a.a.f(c())||{};a.a.P(d,(function(c,d){d=a.a.f(d);var g=c.indexOf(":"),h=(g="lookupNamespaceURI"in b&&0<g&&b.lookupNamespaceURI(c.substr(0,g)),!1===d||null===d||d===n);h?g?b.removeAttributeNS(g,c):b.removeAttribute(c):d=d.toString(),8>=a.a.W&&c in V?(c=V[c],h?b.removeAttribute(c):b[c]=d):h||(g?b.setAttributeNS(g,c,d):b.setAttribute(c,d)),"name"===c&&a.a.Yc(b,h?"":d)}))}},a.c.checked={after:["value","attr"],init:function(b,c,d){function e(){var e=b.checked,f=g();if(!a.S.Ya()&&(e||!m&&!a.S.qa())){var k=a.u.G(c);if(l){var q=p?k.v():k,z=t;t=f,z!==f?e&&(a.a.Na(q,f,!0),a.a.Na(q,z,!1)):a.a.Na(q,f,e),p&&a.Za(k)&&k(q)}else h&&(f===n?f=e:e||(f=n)),a.m.eb(k,d,"checked",f,!0)}}var g=a.xb((function(){return d.has("checkedValue")?a.a.f(d.get("checkedValue")):q?d.has("value")?a.a.f(d.get("value")):b.value:void 0})),h="checkbox"==b.type,m="radio"==b.type;if(h||m){var k=c(),l=h&&a.a.f(k)instanceof Array,p=!(l&&k.push&&k.splice),q=m||l,t=l?g():n;m&&!b.name&&a.c.uniqueName.init(b,(function(){return!0})),a.o(e,null,{l:b}),a.a.B(b,"click",e),a.o((function(){var d=a.a.f(c()),e=g();l?(b.checked=0<=a.a.A(d,e),t=e):b.checked=h&&e===n?!!d:g()===d}),null,{l:b}),k=n}}},a.m.wa.checked=!0,a.c.checkedValue={update:function(b,c){b.value=a.a.f(c())}},a.c.class={update:function(b,c){var d=a.a.Db(a.a.f(c()));a.a.Eb(b,b.__ko__cssValue,!1),b.__ko__cssValue=d,a.a.Eb(b,d,!0)}},a.c.css={update:function(b,c){var d=a.a.f(c());null!==d&&"object"==typeof d?a.a.P(d,(function(c,d){d=a.a.f(d),a.a.Eb(b,c,d)})):a.c.class.update(b,c)}},a.c.enable={update:function(b,c){var d=a.a.f(c());d&&b.disabled?b.removeAttribute("disabled"):d||b.disabled||(b.disabled=!0)}},a.c.disable={update:function(b,c){a.c.enable.update(b,(function(){return!a.a.f(c())}))}},a.c.event={init:function(b,c,d,e,f){var g=c()||{};a.a.P(g,(function(g){"string"==typeof g&&a.a.B(b,g,(function(b){var k,l=c()[g];if(l){try{var p=a.a.la(arguments);e=f.$data,p.unshift(e),k=l.apply(e,p)}finally{!0!==k&&(b.preventDefault?b.preventDefault():b.returnValue=!1)}!1===d.get(g+"Bubble")&&(b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation())}}))}))}},a.c.foreach={Rc:function(b){return function(){var c=b(),d=a.a.bc(c);return d&&"number"!=typeof d.length?(a.a.f(c),{foreach:d.data,as:d.as,noChildContext:d.noChildContext,includeDestroyed:d.includeDestroyed,afterAdd:d.afterAdd,beforeRemove:d.beforeRemove,afterRender:d.afterRender,beforeMove:d.beforeMove,afterMove:d.afterMove,templateEngine:a.ba.Ma}):{foreach:c,templateEngine:a.ba.Ma}}},init:function(b,c){return a.c.template.init(b,a.c.foreach.Rc(c))},update:function(b,c,d,e,f){return a.c.template.update(b,a.c.foreach.Rc(c),d,e,f)}},a.m.Ra.foreach=!1,a.h.ea.foreach=!0,a.c.hasfocus={init:function(b,c,d){function e(e){b.__ko_hasfocusUpdating=!0;var f=b.ownerDocument;if("activeElement"in f){var g;try{g=f.activeElement}catch(l){g=f.body}e=g===b}f=c(),a.m.eb(f,d,"hasfocus",e,!0),b.__ko_hasfocusLastValue=e,b.__ko_hasfocusUpdating=!1}var f=e.bind(null,!0),g=e.bind(null,!1);a.a.B(b,"focus",f),a.a.B(b,"focusin",f),a.a.B(b,"blur",g),a.a.B(b,"focusout",g),b.__ko_hasfocusLastValue=!1},update:function(b,c){var d=!!a.a.f(c());b.__ko_hasfocusUpdating||b.__ko_hasfocusLastValue===d||(d?b.focus():b.blur(),!d&&b.__ko_hasfocusLastValue&&b.ownerDocument.body.focus(),a.u.G(a.a.Fb,null,[b,d?"focusin":"focusout"]))}},a.m.wa.hasfocus=!0,a.c.hasFocus=a.c.hasfocus,a.m.wa.hasFocus="hasfocus",a.c.html={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c){a.a.fc(b,c())}},function(){function b(b,d,e){a.c[b]={init:function(b,c,h,m,k){var l,p,t,x,n,q={};if(d){m=h.get("as");var u=h.get("noChildContext");q={as:m,noChildContext:u,exportDependencies:n=!(m&&u)}}return x=(t="render"==h.get("completeOn"))||h.has(a.i.pa),a.o((function(){var r,h=a.a.f(c()),m=!e!=!h,u=!p;(n||m!==l)&&(x&&(k=a.i.Cb(b,k)),m&&(d&&!n||(q.dataDependency=a.S.o()),r=d?k.createChildContext("function"==typeof h?h:c,q):a.S.qa()?k.extend(null,q):k),u&&a.S.qa()&&(p=a.a.Ca(a.h.childNodes(b),!0)),m?(u||a.h.va(b,a.a.Ca(p)),a.Oa(r,b)):(a.h.Ea(b),t||a.i.ma(b,a.i.H)),l=m)}),null,{l:b}),{controlsDescendantBindings:!0}}},a.m.Ra[b]=!1,a.h.ea[b]=!0}b("if"),b("ifnot",!1,!0),b("with",!0)}(),a.c.let={init:function(b,c,d,e,f){return c=f.extend(c),a.Oa(c,b),{controlsDescendantBindings:!0}}},a.h.ea.let=!0;var Q={};a.c.options={init:function(b){if("select"!==a.a.R(b))throw Error("options binding applies only to SELECT elements");for(;0<b.length;)b.remove(0);return{controlsDescendantBindings:!0}},update:function(b,c,d){function e(){return a.a.jb(b.options,(function(a){return a.selected}))}function f(a,b,c){var d=typeof b;return"function"==d?b(a):"string"==d?a[b]:c}function g(c,d){if(x&&l)a.i.ma(b,a.i.H);else if(t.length){var e=0<=a.a.A(t,a.w.M(d[0]));a.a.Zc(d[0],e),x&&!e&&a.u.G(a.a.Fb,null,[b,"change"])}}var h=b.multiple,m=0!=b.length&&h?b.scrollTop:null,k=a.a.f(c()),l=d.get("valueAllowUnset")&&d.has("value"),p=d.get("optionsIncludeDestroyed");c={};var q,t=[];l||(h?t=a.a.Mb(e(),a.w.M):0<=b.selectedIndex&&t.push(a.w.M(b.options[b.selectedIndex]))),k&&(void 0===k.length&&(k=[k]),q=a.a.jb(k,(function(b){return p||b===n||null===b||!a.a.f(b._destroy)})),d.has("optionsCaption")&&null!==(k=a.a.f(d.get("optionsCaption")))&&k!==n&&q.unshift(Q));var x=!1;c.beforeRemove=function(a){b.removeChild(a)},k=g,d.has("optionsAfterRender")&&"function"==typeof d.get("optionsAfterRender")&&(k=function(b,c){g(0,c),a.u.G(d.get("optionsAfterRender"),null,[c[0],b!==Q?b:n])}),a.a.ec(b,q,(function(c,e,g){return g.length&&(t=!l&&g[0].selected?[a.w.M(g[0])]:[],x=!0),e=b.ownerDocument.createElement("option"),c===Q?(a.a.Bb(e,d.get("optionsCaption")),a.w.cb(e,n)):(g=f(c,d.get("optionsValue"),c),a.w.cb(e,a.a.f(g)),c=f(c,d.get("optionsText"),g),a.a.Bb(e,c)),[e]}),c,k),l||(h?t.length&&e().length<t.length:t.length&&0<=b.selectedIndex?a.w.M(b.options[b.selectedIndex])!==t[0]:t.length||0<=b.selectedIndex)&&a.u.G(a.a.Fb,null,[b,"change"]),(l||a.S.Ya())&&a.i.ma(b,a.i.H),a.a.wd(b),m&&20<Math.abs(m-b.scrollTop)&&(b.scrollTop=m)}},a.c.options.$b=a.a.g.Z(),a.c.selectedOptions={init:function(b,c,d){function e(){var e=c(),f=[];a.a.D(b.getElementsByTagName("option"),(function(b){b.selected&&f.push(a.w.M(b))})),a.m.eb(e,d,"selectedOptions",f)}function f(){var d=a.a.f(c()),e=b.scrollTop;d&&"number"==typeof d.length&&a.a.D(b.getElementsByTagName("option"),(function(b){var c=0<=a.a.A(d,a.w.M(b));b.selected!=c&&a.a.Zc(b,c)})),b.scrollTop=e}if("select"!=a.a.R(b))throw Error("selectedOptions binding applies only to SELECT elements");var g;a.i.subscribe(b,a.i.H,(function(){g?e():(a.a.B(b,"change",e),g=a.o(f,null,{l:b}))}),null,{notifyImmediately:!0})},update:function(){}},a.m.wa.selectedOptions=!0,a.c.style={update:function(b,c){var d=a.a.f(c()||{});a.a.P(d,(function(c,d){if(null!==(d=a.a.f(d))&&d!==n&&!1!==d||(d=""),v)v(b).css(c,d);else if(/^--/.test(c))b.style.setProperty(c,d);else{c=c.replace(/-(\w)/g,(function(a,b){return b.toUpperCase()}));var g=b.style[c];b.style[c]=d,d===g||b.style[c]!=g||isNaN(d)||(b.style[c]=d+"px")}}))}},a.c.submit={init:function(b,c,d,e,f){if("function"!=typeof c())throw Error("The value for a submit binding must be a function");a.a.B(b,"submit",(function(a){var d,e=c();try{d=e.call(f.$data,b)}finally{!0!==d&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}}))}},a.c.text={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c){a.a.Bb(b,c())}},a.h.ea.text=!0,function(){if(A&&A.navigator){var d,e,f,g,h,b=function(a){if(a)return parseFloat(a[1])},c=A.navigator.userAgent;(d=A.opera&&A.opera.version&&parseInt(A.opera.version()))||(h=b(c.match(/Edge\/([^ ]+)$/)))||b(c.match(/Chrome\/([^ ]+)/))||(e=b(c.match(/Version\/([^ ]+) Safari/)))||(f=b(c.match(/Firefox\/([^ ]+)/)))||(g=a.a.W||b(c.match(/MSIE ([^ ]+)/)))||(g=b(c.match(/rv:([^ )]+)/)))}if(8<=g&&10>g)var m=a.a.g.Z(),k=a.a.g.Z(),l=function(b){var c=this.activeElement;(c=c&&a.a.g.get(c,k))&&c(b)},p=function(b,c){var d=b.ownerDocument;a.a.g.get(d,m)||(a.a.g.set(d,m,!0),a.a.B(d,"selectionchange",l)),a.a.g.set(b,k,c)};a.c.textInput={init:function(b,c,k){function l(c,d){a.a.B(b,c,d)}function r(){w||(L=b.value,w=a.a.setTimeout(z,4))}function z(){clearTimeout(w),L=w=n;var d=b.value;v!==d&&(v=d,a.m.eb(c(),k,"textInput",d))}var w,L,v=b.value,A=9==a.a.W?r:z,y=!1;g&&l("keypress",z),11>g&&l("propertychange",(function(a){y||"value"!==a.propertyName||A(a)})),8==g&&(l("keyup",z),l("keydown",z)),p&&(p(b,A),l("dragend",r)),(!g||9<=g)&&l("input",A),5>e&&"textarea"===a.a.R(b)?(l("keydown",r),l("paste",r),l("cut",r)):11>d?l("keydown",r):4>f?(l("DOMAutoComplete",z),l("dragdrop",z),l("drop",z)):h&&"number"===b.type&&l("keydown",r),l("change",z),l("blur",z),a.o((function m(){var d=a.a.f(c());null!==d&&d!==n||(d=""),L!==n&&d===L?a.a.setTimeout(m,4):b.value!==d&&(y=!0,b.value=d,y=!1,v=b.value)}),null,{l:b})}},a.m.wa.textInput=!0,a.c.textinput={preprocess:function(a,b,c){c("textInput",a)}}}(),a.c.uniqueName={init:function(b,c){if(c()){var d="ko_unique_"+ ++a.c.uniqueName.rd;a.a.Yc(b,d)}}},a.c.uniqueName.rd=0,a.c.using={init:function(b,c,d,e,f){var g;return d.has("as")&&(g={as:d.get("as"),noChildContext:d.get("noChildContext")}),c=f.createChildContext(c,g),a.Oa(c,b),{controlsDescendantBindings:!0}}},a.h.ea.using=!0,a.c.value={init:function(b,c,d){var e=a.a.R(b),f="input"==e;if(!f||"checkbox"!=b.type&&"radio"!=b.type){var g=[],h=d.get("valueUpdate"),m=!1,k=null;h&&(g="string"==typeof h?[h]:a.a.wc(h),a.a.Pa(g,"change"));var p,q,l=function(){k=null,m=!1;var e=c(),f=a.w.M(b);a.m.eb(e,d,"value",f)};!a.a.W||!f||"text"!=b.type||"off"==b.autocomplete||b.form&&"off"==b.form.autocomplete||-1!=a.a.A(g,"propertychange")||(a.a.B(b,"propertychange",(function(){m=!0})),a.a.B(b,"focus",(function(){m=!1})),a.a.B(b,"blur",(function(){m&&l()}))),a.a.D(g,(function(c){var d=l;a.a.Ud(c,"after")&&(d=function(){k=a.w.M(b),a.a.setTimeout(l,0)},c=c.substring(5)),a.a.B(b,c,d)})),p=f&&"file"==b.type?function(){var d=a.a.f(c());null===d||d===n||""===d?b.value="":a.u.G(l)}:function(){var f=a.a.f(c()),g=a.w.M(b);null!==k&&f===k?a.a.setTimeout(p,0):f===g&&g!==n||("select"===e?(g=d.get("valueAllowUnset"),a.w.cb(b,f,g),g||f===a.w.M(b)||a.u.G(l)):a.w.cb(b,f))},"select"===e?a.i.subscribe(b,a.i.H,(function(){q?d.get("valueAllowUnset")?p():l():(a.a.B(b,"change",l),q=a.o(p,null,{l:b}))}),null,{notifyImmediately:!0}):(a.a.B(b,"change",l),a.o(p,null,{l:b}))}else a.ib(b,{checkedValue:c})},update:function(){}},a.m.wa.value=!0,a.c.visible={update:function(b,c){var d=a.a.f(c()),e="none"!=b.style.display;d&&!e?b.style.display="":!d&&e&&(b.style.display="none")}},a.c.hidden={update:function(b,c){a.c.visible.update(b,(function(){return!a.a.f(c())}))}},function(b){a.c[b]={init:function(c,d,e,f,g){return a.c.event.init.call(this,c,(function(){var a={};return a[b]=d(),a}),e,f,g)}}}("click"),a.ca=function(){},a.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},a.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},a.ca.prototype.makeTemplateSource=function(b,c){if("string"==typeof b){var d=(c=c||w).getElementById(b);if(!d)throw Error("Cannot find template with ID "+b);return new a.C.F(d)}if(1==b.nodeType||8==b.nodeType)return new a.C.ia(b);throw Error("Unknown template type: "+b)},a.ca.prototype.renderTemplate=function(a,c,d,e){return a=this.makeTemplateSource(a,e),this.renderTemplateSource(a,c,d,e)},a.ca.prototype.isTemplateRewritten=function(a,c){return!1===this.allowTemplateRewriting||this.makeTemplateSource(a,c).data("isRewritten")},a.ca.prototype.rewriteTemplate=function(a,c,d){c=c((a=this.makeTemplateSource(a,d)).text()),a.text(c),a.data("isRewritten",!0)},a.b("templateEngine",a.ca),a.kc=function(){function b(b,c,d,h){b=a.m.ac(b);for(var m=a.m.Ra,k=0;k<b.length;k++){var l=b[k].key;if(Object.prototype.hasOwnProperty.call(m,l)){var p=m[l];if("function"==typeof p){if(l=p(b[k].value))throw Error(l)}else if(!p)throw Error("This template engine does not support the '"+l+"' binding within its templates")}}return d="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+a.m.vb(b,{valueAccessors:!0})+" } })()},'"+d.toLowerCase()+"')",h.createJavaScriptEvaluatorBlock(d)+c}var c=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,d=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{xd:function(b,c,d){c.isTemplateRewritten(b,d)||c.rewriteTemplate(b,(function(b){return a.kc.Ld(b,c)}),d)},Ld:function(a,f){return a.replace(c,(function(a,c,d,e,l){return b(l,c,d,f)})).replace(d,(function(a,c){return b(c,"\x3c!-- ko --\x3e","#comment",f)}))},md:function(b,c){return a.aa.Xb((function(d,h){var m=d.nextSibling;m&&m.nodeName.toLowerCase()===c&&a.ib(m,b,h)}))}}}(),a.b("__tr_ambtns",a.kc.md),function(){a.C={},a.C.F=function(b){if(this.F=b){var c=a.a.R(b);this.ab="script"===c?1:"textarea"===c?2:"template"==c&&b.content&&11===b.content.nodeType?3:4}},a.C.F.prototype.text=function(){var b=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.F[b];var c=arguments[0];"innerHTML"===b?a.a.fc(this.F,c):this.F[b]=c};var b=a.a.g.Z()+"_";a.C.F.prototype.data=function(c){if(1===arguments.length)return a.a.g.get(this.F,b+c);a.a.g.set(this.F,b+c,arguments[1])};var c=a.a.g.Z();a.C.F.prototype.nodes=function(){var b=this.F;if(0==arguments.length){var e=a.a.g.get(b,c)||{},f=e.lb||(3===this.ab?b.content:4===this.ab?b:n);if(!f||e.jd){var g=this.text();g&&g!==e.bb&&(f=a.a.Md(g,b.ownerDocument),a.a.g.set(b,c,{lb:f,bb:g,jd:!0}))}return f}e=arguments[0],this.ab!==n&&this.text(""),a.a.g.set(b,c,{lb:e})},a.C.ia=function(a){this.F=a},a.C.ia.prototype=new a.C.F,a.C.ia.prototype.constructor=a.C.ia,a.C.ia.prototype.text=function(){if(0==arguments.length){var b=a.a.g.get(this.F,c)||{};return b.bb===n&&b.lb&&(b.bb=b.lb.innerHTML),b.bb}a.a.g.set(this.F,c,{bb:arguments[0]})},a.b("templateSources",a.C),a.b("templateSources.domElement",a.C.F),a.b("templateSources.anonymousTemplate",a.C.ia)}(),function(){function b(b,c,d){var e;for(c=a.h.nextSibling(c);b&&(e=b)!==c;)d(e,b=a.h.nextSibling(e))}function c(c,d){if(c.length){var e=c[0],f=c[c.length-1],g=e.parentNode,h=a.ga.instance,m=h.preprocessNode;if(m){if(b(e,f,(function(a,b){var c=a.previousSibling,d=m.call(h,a);d&&(a===e&&(e=d[0]||b),a===f&&(f=d[d.length-1]||c))})),c.length=0,!e)return;e===f?c.push(e):(c.push(e,f),a.a.Ua(c,g))}b(e,f,(function(b){1!==b.nodeType&&8!==b.nodeType||a.vc(d,b)})),b(e,f,(function(b){1!==b.nodeType&&8!==b.nodeType||a.aa.cd(b,[d])})),a.a.Ua(c,g)}}function d(a){return a.nodeType?a:0<a.length?a[0]:null}function e(b,e,f,h,m){m=m||{};var n=(b&&d(b)||f||{}).ownerDocument,B=m.templateEngine||g;if(a.kc.xd(f,B,n),"number"!=typeof(f=B.renderTemplate(f,h,m,n)).length||0<f.length&&"number"!=typeof f[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(n=!1,e){case"replaceChildren":a.h.va(b,f),n=!0;break;case"replaceNode":a.a.Xc(b,f),n=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e)}return n&&(c(f,h),m.afterRender&&a.u.G(m.afterRender,null,[f,h[m.as||"$data"]]),"replaceChildren"==e&&a.i.ma(b,a.i.H)),f}function f(b,c,d){return a.O(b)?b():"function"==typeof b?b(c,d):b}var g;a.gc=function(b){if(b!=n&&!(b instanceof a.ca))throw Error("templateEngine must inherit from ko.templateEngine");g=b},a.dc=function(b,c,h,m,t){if(((h=h||{}).templateEngine||g)==n)throw Error("Set a template engine before calling renderTemplate");if(t=t||"replaceChildren",m){var x=d(m);return a.$((function(){var g=c&&c instanceof a.fa?c:new a.fa(c,null,null,null,{exportDependencies:!0}),n=f(b,g.$data,g);g=e(m,t,n,g,h),"replaceNode"==t&&(x=d(m=g))}),null,{Sa:function(){return!x||!a.a.Sb(x)},l:x&&"replaceNode"==t?x.parentNode:x})}return a.aa.Xb((function(d){a.dc(b,c,h,d,"replaceNode")}))},a.Qd=function(b,d,g,h,m){function x(b,c){a.u.G(a.a.ec,null,[h,b,u,g,r,c]),a.i.ma(h,a.i.H)}function r(a,b){c(b,v),g.afterRender&&g.afterRender(b,a),v=null}function u(a,c){v=m.createChildContext(a,{as:z,noChildContext:g.noChildContext,extend:function(a){a.$index=c,z&&(a[z+"Index"]=c)}});var d=f(b,a,v);return e(h,"ignoreTargetNode",d,v,g)}var v,z=g.as,w=!1===g.includeDestroyed||a.options.foreachHidesDestroyed&&!g.includeDestroyed;if(w||g.beforeRemove||!a.Pc(d))return a.$((function(){var b=a.a.f(d)||[];void 0===b.length&&(b=[b]),w&&(b=a.a.jb(b,(function(b){return b===n||null===b||!a.a.f(b._destroy)}))),x(b)}),null,{l:h});x(d.v());var A=d.subscribe((function(a){x(d(),a)}),null,"arrayChange");return A.l(h),A};var h=a.a.g.Z(),m=a.a.g.Z();a.c.template={init:function(b,c){var d=a.a.f(c());if("string"==typeof d||"name"in d)a.h.Ea(b);else if("nodes"in d){if(d=d.nodes||[],a.O(d))throw Error('The "nodes" option must be a plain, non-observable array.');var e=d[0]&&d[0].parentNode;e&&a.a.g.get(e,m)||(e=a.a.Yb(d),a.a.g.set(e,m,!0)),new a.C.ia(b).nodes(e)}else{if(!(0<(d=a.h.childNodes(b)).length))throw Error("Anonymous template defined, but no template content was provided");e=a.a.Yb(d),new a.C.ia(b).nodes(e)}return{controlsDescendantBindings:!0}},update:function(b,c,d,e,f){var g=c();d=!0,e=null,"string"==typeof(c=a.a.f(g))?c={}:(g="name"in c?c.name:b,"if"in c&&(d=a.a.f(c.if)),d&&"ifnot"in c&&(d=!a.a.f(c.ifnot)),d&&!g&&(d=!1)),"foreach"in c?e=a.Qd(g,d&&c.foreach||[],c,b,f):d?(d=f,"data"in c&&(d=f.createChildContext(c.data,{as:c.as,noChildContext:c.noChildContext,exportDependencies:!0})),e=a.dc(g,d,c,b)):a.h.Ea(b),f=e,(c=a.a.g.get(b,h))&&"function"==typeof c.s&&c.s(),a.a.g.set(b,h,!f||f.ja&&!f.ja()?n:f)}},a.m.Ra.template=function(b){return 1==(b=a.m.ac(b)).length&&b[0].unknown||a.m.Id(b,"name")?null:"This template engine does not support anonymous templates nested within its templates"},a.h.ea.template=!0}(),a.b("setTemplateEngine",a.gc),a.b("renderTemplate",a.dc),a.a.Kc=function(a,c,d){var e,f,g,h,m;if(a.length&&c.length)for(e=f=0;(!d||e<d)&&(h=a[f]);++f){for(g=0;m=c[g];++g)if(h.value===m.value){h.moved=m.index,m.moved=h.index,c.splice(g,1),e=g=0;break}e+=g}},a.a.Pb=function(){function b(b,d,e,f,g){var l,q,u,w,z,h=Math.min,m=Math.max,k=[],p=b.length,n=d.length,r=n-p||1,v=p+n+1;for(l=0;l<=p;l++)for(w=u,k.push(u=[]),z=h(n,l+r),q=m(0,l-1);q<=z;q++)u[q]=q?l?b[l-1]===d[q-1]?w[q-1]:h(w[q]||v,u[q-1]||v)+1:q+1:l+1;for(h=[],m=[],r=[],l=p,q=n;l||q;)n=k[l][q]-1,q&&n===k[l][q-1]?m.push(h[h.length]={status:e,value:d[--q],index:q}):l&&n===k[l-1][q]?r.push(h[h.length]={status:f,value:b[--l],index:l}):(--q,--l,g.sparse||h.push({status:"retained",value:d[q]}));return a.a.Kc(r,m,!g.dontLimitMoves&&10*p),h.reverse()}return function(a,d,e){return e="boolean"==typeof e?{dontLimitMoves:e}:e||{},d=d||[],(a=a||[]).length<d.length?b(a,d,"added","deleted",e):b(d,a,"deleted","added",e)}}(),a.b("utils.compareArrays",a.a.Pb),function(){function b(b,c,d,h,m){var k=[],l=a.$((function(){var l=c(d,m,a.a.Ua(k,b))||[];0<k.length&&(a.a.Xc(k,l),h&&a.u.G(h,null,[d,l,m])),k.length=0,a.a.Nb(k,l)}),null,{l:b,Sa:function(){return!a.a.kd(k)}});return{Y:k,$:l.ja()?l:n}}var c=a.a.g.Z(),d=a.a.g.Z();a.a.ec=function(e,f,g,h,m,k){function l(b){y={Aa:b,pb:a.ta(w++)},v.push(y),r||F.push(y)}function p(b){y=t[b],w!==y.pb.v()&&D.push(y),y.pb(w++),a.a.Ua(y.Y,e),v.push(y)}function q(b,c){if(b)for(var d=0,e=c.length;d<e;d++)a.a.D(c[d].Y,(function(a){b(a,d,c[d].Aa)}))}void 0===(f=f||[]).length&&(f=[f]),h=h||{};var y,M,O,P,t=a.a.g.get(e,c),r=!t,v=[],u=0,w=0,z=[],A=[],C=[],D=[],F=[],I=0;if(r)a.a.D(f,l);else{if(!k||t&&t._countWaitingForRemove){var E=a.a.Mb(t,(function(a){return a.Aa}));k=a.a.Pb(E,f,{dontLimitMoves:h.dontLimitMoves,sparse:!0})}var G,H,K;for(E=0;G=k[E];E++)switch(H=G.moved,K=G.index,G.status){case"deleted":for(;u<K;)p(u++);H===n&&((y=t[u]).$&&(y.$.s(),y.$=n),a.a.Ua(y.Y,e).length&&(h.beforeRemove&&(v.push(y),I++,y.Aa===d?y=null:C.push(y)),y&&z.push.apply(z,y.Y))),u++;break;case"added":for(;w<K;)p(u++);H!==n?(A.push(v.length),p(H)):l(G.value)}for(;w<f.length;)p(u++);v._countWaitingForRemove=I}a.a.g.set(e,c,v),q(h.beforeMove,D),a.a.D(z,h.beforeRemove?a.oa:a.removeNode);try{P=e.ownerDocument.activeElement}catch(N){}if(A.length)for(;(E=A.shift())!=n;){for(y=v[E],M=n;E;)if((O=v[--E].Y)&&O.length){M=O[O.length-1];break}for(f=0;u=y.Y[f];M=u,f++)a.h.Wb(e,u,M)}for(E=0;y=v[E];E++){for(y.Y||a.a.extend(y,b(e,g,y.Aa,m,y.pb)),f=0;u=y.Y[f];M=u,f++)a.h.Wb(e,u,M);!y.Ed&&m&&(m(y.Aa,y.Y,y.pb),y.Ed=!0,M=y.Y[y.Y.length-1])}for(P&&e.ownerDocument.activeElement!=P&&P.focus(),q(h.beforeRemove,C),E=0;E<C.length;++E)C[E].Aa=d;q(h.afterMove,D),q(h.afterAdd,F)}}(),a.b("utils.setDomNodeChildrenFromArrayMapping",a.a.ec),a.ba=function(){this.allowTemplateRewriting=!1},a.ba.prototype=new a.ca,a.ba.prototype.constructor=a.ba,a.ba.prototype.renderTemplateSource=function(b,c,d,e){return(c=9>a.a.W||!b.nodes?null:b.nodes())?a.a.la(c.cloneNode(!0).childNodes):(b=b.text(),a.a.ua(b,e))},a.ba.Ma=new a.ba,a.gc(a.ba.Ma),a.b("nativeTemplateEngine",a.ba),function(){a.$a=function(){var a=this.Hd=function(){if(!v||!v.tmpl)return 0;try{if(0<=v.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(a){}return 1}();this.renderTemplateSource=function(b,e,f,g){if(g=g||w,f=f||{},2>a)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var h=b.data("precompiled");return h||(h=b.text()||"",h=v.template(null,"{{ko_with $item.koBindingContext}}"+h+"{{/ko_with}}"),b.data("precompiled",h)),b=[e.$data],e=v.extend({koBindingContext:e},f.templateOptions),(e=v.tmpl(h,b,e)).appendTo(g.createElement("div")),v.fragments={},e},this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}"},this.addTemplate=function(a,b){w.write("<script type='text/html' id='"+a+"'>"+b+"<\/script>")},0<a&&(v.tmpl.tag.ko_code={open:"__.push($1 || '');"},v.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},a.$a.prototype=new a.ca,a.$a.prototype.constructor=a.$a;var b=new a.$a;0<b.Hd&&a.gc(b),a.b("jqueryTmplTemplateEngine",a.$a)}()}))}(),define("pgui.change_password_dialog",["pgui.utils","pgui.localizer","bootstrap"],(function(utils,localizer){window.PhpGenChangePasswordDialogAdminStrategy=function(onChangePasswordCallback){this.onChangePasswordCallback=onChangePasswordCallback,this.initializeDialog=function(){$("#pg-change-password-dialog-header-admin").show(),$("#pg-change-password-dialog-header-user").hide(),$("#pg-change-password-dialog-current-password-form-group").hide()},this.callChangePasswordCallback=function(currentPassword,newPassword){return this.onChangePasswordCallback(newPassword)}},window.PhpGenChangePasswordDialogUserStrategy=function(onChangePasswordCallback){this.onChangePasswordCallback=onChangePasswordCallback,this.initializeDialog=function(){$("#pg-change-password-dialog-header-admin").hide(),$("#pg-change-password-dialog-header-user").show(),$("#pg-change-password-dialog-current-password-form-group").show()},this.callChangePasswordCallback=function(currentPassword,newPassword){return this.onChangePasswordCallback(currentPassword,newPassword)}},window.PhpGenChangePasswordDialog={initialize:function(userStrategy){this.dialog=$("#pg-change-password-dialog"),this.userStrategy=userStrategy,this.currentPassword=$("#pg-change-password-dialog-current-password"),this.newPassword=$("#pg-change-password-dialog-new-password"),this.confirmedPassword=$("#pg-change-password-dialog-confirmed-password"),this.confirmedPasswordErrorControl=$("#pg-change-password-dialog-confirmed-password-error"),this.dialog.modal("hide"),this.userStrategy.initializeDialog(),$("#pg-change-password-dialog-ok-button").off("click").on("click",function(e){this.onChangePasswordClick(e)}.bind(this))},open:function(){this.clearPasswordElements(),this.confirmedPasswordErrorControl.hide(),this.dialog.modal("show"),this.dialog.find("input:visible:first").focus()},clearPasswordElements:function(){this.currentPassword.val(""),this.newPassword.val(""),this.confirmedPassword.val("")},onChangePasswordClick:function(e){e.preventDefault(),PhpGenPasswordDialogUtils.validateConfirmedPassword(this.newPassword.val(),this.confirmedPassword.val(),this.confirmedPasswordErrorControl)&&this.userStrategy.callChangePasswordCallback(this.currentPassword.val(),this.newPassword.val()).fail((function(message){utils.showErrorMessage(message)})).done(function(){this.dialog.modal("hide"),utils.showSuccessMessage(localizer.getString("PasswordChanged"))}.bind(this))}}})),function(){function forEachObjectEnumberableKey(object,fn,bind){if(enumerables)for(var i=enumerables.length;i--;){var k=enumerables[i];hasOwnProperty.call(object,k)&&fn.call(bind,k,object[k])}}this.MooTools={version:"1.6.0",build:"529422872adfff401b901b8b6c7ca5114ee95e2b"};var typeOf=this.typeOf=function(item){if(null==item)return"null";if(null!=item.$family)return item.$family();if(item.nodeName){if(1==item.nodeType)return"element";if(3==item.nodeType)return/\S/.test(item.nodeValue)?"textnode":"whitespace"}else if("number"==typeof item.length){if("callee"in item)return"arguments";if("item"in item)return"collection"}return typeof item},hasOwnProperty=(this.instanceOf=function(item,object){if(null==item)return!1;for(var constructor=item.$constructor||item.constructor;constructor;){if(constructor===object)return!0;constructor=constructor.parent}return!!item.hasOwnProperty&&item instanceof object},Object.prototype.hasOwnProperty),enumerables=!0;for(var i in{toString:1})enumerables=null;enumerables&&(enumerables=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]);var Function=this.Function;Function.prototype.overloadSetter=function(usePlural){var self=this;return function(a,b){if(null==a)return this;if(usePlural||"string"!=typeof a){for(var k in a)self.call(this,k,a[k]);forEachObjectEnumberableKey(a,self,this)}else self.call(this,a,b);return this}},Function.prototype.overloadGetter=function(usePlural){var self=this;return function(a){var args,result;if("string"!=typeof a?args=a:arguments.length>1?args=arguments:usePlural&&(args=[a]),args){result={};for(var i=0;i<args.length;i++)result[args[i]]=self.call(this,args[i])}else result=self.call(this,a);return result}},Function.prototype.extend=function(key,value){this[key]=value}.overloadSetter(),Function.prototype.implement=function(key,value){this.prototype[key]=value}.overloadSetter();var slice=Array.prototype.slice;Array.convert=function(item){return null==item?[]:Type.isEnumerable(item)&&"string"!=typeof item?"array"==typeOf(item)?item:slice.call(item):[item]},Function.convert=function(item){return"function"==typeOf(item)?item:function(){return item}},Number.convert=function(item){var number=parseFloat(item);return isFinite(number)?number:null},String.convert=function(item){return item+""},Function.from=Function.convert,Number.from=Number.convert,String.from=String.convert,Function.implement({hide:function(){return this.$hidden=!0,this},protect:function(){return this.$protected=!0,this}});var Type=this.Type=function(name,object){if(name){var lower=name.toLowerCase();Type["is"+name]=function(item){return typeOf(item)==lower},null!=object&&(object.prototype.$family=function(){return lower}.hide())}return null==object?null:(object.extend(this),object.$constructor=Type,object.prototype.$constructor=object,object)},toString=Object.prototype.toString;Type.isEnumerable=function(item){return null!=item&&"number"==typeof item.length&&"[object Function]"!=toString.call(item)};var hooks={},hooksOf=function(object){var type=typeOf(object.prototype);return hooks[type]||(hooks[type]=[])},implement=function(name,method){if(!method||!method.$hidden){for(var hooks=hooksOf(this),i=0;i<hooks.length;i++){var hook=hooks[i];"type"==typeOf(hook)?implement.call(hook,name,method):hook.call(this,name,method)}var previous=this.prototype[name];null!=previous&&previous.$protected||(this.prototype[name]=method),null==this[name]&&"function"==typeOf(method)&&extend.call(this,name,(function(item){return method.apply(item,slice.call(arguments,1))}))}},extend=function(name,method){if(!method||!method.$hidden){var previous=this[name];null!=previous&&previous.$protected||(this[name]=method)}};Type.implement({implement:implement.overloadSetter(),extend:extend.overloadSetter(),alias:function(name,existing){implement.call(this,name,this.prototype[existing])}.overloadSetter(),mirror:function(hook){return hooksOf(this).push(hook),this}}),new Type("Type",Type);var force=function(name,object,methods){var isType=object!=Object,prototype=object.prototype;isType&&(object=new Type(name,object));for(var i=0,l=methods.length;l>i;i++){var key=methods[i],generic=object[key],proto=prototype[key];generic&&generic.protect(),isType&&proto&&object.implement(key,proto.protect())}if(isType){var methodsEnumerable=prototype.propertyIsEnumerable(methods[0]);object.forEachMethod=function(fn){if(!methodsEnumerable)for(var i=0,l=methods.length;l>i;i++)fn.call(prototype,prototype[methods[i]],methods[i]);for(var key in prototype)fn.call(prototype,prototype[key],key)}}return force};force("String",String,["charAt","charCodeAt","concat","contains","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","trim","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight","contains"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",Function,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]),Object.extend=extend.overloadSetter(),Date.extend("now",(function(){return+new Date})),new Type("Boolean",Boolean),Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide(),Number.extend("random",(function(min,max){return Math.floor(Math.random()*(max-min+1)+min)})),Array.implement({forEach:function(fn,bind){for(var i=0,l=this.length;l>i;i++)i in this&&fn.call(bind,this[i],i,this)},each:function(fn,bind){return Array.forEach(this,fn,bind),this}}),Object.extend({keys:function(object){var keys=[];for(var k in object)hasOwnProperty.call(object,k)&&keys.push(k);return forEachObjectEnumberableKey(object,(function(k){keys.push(k)})),keys},forEach:function(object,fn,bind){Object.keys(object).forEach((function(key){fn.call(bind,object[key],key,object)}))}}),Object.each=Object.forEach;var cloneOf=function(item){switch(typeOf(item)){case"array":return item.clone();case"object":return Object.clone(item);default:return item}};Array.implement("clone",(function(){for(var i=this.length,clone=new Array(i);i--;)clone[i]=cloneOf(this[i]);return clone}));var mergeOne=function(source,key,current){switch(typeOf(current)){case"object":"object"==typeOf(source[key])?Object.merge(source[key],current):source[key]=Object.clone(current);break;case"array":source[key]=current.clone();break;default:source[key]=current}return source};Object.extend({merge:function(source,k,v){if("string"==typeOf(k))return mergeOne(source,k,v);for(var i=1,l=arguments.length;l>i;i++){var object=arguments[i];for(var key in object)mergeOne(source,key,object[key])}return source},clone:function(object){var clone={};for(var key in object)clone[key]=cloneOf(object[key]);return clone},append:function(original){for(var i=1,l=arguments.length;l>i;i++){var extended=arguments[i]||{};for(var key in extended)original[key]=extended[key]}return original}}),["Object","WhiteSpace","TextNode","Collection","Arguments"].each((function(name){new Type(name)}));var UID=Date.now();String.extend("uniqueID",(function(){return(UID++).toString(36)}))}(),Array.implement({every:function(fn,bind){for(var i=0,l=this.length>>>0;l>i;i++)if(i in this&&!fn.call(bind,this[i],i,this))return!1;return!0},filter:function(fn,bind){for(var value,results=[],i=0,l=this.length>>>0;l>i;i++)i in this&&(value=this[i],fn.call(bind,value,i,this)&&results.push(value));return results},indexOf:function(item,from){for(var length=this.length>>>0,i=0>from?Math.max(0,length+from):from||0;length>i;i++)if(this[i]===item)return i;return-1},map:function(fn,bind){for(var length=this.length>>>0,results=Array(length),i=0;length>i;i++)i in this&&(results[i]=fn.call(bind,this[i],i,this));return results},some:function(fn,bind){for(var i=0,l=this.length>>>0;l>i;i++)if(i in this&&fn.call(bind,this[i],i,this))return!0;return!1},clean:function(){return this.filter((function(item){return null!=item}))},invoke:function(methodName){var args=Array.slice(arguments,1);return this.map((function(item){return item[methodName].apply(item,args)}))},associate:function(keys){for(var obj={},length=Math.min(this.length,keys.length),i=0;length>i;i++)obj[keys[i]]=this[i];return obj},link:function(object){for(var result={},i=0,l=this.length;l>i;i++)for(var key in object)if(object[key](this[i])){result[key]=this[i],delete object[key];break}return result},contains:function(item,from){return-1!=this.indexOf(item,from)},append:function(array){return this.push.apply(this,array),this},getLast:function(){return this.length?this[this.length-1]:null},getRandom:function(){return this.length?this[Number.random(0,this.length-1)]:null},include:function(item){return this.contains(item)||this.push(item),this},combine:function(array){for(var i=0,l=array.length;l>i;i++)this.include(array[i]);return this},erase:function(item){for(var i=this.length;i--;)this[i]===item&&this.splice(i,1);return this},empty:function(){return this.length=0,this},flatten:function(){for(var array=[],i=0,l=this.length;l>i;i++){var type=typeOf(this[i]);"null"!=type&&(array=array.concat("array"==type||"collection"==type||"arguments"==type||instanceOf(this[i],Array)?Array.flatten(this[i]):this[i]))}return array},pick:function(){for(var i=0,l=this.length;l>i;i++)if(null!=this[i])return this[i];return null},hexToRgb:function(array){if(3!=this.length)return null;var rgb=this.map((function(value){return 1==value.length&&(value+=value),parseInt(value,16)}));return array?rgb:"rgb("+rgb+")"},rgbToHex:function(array){if(this.length<3)return null;if(4==this.length&&0==this[3]&&!array)return"transparent";for(var hex=[],i=0;3>i;i++){var bit=(this[i]-0).toString(16);hex.push(1==bit.length?"0"+bit:bit)}return array?hex:"#"+hex.join("")}}),String.implement({contains:function(string,index){return(index?String(this).slice(index):String(this)).indexOf(string)>-1},test:function(regex,params){return("regexp"==typeOf(regex)?regex:new RegExp(""+regex,params)).test(this)},trim:function(){return String(this).replace(/^\s+|\s+$/g,"")},clean:function(){return String(this).replace(/\s+/g," ").trim()},camelCase:function(){return String(this).replace(/-\D/g,(function(match){return match.charAt(1).toUpperCase()}))},hyphenate:function(){return String(this).replace(/[A-Z]/g,(function(match){return"-"+match.charAt(0).toLowerCase()}))},capitalize:function(){return String(this).replace(/\b[a-z]/g,(function(match){return match.toUpperCase()}))},escapeRegExp:function(){return String(this).replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(base){return parseInt(this,base||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(array){var hex=String(this).match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return hex?hex.slice(1).hexToRgb(array):null},rgbToHex:function(array){var rgb=String(this).match(/\d{1,3}/g);return rgb?rgb.rgbToHex(array):null},substitute:function(object,regexp){return String(this).replace(regexp||/\\?\{([^{}]+)\}/g,(function(match,name){return"\\"==match.charAt(0)?match.slice(1):null!=object[name]?object[name]:""}))}}),Number.implement({limit:function(min,max){return Math.min(max,Math.max(min,this))},round:function(precision){return precision=Math.pow(10,precision||0).toFixed(0>precision?-precision:0),Math.round(this*precision)/precision},times:function(fn,bind){for(var i=0;this>i;i++)fn.call(bind,i,this)},toFloat:function(){return parseFloat(this)},toInt:function(base){return parseInt(this,base||10)}}),Number.alias("each","times"),function(math){var methods={};["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"].each((function(name){Number[name]||(methods[name]=function(){return Math[name].apply(null,[this].concat(Array.convert(arguments)))})})),Number.implement(methods)}(),Function.extend({attempt:function(){for(var i=0,l=arguments.length;l>i;i++)try{return arguments[i]()}catch(e){}return null}}),Function.implement({attempt:function(args,bind){try{return this.apply(bind,Array.convert(args))}catch(e){}return null},bind:function(that){var self=this,args=arguments.length>1?Array.slice(arguments,1):null,F=function(){},bound=function(){var context=that,length=arguments.length;this instanceof bound&&(F.prototype=self.prototype,context=new F);var result=args||length?self.apply(context,args&&length?args.concat(Array.slice(arguments)):args||arguments):self.call(context);return context==that?result:context};return bound},pass:function(args,bind){var self=this;return null!=args&&(args=Array.convert(args)),function(){return self.apply(bind,args||arguments)}},delay:function(delay,bind,args){return setTimeout(this.pass(null==args?[]:args,bind),delay)},periodical:function(periodical,bind,args){return setInterval(this.pass(null==args?[]:args,bind),periodical)}}),Object.extend({subset:function(object,keys){for(var results={},i=0,l=keys.length;l>i;i++){var k=keys[i];k in object&&(results[k]=object[k])}return results},map:function(object,fn,bind){for(var results={},keys=Object.keys(object),i=0;i<keys.length;i++){var key=keys[i];results[key]=fn.call(bind,object[key],key,object)}return results},filter:function(object,fn,bind){for(var results={},keys=Object.keys(object),i=0;i<keys.length;i++){var key=keys[i],value=object[key];fn.call(bind,value,key,object)&&(results[key]=value)}return results},every:function(object,fn,bind){for(var keys=Object.keys(object),i=0;i<keys.length;i++){var key=keys[i];if(!fn.call(bind,object[key],key))return!1}return!0},some:function(object,fn,bind){for(var keys=Object.keys(object),i=0;i<keys.length;i++){var key=keys[i];if(fn.call(bind,object[key],key))return!0}return!1},values:function(object){for(var values=[],keys=Object.keys(object),i=0;i<keys.length;i++){var k=keys[i];values.push(object[k])}return values},getLength:function(object){return Object.keys(object).length},keyOf:function(object,value){for(var keys=Object.keys(object),i=0;i<keys.length;i++){var key=keys[i];if(object[key]===value)return key}return null},contains:function(object,value){return null!=Object.keyOf(object,value)},toQueryString:function(object,base){var queryString=[];return Object.each(object,(function(value,key){var result;switch(base&&(key=base+"["+key+"]"),typeOf(value)){case"object":result=Object.toQueryString(value,key);break;case"array":var qs={};value.each((function(val,i){qs[i]=val})),result=Object.toQueryString(qs,key);break;default:result=key+"="+encodeURIComponent(value)}null!=value&&queryString.push(result)})),queryString.join("&")}}),function(){var XMLHTTP,MSXML2,MSXML,document=this.document,window=document.window=this,parse=function(ua,platform){ua=ua.toLowerCase(),platform=platform?platform.toLowerCase():"";var UA=ua.match(/(edge)[\s\/:]([\w\d\.]+)/);return UA||(UA=ua.match(/(opera|ie|firefox|chrome|trident|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|(?:rv[\s\/:]|version[\s\/:])([\w\d\.]+)|$)/)||[null,"unknown",0]),"trident"==UA[1]?(UA[1]="ie",UA[4]&&(UA[2]=UA[4])):"crios"==UA[1]&&(UA[1]="chrome"),"win"==(platform=ua.match(/ip(?:ad|od|hone)/)?"ios":(ua.match(/(?:webos|android)/)||ua.match(/mac|win|linux/)||["other"])[0])&&(platform="windows"),{extend:Function.prototype.extend,name:"version"==UA[1]?UA[3]:UA[1],version:parseFloat("opera"==UA[1]&&UA[4]?UA[4]:UA[2]),platform:platform}},Browser=this.Browser=parse(navigator.userAgent,navigator.platform);if("ie"==Browser.name&&document.documentMode&&(Browser.version=document.documentMode),Browser.extend({Features:{xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector,json:!!window.JSON},parseUA:parse}),Browser.Request=(XMLHTTP=function(){return new XMLHttpRequest},MSXML2=function(){return new ActiveXObject("MSXML2.XMLHTTP")},MSXML=function(){return new ActiveXObject("Microsoft.XMLHTTP")},Function.attempt((function(){return XMLHTTP(),XMLHTTP}),(function(){return MSXML2(),MSXML2}),(function(){return MSXML(),MSXML}))),Browser.Features.xhr=!!Browser.Request,Browser.exec=function(text){if(!text)return text;if(window.execScript)window.execScript(text);else{var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.text=text,document.head.appendChild(script),document.head.removeChild(script)}return text},String.implement("stripScripts",(function(exec){var scripts="",text=this.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,(function(all,code){return scripts+=code+"\n",""}));return!0===exec?Browser.exec(scripts):"function"==typeOf(exec)&&exec(scripts,text),text})),Browser.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event}),this.Window=this.$constructor=new Type("Window",(function(){})),this.$family=Function.convert("window").hide(),Window.mirror((function(name,method){window[name]=method})),this.Document=document.$constructor=new Type("Document",(function(){})),document.$family=Function.convert("document").hide(),Document.mirror((function(name,method){document[name]=method})),document.html=document.documentElement,document.head||(document.head=document.getElementsByTagName("head")[0]),document.execCommand)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}if(this.attachEvent&&!this.addEventListener){var unloadEvent=function(){this.detachEvent("onunload",unloadEvent),document.head=document.html=document.window=null,window=this.Window=document=null};this.attachEvent("onunload",unloadEvent)}var arrayFrom=Array.convert;try{arrayFrom(document.html.childNodes)}catch(e){Array.convert=function(item){if("string"!=typeof item&&Type.isEnumerable(item)&&"array"!=typeOf(item)){for(var i=item.length,array=new Array(i);i--;)array[i]=item[i];return array}return arrayFrom(item)};var prototype=Array.prototype,slice=prototype.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each((function(name){var method=prototype[name];Array[name]=function(item){return method.apply(Array.convert(item),slice.call(arguments,1))}}))}}(),function(){var _keys={},DOMEvent=this.DOMEvent=new Type("DOMEvent",(function(event,win){if(win||(win=window),(event=event||win.event).$extended)return event;this.event=event,this.$extended=!0,this.shift=event.shiftKey,this.control=event.ctrlKey,this.alt=event.altKey,this.meta=event.metaKey;for(var type=this.type=event.type,target=event.target||event.srcElement;target&&3==target.nodeType;)target=target.parentNode;if(this.target=document.id(target),0==type.indexOf("key")){var code=this.code=event.which||event.keyCode;this.shift&&"keypress"==type||(this.key=_keys[code]),("keydown"==type||"keyup"==type)&&(code>111&&124>code?this.key="f"+(code-111):code>95&&106>code&&(this.key=code-96)),null==this.key&&(this.key=String.fromCharCode(code).toLowerCase())}else if("click"==type||"dblclick"==type||"contextmenu"==type||"wheel"==type||"DOMMouseScroll"==type||0==type.indexOf("mouse")){var doc=win.document;if(doc=doc.compatMode&&"CSS1Compat"!=doc.compatMode?doc.body:doc.html,this.page={x:null!=event.pageX?event.pageX:event.clientX+doc.scrollLeft,y:null!=event.pageY?event.pageY:event.clientY+doc.scrollTop},this.client={x:null!=event.pageX?event.pageX-win.pageXOffset:event.clientX,y:null!=event.pageY?event.pageY-win.pageYOffset:event.clientY},("DOMMouseScroll"==type||"wheel"==type||"mousewheel"==type)&&(this.wheel=function(event){var normalized;if(event.wheelDelta)normalized=event.wheelDelta%120==0?event.wheelDelta/120:event.wheelDelta/12;else{var rawAmount=event.deltaY||event.detail||0;normalized=-(rawAmount%3==0?rawAmount/3:10*rawAmount)}return normalized}(event)),this.rightClick=3==event.which||2==event.button,"mouseover"==type||"mouseout"==type||"mouseenter"==type||"mouseleave"==type){for(var overTarget="mouseover"==type||"mouseenter"==type,related=event.relatedTarget||event[(overTarget?"from":"to")+"Element"];related&&3==related.nodeType;)related=related.parentNode;this.relatedTarget=document.id(related)}}else if(0==type.indexOf("touch")||0==type.indexOf("gesture")){this.rotation=event.rotation,this.scale=event.scale,this.targetTouches=event.targetTouches,this.changedTouches=event.changedTouches;var touches=this.touches=event.touches;if(touches&&touches[0]){var touch=touches[0];this.page={x:touch.pageX,y:touch.pageY},this.client={x:touch.clientX,y:touch.clientY}}}this.client||(this.client={}),this.page||(this.page={})}));DOMEvent.implement({stop:function(){return this.preventDefault().stopPropagation()},stopPropagation:function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0,this},preventDefault:function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1,this}}),DOMEvent.defineKey=function(code,key){return _keys[code]=key,this},DOMEvent.defineKeys=DOMEvent.defineKey.overloadSetter(!0),DOMEvent.defineKeys({38:"up",40:"down",37:"left",39:"right",27:"esc",32:"space",8:"backspace",9:"tab",46:"delete",13:"enter"})}(),function(){var Class=this.Class=new Type("Class",(function(params){instanceOf(params,Function)&&(params={initialize:params});var newClass=function(){if(reset(this),newClass.$prototyping)return this;this.$caller=null,this.$family=null;var value=this.initialize?this.initialize.apply(this,arguments):this;return this.$caller=this.caller=null,value}.extend(this).implement(params);return newClass.$constructor=Class,newClass.prototype.$constructor=newClass,newClass.prototype.parent=parent,newClass})),parent=function(){if(!this.$caller)throw new Error('The method "parent" cannot be called.');var name=this.$caller.$name,parent=this.$caller.$owner.parent,previous=parent?parent.prototype[name]:null;if(!previous)throw new Error('The method "'+name+'" has no parent.');return previous.apply(this,arguments)},reset=function(object){for(var key in object){var value=object[key];switch(typeOf(value)){case"object":var F=function(){};F.prototype=value,object[key]=reset(new F);break;case"array":object[key]=value.clone()}}return object},implement=function(key,value,retain){if(Class.Mutators.hasOwnProperty(key)&&null==(value=Class.Mutators[key].call(this,value)))return this;if("function"==typeOf(value)){if(value.$hidden)return this;this.prototype[key]=retain?value:function(self,key,method){method.$origin&&(method=method.$origin);var wrapper=function(){if(method.$protected&&null==this.$caller)throw new Error('The method "'+key+'" cannot be called.');var caller=this.caller,current=this.$caller;this.caller=current,this.$caller=wrapper;var result=method.apply(this,arguments);return this.$caller=current,this.caller=caller,result}.extend({$owner:self,$origin:method,$name:key});return wrapper}(this,key,value)}else Object.merge(this.prototype,key,value);return this};Class.implement("implement",implement.overloadSetter()),Class.Mutators={Extends:function(parent){this.parent=parent,this.prototype=function(klass){klass.$prototyping=!0;var proto=new klass;return delete klass.$prototyping,proto}(parent)},Implements:function(items){Array.convert(items).each((function(item){var instance=new item;for(var key in instance)implement.call(this,key,instance[key],!0)}),this)}}}(),function(){this.Chain=new Class({$chain:[],chain:function(){return this.$chain.append(Array.flatten(arguments)),this},callChain:function(){return!!this.$chain.length&&this.$chain.shift().apply(this,arguments)},clearChain:function(){return this.$chain.empty(),this}});var removeOn=function(string){return string.replace(/^on([A-Z])/,(function(full,first){return first.toLowerCase()}))};this.Events=new Class({$events:{},addEvent:function(type,fn,internal){return type=removeOn(type),this.$events[type]=(this.$events[type]||[]).include(fn),internal&&(fn.internal=!0),this},addEvents:function(events){for(var type in events)this.addEvent(type,events[type]);return this},fireEvent:function(type,args,delay){type=removeOn(type);var events=this.$events[type];return events?(args=Array.convert(args),events.each((function(fn){delay?fn.delay(delay,this,args):fn.apply(this,args)}),this),this):this},removeEvent:function(type,fn){type=removeOn(type);var events=this.$events[type];if(events&&!fn.internal){var index=events.indexOf(fn);-1!=index&&delete events[index]}return this},removeEvents:function(events){var type;if("object"==typeOf(events)){for(type in events)this.removeEvent(type,events[type]);return this}for(type in events&&(events=removeOn(events)),this.$events)if(!events||events==type)for(var fns=this.$events[type],i=fns.length;i--;)i in fns&&this.removeEvent(type,fns[i]);return this}}),this.Options=new Class({setOptions:function(){var options=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent)for(var option in options)"function"==typeOf(options[option])&&/^on[A-Z]/.test(option)&&(this.addEvent(option,options[option]),delete options[option]);return this}})}(),function(){function resolve(thenable,value){if(thenable.$thenableState===STATE_PENDING)if(thenable===value)reject(thenable,new TypeError("Tried to resolve a thenable with itself."));else if(!value||"object"!=typeof value&&"function"!=typeof value)fulfill(thenable,value);else{var then;try{then=value.then}catch(exception){reject(thenable,exception)}if("function"==typeof then){var resolved=!1;defer((function(){try{then.call(value,(function(nextValue){resolved||(resolved=!0,resolve(thenable,nextValue))}),(function(reason){resolved||(resolved=!0,reject(thenable,reason))}))}catch(exception){resolved||(resolved=!0,reject(thenable,exception))}}))}else fulfill(thenable,value)}}function fulfill(thenable,value){thenable.$thenableState===STATE_PENDING&&(thenable.$thenableResult=value,thenable.$thenableState=STATE_FULFILLED,react(thenable))}function reject(thenable,reason){thenable.$thenableState===STATE_PENDING&&(thenable.$thenableResult=reason,thenable.$thenableState=STATE_REJECTED,react(thenable))}function react(thenable){var type,state=thenable.$thenableState,result=thenable.$thenableResult,reactions=thenable.$thenableReactions;state===STATE_FULFILLED?(thenable.$thenableReactions=[],type="fulfillHandler"):state==STATE_REJECTED&&(thenable.$thenableReactions=[],type="rejectHandler"),type&&defer(handle.pass([result,reactions,type]))}function handle(result,reactions,type){for(var i=0,l=reactions.length;l>i;++i){var reaction=reactions[i],handler=reaction[type];if("Identity"===handler)resolve(reaction.thenable,result);else if("Thrower"===handler)reject(reaction.thenable,result);else try{resolve(reaction.thenable,handler(result))}catch(exception){reject(reaction.thenable,exception)}}}var defer,STATE_PENDING=0,STATE_FULFILLED=1,STATE_REJECTED=2,Thenable=Class.Thenable=new Class({$thenableState:STATE_PENDING,$thenableResult:null,$thenableReactions:[],resolve:function(value){return resolve(this,value),this},reject:function(reason){return reject(this,reason),this},getThenableState:function(){switch(this.$thenableState){case STATE_PENDING:return"pending";case STATE_FULFILLED:return"fulfilled";case STATE_REJECTED:return"rejected"}},resetThenable:function(reason){return reject(this,reason),(thenable=this).$thenableState!==STATE_PENDING&&(thenable.$thenableResult=null,thenable.$thenableState=STATE_PENDING),this;var thenable},then:function(onFulfilled,onRejected){"function"!=typeof onFulfilled&&(onFulfilled="Identity"),"function"!=typeof onRejected&&(onRejected="Thrower");var thenable=new Thenable;return this.$thenableReactions.push({thenable:thenable,fulfillHandler:onFulfilled,rejectHandler:onRejected}),this.$thenableState!==STATE_PENDING&&react(this),thenable},catch:function(onRejected){return this.then(null,onRejected)}});Thenable.extend({resolve:function(value){var thenable;return value instanceof Thenable?thenable=value:resolve(thenable=new Thenable,value),thenable},reject:function(reason){var thenable=new Thenable;return reject(thenable,reason),thenable}}),defer="undefined"!=typeof process&&"function"==typeof process.nextTick?process.nextTick:"undefined"!=typeof setImmediate?setImmediate:function(fn){setTimeout(fn,0)}}(),function(){function parser(rawMatch,separator,combinator,combinatorChildren,tagName,id,className,attributeKey,attributeOperator,attributeQuote,attributeValue,pseudoMarker,pseudoClass,pseudoQuote,pseudoClassQuotedValue,pseudoClassValue){if((separator||-1===separatorIndex)&&(parsed.expressions[++separatorIndex]=[],combinatorIndex=-1,separator))return"";if(combinator||combinatorChildren||-1===combinatorIndex){combinator=combinator||" ";var currentSeparator=parsed.expressions[separatorIndex];reversed&&currentSeparator[combinatorIndex]&&(currentSeparator[combinatorIndex].reverseCombinator=reverseCombinator(combinator)),currentSeparator[++combinatorIndex]={combinator:combinator,tag:"*"}}var currentParsed=parsed.expressions[separatorIndex][combinatorIndex];if(tagName)currentParsed.tag=tagName.replace(reUnescape,"");else if(id)currentParsed.id=id.replace(reUnescape,"");else if(className)className=className.replace(reUnescape,""),currentParsed.classList||(currentParsed.classList=[]),currentParsed.classes||(currentParsed.classes=[]),currentParsed.classList.push(className),currentParsed.classes.push({value:className,regexp:new RegExp("(^|\\s)"+escapeRegExp(className)+"(\\s|$)")});else if(pseudoClass)pseudoClassValue=(pseudoClassValue=pseudoClassValue||pseudoClassQuotedValue)?pseudoClassValue.replace(reUnescape,""):null,currentParsed.pseudos||(currentParsed.pseudos=[]),currentParsed.pseudos.push({key:pseudoClass.replace(reUnescape,""),value:pseudoClassValue,type:1==pseudoMarker.length?"class":"element"});else if(attributeKey){var test,regexp;switch(attributeKey=attributeKey.replace(reUnescape,""),attributeValue=(attributeValue||"").replace(reUnescape,""),attributeOperator){case"^=":regexp=new RegExp("^"+escapeRegExp(attributeValue));break;case"$=":regexp=new RegExp(escapeRegExp(attributeValue)+"$");break;case"~=":regexp=new RegExp("(^|\\s)"+escapeRegExp(attributeValue)+"(\\s|$)");break;case"|=":regexp=new RegExp("^"+escapeRegExp(attributeValue)+"(-|$)");break;case"=":test=function(value){return attributeValue==value};break;case"*=":test=function(value){return value&&value.indexOf(attributeValue)>-1};break;case"!=":test=function(value){return attributeValue!=value};break;default:test=function(value){return!!value}}""==attributeValue&&/^[*$^]=$/.test(attributeOperator)&&(test=function(){return!1}),test||(test=function(value){return value&&regexp.test(value)}),currentParsed.attributes||(currentParsed.attributes=[]),currentParsed.attributes.push({key:attributeKey,operator:attributeOperator,value:attributeValue,test:test})}return""}var parsed,separatorIndex,combinatorIndex,reversed,cache={},reverseCache={},reUnescape=/\\/g,parse=function(expression,isReversed){if(null==expression)return null;if(!0===expression.Slick)return expression;expression=(""+expression).replace(/^\s+|\s+$/g,"");var currentCache=(reversed=!!isReversed)?reverseCache:cache;if(currentCache[expression])return currentCache[expression];for(parsed={Slick:!0,expressions:[],raw:expression,reverse:function(){return parse(this.raw,!0)}},separatorIndex=-1;expression!=(expression=expression.replace(regexp,parser)););return parsed.length=parsed.expressions.length,currentCache[parsed.raw]=reversed?reverse(parsed):parsed},reverseCombinator=function(combinator){return"!"===combinator?" ":" "===combinator?"!":/^!/.test(combinator)?combinator.replace(/^!/,""):"!"+combinator},reverse=function(expression){for(var expressions=expression.expressions,i=0;i<expressions.length;i++){for(var exp=expressions[i],last={parts:[],tag:"*",combinator:reverseCombinator(exp[0].combinator)},j=0;j<exp.length;j++){var cexp=exp[j];cexp.reverseCombinator||(cexp.reverseCombinator=" "),cexp.combinator=cexp.reverseCombinator,delete cexp.reverseCombinator}exp.reverse().push(last)}return expression},escapeRegExp=function(string){return string.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,(function(match){return"\\"+match}))},regexp=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+escapeRegExp(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])")),Slick=this.Slick||{};Slick.parse=function(expression){return parse(expression)},Slick.escapeRegExp=escapeRegExp,this.Slick||(this.Slick=Slick)}.apply("undefined"!=typeof exports?exports:this),function(){var local={},featuresCache={},toString=Object.prototype.toString;local.isNativeCode=function(fn){return/\{\s*\[native code\]\s*\}/.test(""+fn)},local.isXML=function(document){return!!document.xmlVersion||!!document.xml||"[object XMLDocument]"==toString.call(document)||9==document.nodeType&&"HTML"!=document.documentElement.nodeName},local.setDocument=function(document){var nodeType=document.nodeType;if(9==nodeType);else if(nodeType)document=document.ownerDocument;else{if(!document.navigator)return;document=document.document}if(this.document!==document){this.document=document;var feature,root=document.documentElement,rootUid=this.getUIDXML(root),features=featuresCache[rootUid];if(features)for(feature in features)this[feature]=features[feature];else{(features=featuresCache[rootUid]={}).root=root,features.isXMLDocument=this.isXML(document),features.brokenStarGEBTN=features.starSelectsClosedQSA=features.idGetsName=features.brokenMixedCaseQSA=features.brokenGEBCN=features.brokenCheckedQSA=features.brokenEmptyAttributeQSA=features.isHTMLDocument=features.nativeMatchesSelector=!1;var starSelectsClosed,starSelectsComments,brokenSecondClassNameGEBCN,cachedGetElementsByClassName,brokenFormAttributeGetter,selected,id="slick_uniqueid",testNode=document.createElement("div"),testRoot=document.body||document.getElementsByTagName("body")[0]||root;testRoot.appendChild(testNode);try{testNode.innerHTML='<a id="'+id+'"></a>',features.isHTMLDocument=!!document.getElementById(id)}catch(e){}if(features.isHTMLDocument){testNode.style.display="none",testNode.appendChild(document.createComment("")),starSelectsComments=testNode.getElementsByTagName("*").length>1;try{testNode.innerHTML="foo</foo>",starSelectsClosed=(selected=testNode.getElementsByTagName("*"))&&!!selected.length&&"/"==selected[0].nodeName.charAt(0)}catch(e){}features.brokenStarGEBTN=starSelectsComments||starSelectsClosed;try{testNode.innerHTML='<a name="'+id+'"></a><b id="'+id+'"></b>',features.idGetsName=document.getElementById(id)===testNode.firstChild}catch(e){}if(testNode.getElementsByClassName){try{testNode.innerHTML='<a class="f"></a><a class="b"></a>',testNode.getElementsByClassName("b").length,testNode.firstChild.className="b",cachedGetElementsByClassName=2!=testNode.getElementsByClassName("b").length}catch(e){}try{testNode.innerHTML='<a class="a"></a><a class="f b a"></a>',brokenSecondClassNameGEBCN=2!=testNode.getElementsByClassName("a").length}catch(e){}features.brokenGEBCN=cachedGetElementsByClassName||brokenSecondClassNameGEBCN}if(testNode.querySelectorAll){try{testNode.innerHTML="foo</foo>",selected=testNode.querySelectorAll("*"),features.starSelectsClosedQSA=selected&&!!selected.length&&"/"==selected[0].nodeName.charAt(0)}catch(e){}try{testNode.innerHTML='<a class="MiX"></a>',features.brokenMixedCaseQSA=!testNode.querySelectorAll(".MiX").length}catch(e){}try{testNode.innerHTML='<select><option selected="selected">a</option></select>',features.brokenCheckedQSA=0==testNode.querySelectorAll(":checked").length}catch(e){}try{testNode.innerHTML='<a class=""></a>',features.brokenEmptyAttributeQSA=0!=testNode.querySelectorAll('[class*=""]').length}catch(e){}}try{testNode.innerHTML='<form action="s"><input id="action"/></form>',brokenFormAttributeGetter="s"!=testNode.firstChild.getAttribute("action")}catch(e){}if(features.nativeMatchesSelector=root.matches||root.mozMatchesSelector||root.webkitMatchesSelector,features.nativeMatchesSelector)try{features.nativeMatchesSelector.call(root,":slick"),features.nativeMatchesSelector=null}catch(e){}}try{root.slick_expando=1,delete root.slick_expando,features.getUID=this.getUIDHTML}catch(e){features.getUID=this.getUIDXML}testRoot.removeChild(testNode),testNode=selected=testRoot=null,features.getAttribute=features.isHTMLDocument&&brokenFormAttributeGetter?function(node,name){var method=this.attributeGetters[name];if(method)return method.call(node);var attributeNode=node.getAttributeNode(name);return attributeNode?attributeNode.nodeValue:null}:function(node,name){var method=this.attributeGetters[name];return method?method.call(node):node.getAttribute(name)},features.hasAttribute=root&&this.isNativeCode(root.hasAttribute)?function(node,attribute){return node.hasAttribute(attribute)}:function(node,attribute){return!(!(node=node.getAttributeNode(attribute))||!node.specified&&!node.nodeValue)};var nativeRootContains=root&&this.isNativeCode(root.contains),nativeDocumentContains=document&&this.isNativeCode(document.contains);for(feature in features.contains=nativeRootContains&&nativeDocumentContains?function(context,node){return context.contains(node)}:nativeRootContains&&!nativeDocumentContains?function(context,node){return context===node||(context===document?document.documentElement:context).contains(node)}:root&&root.compareDocumentPosition?function(context,node){return context===node||!!(16&context.compareDocumentPosition(node))}:function(context,node){if(node)do{if(node===context)return!0}while(node=node.parentNode);return!1},features.documentSorter=root.compareDocumentPosition?function(a,b){return a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:a===b?0:1:0}:"sourceIndex"in root?function(a,b){return a.sourceIndex&&b.sourceIndex?a.sourceIndex-b.sourceIndex:0}:document.createRange?function(a,b){if(!a.ownerDocument||!b.ownerDocument)return 0;var aRange=a.ownerDocument.createRange(),bRange=b.ownerDocument.createRange();return aRange.setStart(a,0),aRange.setEnd(a,0),bRange.setStart(b,0),bRange.setEnd(b,0),aRange.compareBoundaryPoints(Range.START_TO_END,bRange)}:null,root=null,features)this[feature]=features[feature]}}};var reSimpleSelector=/^([#.]?)((?:[\w-]+|\*))$/,reEmptyAttribute=/\[.+[*$^]=(?:""|'')?\]/,qsaFailExpCache={};local.search=function(context,expression,append,first){var found=this.found=first?null:append||[];if(!context)return found;if(context.navigator)context=context.document;else if(!context.nodeType)return found;var parsed,i,node,nodes,uniques=this.uniques={},hasOthers=!(!append||!append.length),contextIsDocument=9==context.nodeType;if(this.document!==(contextIsDocument?context:context.ownerDocument)&&this.setDocument(context),hasOthers)for(i=found.length;i--;)uniques[this.getUID(found[i])]=!0;if("string"==typeof expression){var simpleSelector=expression.match(reSimpleSelector);simpleSelectors:if(simpleSelector){var symbol=simpleSelector[1],name=simpleSelector[2];if(symbol){if("#"==symbol){if(!this.isHTMLDocument||!contextIsDocument)break simpleSelectors;if(!(node=context.getElementById(name)))return found;if(this.idGetsName&&node.getAttributeNode("id").nodeValue!=name)break simpleSelectors;if(first)return node||null;hasOthers&&uniques[this.getUID(node)]||found.push(node)}else if("."==symbol){if(!this.isHTMLDocument||(!context.getElementsByClassName||this.brokenGEBCN)&&context.querySelectorAll)break simpleSelectors;if(context.getElementsByClassName&&!this.brokenGEBCN){if(nodes=context.getElementsByClassName(name),first)return nodes[0]||null;for(i=0;node=nodes[i++];)hasOthers&&uniques[this.getUID(node)]||found.push(node)}else{var matchClass=new RegExp("(^|\\s)"+Slick.escapeRegExp(name)+"(\\s|$)");for(nodes=context.getElementsByTagName("*"),i=0;node=nodes[i++];)if(className=node.className,className&&matchClass.test(className)){if(first)return node;hasOthers&&uniques[this.getUID(node)]||found.push(node)}}}}else{if("*"==name&&this.brokenStarGEBTN)break simpleSelectors;if(nodes=context.getElementsByTagName(name),first)return nodes[0]||null;for(i=0;node=nodes[i++];)hasOthers&&uniques[this.getUID(node)]||found.push(node)}return hasOthers&&this.sort(found),first?null:found}querySelector:if(context.querySelectorAll){if(!this.isHTMLDocument||qsaFailExpCache[expression]||this.brokenMixedCaseQSA||this.brokenCheckedQSA&&expression.indexOf(":checked")>-1||this.brokenEmptyAttributeQSA&&reEmptyAttribute.test(expression)||!contextIsDocument&&expression.indexOf(",")>-1||Slick.disableQSA)break querySelector;var currentId,_expression=expression,_context=context;contextIsDocument||(currentId=_context.getAttribute("id"),slickid="slickid__",_context.setAttribute("id",slickid),_expression="#"+slickid+" "+_expression,context=_context.parentNode);try{if(first)return context.querySelector(_expression)||null;nodes=context.querySelectorAll(_expression)}catch(e){qsaFailExpCache[expression]=1;break querySelector}finally{contextIsDocument||(currentId?_context.setAttribute("id",currentId):_context.removeAttribute("id"),context=_context)}if(this.starSelectsClosedQSA)for(i=0;node=nodes[i++];)!(node.nodeName>"@")||hasOthers&&uniques[this.getUID(node)]||found.push(node);else for(i=0;node=nodes[i++];)hasOthers&&uniques[this.getUID(node)]||found.push(node);return hasOthers&&this.sort(found),found}if(!(parsed=this.Slick.parse(expression)).length)return found}else{if(null==expression)return found;if(!expression.Slick)return this.contains(context.documentElement||context,expression)?(found?found.push(expression):found=expression,found):found;parsed=expression}this.posNTH={},this.posNTHLast={},this.posNTHType={},this.posNTHTypeLast={},this.push=!hasOthers&&(first||1==parsed.length&&1==parsed.expressions[0].length)?this.pushArray:this.pushUID,null==found&&(found=[]);var j,m,n,combinator,tag,id,classList,classes,attributes,pseudos,currentItems,currentExpression,currentBit,lastBit,expressions=parsed.expressions;search:for(i=0;currentExpression=expressions[i];i++)for(j=0;currentBit=currentExpression[j];j++){if(!this[combinator="combinator:"+currentBit.combinator])continue search;if(tag=this.isXMLDocument?currentBit.tag:currentBit.tag.toUpperCase(),id=currentBit.id,classList=currentBit.classList,classes=currentBit.classes,attributes=currentBit.attributes,pseudos=currentBit.pseudos,lastBit=j===currentExpression.length-1,this.bitUniques={},lastBit?(this.uniques=uniques,this.found=found):(this.uniques={},this.found=[]),0===j){if(this[combinator](context,tag,id,classes,attributes,pseudos,classList),first&&lastBit&&found.length)break search}else if(first&&lastBit){for(m=0,n=currentItems.length;n>m;m++)if(this[combinator](currentItems[m],tag,id,classes,attributes,pseudos,classList),found.length)break search}else for(m=0,n=currentItems.length;n>m;m++)this[combinator](currentItems[m],tag,id,classes,attributes,pseudos,classList);currentItems=this.found}return(hasOthers||parsed.expressions.length>1)&&this.sort(found),first?found[0]||null:found},local.uidx=1,local.uidk="slick-uniqueid",local.getUIDXML=function(node){var uid=node.getAttribute(this.uidk);return uid||(uid=this.uidx++,node.setAttribute(this.uidk,uid)),uid},local.getUIDHTML=function(node){return node.uniqueNumber||(node.uniqueNumber=this.uidx++)},local.sort=function(results){return this.documentSorter?(results.sort(this.documentSorter),results):results},local.cacheNTH={},local.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/,local.parseNTHArgument=function(argument){var parsed=argument.match(this.matchNTH);if(!parsed)return!1;var special=parsed[2]||!1,a=parsed[1]||1;"-"==a&&(a=-1);var b=+parsed[3]||0;return parsed="n"==special?{a:a,b:b}:"odd"==special?{a:2,b:1}:"even"==special?{a:2,b:0}:{a:0,b:a},this.cacheNTH[argument]=parsed},local.createNTHPseudo=function(child,sibling,positions,ofType){return function(node,argument){var uid=this.getUID(node);if(!this[positions][uid]){var parent=node.parentNode;if(!parent)return!1;var el=parent[child],count=1;if(ofType){var nodeName=node.nodeName;do{el.nodeName==nodeName&&(this[positions][this.getUID(el)]=count++)}while(el=el[sibling])}else do{1==el.nodeType&&(this[positions][this.getUID(el)]=count++)}while(el=el[sibling])}argument=argument||"n";var parsed=this.cacheNTH[argument]||this.parseNTHArgument(argument);if(!parsed)return!1;var a=parsed.a,b=parsed.b,pos=this[positions][uid];if(0==a)return b==pos;if(a>0){if(b>pos)return!1}else if(pos>b)return!1;return(pos-b)%a==0}},local.pushArray=function(node,tag,id,classes,attributes,pseudos){this.matchSelector(node,tag,id,classes,attributes,pseudos)&&this.found.push(node)},local.pushUID=function(node,tag,id,classes,attributes,pseudos){var uid=this.getUID(node);!this.uniques[uid]&&this.matchSelector(node,tag,id,classes,attributes,pseudos)&&(this.uniques[uid]=!0,this.found.push(node))},local.matchNode=function(node,selector){if(this.isHTMLDocument&&this.nativeMatchesSelector)try{return this.nativeMatchesSelector.call(node,selector.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(matchError){}var parsed=this.Slick.parse(selector);if(!parsed)return!0;var i,currentExpression,expressions=parsed.expressions,simpleExpCounter=0;for(i=0;currentExpression=expressions[i];i++)if(1==currentExpression.length){var exp=currentExpression[0];if(this.matchSelector(node,this.isXMLDocument?exp.tag:exp.tag.toUpperCase(),exp.id,exp.classes,exp.attributes,exp.pseudos))return!0;simpleExpCounter++}if(simpleExpCounter==parsed.length)return!1;var item,nodes=this.search(this.document,parsed);for(i=0;item=nodes[i++];)if(item===node)return!0;return!1},local.matchPseudo=function(node,name,argument){var pseudoName="pseudo:"+name;if(this[pseudoName])return this[pseudoName](node,argument);var attribute=this.getAttribute(node,name);return argument?argument==attribute:!!attribute},local.matchSelector=function(node,tag,id,classes,attributes,pseudos){if(tag){var nodeName=this.isXMLDocument?node.nodeName:node.nodeName.toUpperCase();if("*"==tag){if("@">nodeName)return!1}else if(nodeName!=tag)return!1}if(id&&node.getAttribute("id")!=id)return!1;var i,part,cls;if(classes)for(i=classes.length;i--;)if(!(cls=this.getAttribute(node,"class"))||!classes[i].regexp.test(cls))return!1;if(attributes)for(i=attributes.length;i--;)if((part=attributes[i]).operator?!part.test(this.getAttribute(node,part.key)):!this.hasAttribute(node,part.key))return!1;if(pseudos)for(i=pseudos.length;i--;)if(part=pseudos[i],!this.matchPseudo(node,part.key,part.value))return!1;return!0};var combinators={" ":function(node,tag,id,classes,attributes,pseudos,classList){var i,item,children;if(this.isHTMLDocument){getById:if(id){if(!(item=this.document.getElementById(id))&&node.all||this.idGetsName&&item&&item.getAttributeNode("id").nodeValue!=id){if(!(children=node.all[id]))return;for(children[0]||(children=[children]),i=0;item=children[i++];){var idNode=item.getAttributeNode("id");if(idNode&&idNode.nodeValue==id){this.push(item,tag,null,classes,attributes,pseudos);break}}return}if(!item){if(this.contains(this.root,node))return;break getById}if(this.document!==node&&!this.contains(node,item))return;return void this.push(item,tag,null,classes,attributes,pseudos)}getByClass:if(classes&&node.getElementsByClassName&&!this.brokenGEBCN){if(!(children=node.getElementsByClassName(classList.join(" ")))||!children.length)break getByClass;for(i=0;item=children[i++];)this.push(item,tag,id,null,attributes,pseudos);return}}if((children=node.getElementsByTagName(tag))&&children.length)for(this.brokenStarGEBTN||(tag=null),i=0;item=children[i++];)this.push(item,tag,id,classes,attributes,pseudos)},">":function(node,tag,id,classes,attributes,pseudos){if(node=node.firstChild)do{1==node.nodeType&&this.push(node,tag,id,classes,attributes,pseudos)}while(node=node.nextSibling)},"+":function(node,tag,id,classes,attributes,pseudos){for(;node=node.nextSibling;)if(1==node.nodeType){this.push(node,tag,id,classes,attributes,pseudos);break}},"^":function(node,tag,id,classes,attributes,pseudos){(node=node.firstChild)&&(1==node.nodeType?this.push(node,tag,id,classes,attributes,pseudos):this["combinator:+"](node,tag,id,classes,attributes,pseudos))},"~":function(node,tag,id,classes,attributes,pseudos){for(;node=node.nextSibling;)if(1==node.nodeType){var uid=this.getUID(node);if(this.bitUniques[uid])break;this.bitUniques[uid]=!0,this.push(node,tag,id,classes,attributes,pseudos)}},"++":function(node,tag,id,classes,attributes,pseudos){this["combinator:+"](node,tag,id,classes,attributes,pseudos),this["combinator:!+"](node,tag,id,classes,attributes,pseudos)},"~~":function(node,tag,id,classes,attributes,pseudos){this["combinator:~"](node,tag,id,classes,attributes,pseudos),this["combinator:!~"](node,tag,id,classes,attributes,pseudos)},"!":function(node,tag,id,classes,attributes,pseudos){for(;node=node.parentNode;)node!==this.document&&this.push(node,tag,id,classes,attributes,pseudos)},"!>":function(node,tag,id,classes,attributes,pseudos){(node=node.parentNode)!==this.document&&this.push(node,tag,id,classes,attributes,pseudos)},"!+":function(node,tag,id,classes,attributes,pseudos){for(;node=node.previousSibling;)if(1==node.nodeType){this.push(node,tag,id,classes,attributes,pseudos);break}},"!^":function(node,tag,id,classes,attributes,pseudos){(node=node.lastChild)&&(1==node.nodeType?this.push(node,tag,id,classes,attributes,pseudos):this["combinator:!+"](node,tag,id,classes,attributes,pseudos))},"!~":function(node,tag,id,classes,attributes,pseudos){for(;node=node.previousSibling;)if(1==node.nodeType){var uid=this.getUID(node);if(this.bitUniques[uid])break;this.bitUniques[uid]=!0,this.push(node,tag,id,classes,attributes,pseudos)}}};for(var c in combinators)local["combinator:"+c]=combinators[c];var pseudos={empty:function(node){var child=node.firstChild;return!(child&&1==child.nodeType||(node.innerText||node.textContent||"").length)},not:function(node,expression){return!this.matchNode(node,expression)},contains:function(node,text){return(node.innerText||node.textContent||"").indexOf(text)>-1},"first-child":function(node){for(;node=node.previousSibling;)if(1==node.nodeType)return!1;return!0},"last-child":function(node){for(;node=node.nextSibling;)if(1==node.nodeType)return!1;return!0},"only-child":function(node){for(var prev=node;prev=prev.previousSibling;)if(1==prev.nodeType)return!1;for(var next=node;next=next.nextSibling;)if(1==next.nodeType)return!1;return!0},"nth-child":local.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":local.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":local.createNTHPseudo("firstChild","nextSibling","posNTHType",!0),"nth-last-of-type":local.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",!0),index:function(node,index){return this["pseudo:nth-child"](node,""+(index+1))},even:function(node){return this["pseudo:nth-child"](node,"2n")},odd:function(node){return this["pseudo:nth-child"](node,"2n+1")},"first-of-type":function(node){for(var nodeName=node.nodeName;node=node.previousSibling;)if(node.nodeName==nodeName)return!1;return!0},"last-of-type":function(node){for(var nodeName=node.nodeName;node=node.nextSibling;)if(node.nodeName==nodeName)return!1;return!0},"only-of-type":function(node){for(var prev=node,nodeName=node.nodeName;prev=prev.previousSibling;)if(prev.nodeName==nodeName)return!1;for(var next=node;next=next.nextSibling;)if(next.nodeName==nodeName)return!1;return!0},enabled:function(node){return!node.disabled},disabled:function(node){return node.disabled},checked:function(node){return node.checked||node.selected},focus:function(node){return this.isHTMLDocument&&this.document.activeElement===node&&(node.href||node.type||this.hasAttribute(node,"tabindex"))},root:function(node){return node===this.root},selected:function(node){return node.selected}};for(var p in pseudos)local["pseudo:"+p]=pseudos[p];var attributeGetters=local.attributeGetters={for:function(){return"htmlFor"in this?this.htmlFor:this.getAttribute("for")},href:function(){return"href"in this?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return this.style?this.style.cssText:this.getAttribute("style")},tabindex:function(){var attributeNode=this.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?attributeNode.nodeValue:null},type:function(){return this.getAttribute("type")},maxlength:function(){var attributeNode=this.getAttributeNode("maxLength");return attributeNode&&attributeNode.specified?attributeNode.nodeValue:null}};attributeGetters.MAXLENGTH=attributeGetters.maxLength=attributeGetters.maxlength;var Slick=local.Slick=this.Slick||{};Slick.version="1.1.7",Slick.search=function(context,expression,append){return local.search(context,expression,append)},Slick.find=function(context,expression){return local.search(context,expression,null,!0)},Slick.contains=function(container,node){return local.setDocument(container),local.contains(container,node)},Slick.getAttribute=function(node,name){return local.setDocument(node),local.getAttribute(node,name)},Slick.hasAttribute=function(node,name){return local.setDocument(node),local.hasAttribute(node,name)},Slick.match=function(node,selector){return!(!node||!selector)&&(!selector||selector===node||(local.setDocument(node),local.matchNode(node,selector)))},Slick.defineAttributeGetter=function(name,fn){return local.attributeGetters[name]=fn,this},Slick.lookupAttributeGetter=function(name){return local.attributeGetters[name]},Slick.definePseudo=function(name,fn){return local["pseudo:"+name]=function(node,argument){return fn.call(node,argument)},this},Slick.lookupPseudo=function(name){var pseudo=local["pseudo:"+name];return pseudo?function(argument){return pseudo.call(this,argument)}:null},Slick.override=function(regexp,fn){return local.override(regexp,fn),this},Slick.isXML=local.isXML,Slick.uidOf=function(node){return local.getUIDHTML(node)},this.Slick||(this.Slick=Slick)}.apply("undefined"!=typeof exports?exports:this);var Element=this.Element=function(tag,props){var konstructor=Element.Constructors[tag];if(konstructor)return konstructor(props);if("string"!=typeof tag)return document.id(tag).set(props);if(props||(props={}),!/^[\w-]+$/.test(tag)){var parsed=Slick.parse(tag).expressions[0][0];tag="*"==parsed.tag?"div":parsed.tag,parsed.id&&null==props.id&&(props.id=parsed.id);var attributes=parsed.attributes;if(attributes)for(var attr,i=0,l=attributes.length;l>i;i++)null==props[(attr=attributes[i]).key]&&(null!=attr.value&&"="==attr.operator?props[attr.key]=attr.value:attr.value||attr.operator||(props[attr.key]=!0));parsed.classList&&null==props.class&&(props.class=parsed.classList.join(" "))}return document.newElement(tag,props)};Browser.Element&&(Element.prototype=Browser.Element.prototype,Element.prototype._fireEvent=function(fireEvent){return function(type,event){return fireEvent.call(this,type,event)}}(Element.prototype.fireEvent)),new Type("Element",Element).mirror((function(name){if(!Array.prototype[name]){var obj={};obj[name]=function(){for(var results=[],args=arguments,elements=!0,i=0,l=this.length;l>i;i++){var element=this[i],result=results[i]=element[name].apply(element,args);elements=elements&&"element"==typeOf(result)}return elements?new Elements(results):results},Elements.implement(obj)}})),Browser.Element||(Element.parent=Object,Element.Prototype={$constructor:Element,$family:Function.convert("element").hide()},Element.mirror((function(name,method){Element.Prototype[name]=method}))),Element.Constructors={};var IFrame=new Type("IFrame",(function(){var iframe,params=Array.link(arguments,{properties:Type.isObject,iframe:function(obj){return null!=obj}}),props=params.properties||{};params.iframe&&(iframe=document.id(params.iframe));var onload=props.onload||function(){};delete props.onload,props.id=props.name=[props.id,props.name,iframe?iframe.id||iframe.name:"IFrame_"+String.uniqueID()].pick(),iframe=new Element(iframe||"iframe",props);var onLoad=function(){onload.call(iframe.contentWindow)};return window.frames[props.id]?onLoad():iframe.addListener("load",onLoad),iframe})),Elements=this.Elements=function(nodes){if(nodes&&nodes.length)for(var node,uniques={},i=0;node=nodes[i++];){var uid=Slick.uidOf(node);uniques[uid]||(uniques[uid]=!0,this.push(node))}};Elements.prototype={length:0},Elements.parent=Array,new Type("Elements",Elements).implement({filter:function(filter,bind){return filter?new Elements(Array.filter(this,"string"==typeOf(filter)?function(item){return item.match(filter)}:filter,bind)):this}.protect(),push:function(){for(var length=this.length,i=0,l=arguments.length;l>i;i++){var item=document.id(arguments[i]);item&&(this[length++]=item)}return this.length=length}.protect(),unshift:function(){for(var items=[],i=0,l=arguments.length;l>i;i++){var item=document.id(arguments[i]);item&&items.push(item)}return Array.prototype.unshift.apply(this,items)}.protect(),concat:function(){for(var newElements=new Elements(this),i=0,l=arguments.length;l>i;i++){var item=arguments[i];Type.isEnumerable(item)?newElements.append(item):newElements.push(item)}return newElements}.protect(),append:function(collection){for(var i=0,l=collection.length;l>i;i++)this.push(collection[i]);return this}.protect(),empty:function(){for(;this.length;)delete this[--this.length];return this}.protect()}),function(){var createElementAcceptsHTML,splice=Array.prototype.splice,object={0:0,1:1,length:2};splice.call(object,1,1),1==object[1]&&Elements.implement("splice",function(){for(var length=this.length,result=splice.apply(this,arguments);length>=this.length;)delete this[length--];return result}.protect()),Array.forEachMethod((function(method,name){Elements.implement(name,method)})),Array.mirror(Elements);try{createElementAcceptsHTML="x"==document.createElement("<input name=x>").name}catch(e){}var escapeQuotes=function(html){return(""+html).replace(/&/g,"&amp;").replace(/"/g,"&quot;")},canChangeStyleHTML=function(){var div=document.createElement("style"),flag=!1;try{div.innerHTML="#justTesing{margin: 0px;}",flag=!!div.innerHTML}catch(e){}return flag}();Document.implement({newElement:function(tag,props){if(props){if(null!=props.checked&&(props.defaultChecked=props.checked),"checkbox"!=props.type&&"radio"!=props.type||null!=props.value||(props.value="on"),!canChangeStyleHTML&&"style"==tag){var styleElement=document.createElement("style");return styleElement.setAttribute("type","text/css"),props.type&&delete props.type,this.id(styleElement).set(props)}createElementAcceptsHTML&&(tag="<"+tag,props.name&&(tag+=' name="'+escapeQuotes(props.name)+'"'),props.type&&(tag+=' type="'+escapeQuotes(props.type)+'"'),tag+=">",delete props.name,delete props.type)}return this.id(this.createElement(tag)).set(props)}})}(),function(){var types;Slick.uidOf(window),Slick.uidOf(document),Document.implement({newTextNode:function(text){return this.createTextNode(text)},getDocument:function(){return this},getWindow:function(){return this.window},id:(types={string:function(id,nocash,doc){return(id=Slick.find(doc,"#"+id.replace(/(\W)/g,"\\$1")))?types.element(id,nocash):null},element:function(el,nocash){if(Slick.uidOf(el),!nocash&&!el.$family&&!/^(?:object|embed)$/i.test(el.tagName)){var fireEvent=el.fireEvent;el._fireEvent=function(type,event){return fireEvent(type,event)},Object.append(el,Element.Prototype)}return el},object:function(obj,nocash,doc){return obj.toElement?types.element(obj.toElement(doc),nocash):null}},types.textnode=types.whitespace=types.window=types.document=function(zero){return zero},function(el,nocash,doc){if(el&&el.$family&&el.uniqueNumber)return el;var type=typeOf(el);return types[type]?types[type](el,nocash,doc||document):null})}),null==window.$&&Window.implement("$",(function(el,nc){return document.id(el,nc,this.document)})),Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}}),[Document,Element].invoke("implement",{getElements:function(expression){return Slick.search(this,expression,new Elements)},getElement:function(expression){return document.id(Slick.find(this,expression))}});var contains={contains:function(element){return Slick.contains(this,element)}};document.contains||Document.implement(contains),document.createElement("div").contains||Element.implement(contains);var injectCombinator=function(expression,combinator){if(!expression)return combinator;for(var expressions=(expression=Object.clone(Slick.parse(expression))).expressions,i=expressions.length;i--;)expressions[i][0].combinator=combinator;return expression};Object.forEach({getNext:"~",getPrevious:"!~",getParent:"!"},(function(combinator,method){Element.implement(method,(function(expression){return this.getElement(injectCombinator(expression,combinator))}))})),Object.forEach({getAllNext:"~",getAllPrevious:"!~",getSiblings:"~~",getChildren:">",getParents:"!"},(function(combinator,method){Element.implement(method,(function(expression){return this.getElements(injectCombinator(expression,combinator))}))})),Element.implement({getFirst:function(expression){return document.id(Slick.search(this,injectCombinator(expression,">"))[0])},getLast:function(expression){return document.id(Slick.search(this,injectCombinator(expression,">")).getLast())},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(id){return document.id(Slick.find(this,"#"+(""+id).replace(/(\W)/g,"\\$1")))},match:function(expression){return!expression||Slick.match(this,expression)}}),null==window.$$&&Window.implement("$$",(function(selector){if(1==arguments.length){if("string"==typeof selector)return Slick.search(this.document,selector,new Elements);if(Type.isEnumerable(selector))return new Elements(selector)}return new Elements(arguments)}));var inserters={before:function(context,element){var parent=element.parentNode;parent&&parent.insertBefore(context,element)},after:function(context,element){var parent=element.parentNode;parent&&parent.insertBefore(context,element.nextSibling)},bottom:function(context,element){element.appendChild(context)},top:function(context,element){element.insertBefore(context,element.firstChild)}};inserters.inside=inserters.bottom;var getter,propertyGetters={},propertySetters={},properties={};Array.forEach(["type","value","defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","rowSpan","tabIndex","useMap"],(function(property){properties[property.toLowerCase()]=property})),properties.html="innerHTML",properties.text=null==document.createElement("div").textContent?"innerText":"textContent",Object.forEach(properties,(function(real,key){propertySetters[key]=function(node,value){node[real]=value},propertyGetters[key]=function(node){return node[real]}})),propertySetters.text=(propertySetters.text,function(node,value){"style"==node.get("tag")?node.set("html",value):node[properties.text]=value}),propertyGetters.text=(getter=propertyGetters.text,function(node){return"style"==node.get("tag")?node.innerHTML:getter(node)});var booleans={};Array.forEach(["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked","autofocus","controls","autoplay","loop"],(function(bool){var lower=bool.toLowerCase();booleans[lower]=bool,propertySetters[lower]=function(node,value){node[bool]=!!value},propertyGetters[lower]=function(node){return!!node[bool]}})),Object.append(propertySetters,{class:function(node,value){"className"in node?node.className=value||"":node.setAttribute("class",value)},for:function(node,value){"htmlFor"in node?node.htmlFor=value:node.setAttribute("for",value)},style:function(node,value){node.style?node.style.cssText=value:node.setAttribute("style",value)},value:function(node,value){node.value=null!=value?value:""}}),propertyGetters.class=function(node){return"className"in node?node.className||null:node.getAttribute("class")};var el=document.createElement("button");try{el.type="button"}catch(e){}"button"!=el.type&&(propertySetters.type=function(node,value){node.setAttribute("type",value)}),el=null;var volatileInputValue,html5InputSupport,canChangeStyleHTML=function(){var div=document.createElement("style"),flag=!1;try{div.innerHTML="#justTesing{margin: 0px;}",flag=!!div.innerHTML}catch(e){}return flag}(),input=document.createElement("input");input.value="t",input.type="submit",volatileInputValue="t"!=input.value;try{input.value="",input.type="email",html5InputSupport="email"==input.type}catch(e){}input=null,(volatileInputValue||!html5InputSupport)&&(propertySetters.type=function(node,type){try{var value=node.value;node.type=type,node.value=value}catch(e){}});var test,pollutesGetAttribute=function(div){return div.random="attribute","attribute"==div.getAttribute("random")}(document.createElement("div")),hasCloneBug=((test=document.createElement("div")).innerHTML='<object><param name="should_fix" value="the unknown" /></object>',1!=test.cloneNode(!0).firstChild.childNodes.length),hasClassList=!!document.createElement("div").classList,classes=function(className){var classNames=(className||"").clean().split(" "),uniques={};return classNames.filter((function(className){return""===className||uniques[className]?void 0:uniques[className]=className}))},addToClassList=function(name){this.classList.add(name)},removeFromClassList=function(name){this.classList.remove(name)};Element.implement({setProperty:function(name,value){var attributeWhiteList,setter=propertySetters[name.toLowerCase()];setter?setter(this,value):(pollutesGetAttribute&&(attributeWhiteList=this.retrieve("$attributeWhiteList",{})),null==value?(this.removeAttribute(name),pollutesGetAttribute&&delete attributeWhiteList[name]):(this.setAttribute(name,""+value),pollutesGetAttribute&&(attributeWhiteList[name]=!0)));return this},setProperties:function(attributes){for(var attribute in attributes)this.setProperty(attribute,attributes[attribute]);return this},getProperty:function(name){var getter=propertyGetters[name.toLowerCase()];if(getter)return getter(this);if(pollutesGetAttribute){var attr=this.getAttributeNode(name),attributeWhiteList=this.retrieve("$attributeWhiteList",{});if(!attr)return null;if(attr.expando&&!attributeWhiteList[name]){var outer=this.outerHTML;if(outer.substr(0,outer.search(/\/?['"]?>(?![^<]*<['"])/)).indexOf(name)<0)return null;attributeWhiteList[name]=!0}}var result=Slick.getAttribute(this,name);return result||Slick.hasAttribute(this,name)?result:null},getProperties:function(){var args=Array.convert(arguments);return args.map(this.getProperty,this).associate(args)},removeProperty:function(name){return this.setProperty(name,null)},removeProperties:function(){return Array.each(arguments,this.removeProperty,this),this},set:function(prop,value){var property=Element.Properties[prop];property&&property.set?property.set.call(this,value):this.setProperty(prop,value)}.overloadSetter(),get:function(prop){var property=Element.Properties[prop];return property&&property.get?property.get.apply(this):this.getProperty(prop)}.overloadGetter(),erase:function(prop){var property=Element.Properties[prop];return property&&property.erase?property.erase.apply(this):this.removeProperty(prop),this},hasClass:hasClassList?function(className){return this.classList.contains(className)}:function(className){return classes(this.className).contains(className)},addClass:hasClassList?function(className){return classes(className).forEach(addToClassList,this),this}:function(className){return this.className=classes(className+" "+this.className).join(" "),this},removeClass:hasClassList?function(className){return classes(className).forEach(removeFromClassList,this),this}:function(className){var classNames=classes(this.className);return classes(className).forEach(classNames.erase,classNames),this.className=classNames.join(" "),this},toggleClass:function(className,force){return null==force&&(force=!this.hasClass(className)),force?this.addClass(className):this.removeClass(className)},adopt:function(){var fragment,parent=this,elements=Array.flatten(arguments),length=elements.length;length>1&&(parent=fragment=document.createDocumentFragment());for(var i=0;length>i;i++){var element=document.id(elements[i],!0);element&&parent.appendChild(element)}return fragment&&this.appendChild(fragment),this},appendText:function(text,where){return this.grab(this.getDocument().newTextNode(text),where)},grab:function(el,where){return inserters[where||"bottom"](document.id(el,!0),this),this},inject:function(el,where){return inserters[where||"bottom"](this,document.id(el,!0)),this},replaces:function(el){return(el=document.id(el,!0)).parentNode.replaceChild(this,el),this},wraps:function(el,where){return el=document.id(el,!0),this.replaces(el).grab(el,where)},getSelected:function(){return this.selectedIndex,new Elements(Array.convert(this.options).filter((function(option){return option.selected})))},toQueryString:function(){var queryString=[];return this.getElements("input, select, textarea").each((function(el){var type=el.type;if(el.name&&!el.disabled&&"submit"!=type&&"reset"!=type&&"file"!=type&&"image"!=type){var value="select"==el.get("tag")?el.getSelected().map((function(opt){return document.id(opt).get("value")})):"radio"!=type&&"checkbox"!=type||el.checked?el.get("value"):null;Array.convert(value).each((function(val){void 0!==val&&queryString.push(encodeURIComponent(el.name)+"="+encodeURIComponent(val))}))}})),queryString.join("&")}});var appendInserters={before:"beforeBegin",after:"afterEnd",bottom:"beforeEnd",top:"afterBegin",inside:"beforeEnd"};Element.implement("appendHTML","insertAdjacentHTML"in document.createElement("div")?function(html,where){return this.insertAdjacentHTML(appendInserters[where||"bottom"],html),this}:function(html,where){var temp=new Element("div",{html:html}),children=temp.childNodes,fragment=temp.firstChild;if(!fragment)return this;if(children.length>1){fragment=document.createDocumentFragment();for(var i=0,l=children.length;l>i;i++)fragment.appendChild(children[i])}return inserters[where||"bottom"](fragment,this),this});var collected={},storage={},get=function(uid){return storage[uid]||(storage[uid]={})},clean=function(item){var uid=item.uniqueNumber;return item.removeEvents&&item.removeEvents(),item.clearAttributes&&item.clearAttributes(),null!=uid&&(delete collected[uid],delete storage[uid]),item},formProps={input:"checked",option:"selected",textarea:"value"};if(Element.implement({destroy:function(){var children=clean(this).getElementsByTagName("*");return Array.each(children,clean),Element.dispose(this),null},empty:function(){return Array.convert(this.childNodes).each(Element.dispose),this},dispose:function(){return this.parentNode?this.parentNode.removeChild(this):this},clone:function(contents,keepid){contents=!1!==contents;var i,clone=this.cloneNode(contents),ce=[clone],te=[this];for(contents&&(ce.append(Array.convert(clone.getElementsByTagName("*"))),te.append(Array.convert(this.getElementsByTagName("*")))),i=ce.length;i--;){var node=ce[i],element=te[i];if(keepid||node.removeAttribute("id"),node.clearAttributes&&(node.clearAttributes(),node.mergeAttributes(element),node.removeAttribute("uniqueNumber"),node.options))for(var no=node.options,eo=element.options,j=no.length;j--;)no[j].selected=eo[j].selected;var prop=formProps[element.tagName.toLowerCase()];prop&&element[prop]&&(node[prop]=element[prop])}if(hasCloneBug){var co=clone.getElementsByTagName("object"),to=this.getElementsByTagName("object");for(i=co.length;i--;)co[i].outerHTML=to[i].outerHTML}return document.id(clone)}}),[Element,Window,Document].invoke("implement",{addListener:function(type,fn){return window.attachEvent&&!window.addEventListener&&(collected[Slick.uidOf(this)]=this),this.addEventListener?this.addEventListener(type,fn,!!arguments[2]):this.attachEvent("on"+type,fn),this},removeListener:function(type,fn){return this.removeEventListener?this.removeEventListener(type,fn,!!arguments[2]):this.detachEvent("on"+type,fn),this},retrieve:function(property,dflt){var storage=get(Slick.uidOf(this)),prop=storage[property];return null!=dflt&&null==prop&&(prop=storage[property]=dflt),null!=prop?prop:null},store:function(property,value){return get(Slick.uidOf(this))[property]=value,this},eliminate:function(property){return delete get(Slick.uidOf(this))[property],this}}),window.attachEvent&&!window.addEventListener){var gc=function(){Object.each(collected,clean),window.CollectGarbage&&CollectGarbage(),window.removeListener("unload",gc)};window.addListener("unload",gc)}Element.Properties={},Element.Properties.style={set:function(style){this.style.cssText=style},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}},Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}},Element.Properties.html={set:function(html){null==html?html="":"array"==typeOf(html)&&(html=html.join("")),this.styleSheet&&!canChangeStyleHTML?this.styleSheet.cssText=html:this.innerHTML=html},erase:function(){this.set("html","")}};var fragment,supportsHTML5Elements,supportsTableInnerHTML,supportsTRInnerHTML,div=document.createElement("div");if(div.innerHTML="<nav></nav>",!(supportsHTML5Elements=1==div.childNodes.length)){var tags="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" ");for(fragment=document.createDocumentFragment(),l=tags.length;l--;)fragment.createElement(tags[l])}div=null,supportsTableInnerHTML=Function.attempt((function(){return document.createElement("table").innerHTML="<tr><td></td></tr>",!0}));var set,translations,tr=document.createElement("tr");tr.innerHTML="<td></td>",supportsTRInnerHTML="<td></td>"==tr.innerHTML,tr=null,supportsTableInnerHTML&&supportsTRInnerHTML&&supportsHTML5Elements||(Element.Properties.html.set=(set=Element.Properties.html.set,(translations={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]}).thead=translations.tfoot=translations.tbody,function(html){if(this.styleSheet)return set.call(this,html);var wrap=translations[this.get("tag")];if(wrap||supportsHTML5Elements||(wrap=[0,"",""]),!wrap)return set.call(this,html);var level=wrap[0],wrapper=document.createElement("div"),target=wrapper;for(supportsHTML5Elements||fragment.appendChild(wrapper),wrapper.innerHTML=[wrap[1],html,wrap[2]].flatten().join("");level--;)target=target.firstChild;this.empty().adopt(target.childNodes),supportsHTML5Elements||fragment.removeChild(wrapper),wrapper=null}));var testForm=document.createElement("form");testForm.innerHTML="<select><option>s</option></select>","s"!=testForm.firstChild.value&&(Element.Properties.value={set:function(value){if("select"!=this.get("tag"))return this.setProperty("value",value);var options=this.getElements("option");value=String(value);for(var i=0;i<options.length;i++){var option=options[i],attr=option.getAttributeNode("value");if((attr&&attr.specified?option.value:option.get("text"))===value)return option.selected=!0}},get:function(){var option=this,tag=option.get("tag");if("select"!=tag&&"option"!=tag)return this.getProperty("value");if("select"==tag&&!(option=option.getSelected()[0]))return"";var attr=option.getAttributeNode("value");return attr&&attr.specified?option.value:option.get("text")}}),testForm=null,document.createElement("div").getAttributeNode("id")&&(Element.Properties.id={set:function(id){this.id=this.getAttributeNode("id").value=id},get:function(){return this.id||null},erase:function(){this.id=this.getAttributeNode("id").value=""}})}(),function(){var el,html=document.html;(el=document.createElement("div")).style.color="red",el.style.color=null;var doesNotRemoveStyles="red"==el.style.color;el.style.border="1px solid #123abc";var returnsBordersInWrongOrder="1px solid #123abc"!=el.style.border;el=null;var hasGetComputedStyle=!!window.getComputedStyle,supportBorderRadius=null!=document.createElement("div").style.borderRadius;Element.Properties.styles={set:function(styles){this.setStyles(styles)}};var hasOpacity=null!=html.style.opacity,hasFilter=null!=html.style.filter,reAlpha=/alpha\(opacity=([\d.]+)\)/i,setFilter=function(element,regexp,value){var style=element.style,filter=style.filter||element.getComputedStyle("filter")||"";style.filter=(regexp.test(filter)?filter.replace(regexp,value):filter+" "+value).trim(),style.filter||style.removeAttribute("filter")},setOpacity=hasOpacity?function(element,opacity){element.style.opacity=opacity}:hasFilter?function(element,opacity){element.currentStyle&&element.currentStyle.hasLayout||(element.style.zoom=1),null==opacity||1==opacity?(setFilter(element,reAlpha,""),1==opacity&&1!=getOpacity(element)&&setFilter(element,reAlpha,"alpha(opacity=100)")):setFilter(element,reAlpha,"alpha(opacity="+(100*opacity).limit(0,100).round()+")")}:function(element,opacity){element.store("$opacity",opacity),element.style.visibility=opacity>0||null==opacity?"visible":"hidden"},getOpacity=hasOpacity?function(element){var opacity=element.style.opacity||element.getComputedStyle("opacity");return""==opacity?1:opacity.toFloat()}:hasFilter?function(element){var opacity,filter=element.style.filter||element.getComputedStyle("filter");return filter&&(opacity=filter.match(reAlpha)),null==opacity||null==filter?1:opacity[1]/100}:function(element){var opacity=element.retrieve("$opacity");return null==opacity&&(opacity="hidden"==element.style.visibility?0:1),opacity},floatName=null==html.style.cssFloat?"styleFloat":"cssFloat",namedPositions={left:"0%",top:"0%",center:"50%",right:"100%",bottom:"100%"},hasBackgroundPositionXY=null!=html.style.backgroundPositionX,prefixPattern=/^-(ms)-/,camelCase=function(property){return property.replace(prefixPattern,"$1-").camelCase()};Element.implement({getComputedStyle:function(property){if(!hasGetComputedStyle&&this.currentStyle)return this.currentStyle[camelCase(property)];var defaultView=Element.getDocument(this).defaultView,computed=defaultView?defaultView.getComputedStyle(this,null):null;return computed?computed.getPropertyValue(property==floatName?"float":property.hyphenate()):""},setStyle:function(property,value){if("opacity"==property)return null!=value&&(value=parseFloat(value)),setOpacity(this,value),this;if(property=camelCase("float"==property?floatName:property),"string"!=typeOf(value)){var map=(Element.Styles[property]||"@").split(" ");value=Array.convert(value).map((function(val,i){return map[i]?"number"==typeOf(val)?map[i].replace("@",Math.round(val)):val:""})).join(" ")}else value==String(Number(value))&&(value=Math.round(value));return this.style[property]=value,(""==value||null==value)&&doesNotRemoveStyles&&this.style.removeAttribute&&function(style,property){"backgroundPosition"==property&&(style.removeAttribute(property+"X"),property+="Y"),style.removeAttribute(property)}(this.style,property),this},getStyle:function(property){if("opacity"==property)return getOpacity(this);if(property=camelCase("float"==property?floatName:property),supportBorderRadius&&-1!=property.indexOf("borderRadius"))return["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"].map((function(corner){return this.style[corner]||"0px"}),this).join(" ");var result=this.style[property];if(!result||"zIndex"==property){if(Element.ShortStyles.hasOwnProperty(property)){for(var s in result=[],Element.ShortStyles[property])result.push(this.getStyle(s));return result.join(" ")}result=this.getComputedStyle(property)}if(hasBackgroundPositionXY&&/^backgroundPosition[XY]?$/.test(property))return result.replace(/(top|right|bottom|left)/g,(function(position){return namedPositions[position]}))||"0px";if(!result&&"backgroundPosition"==property)return"0px 0px";if(result){var color=(result=String(result)).match(/rgba?\([\d\s,]+\)/);color&&(result=result.replace(color[0],color[0].rgbToHex()))}if(!hasGetComputedStyle&&!this.style[property]){if(/^(height|width)$/.test(property)&&!/px$/.test(result)){var size=0;return("width"==property?["left","right"]:["top","bottom"]).each((function(value){size+=this.getStyle("border-"+value+"-width").toInt()+this.getStyle("padding-"+value).toInt()}),this),this["offset"+property.capitalize()]-size+"px"}if(/^border(.+)Width|margin|padding/.test(property)&&isNaN(parseFloat(result)))return"0px"}return returnsBordersInWrongOrder&&/^border(Top|Right|Bottom|Left)?$/.test(property)&&/^#/.test(result)?result.replace(/^(.+)\s(.+)\s(.+)$/,"$2 $3 $1"):result},setStyles:function(styles){for(var style in styles)this.setStyle(style,styles[style]);return this},getStyles:function(){var result={};return Array.flatten(arguments).each((function(key){result[key]=this.getStyle(key)}),this),result}}),Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundSize:"@px",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@",borderRadius:"@px @px @px @px"},Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}},["Top","Right","Bottom","Left"].each((function(direction){var Short=Element.ShortStyles,All=Element.Styles;["margin","padding"].each((function(style){var sd=style+direction;Short[style][sd]=All[sd]="@px"}));var bd="border"+direction;Short.border[bd]=All[bd]="@px @ rgb(@, @, @)";var bdw=bd+"Width",bds=bd+"Style",bdc=bd+"Color";Short[bd]={},Short.borderWidth[bdw]=Short[bd][bdw]=All[bdw]="@px",Short.borderStyle[bds]=Short[bd][bds]=All[bds]="@",Short.borderColor[bdc]=Short[bd][bdc]=All[bdc]="rgb(@, @, @)"})),hasBackgroundPositionXY&&(Element.ShortStyles.backgroundPosition={backgroundPositionX:"@",backgroundPositionY:"@"})}(),function(){Element.Properties.events={set:function(events){this.addEvents(events)}},[Element,Window,Document].invoke("implement",{addEvent:function(type,fn){var events=this.retrieve("events",{});if(events[type]||(events[type]={keys:[],values:[]}),events[type].keys.contains(fn))return this;events[type].keys.push(fn);var realType=type,custom=Element.Events[type],condition=fn,self=this;custom&&(custom.onAdd&&custom.onAdd.call(this,fn,type),custom.condition&&(condition=function(event){return!custom.condition.call(this,event,type)||fn.call(this,event)}),custom.base&&(realType=Function.convert(custom.base).call(this,type)));var defn=function(){return fn.call(self)},nativeEvent=Element.NativeEvents[realType];return nativeEvent&&(2==nativeEvent&&(defn=function(event){event=new DOMEvent(event,self.getWindow()),!1===condition.call(self,event)&&event.stop()}),this.addListener(realType,defn,arguments[2])),events[type].values.push(defn),this},removeEvent:function(type,fn){var events=this.retrieve("events");if(!events||!events[type])return this;var list=events[type],index=list.keys.indexOf(fn);if(-1==index)return this;var value=list.values[index];delete list.keys[index],delete list.values[index];var custom=Element.Events[type];return custom&&(custom.onRemove&&custom.onRemove.call(this,fn,type),custom.base&&(type=Function.convert(custom.base).call(this,type))),Element.NativeEvents[type]?this.removeListener(type,value,arguments[2]):this},addEvents:function(events){for(var event in events)this.addEvent(event,events[event]);return this},removeEvents:function(events){var type;if("object"==typeOf(events)){for(type in events)this.removeEvent(type,events[type]);return this}var attached=this.retrieve("events");if(!attached)return this;if(events)attached[events]&&(attached[events].keys.each((function(fn){this.removeEvent(events,fn)}),this),delete attached[events]);else{for(type in attached)this.removeEvents(type);this.eliminate("events")}return this},fireEvent:function(type,args,delay){var events=this.retrieve("events");return events&&events[type]?(args=Array.convert(args),events[type].keys.each((function(fn){delay?fn.delay(delay,this,args):fn.apply(this,args)}),this),this):this},cloneEvents:function(from,type){var events=(from=document.id(from)).retrieve("events");if(!events)return this;if(type)events[type]&&events[type].keys.each((function(fn){this.addEvent(type,fn)}),this);else for(var eventType in events)this.cloneEvents(from,eventType);return this}}),Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,wheel:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,paste:2,input:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,hashchange:1,popstate:2,pageshow:2,pagehide:2,error:1,abort:1,scroll:1,message:2},Element.Events={mousewheel:{base:"onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll"}};var check=function(event){var related=event.relatedTarget;return null==related||!!related&&(related!=this&&"xul"!=related.prefix&&"document"!=typeOf(this)&&!this.contains(related))};"onmouseenter"in document.documentElement?(Element.NativeEvents.mouseenter=Element.NativeEvents.mouseleave=2,Element.MouseenterCheck=check):(Element.Events.mouseenter={base:"mouseover",condition:check},Element.Events.mouseleave={base:"mouseout",condition:check}),window.addEventListener||(Element.NativeEvents.propertychange=2,Element.Events.change={base:function(){var type=this.type;return"input"!=this.get("tag")||"radio"!=type&&"checkbox"!=type?"change":"propertychange"},condition:function(event){return"propertychange"!=event.type||"checked"==event.event.propertyName}})}(),function(){var eventListenerSupport=!!window.addEventListener;Element.NativeEvents.focusin=Element.NativeEvents.focusout=2;var bubbleUp=function(self,match,fn,event,target){for(;target&&target!=self;){if(match(target,event))return fn.call(target,event,target);target=document.id(target.parentNode)}},map={mouseenter:{base:"mouseover",condition:Element.MouseenterCheck},mouseleave:{base:"mouseout",condition:Element.MouseenterCheck},focus:{base:"focus"+(eventListenerSupport?"":"in"),capture:!0},blur:{base:eventListenerSupport?"blur":"focusout",capture:!0}},_key="$delegation:",formObserver=function(type){return{base:"focusin",remove:function(self,uid){var list=self.retrieve(_key+type+"listeners",{})[uid];if(list&&list.forms)for(var i=list.forms.length;i--;)list.forms[i].removeEvent&&list.forms[i].removeEvent(type,list.fns[i])},listen:function(self,match,fn,event,target,uid){var form="form"==target.get("tag")?target:event.target.getParent("form");if(form){var listeners=self.retrieve(_key+type+"listeners",{}),listener=listeners[uid]||{forms:[],fns:[]},forms=listener.forms,fns=listener.fns;if(-1==forms.indexOf(form)){forms.push(form);var _fn=function(event){bubbleUp(self,match,fn,event,target)};form.addEvent(type,_fn),fns.push(_fn),listeners[uid]=listener,self.store(_key+type+"listeners",listeners)}}}}},inputObserver=function(type){return{base:"focusin",listen:function(self,match,fn,event,target){var events={blur:function(){this.removeEvents(events)}};events[type]=function(event){bubbleUp(self,match,fn,event,target)},event.target.addEvents(events)}}};eventListenerSupport||Object.append(map,{submit:formObserver("submit"),reset:formObserver("reset"),change:inputObserver("change"),select:inputObserver("select")});var proto=Element.prototype,addEvent=proto.addEvent,removeEvent=proto.removeEvent,relay=function(old,method){return function(type,fn,useCapture){if(-1==type.indexOf(":relay"))return old.call(this,type,fn,useCapture);var parsed=Slick.parse(type).expressions[0][0];if("relay"!=parsed.pseudos[0].key)return old.call(this,type,fn,useCapture);var newType=parsed.tag;return parsed.pseudos.slice(1).each((function(pseudo){newType+=":"+pseudo.key+(pseudo.value?"("+pseudo.value+")":"")})),old.call(this,type,fn),method.call(this,newType,parsed.pseudos[0].value,fn)}},delegation={addEvent:function(type,match,fn){var storage=this.retrieve("$delegates",{}),stored=storage[type];if(stored)for(var _uid in stored)if(stored[_uid].fn==fn&&stored[_uid].match==match)return this;var _type=type,_match=match,_fn=fn,_map=map[type]||{};type=_map.base||_type,match=function(target){return Slick.match(target,_match)};var elementEvent=Element.Events[_type];if(_map.condition||elementEvent&&elementEvent.condition){var __match=match,condition=_map.condition||elementEvent.condition;match=function(target,event){return __match(target,event)&&condition.call(target,event,type)}}var self=this,uid=String.uniqueID(),delegator=_map.listen?function(event,target){!target&&event&&event.target&&(target=event.target),target&&_map.listen(self,match,fn,event,target,uid)}:function(event,target){!target&&event&&event.target&&(target=event.target),target&&bubbleUp(self,match,fn,event,target)};return stored||(stored={}),stored[uid]={match:_match,fn:_fn,delegator:delegator},storage[_type]=stored,addEvent.call(this,type,delegator,_map.capture)},removeEvent:function(type,match,fn,_uid){var __uid,s,storage=this.retrieve("$delegates",{}),stored=storage[type];if(!stored)return this;if(_uid){var _type=type,delegator=stored[_uid].delegator,_map=map[type]||{};return type=_map.base||_type,_map.remove&&_map.remove(this,_uid),delete stored[_uid],storage[_type]=stored,removeEvent.call(this,type,delegator,_map.capture)}if(fn){for(__uid in stored)if((s=stored[__uid]).match==match&&s.fn==fn)return delegation.removeEvent.call(this,type,match,fn,__uid)}else for(__uid in stored)(s=stored[__uid]).match==match&&delegation.removeEvent.call(this,type,match,s.fn,__uid);return this}};[Element,Window,Document].invoke("implement",{addEvent:relay(addEvent,delegation.addEvent),removeEvent:relay(removeEvent,delegation.removeEvent)})}(),function(){function styleNumber(element,style){return styleString(element,style).toInt()||0}function topBorder(element){return styleNumber(element,"border-top-width")}function leftBorder(element){return styleNumber(element,"border-left-width")}function isBody(element){return/^(?:body|html)$/i.test(element.tagName)}function getCompatElement(element){var doc=element.getDocument();return doc.compatMode&&"CSS1Compat"!=doc.compatMode?doc.body:doc.html}var element=document.createElement("div"),child=document.createElement("div");element.style.height="0",element.appendChild(child);var brokenOffsetParent=child.offsetParent===element;element=child=null;var heightComponents=["height","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth"],widthComponents=["width","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],isOffset=function(el){return"static"!=styleString(el,"position")||isBody(el)},isOffsetStatic=function(el){return isOffset(el)||/^(?:table|td|th)$/i.test(el.tagName)};Element.implement({scrollTo:function(x,y){return isBody(this)?this.getWindow().scrollTo(x,y):(this.scrollLeft=x,this.scrollTop=y),this},getSize:function(){if(isBody(this))return this.getWindow().getSize();if(!window.getComputedStyle)return{x:this.offsetWidth,y:this.offsetHeight};if("svg"==this.get("tag"))return function(el){var gCS=window.getComputedStyle(el),bounds={x:0,y:0};return heightComponents.each((function(css){bounds.y+=parseFloat(gCS[css])})),widthComponents.each((function(css){bounds.x+=parseFloat(gCS[css])})),bounds}(this);try{var bounds=this.getBoundingClientRect();return{x:bounds.width,y:bounds.height}}catch(e){return{x:0,y:0}}},getScrollSize:function(){return isBody(this)?this.getWindow().getScrollSize():{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){return isBody(this)?this.getWindow().getScroll():{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){for(var element=this.parentNode,position={x:0,y:0};element&&!isBody(element);)position.x+=element.scrollLeft,position.y+=element.scrollTop,element=element.parentNode;return position},getOffsetParent:brokenOffsetParent?function(){var element=this;if(isBody(element)||"fixed"==styleString(element,"position"))return null;for(var isOffsetCheck="static"==styleString(element,"position")?isOffsetStatic:isOffset;element=element.parentNode;)if(isOffsetCheck(element))return element;return null}:function(){if(isBody(this)||"fixed"==styleString(this,"position"))return null;try{return this.offsetParent}catch(e){}return null},getOffsets:function(){if(this.getBoundingClientRect){var bound=this.getBoundingClientRect(),html=document.id(this.getDocument().documentElement),htmlScroll=html.getScroll(),elemScrolls=this.getScrolls(),isFixed="fixed"==styleString(this,"position");return{x:bound.left.toFloat()+elemScrolls.x+(isFixed?0:htmlScroll.x)-html.clientLeft,y:bound.top.toFloat()+elemScrolls.y+(isFixed?0:htmlScroll.y)-html.clientTop}}var element=this,position={x:0,y:0};if(isBody(this))return position;for(;element&&!isBody(element);)position.x+=element.offsetLeft,position.y+=element.offsetTop,element=element.offsetParent;return position},getPosition:function(relative){var offset=this.getOffsets(),scroll=this.getScrolls(),position={x:offset.x-scroll.x,y:offset.y-scroll.y};if(relative&&(relative=document.id(relative))){var relativePosition=relative.getPosition();return{x:position.x-relativePosition.x-leftBorder(relative),y:position.y-relativePosition.y-topBorder(relative)}}return position},getCoordinates:function(element){if(isBody(this))return this.getWindow().getCoordinates();var position=this.getPosition(element),size=this.getSize(),obj={left:position.x,top:position.y,width:size.x,height:size.y};return obj.right=obj.left+obj.width,obj.bottom=obj.top+obj.height,obj},computePosition:function(obj){return{left:obj.x-styleNumber(this,"margin-left"),top:obj.y-styleNumber(this,"margin-top")}},setPosition:function(obj){return this.setStyles(this.computePosition(obj))}}),[Document,Window].invoke("implement",{getSize:function(){var doc=getCompatElement(this);return{x:doc.clientWidth,y:doc.clientHeight}},getScroll:function(){var win=this.getWindow(),doc=getCompatElement(this);return{x:win.pageXOffset||doc.scrollLeft,y:win.pageYOffset||doc.scrollTop}},getScrollSize:function(){var doc=getCompatElement(this),min=this.getSize(),body=this.getDocument().body;return{x:Math.max(doc.scrollWidth,body.scrollWidth,min.x),y:Math.max(doc.scrollHeight,body.scrollHeight,min.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var size=this.getSize();return{top:0,left:0,bottom:size.y,right:size.x,height:size.y,width:size.x}}});var styleString=Element.getComputedStyle}(),Element.alias({position:"setPosition"}),[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}}),function(){var Fx=this.Fx=new Class({Implements:[Chain,Events,Options,Class.Thenable],options:{fps:60,unit:!1,duration:500,frames:null,frameSkip:!0,link:"ignore"},initialize:function(options){this.subject=this.subject||this,this.setOptions(options)},getTransition:function(){return function(p){return-(Math.cos(Math.PI*p)-1)/2}},step:function(now){if(this.options.frameSkip){var frames=(null!=this.time?now-this.time:0)/this.frameInterval;this.time=now,this.frame+=frames}else this.frame++;if(this.frame<this.frames){var delta=this.transition(this.frame/this.frames);this.set(this.compute(this.from,this.to,delta))}else this.frame=this.frames,this.set(this.compute(this.from,this.to,1)),this.stop()},set:function(now){return now},compute:function(from,to,delta){return Fx.compute(from,to,delta)},check:function(){if(!this.isRunning())return!0;switch(this.options.link){case"cancel":return this.cancel(),!0;case"chain":return this.chain(this.caller.pass(arguments,this)),!1}return!1},start:function(from,to){if(!this.check(from,to))return this;this.from=from,this.to=to,this.frame=this.options.frameSkip?0:-1,this.time=null,this.transition=this.getTransition();var frames=this.options.frames,fps=this.options.fps,duration=this.options.duration;return this.duration=Fx.Durations[duration]||duration.toInt(),this.frameInterval=1e3/fps,this.frames=frames||Math.round(this.duration/this.frameInterval),"pending"!==this.getThenableState()&&this.resetThenable(this.subject),this.fireEvent("start",this.subject),pushInstance.call(this,fps),this},stop:function(){return this.isRunning()&&(this.time=null,pullInstance.call(this,this.options.fps),this.frames==this.frame?(this.fireEvent("complete",this.subject),this.callChain()||this.fireEvent("chainComplete",this.subject)):this.fireEvent("stop",this.subject),this.resolve(this.subject===this?null:this.subject)),this},cancel:function(){return this.isRunning()&&(this.time=null,pullInstance.call(this,this.options.fps),this.frame=this.frames,this.fireEvent("cancel",this.subject).clearChain(),this.reject(this.subject)),this},pause:function(){return this.isRunning()&&(this.time=null,pullInstance.call(this,this.options.fps)),this},resume:function(){return this.isPaused()&&pushInstance.call(this,this.options.fps),this},isRunning:function(){var list=instances[this.options.fps];return list&&list.contains(this)},isPaused:function(){return this.frame<this.frames&&!this.isRunning()}});Fx.compute=function(from,to,delta){return(to-from)*delta+from},Fx.Durations={short:250,normal:500,long:1e3};var instances={},timers={},loop=function(){for(var now=Date.now(),i=this.length;i--;){var instance=this[i];instance&&instance.step(now)}},pushInstance=function(fps){var list=instances[fps]||(instances[fps]=[]);list.push(this),timers[fps]||(timers[fps]=loop.periodical(Math.round(1e3/fps),list))},pullInstance=function(fps){var list=instances[fps];list&&(list.erase(this),!list.length&&timers[fps]&&(delete instances[fps],timers[fps]=clearInterval(timers[fps])))}}(),Fx.CSS=new Class({Extends:Fx,prepare:function(element,property,values){var from=(values=Array.convert(values))[0],to=values[1];if(null==to){to=from,from=element.getStyle(property);var unit=this.options.unit;if(unit&&from&&"string"==typeof from&&from.slice(-unit.length)!=unit&&0!=parseFloat(from)){element.setStyle(property,to+unit);var value=element.getComputedStyle(property);if(!/px$/.test(value)&&null==(value=element.style[("pixel-"+property).camelCase()])){var left=element.style.left;element.style.left=to+unit,value=element.style.pixelLeft,element.style.left=left}from=(to||1)/(parseFloat(value)||1)*(parseFloat(from)||0),element.setStyle(property,from+unit)}}return{from:this.parse(from),to:this.parse(to)}},parse:function(value){return(value="string"==typeof(value=Function.convert(value)())?value.split(" "):Array.convert(value)).map((function(val){val=String(val);var found=!1;return Object.each(Fx.CSS.Parsers,(function(parser){if(!found){var parsed=parser.parse(val);(parsed||0===parsed)&&(found={value:parsed,parser:parser})}})),found=found||{value:val,parser:Fx.CSS.Parsers.String}}))},compute:function(from,to,delta){var computed=[];return Math.min(from.length,to.length).times((function(i){computed.push({value:from[i].parser.compute(from[i].value,to[i].value,delta),parser:from[i].parser})})),computed.$family=Function.convert("fx:css:value"),computed},serve:function(value,unit){"fx:css:value"!=typeOf(value)&&(value=this.parse(value));var returned=[];return value.each((function(bit){returned=returned.concat(bit.parser.serve(bit.value,unit))})),returned},render:function(element,property,value,unit){element.setStyle(property,this.serve(value,unit))},search:function(selector){if(Fx.CSS.Cache[selector])return Fx.CSS.Cache[selector];var to={},selectorTest=new RegExp("^"+selector.escapeRegExp()+"$"),searchStyles=function(rules){Array.each(rules,(function(rule){if(rule.media)searchStyles(rule.rules||rule.cssRules);else if(rule.style){var selectorText=rule.selectorText?rule.selectorText.replace(/^\w+/,(function(m){return m.toLowerCase()})):null;selectorText&&selectorTest.test(selectorText)&&Object.each(Element.Styles,(function(value,style){rule.style[style]&&!Element.ShortStyles[style]&&(value=String(rule.style[style]),to[style]=/^rgb/.test(value)?value.rgbToHex():value)}))}}))};return Array.each(document.styleSheets,(function(sheet){var href=sheet.href;if(!(href&&href.indexOf("://")>-1&&-1==href.indexOf(document.domain))){var rules=sheet.rules||sheet.cssRules;searchStyles(rules)}})),Fx.CSS.Cache[selector]=to}}),Fx.CSS.Cache={},Fx.CSS.Parsers={Color:{parse:function(value){return value.match(/^#[0-9a-f]{3,6}$/i)?value.hexToRgb(!0):!!(value=value.match(/(\d+),\s*(\d+),\s*(\d+)/))&&[value[1],value[2],value[3]]},compute:function(from,to,delta){return from.map((function(value,i){return Math.round(Fx.compute(from[i],to[i],delta))}))},serve:function(value){return value.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(value,unit){return unit?value+unit:value}},String:{parse:Function.convert(!1),compute:function(zero,one){return one},serve:function(zero){return zero}}},Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(element,options){this.element=this.subject=document.id(element),this.parent(options)},set:function(property,now){return 1==arguments.length&&(now=property,property=this.property||this.options.property),this.render(this.element,property,now,this.options.unit),this},start:function(property,from,to){if(!this.check(property,from,to))return this;var args=Array.flatten(arguments);this.property=this.options.property||args.shift();var parsed=this.prepare(this.element,this.property,args);return this.parent(parsed.from,parsed.to)}}),Element.Properties.tween={set:function(options){return this.get("tween").cancel().setOptions(options),this},get:function(){var tween=this.retrieve("tween");return tween||(tween=new Fx.Tween(this,{link:"cancel"}),this.store("tween",tween)),tween}},Element.implement({tween:function(property,from,to){return this.get("tween").start(property,from,to),this},fade:function(){var method,toggle,fade=this.get("tween"),args=["opacity"].append(arguments);switch(null==args[1]&&(args[1]="toggle"),args[1]){case"in":method="start",args[1]=1;break;case"out":method="start",args[1]=0;break;case"show":method="set",args[1]=1;break;case"hide":method="set",args[1]=0;break;case"toggle":var flag=this.retrieve("fade:flag",1==this.getStyle("opacity"));method="start",args[1]=flag?0:1,this.store("fade:flag",!flag),toggle=!0;break;default:method="start"}toggle||this.eliminate("fade:flag"),fade[method].apply(fade,args);var to=args[args.length-1];return"set"==method?this.setStyle("visibility",0==to?"hidden":"visible"):0!=to?fade.$chain.length?fade.chain((function(){this.element.setStyle("visibility","visible"),this.callChain()})):this.setStyle("visibility","visible"):fade.chain((function(){this.element.getStyle("opacity")||(this.element.setStyle("visibility","hidden"),this.callChain())})),this},highlight:function(start,end){end||(end="transparent"==(end=this.retrieve("highlight:original",this.getStyle("background-color")))?"#fff":end);var tween=this.get("tween");return tween.start("background-color",start||"#ffff88",end).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original")),tween.callChain()}.bind(this)),this}}),Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(element,options){this.element=this.subject=document.id(element),this.parent(options)},set:function(now){for(var p in"string"==typeof now&&(now=this.search(now)),now)this.render(this.element,p,now[p],this.options.unit);return this},compute:function(from,to,delta){var now={};for(var p in from)now[p]=this.parent(from[p],to[p],delta);return now},start:function(properties){if(!this.check(properties))return this;"string"==typeof properties&&(properties=this.search(properties));var from={},to={};for(var p in properties){var parsed=this.prepare(this.element,p,properties[p]);from[p]=parsed.from,to[p]=parsed.to}return this.parent(from,to)}}),Element.Properties.morph={set:function(options){return this.get("morph").cancel().setOptions(options),this},get:function(){var morph=this.retrieve("morph");return morph||(morph=new Fx.Morph(this,{link:"cancel"}),this.store("morph",morph)),morph}},Element.implement({morph:function(props){return this.get("morph").start(props),this}}),Fx.implement({getTransition:function(){var trans=this.options.transition||Fx.Transitions.Sine.easeInOut;if("string"==typeof trans){var data=trans.split(":");trans=(trans=Fx.Transitions)[data[0]]||trans[data[0].capitalize()],data[1]&&(trans=trans["ease"+data[1].capitalize()+(data[2]?data[2].capitalize():"")])}return trans}}),Fx.Transition=function(transition,params){params=Array.convert(params);var easeIn=function(pos){return transition(pos,params)};return Object.append(easeIn,{easeIn:easeIn,easeOut:function(pos){return 1-transition(1-pos,params)},easeInOut:function(pos){return(.5>=pos?transition(2*pos,params):2-transition(2*(1-pos),params))/2}})},Fx.Transitions={linear:function(zero){return zero}},Fx.Transitions.extend=function(transitions){for(var transition in transitions)Fx.Transitions[transition]=new Fx.Transition(transitions[transition])},Fx.Transitions.extend({Pow:function(p,x){return Math.pow(p,x&&x[0]||6)},Expo:function(p){return Math.pow(2,8*(p-1))},Circ:function(p){return 1-Math.sin(Math.acos(p))},Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Back:function(p,x){return x=x&&x[0]||1.618,Math.pow(p,2)*((x+1)*p-x)},Bounce:function(p){for(var value,a=0,b=1;;a+=b,b/=2)if(p>=(7-4*a)/11){value=b*b-Math.pow((11-6*a-11*p)/4,2);break}return value},Elastic:function(p,x){return Math.pow(2,10*--p)*Math.cos(20*p*Math.PI*(x&&x[0]||1)/3)}}),["Quad","Cubic","Quart","Quint"].each((function(transition,i){Fx.Transitions[transition]=new Fx.Transition((function(p){return Math.pow(p,i+2)}))})),function(){var empty=function(){},progressSupport="onprogress"in new Browser.Request,Request=this.Request=new Class({Implements:[Chain,Events,Options,Class.Thenable],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:!0,format:!1,method:"post",link:"ignore",isSuccess:null,emulation:!0,urlEncoded:!0,encoding:"utf-8",evalScripts:!1,evalResponse:!1,timeout:0,noCache:!1},initialize:function(options){this.xhr=new Browser.Request,this.setOptions(options),this.headers=this.options.headers},onStateChange:function(){var xhr=this.xhr;4==xhr.readyState&&this.running&&(this.running=!1,this.status=0,Function.attempt(function(){var status=xhr.status;this.status=1223==status?204:status}.bind(this)),xhr.onreadystatechange=empty,progressSupport&&(xhr.onprogress=xhr.onloadstart=empty),this.timer&&(clearTimeout(this.timer),delete this.timer),this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML},this.options.isSuccess.call(this,this.status)?this.success(this.response.text,this.response.xml):this.failure())},isSuccess:function(){var status=this.status;return status>=200&&300>status},isRunning:function(){return!!this.running},processScripts:function(text){return this.options.evalResponse||/(ecma|java)script/.test(this.getHeader("Content-type"))?Browser.exec(text):text.stripScripts(this.options.evalScripts)},success:function(text,xml){this.onSuccess(this.processScripts(text),xml),this.resolve({text:text,xml:xml})},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure(),this.reject({reason:"failure",xhr:this.xhr})},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(event){this.fireEvent("loadstart",[event,this.xhr])},progress:function(event){this.fireEvent("progress",[event,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr),this.reject({reason:"timeout",xhr:this.xhr})},setHeader:function(name,value){return this.headers[name]=value,this},getHeader:function(name){return Function.attempt(function(){return this.xhr.getResponseHeader(name)}.bind(this))},check:function(){if(!this.running)return!0;switch(this.options.link){case"cancel":return this.cancel(),!0;case"chain":return this.chain(this.caller.pass(arguments,this)),!1}return!1},send:function(options){if(!this.check(options))return this;this.options.isSuccess=this.options.isSuccess||this.isSuccess,this.running=!0;var type=typeOf(options);("string"==type||"element"==type)&&(options={data:options});var old=this.options,data=(options=Object.append({data:old.data,url:old.url,method:old.method},options)).data,url=String(options.url),method=options.method.toLowerCase();switch(typeOf(data)){case"element":data=document.id(data).toQueryString();break;case"object":case"hash":data=Object.toQueryString(data)}if(this.options.format){var format="format="+this.options.format;data=data?format+"&"+data:format}if(this.options.emulation&&!["get","post"].contains(method)){var _method="_method="+method;data=data?_method+"&"+data:_method,method="post"}if(this.options.urlEncoded&&["post","put"].contains(method)){var encoding=this.options.encoding?"; charset="+this.options.encoding:"";this.headers["Content-type"]="application/x-www-form-urlencoded"+encoding}url||(url=document.location.pathname);var trimPosition=url.lastIndexOf("/");trimPosition>-1&&(trimPosition=url.indexOf("#"))>-1&&(url=url.substr(0,trimPosition)),this.options.noCache&&(url+=(url.indexOf("?")>-1?"&":"?")+String.uniqueID()),!data||"get"!=method&&"delete"!=method||(url+=(url.indexOf("?")>-1?"&":"?")+data,data=null);var xhr=this.xhr;return progressSupport&&(xhr.onloadstart=this.loadstart.bind(this),xhr.onprogress=this.progress.bind(this)),xhr.open(method.toUpperCase(),url,this.options.async,this.options.user,this.options.password),this.options.withCredentials&&"withCredentials"in xhr&&(xhr.withCredentials=!0),xhr.onreadystatechange=this.onStateChange.bind(this),Object.each(this.headers,(function(value,key){try{xhr.setRequestHeader(key,value)}catch(e){this.fireEvent("exception",[key,value]),this.reject({reason:"exception",xhr:xhr,exception:e})}}),this),"pending"!==this.getThenableState()&&this.resetThenable({reason:"send"}),this.fireEvent("request"),xhr.send(data),this.options.async?this.options.timeout&&(this.timer=this.timeout.delay(this.options.timeout,this)):this.onStateChange(),this},cancel:function(){if(!this.running)return this;this.running=!1;var xhr=this.xhr;return xhr.abort(),this.timer&&(clearTimeout(this.timer),delete this.timer),xhr.onreadystatechange=empty,progressSupport&&(xhr.onprogress=xhr.onloadstart=empty),this.xhr=new Browser.Request,this.fireEvent("cancel"),this.reject({reason:"cancel",xhr:xhr}),this}}),methods={};["get","post","put","delete","patch","head","GET","POST","PUT","DELETE","PATCH","HEAD"].each((function(method){methods[method]=function(data){var object={method:method};return null!=data&&(object.data=data),this.send(object)}})),Request.implement(methods),Element.Properties.send={set:function(options){return this.get("send").cancel().setOptions(options),this},get:function(){var send=this.retrieve("send");return send||(send=new Request({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")}),this.store("send",send)),send}},Element.implement({send:function(url){var sender=this.get("send");return sender.send({data:this,url:url||sender.options.url}),this}})}(),Request.HTML=new Class({Extends:Request,options:{update:!1,append:!1,evalScripts:!0,filter:!1,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(text){var options=this.options,response=this.response;response.html=text.stripScripts((function(script){response.javascript=script}));var match=response.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);match&&(response.html=match[1]);var temp=new Element("div").set("html",response.html);if(response.tree=temp.childNodes,response.elements=temp.getElements(options.filter||"*"),options.filter&&(response.tree=response.elements),options.update){var update=document.id(options.update).empty();options.filter?update.adopt(response.elements):update.set("html",response.html)}else if(options.append){var append=document.id(options.append);options.filter?response.elements.reverse().inject(append):append.adopt(temp.getChildren())}options.evalScripts&&Browser.exec(response.javascript),this.onSuccess(response.tree,response.elements,response.html,response.javascript),this.resolve({tree:response.tree,elements:response.elements,html:response.html,javascript:response.javascript})}}),Element.Properties.load={set:function(options){return this.get("load").cancel().setOptions(options),this},get:function(){var load=this.retrieve("load");return load||(load=new Request.HTML({data:this,link:"cancel",update:this,method:"get"}),this.store("load",load)),load}},Element.implement({load:function(){return this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString})),this}}),"undefined"==typeof JSON&&(this.JSON={}),function(){var special={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},escape=function(chr){return special[chr]||"\\u"+("0000"+chr.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(string){return string=string.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(string)},JSON.encode=JSON.stringify?function(obj){return JSON.stringify(obj)}:function(obj){switch(obj&&obj.toJSON&&(obj=obj.toJSON()),typeOf(obj)){case"string":return'"'+obj.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":return"["+obj.map(JSON.encode).clean()+"]";case"object":case"hash":var string=[];return Object.each(obj,(function(value,key){var json=JSON.encode(value);json&&string.push(JSON.encode(key)+":"+json)})),"{"+string+"}";case"number":case"boolean":return""+obj;case"null":return"null"}return null},JSON.secure=!0,JSON.decode=function(string,secure){if(!string||"string"!=typeOf(string))return null;if(null==secure&&(secure=JSON.secure),secure){if(JSON.parse)return JSON.parse(string);if(!JSON.validate(string))throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}return eval("("+string+")")}}(),Request.JSON=new Class({Extends:Request,options:{secure:!0},initialize:function(options){this.parent(options),Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(text){var json;try{json=this.response.json=JSON.decode(text,this.options.secure)}catch(error){return void this.fireEvent("error",[text,error])}null==json?this.failure():(this.onSuccess(json,text),this.resolve({json:json,text:text}))}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:!1,duration:!1,secure:!1,document:document,encode:!0,httpOnly:!1},initialize:function(key,options){this.key=key,this.setOptions(options)},write:function(value){if(this.options.encode&&(value=encodeURIComponent(value)),this.options.domain&&(value+="; domain="+this.options.domain),this.options.path&&(value+="; path="+this.options.path),this.options.duration){var date=new Date;date.setTime(date.getTime()+24*this.options.duration*60*60*1e3),value+="; expires="+date.toGMTString()}return this.options.secure&&(value+="; secure"),this.options.httpOnly&&(value+="; HttpOnly"),this.options.document.cookie=this.key+"="+value,this},read:function(){var value=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return value?decodeURIComponent(value[1]):null},dispose:function(){return new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write(""),this}});Cookie.write=function(key,value,options){return new Cookie(key,options).write(value)},Cookie.read=function(key){return new Cookie(key).read()},Cookie.dispose=function(key,options){return new Cookie(key,options).dispose()},function(window,document){var ready,loaded,shouldPoll,timer,checks=[],testElement=document.createElement("div"),domready=function(){clearTimeout(timer),ready||(Browser.loaded=ready=!0,document.removeListener("DOMContentLoaded",domready).removeListener("readystatechange",check),document.fireEvent("domready"),window.fireEvent("domready")),document=window=testElement=null},check=function(){for(var i=checks.length;i--;)if(checks[i]())return domready(),!0;return!1},poll=function(){clearTimeout(timer),check()||(timer=setTimeout(poll,10))};document.addListener("DOMContentLoaded",domready);var doScrollWorks=function(){try{return testElement.doScroll(),!0}catch(e){}return!1};testElement.doScroll&&!doScrollWorks()&&(checks.push(doScrollWorks),shouldPoll=!0),document.readyState&&checks.push((function(){var state=document.readyState;return"loaded"==state||"complete"==state})),"onreadystatechange"in document?document.addListener("readystatechange",check):shouldPoll=!0,shouldPoll&&poll(),Element.Events.domready={onAdd:function(fn){ready&&fn.call(this)}},Element.Events.load={base:"load",onAdd:function(fn){loaded&&this==window&&fn.call(this)},condition:function(){return this==window&&(domready(),delete Element.Events.load),!0}},window.addEvent("load",(function(){loaded=!0}))}(window,document),define("mootools-core",(function(){})),define("pgui.admin-page-main",["pgui.user_management_api","pgui.localizer","libs/sprintf","pgui.utils","knockout","pgui.change_password_dialog","bootbox","mootools-core"],(function(PhpGenUserManagementApi,localizer,sprintf,utils,ko){return function(){window.PhpGenAdmin.Utils={showProgressCursor:function(){$("body").addClass("cursor-progress")},hideProgressCursor:function(){$("body").removeClass("cursor-progress")}},window.PhpGenAdmin.UserViewModel=new Class({initialize:function(api,id,name,password,email,status,editable){this.api=api,this.id=id,this.name=ko.observable(name),this.password=password,this.email=ko.observable(email),this.status=ko.observable(status),this.editable=ko.observable(editable),this.grantsLoaded=ko.observable(!1),this.grantsExpanded=ko.observable(!1),this.grants=ko.observableArray([])},_loadGrants:function(){this.api.getUserGrants(this.id).done(function(grants){for(var i=0;i<grants.length;i++)this.grants.push(new PhpGenAdmin.UserPageGrantsViewModel(this.api,this.id,grants[i].name,grants[i].caption,grants[i].selectGrant,grants[i].updateGrant,grants[i].insertGrant,grants[i].deleteGrant,grants[i].adminGrant));this.grantsLoaded(!0)}.bind(this))},collapseGrants:function(){this.grantsExpanded(!1)},expandGrants:function(){this.grantsExpanded()||(this.grantsExpanded(!0),this.grantsLoaded()||this._loadGrants())},toggleGrantsExpanded:function(){this.grantsExpanded()?this.grantsExpanded(!1):(this.grantsExpanded(!0),this.grantsLoaded()||this._loadGrants())}}),window.PhpGenAdmin.UserPageGrantsViewModel=new Class({initialize:function(api,userId,pageName,caption,selectGrant,updateGrant,insertGrant,deleteGrant,adminGrant){this.api=api,this.userId=userId,this.pageName=ko.observable(pageName),this.caption=ko.observable(caption),this.selectGrant=ko.observable(selectGrant),this.updateGrant=ko.observable(updateGrant),this.insertGrant=ko.observable(insertGrant),this.deleteGrant=ko.observable(deleteGrant),this.adminGrant=ko.observable(adminGrant),this.selectGrant.subscribe(function(newValue){this._updateUserGrant("SELECT",newValue)}.bind(this)),this.updateGrant.subscribe(function(newValue){this._updateUserGrant("UPDATE",newValue)}.bind(this)),this.insertGrant.subscribe(function(newValue){this._updateUserGrant("INSERT",newValue)}.bind(this)),this.deleteGrant.subscribe(function(newValue){this._updateUserGrant("DELETE",newValue)}.bind(this)),this.adminGrant.subscribe(function(newValue){this._updateUserGrant("ADMIN",newValue)}.bind(this))},isApplication:function(){return 0===this.pageName().length},_updateUserGrant:function(grantName,newValue){PhpGenAdmin.Utils.showProgressCursor(),function(){return newValue?this.api.addUserGrant(this.userId,this.pageName(),grantName):this.api.removeUserGrant(this.userId,this.pageName(),grantName)}.bind(this)().always((function(){PhpGenAdmin.Utils.hideProgressCursor()})).fail((function(message){utils.showErrorMessage(message)}))}}),window.PhpGenAdmin.AdminPanelViewModel=function(api){this.api=api,this.newUser={id:ko.observable(""),name:ko.observable("New user"),password:ko.observable(""),confirmedPassword:ko.observable(""),email:ko.observable("")},this.changePasswordUser={id:ko.observable(""),name:ko.observable("")},this.editUser={id:ko.observable(""),name:ko.observable("Edit user"),password:ko.observable(""),email:ko.observable(""),status:ko.observable("")},this.currentUserRoles=ko.observableArray([]),this.invokeRemoveUserDialog=function(user){var self=this;bootbox.confirm(sprintf.sprintf(localizer.getString("DeleteUserConfirmation"),user.name()),(function(isConfirmed){isConfirmed&&(PhpGenAdmin.Utils.showProgressCursor(),self.api.removeUser(user.id).done(function(result){self.users.remove(user)}.bind(this)).always((function(){PhpGenAdmin.Utils.hideProgressCursor()})).fail((function(message){utils.showErrorMessage(message)})))}))},this.invokeChangeUserPasswordDialog=function(user){this.changePasswordUser.id(user.id),this.changePasswordUser.name(user.name()),PhpGenChangePasswordDialog.open()},this.invokeEditUserDialog=function(user){var self=this,dialog=$("#pg-admin-edit-user-dialog");self.editUser.id(user.id),self.editUser.name(user.name()),self.editUser.password(user.password),self.editUser.email(user.email()),self.editUser.status(user.status()),$("#save-edit-user-dialog").bind("click",(function(e){e.preventDefault(),self.emailBasedFeaturesEnabled?self.api.updateUser(self.editUser.id(),self.editUser.name(),self.editUser.email(),self.editUser.status()).fail((function(message){utils.showErrorMessage(message)})).done((function(result){dialog.modal("hide"),user.name(result.name),user.email(result.email),user.status(result.status)})):self.api.changeUserName(self.editUser.id(),self.editUser.name()).fail((function(message){utils.showErrorMessage(message)})).done((function(result){dialog.modal("hide"),user.name(result.username)}))})),dialog.modal("show"),$("#user-username").focus(),dialog.bind("hidden.bs.modal",(function(){$("#save-edit-user-dialog").unbind("click"),dialog.unbind("hidden.bs.modal")}))},this.expandAllGrants=function(){for(var i=0;i<this.users().length;i++)this.users()[i].expandGrants()},this.collapseAllGrants=function(){for(var i=0;i<this.users().length;i++)this.users()[i].collapseGrants()},this.invokeAddUserDialog=function(){var self=this,dialog=$("#pg-admin-create-user-dialog"),confirmedPasswordErrorControl=$("#newuser-confirmed-password-error");self.newUser.id(""),self.newUser.name("New user"),self.newUser.password(""),self.newUser.confirmedPassword(""),confirmedPasswordErrorControl.hide(),self.newUser.email(""),$("#save-create-user-dialog").bind("click",(function(e){e.preventDefault(),PhpGenPasswordDialogUtils.validateConfirmedPassword(self.newUser.password(),self.newUser.confirmedPassword(),confirmedPasswordErrorControl)&&(self.emailBasedFeaturesEnabled?self.api.addUserEx(self.newUser.name(),self.newUser.password(),self.newUser.email()).fail((function(message){utils.showErrorMessage(message)})).done((function(result){dialog.modal("hide"),self.users.push(new PhpGenAdmin.UserViewModel(self.api,result.id,result.name,result.password,result.email,0,!0))})):self.api.addUser(self.newUser.name(),self.newUser.password()).fail((function(message){utils.showErrorMessage(message)})).done((function(result){dialog.modal("hide"),self.users.push(new PhpGenAdmin.UserViewModel(self.api,result.id,result.name,result.password,"",0,!0))})))})),dialog.modal("show"),$("#newuser-id").focus(),dialog.bind("hidden.bs.modal",(function(){$("#save-create-user-dialog").unbind("click"),dialog.unbind("hidden.bs.modal")}))},this.users=ko.observableArray([]),this.usersOnCurrentPage=ko.dependentObservable((function(){return this.users.slice(0,this.users().length).sort((function(a,b){return-1===a.id||0===a.id?0===b.id?1:-1:a.name()<b.name()?-1:a.name()>b.name()?1:0}))}),this)};var i,api=PhpGenUserManagementApi;for(window.PhpGenAdmin.adminPanelViewModel=new PhpGenAdmin.AdminPanelViewModel(api),PhpGenAdmin.adminPanelViewModel.emailBasedFeaturesEnabled=PhpGenAdmin.EmailBasedFeaturesEnabled,i=0;i<PhpGenAdmin.CurrentUsers.length;i++)PhpGenAdmin.adminPanelViewModel.users.push(new PhpGenAdmin.UserViewModel(api,PhpGenAdmin.CurrentUsers[i].id,PhpGenAdmin.CurrentUsers[i].name,PhpGenAdmin.CurrentUsers[i].password,PhpGenAdmin.CurrentUsers[i].email,PhpGenAdmin.CurrentUsers[i].status,PhpGenAdmin.CurrentUsers[i].editable));ko.applyBindings(PhpGenAdmin.adminPanelViewModel),PhpGenChangePasswordDialog.initialize(new PhpGenChangePasswordDialogAdminStrategy((function(newPassword){return api.changeUserPassword(PhpGenAdmin.adminPanelViewModel.changePasswordUser.id,newPassword)}))),$("#pg-admin-create-user-dialog").modal({show:!1}),$("#pg-admin-edit-user-dialog").modal({show:!1})}})),define("pgui.validation-utils",["pgui.localizer"],(function(localizer){return{validatePasswordBasedForm:function(fieldValues,errorInfo){return fieldValues.password===fieldValues.confirmedpassword||(errorInfo.SetMessage(localizer.getString("PasswordAndConfirmationPasswordMustMatch")),!1)}}})),define("pgui.registration-page",["pgui.form-page-main","pgui.validation-utils"],(function(initFormPage,validationUtils){return function(){initFormPage(),window.registrationFormValidation=validationUtils.validatePasswordBasedForm}})),define("pgui.reset-password-page",["pgui.form-page-main","pgui.validation-utils"],(function(initFormPage,validationUtils){return function(){initFormPage(),window.resetPasswordFormValidation=validationUtils.validatePasswordBasedForm}})),define("pgui.self_change_password",["pgui.user_management_api","pgui.change_password_dialog"],(function(PhpGenUserManagementApi){return function(){PhpGenChangePasswordDialog.initialize(new PhpGenChangePasswordDialogUserStrategy((function(currentPassword,newPassword){return PhpGenUserManagementApi.selfChangePassword(currentPassword,newPassword)}))),$("#self-change-password").click((function(){PhpGenChangePasswordDialog.open()}))}}));var PhpGenPasswordDialogUtils={validateConfirmedPassword:function(password,confirmedPassword,errorControl){return password!==confirmedPassword?(errorControl.show(),!1):(errorControl.hide(),!0)}};define("pgui.password_dialog_utils",(function(){})),$((function(){$("div[data-hint], img[data-hint], th[data-hint]").each((function(){$(this).popover({placement:"right",container:"body",trigger:"hover",html:!0,title:$(this).attr("data-hinttitle"),content:$(this).attr("data-hint")})}))})),define("custom/custom.hints",(function(){})),$((function(){function setWSFieldValue(formId,field_name,wsVal,overwrite=!0,ignore_new_empty=!0){return function(field,wsVal,field_name,overwrite,ignore_new_empty){const fieldType=$(field).attr("type");var oldVal=$(field).val();const isEmptyOldVal=!oldVal,isEmptyWsVal=!wsVal;oldVal==wsVal||isEmptyOldVal&&isEmptyWsVal||!overwrite&&!isEmptyOldVal?$(field).removeClass("ws-changed-value"):"checkbox"===fieldType?(oldVal=$(field).prop("checked"))!==wsVal&&($(field).prop("checked",wsVal).addClass("ws-changed-value"),$(field).parent().addClass("ws-changed-value"),$("#info-message").append('<p><span class="ws-update-val ws-update-val-old">'+field_name+": "+oldVal+'</span> â <span class="ws-update-val ws-update-val-new">'+wsVal+"</span></p>").show()):ignore_new_empty&&isEmptyWsVal||($(field).val(wsVal).addClass("ws-changed-value"),isEmptyOldVal||$("#info-message").append('<p><span class="ws-update-val ws-update-val-old">'+field_name+": "+oldVal+'</span> â <span class="ws-update-val ws-update-val-new">'+wsVal+"</span></p>").show())}("#"+formId+"_"+field_name+"_edit",wsVal,field_name,overwrite,ignore_new_empty)}$("#btn-ws-uid").click((function(){$(".row form").each((function(){const formId=$(this).attr("id"),uid_raw=$("#"+formId+"_uid_edit").val();uid_raw?($("#info-message").append("<p>Fetch data from uid webservice for "+uid_raw+"</p>").show(),$("#btn-ws-uid").addClass("btn-loading"),$.getJSON(`/de/data/interface/v1/json/ws/uid/flat/uid/${uid_raw}?access_key=cdaVCGjrDqbuR0kuD0lx4eHF9eJmiWBUP6OgLA4t`,(function(data,textStatus,jqXHR){data&&data.success&&data.data?(setWSFieldValue(formId,"name_de",data.data.name_de),setWSFieldValue(formId,"abkuerzung_de",data.data.abkuerzung_de),setWSFieldValue(formId,"in_handelsregister",data.data.in_handelsregister),setWSFieldValue(formId,"land_id",data.data.land_id),setWSFieldValue(formId,"adresse_strasse",data.data.adresse_strasse),setWSFieldValue(formId,"adresse_zusatz",data.data.adresse_zusatz),setWSFieldValue(formId,"adresse_plz",data.data.adresse_plz),setWSFieldValue(formId,"ort",data.data.ort),setWSFieldValue(formId,"bfs_gemeinde_nr",data.data.bfs_gemeinde_nr),setWSFieldValue(formId,"rechtsform",data.data.rechtsform),setWSFieldValue(formId,"rechtsform_zefix",data.data.rechtsform_zefix),setWSFieldValue(formId,"rechtsform_handelsregister",data.data.rechtsform_handelsregister),setWSFieldValue(formId,"beschreibung",data.data.zweck,!1),(data.data.inaktiv||!1===data.data.inaktiv)&&setWSFieldValue(formId,"inaktiv",data.data.inaktiv,!1),$("#info-message").append("<p>State: "+textStatus+"</p>").show()):$("#error-message").append("<p>Failed: "+data.message+" (Call state: "+textStatus+")</p>").show()})).fail((function(jqxhr,textStatus,error){const err=textStatus+", "+error;$("#error-message").append("<p>Request failed: "+err+"</p>").show()})).always((function(jqxhr,textStatus,error){$("#btn-ws-uid").removeClass("btn-loading")}))):$("#error-message").append('<p>Failed: Empty UID.<br>Search UID on <a href="https://www.uid.admin.ch/" title="Opens UID-Register@BFS webpage" target="_blank">UID-Register</a>.</p>').show()}))}))})),define("custom/custom.ws-uid",(function(){})),
/*! jQuery UI - v1.12.1 - 2016-11-12
* http://jqueryui.com
* Includes: widget.js, keycode.js, unique-id.js, widgets/tabs.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */
function(t){"function"==typeof define&&define.amd?define("custom/jquery-ui.min",["jquery"],t):t(jQuery)}((function(t){t.ui=t.ui||{},t.ui.version="1.12.1";var e=0,i=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{(s=t._data(n,"events"))&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r={},l=e.split(".")[0],h=l+"-"+(e=e.split(".")[1]);return s||(s=i,i=t.Widget),t.isArray(s)&&(s=t.extend.apply(null,[{}].concat(s))),t.expr[":"][h.toLowerCase()]=function(e){return!!t.data(e,h)},t[l]=t[l]||{},n=t[l][e],o=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),(a=new i).options=t.widget.extend({},a.options),t.each(s,(function(e,s){return t.isFunction(s)?void(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(r[e]=s)})),o.prototype=t.widget.extend(a,{widgetEventPrefix:n&&a.widgetEventPrefix||e},r,{constructor:o,namespace:l,widgetName:e,widgetFullName:h}),n?(t.each(n._childConstructors,(function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)})),delete n._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var s,n,o=i.call(arguments,1),a=0,r=o.length;r>a;a++)for(s in o[a])n=o[a][s],o[a].hasOwnProperty(s)&&void 0!==n&&(e[s]=t.isPlainObject(n)?t.isPlainObject(e[s])?t.widget.extend({},e[s],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,s){var n=s.prototype.widgetFullName||e;t.fn[e]=function(o){var a="string"==typeof o,r=i.call(arguments,1),l=this;return a?this.length||"instance"!==o?this.each((function(){var i,s=t.data(this,n);return"instance"===o?(l=s,!1):s?t.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,r))!==s&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")})):l=void 0:(r.length&&(o=t.widget.extend.apply(null,[o].concat(r))),this.each((function(){var e=t.data(this,n);e?(e.option(o||{}),e._init&&e._init()):t.data(this,n,new s(o,this))}))),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(i,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},s!==this&&(t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,(function(t,i){e._removeClass(i,t)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,s,n;for(i in e)n=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&n&&n.length&&(s=t(n.get()),this._removeClass(n,i),s.addClass(this._classes({element:s,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,o){var a,r;for(r=0;i.length>r;r++)a=n.classesElementLookup[i[r]]||t(),a=e.add?t(t.unique(a.get().concat(e.element.get()))):t(a.not(e.element).get()),n.classesElementLookup[i[r]]=a,s.push(i[r]),o&&e.classes[i[r]]&&s.push(e.classes[i[r]])}var s=[],n=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,(function(s,n){-1!==t.inArray(e.target,n)&&(i.classesElementLookup[s]=t(n.not(e.target).get()))}))},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var n="string"==typeof t||null===t,o={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,(function(s,a){function r(){return e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?n.on(h,c,r):i.on(h,r)}))},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var s=this;return setTimeout((function(){return("string"==typeof t?s[t]:t).apply(s,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(s))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?!0===n||"number"==typeof n?i:n.effect||i:e;"number"==typeof(n=n||{})&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue((function(i){t(this)[e](),o&&o.call(s[0]),i()}))}})),t.widget,t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.fn.extend({uniqueId:function(){var t=0;return function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++t)}))}}(),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")}))}}),t.ui.escapeSelector=function(){var t=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g;return function(e){return e.replace(t,"\\$1")}}(),t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(i){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,s;i=e.href.replace(t,""),s=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return e.hash.length>1&&i===s}}(),_create:function(){var e=this,i=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),(function(t){return e.tabs.index(t)})))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===e&&(s&&this.tabs.each((function(i,n){return t(n).attr("aria-controls")===s?(e=i,!1):void 0})),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=!!this.tabs.length&&0)),!1!==e&&(-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!i&&0)),!i&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(t.ui.safeActiveElement(this.document[0])).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:s++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:n=!1,s--;break;case t.ui.keyCode.END:s=this.anchors.length-1;break;case t.ui.keyCode.HOME:s=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(s);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(s!==this.options.active&&s);default:return}e.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",s)}),this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){for(var n=this.tabs.length-1;-1!==t.inArray((e>n&&(e=0),0>e&&(e=n),e),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){return"active"===t?void this._activate(e):(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),(function(t){return i.index(t)})),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",(function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()})).on("focus"+this.eventNamespace,".ui-tabs-anchor",(function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()})),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map((function(){return t("a",this)[0]})).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=t(),this.anchors.each((function(i,s){var n,o,a,r=t(s).uniqueId().attr("id"),l=t(s).closest("li"),h=l.attr("aria-controls");e._isLocal(s)?(a=(n=s.hash).substring(1),o=e.element.find(e._sanitizeSelector(n))):(n="#"+(a=l.attr("aria-controls")||t({}).uniqueId()[0].id),(o=e.element.find(n)).length||(o=e._createPanel(a)).insertAfter(e.panels[i-1]||e.tablist),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),h&&l.data("ui-tabs-aria-controls",h),l.attr({"aria-controls":a,"aria-labelledby":r}),o.attr("aria-labelledby",r)})),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(e){var i,s,n;for(t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1),n=0;s=this.tabs[n];n++)i=t(s),!0===e||-1!==t.inArray(n,e)?(i.attr("aria-disabled","true"),this._addClass(i,null,"ui-state-disabled")):(i.removeAttr("aria-disabled"),this._removeClass(i,null,"ui-state-disabled"));this.options.disabled=e,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===e)},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),(function(t,e){i[e]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){i-=t(this).outerHeight(!0)})),this.panels.each((function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each((function(){i=Math.max(i,t(this).height("").height())})).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,o=t(e.currentTarget).closest("li"),a=o[0]===s[0],r=a&&i.collapsible,l=r?t():this._getPanelForTab(o),h=s.length?this._getPanelForTab(s):t(),c={oldTab:s,oldPanel:h,newTab:r?t():o,newPanel:l};e.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||!1===this._trigger("beforeActivate",e,c)||(i.active=!r&&this.tabs.index(o),this.active=a?t():o,this.xhr&&this.xhr.abort(),h.length||l.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(o),e),this._toggle(e,c))},_toggle:function(e,i){function s(){o.running=!1,o._trigger("activate",e,i)}function n(){o._addClass(i.newTab.closest("li"),"ui-tabs-active","ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,s):(a.show(),s())}var o=this,a=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,(function(){o._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),n()})):(this._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),a.length&&r.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter((function(){return 0===t(this).attr("tabIndex")})).attr("tabIndex",-1),a.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+t.ui.escapeSelector(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each((function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")})),this.tabs.each((function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;!1!==i&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,(function(t){return t!==e?t:null})):t.map(this.tabs,(function(t,i){return i!==e?i:null}))),this._setOptionDisabled(i))},disable:function(e){var i=this.options.disabled;if(!0!==i){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setOptionDisabled(i)}},load:function(e,i){e=this._getIndex(e);var s=this,n=this.tabs.eq(e),o=n.find(".ui-tabs-anchor"),a=this._getPanelForTab(n),r={tab:n,panel:a},l=function(t,e){"abort"===e&&s.panels.stop(!1,!0),s._removeClass(n,"ui-tabs-loading"),a.removeAttr("aria-busy"),t===s.xhr&&delete s.xhr};this._isLocal(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(n,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done((function(t,e,n){setTimeout((function(){a.html(t),s._trigger("load",i,r),l(n,e)}),1)})).fail((function(t,e){setTimeout((function(){l(t,e)}),1)}))))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,o){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:o},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),!1!==t.uiBackCompat&&t.widget("ui.tabs",t.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),t.ui.tabs})),define("custom/custom-require",["custom/custom.hints","custom/custom.ws-uid","custom/pgui.selection-handler.ops","custom/jquery-ui.min"],(function(hints,wsuid,pgridops){})),define("modal_customize",["bootstrap"],(function(){var escapeHandler=function(e){document.activeElement===document.body&&27==e.which&&$(".modal").modal("hide")},$document=$(document),origShow=$.fn.modal.Constructor.prototype.show;$.fn.modal.Constructor.prototype.show=function(){origShow.apply(this,arguments);var self=this;this.$element.one("shown.bs.modal",(function(){var $input=self.$element.find(".form-control").get(0);$input&&$input.focus(),$document.on("keydown",escapeHandler)})),this.$element.one("hidden.bs.modal",(function(){$document.off("keydown",escapeHandler)}))};$.fn.modal.Constructor.prototype.hideModal;$.fn.modal.Constructor.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop((function(){0===that.$body.find(".modal:visible").length&&that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")}))},$document.on("show.bs.modal",".modal",(function(event){var parentModal=$document.find(".modal:visible").last();if(parentModal.length){var parentWidth=parentModal.find(".modal-dialog").width(),$dialog=$(this).find(".modal-dialog");parentWidth===$dialog.width()&&$dialog.css("width",parentWidth-40)}var zIndex=1040+10*$(".modal:visible").length;$(this).css("z-index",zIndex),setTimeout((function(){$(".modal-backdrop").not(".modal-stack").css("z-index",zIndex-1).addClass("modal-stack")}),0)}))})),define("main",["pgui.localizer","pgui.sidebar","pgui.list-page-main","pgui.view-page-main","pgui.compare-page-main","pgui.form-page-main","pgui.admin-page-main","pgui.registration-page","pgui.reset-password-page","pgui.self_change_password","pgui.utils","pgui.user_management_api","pgui.change_password_dialog","pgui.password_dialog_utils","jquery","bootstrap","custom/custom-require","modal_customize"],(function(localizer,initSidebar,initListPage,initViewPage,initComparePage,initFormPage,initAdminPage,initRegistrationPage,initResetPasswordPage,initSelfChangePassword,utils){require(["user"],(function(){"function"==typeof window.beforePageLoad&&window.beforePageLoad(),$((function(){var $body=$("body"),pageType=$body.data("page-entry"),inactivityTimeout=$body.data("inactivity-timeout");""!=pageType&&inactivityTimeout>0&&require(["inactivity_timeout"],(function(){initInactivityTimeout(inactivityTimeout)})),initSidebar($body),initSelfChangePassword(),localizer.load().done((function(){switch(pageType){case"list":initListPage();break;case"view":initViewPage();break;case"compare":initComparePage();break;case"form":initFormPage();break;case"admin":initAdminPage();break;case"register":initRegistrationPage();break;case"reset-password":initResetPasswordPage()}$body.data("inactivity-timeout-expired")&&utils.showMessage(localizer.getString("InactivityTimeoutExpired"))})),"function"==typeof window.afterPageLoad&&window.afterPageLoad()}))}))})),require(["main"]);
